"use strict";(globalThis.webpackChunkgl_0_bal_01=globalThis.webpackChunkgl_0_bal_01||[]).push([[7228],{28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var s=i(96540);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}},29174:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"Security/Pentesting/sop-ad-pentest","title":"Active Directory Pentesting SOP (Authorized)","description":"Master Active Directory penetration testing: enumeration, Kerberoasting, password spraying, privilege escalation, Golden Tickets & domain takeover.","source":"@site/intel-codex/Security/Pentesting/sop-ad-pentest.md","sourceDirName":"Security/Pentesting","slug":"/Security/Pentesting/sop-ad-pentest","permalink":"/intel-codex/Security/Pentesting/sop-ad-pentest","draft":false,"unlisted":false,"editUrl":"https://github.com/gl0bal01/intel-codex/tree/main/intel-codex/Security/Pentesting/sop-ad-pentest.md","tags":[{"inline":true,"label":"sop","permalink":"/intel-codex/tags/sop"},{"inline":true,"label":"pentest","permalink":"/intel-codex/tags/pentest"},{"inline":true,"label":"active-directory","permalink":"/intel-codex/tags/active-directory"},{"inline":true,"label":"internal","permalink":"/intel-codex/tags/internal"}],"version":"current","lastUpdatedAt":null,"frontMatter":{"type":"sop","title":"Active Directory Pentesting SOP (Authorized)","description":"Master Active Directory penetration testing: enumeration, Kerberoasting, password spraying, privilege escalation, Golden Tickets & domain takeover.","tags":["sop","pentest","active-directory","internal"],"template_version":"2025-10-05T00:00:00.000Z"},"sidebar":"intelCodexSidebar","previous":{"title":"Pentesting SOPs","permalink":"/intel-codex/Security/Pentesting/Pentesting-Index"},"next":{"title":"Bug Bounty Methodology SOP","permalink":"/intel-codex/Security/Pentesting/sop-bug-bounty"}}');var r=i(74848),t=i(28453);const l={type:"sop",title:"Active Directory Pentesting SOP (Authorized)",description:"Master Active Directory penetration testing: enumeration, Kerberoasting, password spraying, privilege escalation, Golden Tickets & domain takeover.",tags:["sop","pentest","active-directory","internal"],template_version:new Date("2025-10-05T00:00:00.000Z")},o="Active Directory Pentesting SOP (Authorized)",c={},a=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"1. Engagement Setup",id:"1-engagement-setup",level:2},{value:"Pre-Engagement",id:"pre-engagement",level:3},{value:"Objectives (Examples)",id:"objectives-examples",level:3},{value:"2. Domain Enumeration (Read-Only)",id:"2-domain-enumeration-read-only",level:2},{value:"Basic Domain Information",id:"basic-domain-information",level:3},{value:"User Enumeration",id:"user-enumeration",level:3},{value:"Group Enumeration",id:"group-enumeration",level:3},{value:"Computer Enumeration",id:"computer-enumeration",level:3},{value:"OU Structure",id:"ou-structure",level:3},{value:"3. BloodHound Analysis",id:"3-bloodhound-analysis",level:2},{value:"Data Collection",id:"data-collection",level:3},{value:"Import &amp; Analysis",id:"import--analysis",level:3},{value:"Pre-Built Queries to Run",id:"pre-built-queries-to-run",level:3},{value:"Custom Cypher Queries",id:"custom-cypher-queries",level:3},{value:"4. Privilege Escalation Paths",id:"4-privilege-escalation-paths",level:2},{value:"Kerberoasting",id:"kerberoasting",level:3},{value:"AS-REP Roasting",id:"as-rep-roasting",level:3},{value:"Unconstrained Delegation",id:"unconstrained-delegation",level:3},{value:"Constrained Delegation",id:"constrained-delegation",level:3},{value:"5. ACL Abuse &amp; Dangerous Permissions",id:"5-acl-abuse--dangerous-permissions",level:2},{value:"Common ACL Attack Paths",id:"common-acl-attack-paths",level:3},{value:"Find Dangerous ACLs",id:"find-dangerous-acls",level:3},{value:"DCSync Rights",id:"dcsync-rights",level:3},{value:"6. Group Policy Object (GPO) Review",id:"6-group-policy-object-gpo-review",level:2},{value:"Enumerate GPOs",id:"enumerate-gpos",level:3},{value:"GPO Security Issues",id:"gpo-security-issues",level:3},{value:"LAPS (Local Administrator Password Solution)",id:"laps-local-administrator-password-solution",level:3},{value:"7. Password Policy &amp; Account Security",id:"7-password-policy--account-security",level:2},{value:"Domain Password Policy",id:"domain-password-policy",level:3},{value:"Stale Accounts",id:"stale-accounts",level:3},{value:"8. Service Accounts &amp; Credentials",id:"8-service-accounts--credentials",level:2},{value:"Service Account Checks",id:"service-account-checks",level:3},{value:"Credentials in SYSVOL/Scripts",id:"credentials-in-sysvolscripts",level:3},{value:"9. Monitoring &amp; Detection Review",id:"9-monitoring--detection-review",level:2},{value:"Event Log Analysis",id:"event-log-analysis",level:3},{value:"Protected Users Group",id:"protected-users-group",level:3},{value:"10. Attack Simulation (Controlled Testing)",id:"10-attack-simulation-controlled-testing",level:2},{value:"Red Team TTPs to Test Detection For",id:"red-team-ttps-to-test-detection-for",level:3},{value:"11. Common Misconfigurations Checklist",id:"11-common-misconfigurations-checklist",level:2},{value:"12. Evidence Collection",id:"12-evidence-collection",level:2},{value:"13. Reporting",id:"13-reporting",level:2},{value:"Finding Format",id:"finding-format",level:3},{value:"Remediation Priority",id:"remediation-priority",level:3},{value:"14. Safety &amp; Legal",id:"14-safety--legal",level:2},{value:"15. Tools Reference",id:"15-tools-reference",level:2},{value:"16. Reference Resources",id:"16-reference-resources",level:2},{value:"Comprehensive Knowledge Bases",id:"comprehensive-knowledge-bases",level:3},{value:"Attack Technique Deep Dives",id:"attack-technique-deep-dives",level:3},{value:"Defense &amp; Hardening",id:"defense--hardening",level:3},{value:"Cheat Sheets &amp; Quick References",id:"cheat-sheets--quick-references",level:3},{value:"17. Common Pitfalls",id:"17-common-pitfalls",level:2},{value:"Related SOPs",id:"related-sops",level:2}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.admonition,{type:"danger",children:[(0,r.jsxs)(n.mdxAdmonitionTitle,{children:["Synced from an ",(0,r.jsx)(n.strong,{children:"Obsidian vault"})]}),(0,r.jsxs)(n.p,{children:["For graph and advanced features, download the ",(0,r.jsx)(n.strong,{children:"full"})," ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://github.com/gl0bal01/intel-codex",children:"Intel Codex Vault"})})," and open it in ",(0,r.jsx)(n.strong,{children:"Obsidian"}),"."]})]}),"\n",(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"active-directory-pentesting-sop-authorized",children:"Active Directory Pentesting SOP (Authorized)"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Authorized environments only."})," This SOP covers defensive assessment of Active Directory environments."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#active-directory-pentesting-sop-authorized",children:"Active Directory Pentesting SOP (Authorized)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#table-of-contents",children:"Table of Contents"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#1-engagement-setup",children:"1. Engagement Setup"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#pre-engagement",children:"Pre-Engagement"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#objectives-examples",children:"Objectives (Examples)"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#2-domain-enumeration-read-only",children:"2. Domain Enumeration (Read-Only)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#basic-domain-information",children:"Basic Domain Information"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#user-enumeration",children:"User Enumeration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#group-enumeration",children:"Group Enumeration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#computer-enumeration",children:"Computer Enumeration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#ou-structure",children:"OU Structure"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#3-bloodhound-analysis",children:"3. BloodHound Analysis"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#data-collection",children:"Data Collection"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#import--analysis",children:"Import & Analysis"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#pre-built-queries-to-run",children:"Pre-Built Queries to Run"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#custom-cypher-queries",children:"Custom Cypher Queries"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#4-privilege-escalation-paths",children:"4. Privilege Escalation Paths"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#kerberoasting",children:"Kerberoasting"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#as-rep-roasting",children:"AS-REP Roasting"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#unconstrained-delegation",children:"Unconstrained Delegation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#constrained-delegation",children:"Constrained Delegation"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#5-acl-abuse--dangerous-permissions",children:"5. ACL Abuse & Dangerous Permissions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#common-acl-attack-paths",children:"Common ACL Attack Paths"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#find-dangerous-acls",children:"Find Dangerous ACLs"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#dcsync-rights",children:"DCSync Rights"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#6-group-policy-object-gpo-review",children:"6. Group Policy Object (GPO) Review"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#enumerate-gpos",children:"Enumerate GPOs"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#gpo-security-issues",children:"GPO Security Issues"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#laps-local-administrator-password-solution",children:"LAPS (Local Administrator Password Solution)"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#7-password-policy--account-security",children:"7. Password Policy & Account Security"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#domain-password-policy",children:"Domain Password Policy"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#stale-accounts",children:"Stale Accounts"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#8-service-accounts--credentials",children:"8. Service Accounts & Credentials"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#service-account-checks",children:"Service Account Checks"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#credentials-in-sysvolscripts",children:"Credentials in SYSVOL/Scripts"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#9-monitoring--detection-review",children:"9. Monitoring & Detection Review"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#event-log-analysis",children:"Event Log Analysis"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#protected-users-group",children:"Protected Users Group"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#10-attack-simulation-controlled-testing",children:"10. Attack Simulation (Controlled Testing)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#red-team-ttps-to-test-detection-for",children:"Red Team TTPs to Test Detection For"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#11-common-misconfigurations-checklist",children:"11. Common Misconfigurations Checklist"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#12-evidence-collection",children:"12. Evidence Collection"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#13-reporting",children:"13. Reporting"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#finding-format",children:"Finding Format"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#remediation-priority",children:"Remediation Priority"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#14-safety--legal",children:"14. Safety & Legal"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#15-tools-reference",children:"15. Tools Reference"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#16-reference-resources",children:"16. Reference Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#comprehensive-knowledge-bases",children:"Comprehensive Knowledge Bases"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#attack-technique-deep-dives",children:"Attack Technique Deep Dives"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#defense--hardening",children:"Defense & Hardening"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#cheat-sheets--quick-references",children:"Cheat Sheets & Quick References"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#17-common-pitfalls",children:"17. Common Pitfalls"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#related-sops",children:"Related SOPs"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-engagement-setup",children:"1. Engagement Setup"}),"\n",(0,r.jsx)(n.h3,{id:"pre-engagement",children:"Pre-Engagement"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Obtain written authorization (signed Rules of Engagement)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Define scope: domains, forests, trusts, target OUs/hosts"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Identify test accounts vs production accounts"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Set time windows and blackout periods (avoid business-critical hours)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Establish emergency contacts (IT, security team, change management)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Confirm rollback procedures exist"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Determine if testing lab environment or limited production scope"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"objectives-examples",children:"Objectives (Examples)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Identify misconfigurations enabling lateral movement and privilege escalation"}),"\n",(0,r.jsx)(n.li,{children:"Validate detection/monitoring efficacy for AD attack paths"}),"\n",(0,r.jsx)(n.li,{children:"Test privileged group memberships and delegation"}),"\n",(0,r.jsx)(n.li,{children:"Review tiering model implementation"}),"\n",(0,r.jsx)(n.li,{children:"Assess Kerberos security (Kerberoasting, AS-REP roasting)"}),"\n",(0,r.jsx)(n.li,{children:"Evaluate GPO security and deployment"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-domain-enumeration-read-only",children:"2. Domain Enumeration (Read-Only)"}),"\n",(0,r.jsx)(n.h3,{id:"basic-domain-information",children:"Basic Domain Information"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# Domain information\nGet-ADDomain\nGet-ADForest\n\n# Domain Controllers\nGet-ADDomainController -Filter *\n\n# Domain trusts\nGet-ADTrust -Filter *\nnltest /domain_trusts\n\n# Forest trusts\nGet-ADForest | Select-Object -ExpandProperty Domains\n"})}),"\n",(0,r.jsx)(n.h3,{id:"user-enumeration",children:"User Enumeration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# All domain users\nGet-ADUser -Filter * -Properties *\n\n# Enabled users only\nGet-ADUser -Filter {Enabled -eq $true} -Properties *\n\n# Users with AdminCount=1 (protected accounts)\nGet-ADUser -Filter {AdminCount -eq 1} -Properties AdminCount\n\n# Users with password not required\nGet-ADUser -Filter {PasswordNotRequired -eq $true}\n\n# Users with password never expires\nGet-ADUser -Filter {PasswordNeverExpires -eq $true}\n\n# Users with no password expiration and enabled\nGet-ADUser -Filter {(PasswordNeverExpires -eq $true) -and (Enabled -eq $true)}\n\n# Service Principal Names (for Kerberoasting)\nGet-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName\n\n# Pre-Windows 2000 compatible access\nGet-ADUser -Filter * -Properties PrimaryGroupID | Where-Object {$_.PrimaryGroupID -eq 515}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"group-enumeration",children:"Group Enumeration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# All domain groups\nGet-ADGroup -Filter * -Properties *\n\n# Privileged groups\nGet-ADGroupMember "Domain Admins"\nGet-ADGroupMember "Enterprise Admins"\nGet-ADGroupMember "Schema Admins"\nGet-ADGroupMember "Administrators"\nGet-ADGroupMember "Account Operators"\nGet-ADGroupMember "Backup Operators"\nGet-ADGroupMember "Print Operators"\nGet-ADGroupMember "Server Operators"\n\n# Nested group memberships (recursive)\nGet-ADGroupMember "Domain Admins" -Recursive\n\n# Groups with AdminCount=1\nGet-ADGroup -Filter {AdminCount -eq 1}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"computer-enumeration",children:"Computer Enumeration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# All domain computers\nGet-ADComputer -Filter * -Properties *\n\n# Domain Controllers\nGet-ADComputer -Filter {PrimaryGroupID -eq 516} -Properties OperatingSystem\n\n# Servers\nGet-ADComputer -Filter {OperatingSystem -like "*Server*"} -Properties OperatingSystem\n\n# Workstations\nGet-ADComputer -Filter {OperatingSystem -like "*Windows 10*" -or OperatingSystem -like "*Windows 11*"}\n\n# Computers with unconstrained delegation\nGet-ADComputer -Filter {TrustedForDelegation -eq $true} -Properties TrustedForDelegation\n\n# Computers with constrained delegation\nGet-ADComputer -Filter {msDS-AllowedToDelegateTo -ne "$null"} -Properties msDS-AllowedToDelegateTo\n'})}),"\n",(0,r.jsx)(n.h3,{id:"ou-structure",children:"OU Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# List all OUs\nGet-ADOrganizationalUnit -Filter * | Select-Object Name,DistinguishedName\n\n# Check GPO links per OU\nGet-ADOrganizationalUnit -Filter * | Select-Object Name,LinkedGroupPolicyObjects\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-bloodhound-analysis",children:"3. BloodHound Analysis"}),"\n",(0,r.jsx)(n.h3,{id:"data-collection",children:"Data Collection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using SharpHound (Windows):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# Download SharpHound\n# https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors\n\n# Run collection (all methods)\n.\\SharpHound.exe -c All\n\n# Stealthy collection (avoid DCOnly)\n.\\SharpHound.exe -c Session,Trusts,ACL,Container,Group,LocalAdmin,RDP,DCOM,PSRemote\n\n# Specify domain\n.\\SharpHound.exe -c All -d domain.local\n\n# Exclude Domain Controllers from session enumeration (less noisy)\n.\\SharpHound.exe -c All --ExcludeDCs\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using BloodHound.py (Linux):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Install\npip install bloodhound\n\n# Run collection\nbloodhound-python -u username -p password -d domain.local -dc dc01.domain.local -c All\n\n# With NTLM hash\nbloodhound-python -u username --hashes :NTLMhash -d domain.local -dc dc01.domain.local -c All\n"})}),"\n",(0,r.jsx)(n.h3,{id:"import--analysis",children:"Import & Analysis"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Start Neo4j database:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo neo4j console\n# Navigate to http://localhost:7474\n# Default creds: neo4j/neo4j (change on first login)\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Start BloodHound GUI:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./BloodHound --no-sandbox\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Import collected data (drag .json files into BloodHound)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"pre-built-queries-to-run",children:"Pre-Built Queries to Run"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Shortest Paths:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Shortest Paths to Domain Admins"}),"\n",(0,r.jsx)(n.li,{children:"Shortest Paths to High Value Targets"}),"\n",(0,r.jsx)(n.li,{children:"Shortest Paths from Owned Principals"}),"\n",(0,r.jsx)(n.li,{children:"Shortest Paths from Kerberoastable Users"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Domain Information:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Find all Domain Admins"}),"\n",(0,r.jsx)(n.li,{children:"Find Workstations where Domain Users can RDP"}),"\n",(0,r.jsx)(n.li,{children:"Find Servers where Domain Users can RDP"}),"\n",(0,r.jsx)(n.li,{children:"Find Computers where Domain Users are Local Admin"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Kerberos:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"List all Kerberoastable Accounts"}),"\n",(0,r.jsx)(n.li,{children:"AS-REP Roastable Users (Do not require Pre-Authentication)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Delegation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Find Computers with Unconstrained Delegation"}),"\n",(0,r.jsx)(n.li,{children:"Find Computers with Constrained Delegation"}),"\n",(0,r.jsx)(n.li,{children:"Shortest Paths from Computers with Unconstrained Delegation"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"ACLs:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Find Principals with DCSync Rights"}),"\n",(0,r.jsx)(n.li,{children:"Users with Foreign Domain Group Membership"}),"\n",(0,r.jsx)(n.li,{children:"Groups with Foreign Domain Group Membership"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"custom-cypher-queries",children:"Custom Cypher Queries"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cypher",children:'// Users with path to Domain Admins (excluding direct members)\nMATCH (u:User),(g:Group {name:"DOMAIN ADMINS@DOMAIN.LOCAL"}),\np=shortestPath((u)-[*1..]->(g))\nWHERE NOT (u)-[:MemberOf]->(g)\nRETURN p\n\n// Computers with sessions from privileged users\nMATCH (c:Computer)-[:HasSession]->(u:User)-[:MemberOf*1..]->(g:Group)\nWHERE g.highvalue=true\nRETURN c.name, u.name, g.name\n\n// Users with GenericAll on computers\nMATCH (u:User)-[:GenericAll]->(c:Computer)\nRETURN u.name, c.name\n\n// Find owned users with paths to high value targets\nMATCH (u:User {owned:true}),(g:Group {highvalue:true}),\np=shortestPath((u)-[*1..]->(g))\nRETURN p\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-privilege-escalation-paths",children:"4. Privilege Escalation Paths"}),"\n",(0,r.jsx)(n.h3,{id:"kerberoasting",children:"Kerberoasting"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Identify targets:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# PowerShell\nGet-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName,MemberOf\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request service tickets (for offline cracking):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# Using Rubeus\n.\\Rubeus.exe kerberoast /outfile:kerberoast_hashes.txt\n\n# Using Invoke-Kerberoast (PowerView)\nInvoke-Kerberoast -OutputFormat Hashcat | fl\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Crack with hashcat:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"hashcat -m 13100 kerberoast_hashes.txt wordlist.txt\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Remediation recommendations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use strong passwords for service accounts (25+ characters)"}),"\n",(0,r.jsx)(n.li,{children:"Use Group Managed Service Accounts (gMSA)"}),"\n",(0,r.jsx)(n.li,{children:"Monitor for unusual TGS requests"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"as-rep-roasting",children:"AS-REP Roasting"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Identify targets:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# Users with "Do not require Kerberos preauthentication"\nGet-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties DoesNotRequirePreAuth\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request AS-REP hashes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# Using Rubeus\n.\\Rubeus.exe asreproast /outfile:asrep_hashes.txt\n\n# Using Impacket (Linux)\nGetNPUsers.py domain.local/ -usersfile users.txt -dc-ip 10.0.0.1\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Crack with hashcat:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"hashcat -m 18200 asrep_hashes.txt wordlist.txt\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Remediation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Enable Kerberos pre-authentication for all accounts"}),"\n",(0,r.jsx)(n.li,{children:"Monitor for AS-REP requests without pre-auth"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"unconstrained-delegation",children:"Unconstrained Delegation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Find computers/users with unconstrained delegation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# Computers\nGet-ADComputer -Filter {TrustedForDelegation -eq $true} -Properties TrustedForDelegation\n\n# Users\nGet-ADUser -Filter {TrustedForDelegation -eq $true} -Properties TrustedForDelegation\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Risk:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Any service on these systems can impersonate any user"}),"\n",(0,r.jsx)(n.li,{children:"If admin connects, attacker can extract TGT and impersonate them"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Remediation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Remove unconstrained delegation (use constrained instead)"}),"\n",(0,r.jsx)(n.li,{children:'Protect sensitive accounts with "Account is sensitive and cannot be delegated"'}),"\n",(0,r.jsx)(n.li,{children:"Monitor TGT requests from delegation-enabled systems"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"constrained-delegation",children:"Constrained Delegation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Find accounts with constrained delegation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Get-ADComputer -Filter {msDS-AllowedToDelegateTo -ne "$null"} -Properties msDS-AllowedToDelegateTo\nGet-ADUser -Filter {msDS-AllowedToDelegateTo -ne "$null"} -Properties msDS-AllowedToDelegateTo\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Risk:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Can impersonate any user to specific services"}),"\n",(0,r.jsx)(n.li,{children:"With protocol transition, can request tickets on behalf of any user"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Remediation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use Resource-Based Constrained Delegation (RBCD) instead"}),"\n",(0,r.jsx)(n.li,{children:"Monitor for S4U2Self/S4U2Proxy requests"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-acl-abuse--dangerous-permissions",children:"5. ACL Abuse & Dangerous Permissions"}),"\n",(0,r.jsx)(n.h3,{id:"common-acl-attack-paths",children:"Common ACL Attack Paths"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"GenericAll:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Full control over object"}),"\n",(0,r.jsx)(n.li,{children:"Can reset passwords, modify group membership, etc."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"WriteDACL:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Can modify permissions on object"}),"\n",(0,r.jsx)(n.li,{children:"Grant yourself GenericAll, then exploit"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"WriteOwner:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Can take ownership of object"}),"\n",(0,r.jsx)(n.li,{children:"Then grant permissions"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"GenericWrite:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Can write to most attributes"}),"\n",(0,r.jsx)(n.li,{children:"For users: modify scriptPath, servicePrincipalName"}),"\n",(0,r.jsx)(n.li,{children:"For computers: can perform RBCD attack"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"ForceChangePassword:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Can reset user password without knowing current password"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"find-dangerous-acls",children:"Find Dangerous ACLs"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using PowerView:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# Download PowerView\n# https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1\n\n# Find ACLs where non-standard principals have control\nFind-InterestingDomainAcl -ResolveGUIDs\n\n# Find ACLs for specific user\nGet-DomainObjectAcl -Identity "Domain Admins" -ResolveGUIDs\n\n# Find users with WriteDACL on Domain Admins\nGet-DomainObjectAcl -Identity "Domain Admins" -ResolveGUIDs | Where-Object {$_.ActiveDirectoryRights -match "WriteDacl"}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using BloodHound:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'Pre-built queries under "Dangerous Privileges"'}),"\n",(0,r.jsx)(n.li,{children:"Review edges: GenericAll, WriteDacl, WriteOwner, GenericWrite"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"dcsync-rights",children:"DCSync Rights"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Find principals with DCSync rights:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# PowerView\nGet-DomainObjectAcl \"DC=domain,DC=local\" -ResolveGUIDs | Where-Object {\n    ($_.ObjectType -match 'replication') -or\n    ($_.ActiveDirectoryRights -match 'GenericAll')\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Risk:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Allows replication of AD data (including password hashes)"}),"\n",(0,r.jsx)(n.li,{children:"Equivalent to Domain Admin"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Remediation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Only Domain Controllers and specific backup systems should have this right"}),"\n",(0,r.jsx)(n.li,{children:"Monitor for DS-Replication-Get-Changes events (4662)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-group-policy-object-gpo-review",children:"6. Group Policy Object (GPO) Review"}),"\n",(0,r.jsx)(n.h3,{id:"enumerate-gpos",children:"Enumerate GPOs"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# List all GPOs\nGet-GPO -All\n\n# GPOs linked to specific OU\nGet-GPInheritance -Target "OU=Servers,DC=domain,DC=local"\n\n# Find GPOs with specific settings\nGet-GPOReport -All -ReportType HTML -Path C:\\GPOReport.html\n'})}),"\n",(0,r.jsx)(n.h3,{id:"gpo-security-issues",children:"GPO Security Issues"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check for:"})}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Authenticated Users with edit rights on GPOs"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","GPOs with password/credential settings"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Unrestricted software installation policies"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Weak LAPS configuration"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Disabled security settings (Windows Firewall, Defender)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Find GPOs modifiable by non-admins:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# Using PowerView\nGet-DomainGPO | Get-DomainObjectAcl -ResolveGUIDs | Where-Object {\n    ($_.ActiveDirectoryRights -match "WriteProperty|GenericAll|GenericWrite|WriteDacl|WriteOwner") -and\n    ($_.SecurityIdentifier -match "S-1-5-21-.*-[0-9]{4,}")\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"laps-local-administrator-password-solution",children:"LAPS (Local Administrator Password Solution)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check if LAPS is deployed:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Get-ADComputer -Filter * -Properties ms-Mcs-AdmPwd | Where-Object {$_."ms-Mcs-AdmPwd" -ne $null}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check who can read LAPS passwords:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# Using PowerView\nGet-DomainComputer | Get-DomainObjectAcl -ResolveGUIDs | Where-Object {\n    $_.ObjectType -like "ms-Mcs-AdmPwd"\n} | Select-Object ObjectDN,SecurityIdentifier\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-password-policy--account-security",children:"7. Password Policy & Account Security"}),"\n",(0,r.jsx)(n.h3,{id:"domain-password-policy",children:"Domain Password Policy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"Get-ADDefaultDomainPasswordPolicy\n\n# Fine-Grained Password Policies\nGet-ADFineGrainedPasswordPolicy -Filter *\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check for weak policies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Minimum password length < 14 characters"}),"\n",(0,r.jsx)(n.li,{children:"Password history < 24"}),"\n",(0,r.jsx)(n.li,{children:"Maximum password age > 60 days"}),"\n",(0,r.jsx)(n.li,{children:"Lockout threshold disabled or > 5 attempts"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"stale-accounts",children:"Stale Accounts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# Users not logged in for 90+ days\n$90days = (Get-Date).AddDays(-90)\nGet-ADUser -Filter {LastLogonDate -lt $90days} -Properties LastLogonDate\n\n# Computers not logged in for 90+ days\nGet-ADComputer -Filter {LastLogonDate -lt $90days} -Properties LastLogonDate\n\n# Disabled accounts still in privileged groups\nGet-ADGroupMember "Domain Admins" | Get-ADUser | Where-Object {$_.Enabled -eq $false}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"8-service-accounts--credentials",children:"8. Service Accounts & Credentials"}),"\n",(0,r.jsx)(n.h3,{id:"service-account-checks",children:"Service Account Checks"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# Accounts with SPNs (service accounts)\nGet-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName,PasswordLastSet,PasswordNeverExpires\n\n# Check for old password last set dates\nGet-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties PasswordLastSet |\nWhere-Object {$_.PasswordLastSet -lt (Get-Date).AddYears(-1)}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Red flags:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Service accounts in Domain Admins"}),"\n",(0,r.jsx)(n.li,{children:"Service accounts with PasswordNeverExpires"}),"\n",(0,r.jsx)(n.li,{children:"Service accounts with interactive logon rights"}),"\n",(0,r.jsx)(n.li,{children:"SPNs on privileged accounts"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"credentials-in-sysvolscripts",children:"Credentials in SYSVOL/Scripts"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check for passwords in Group Policy Preferences (cpassword):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# Search SYSVOL for cpassword attribute (Groups.xml)\nfindstr /S /I cpassword \\\\domain.local\\sysvol\\domain.local\\policies\\*.xml\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check scripts for hardcoded credentials:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Get-ChildItem \\\\domain.local\\SYSVOL\\domain.local\\scripts -Recurse -Include *.ps1,*.bat,*.vbs |\nSelect-String -Pattern "password","pwd","pass"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"9-monitoring--detection-review",children:"9. Monitoring & Detection Review"}),"\n",(0,r.jsx)(n.h3,{id:"event-log-analysis",children:"Event Log Analysis"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check if important events are logged:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# Audit policy\nauditpol /get /category:*\n\n# Check for PowerShell logging\nGet-ItemProperty HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\nGet-ItemProperty HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key events to monitor:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"4624 (Successful logon)"}),"\n",(0,r.jsx)(n.li,{children:"4625 (Failed logon)"}),"\n",(0,r.jsx)(n.li,{children:"4672 (Special privileges assigned)"}),"\n",(0,r.jsx)(n.li,{children:"4768/4769 (Kerberos TGT/TGS requests)"}),"\n",(0,r.jsx)(n.li,{children:"4776 (NTLM authentication)"}),"\n",(0,r.jsx)(n.li,{children:"4662 (DCSync - replication operation)"}),"\n",(0,r.jsx)(n.li,{children:"7045 (Service installed)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"protected-users-group",children:"Protected Users Group"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# Check if high-value accounts are in Protected Users\nGet-ADGroupMember "Protected Users"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"No NTLM authentication"}),"\n",(0,r.jsx)(n.li,{children:"No DES or RC4 in Kerberos"}),"\n",(0,r.jsx)(n.li,{children:"No delegation"}),"\n",(0,r.jsx)(n.li,{children:"TGT max lifetime 4 hours"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"10-attack-simulation-controlled-testing",children:"10. Attack Simulation (Controlled Testing)"}),"\n",(0,r.jsx)(n.h3,{id:"red-team-ttps-to-test-detection-for",children:"Red Team TTPs to Test Detection For"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Initial Access:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Password spraying (low-volume, controlled)"}),"\n",(0,r.jsx)(n.li,{children:"AS-REP roasting"}),"\n",(0,r.jsx)(n.li,{children:"Kerberoasting"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Lateral Movement:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pass-the-Hash (in test environment)"}),"\n",(0,r.jsx)(n.li,{children:"Pass-the-Ticket"}),"\n",(0,r.jsx)(n.li,{children:"Overpass-the-Hash"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Privilege Escalation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ACL abuse (WriteDACL \u2192 GenericAll)"}),"\n",(0,r.jsx)(n.li,{children:"Unconstrained delegation exploitation"}),"\n",(0,r.jsx)(n.li,{children:"GPO modification"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Persistence:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Golden Ticket (test environment only)"}),"\n",(0,r.jsx)(n.li,{children:"Silver Ticket"}),"\n",(0,r.jsx)(n.li,{children:"DCSync"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Safety:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Coordinate with SOC/detection team"}),"\n",(0,r.jsx)(n.li,{children:"Use test accounts and canary systems"}),"\n",(0,r.jsx)(n.li,{children:"Monitor for alerts during tests"}),"\n",(0,r.jsx)(n.li,{children:"Document all actions with timestamps"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"11-common-misconfigurations-checklist",children:"11. Common Misconfigurations Checklist"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Domain/Enterprise Admins with more members than necessary"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Service accounts in privileged groups"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Computers with unconstrained delegation"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ",'Users with "Password never expires" enabled']}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Weak password policy (< 14 chars, no complexity)"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","LAPS not deployed or improperly configured"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Authenticated Users can modify GPOs"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No Protected Users group usage for VIPs"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","AdminSDHolder not monitored for modifications"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Stale accounts (90+ days inactive) not disabled"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Pre-Windows 2000 Compatible Access group populated"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Service accounts with interactive logon rights"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Credentials in SYSVOL scripts/GPP"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","PowerShell logging disabled"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No monitoring for DCSync (4662 events)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"12-evidence-collection",children:"12. Evidence Collection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"For each finding, document:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Object path (DN)"}),"\n",(0,r.jsx)(n.li,{children:"Exact PowerShell/tool command used"}),"\n",(0,r.jsx)(n.li,{children:"Full output (sanitize if needed)"}),"\n",(0,r.jsx)(n.li,{children:"Timestamp (UTC)"}),"\n",(0,r.jsx)(n.li,{children:"Screenshot for BloodHound paths"}),"\n",(0,r.jsx)(n.li,{children:"Risk level and business impact"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"File structure:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"/Evidence/{engagement_id}/AD/\n  \u251c\u2500\u2500 bloodhound/\n  \u2502   \u251c\u2500\u2500 20251005_bloodhound_data.zip\n  \u2502   \u2514\u2500\u2500 screenshots/\n  \u251c\u2500\u2500 enumeration/\n  \u2502   \u251c\u2500\u2500 20251005_domain_admins.txt\n  \u2502   \u251c\u2500\u2500 20251005_kerberoastable_users.txt\n  \u2502   \u2514\u2500\u2500 20251005_unconstrained_delegation.txt\n  \u251c\u2500\u2500 gpo/\n  \u2502   \u251c\u2500\u2500 20251005_gpo_report.html\n  \u2502   \u2514\u2500\u2500 20251005_sysvol_creds.txt\n  \u251c\u2500\u2500 acls/\n  \u2502   \u2514\u2500\u2500 20251005_dangerous_acls.txt\n  \u2514\u2500\u2500 hashes/\n      \u2514\u2500\u2500 evidence_hashes.txt\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Hash all files:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"Get-FileHash *.txt,*.html,*.zip | Export-Csv hashes.csv\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"13-reporting",children:"13. Reporting"}),"\n",(0,r.jsx)(n.h3,{id:"finding-format",children:"Finding Format"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'Title: Service Accounts with Unconstrained Delegation\nSeverity: Critical\nAffected Objects:\n  - SQLSVC@domain.local (CN=SQLSVC,OU=Service Accounts,DC=domain,DC=local)\n  - WEBSVC@domain.local (CN=WEBSVC,OU=Service Accounts,DC=domain,DC=local)\n\nDescription:\nService accounts configured with unconstrained delegation can be abused to\nimpersonate any domain user, including Domain Admins, if they authenticate\nto the compromised system.\n\nImpact:\nIf an attacker compromises the SQL or Web servers, they can extract TGTs\nfrom memory for any user who authenticates, leading to full domain compromise.\n\nEvidence:\nGet-ADUser -Filter {TrustedForDelegation -eq $true} -Properties TrustedForDelegation\nOutput: [screenshot/paste]\n\nAttack Path (BloodHound):\n[Screenshot showing path from SQLSVC to Domain Admins]\n\nRemediation:\n1. Remove unconstrained delegation from service accounts\n2. Implement constrained or resource-based constrained delegation instead\n3. Add sensitive accounts to Protected Users group\n4. Enable "Account is sensitive and cannot be delegated" for VIP accounts\n\nVerification:\n1. Re-run: Get-ADUser -Filter {TrustedForDelegation -eq $true}\n2. Verify no service accounts have TrustedForDelegation=True\n3. Confirm Protected Users group contains Domain/Enterprise Admins\n'})}),"\n",(0,r.jsx)(n.h3,{id:"remediation-priority",children:"Remediation Priority"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Critical:"})," Unconstrained delegation, DCSync rights to non-DCs, DA credentials in SYSVOL"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"High:"})," Kerberoastable privileged accounts, weak ACLs on admin groups, no LAPS"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Medium:"})," Stale privileged accounts, weak password policy, missing audit logging"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Low:"})," Informational findings, hardening recommendations"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"14-safety--legal",children:"14. Safety & Legal"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Read-only enumeration first:"})," Gather data before testing exploitability"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Coordinate with stakeholders"})," before password attacks or GPO modifications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use test accounts"})," for exploitation testing (not production accounts)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitor for impact:"})," Watch for service disruptions, lockouts, replication issues"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stop immediately"})," if Domain Controllers show instability"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Document everything"})," for audit trail and legal defensibility"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Respect scope:"})," Do not pivot to out-of-scope domains/forests without approval"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"15-tools-reference",children:"15. Tools Reference"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Tool"}),(0,r.jsx)(n.th,{children:"Purpose"}),(0,r.jsx)(n.th,{children:"Link"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"BloodHound"}),(0,r.jsx)(n.td,{children:"AD relationship mapping"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://github.com/BloodHoundAD/BloodHound",children:"github.com/BloodHoundAD/BloodHound"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SharpHound"}),(0,r.jsx)(n.td,{children:"BloodHound data collector (Windows)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://github.com/BloodHoundAD/BloodHound",children:"github.com/BloodHoundAD/BloodHound"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"BloodHound.py"}),(0,r.jsx)(n.td,{children:"BloodHound collector (Linux)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://github.com/fox-it/BloodHound.py",children:"github.com/fox-it/BloodHound.py"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PowerView"}),(0,r.jsx)(n.td,{children:"AD enumeration (PowerShell)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://github.com/PowerShellMafia/PowerSploit",children:"github.com/PowerShellMafia/PowerSploit"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Rubeus"}),(0,r.jsx)(n.td,{children:"Kerberos abuse toolkit"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://github.com/GhostPack/Rubeus",children:"github.com/GhostPack/Rubeus"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Impacket"}),(0,r.jsx)(n.td,{children:"Python AD toolkit"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://github.com/SecureAuthCorp/impacket",children:"github.com/SecureAuthCorp/impacket"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADRecon"}),(0,r.jsx)(n.td,{children:"AD data aggregation"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://github.com/adrecon/ADRecon",children:"github.com/adrecon/ADRecon"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PingCastle"}),(0,r.jsx)(n.td,{children:"AD security audit"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://www.pingcastle.com/",children:"pingcastle.com"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Purple Knight"}),(0,r.jsx)(n.td,{children:"AD security assessment"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://www.purple-knight.com/",children:"purple-knight.com"})})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"16-reference-resources",children:"16. Reference Resources"}),"\n",(0,r.jsx)(n.h3,{id:"comprehensive-knowledge-bases",children:"Comprehensive Knowledge Bases"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"The Hacker Recipes"})," - ",(0,r.jsx)(n.a,{href:"https://www.thehacker.recipes/",children:"thehacker.recipes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Excellent AD attack techniques, Kerberos exploitation, ACL abuse"}),"\n",(0,r.jsx)(n.li,{children:"Well-documented attack paths with defensive recommendations"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"HackTricks - Active Directory"})," - ",(0,r.jsx)(n.a,{href:"https://book.hacktricks.xyz/windows-hardening/active-directory-methodology",children:"book.hacktricks.xyz/windows-hardening/active-directory-methodology"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Comprehensive AD pentesting methodology"}),"\n",(0,r.jsx)(n.li,{children:"Covers enumeration, lateral movement, privilege escalation"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"LOLAD Project"})," - ",(0,r.jsx)(n.a,{href:"https://lolad-project.github.io/",children:"lolad-project.github.io"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Living Off the Land in Active Directory"}),"\n",(0,r.jsx)(n.li,{children:"Built-in Windows tools and commands for AD exploitation"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Zer1t0's Active Directory Cheatsheet"})," - ",(0,r.jsx)(n.a,{href:"https://zer1t0.gitlab.io/posts/attacking_ad/",children:"zer1t0.gitlab.io/posts/attacking_ad"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"In-depth technical AD attack techniques"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MITRE ATT&CK - Windows"})," - ",(0,r.jsx)(n.a,{href:"https://attack.mitre.org/matrices/enterprise/windows/",children:"attack.mitre.org/matrices/enterprise/windows"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Adversary tactics and techniques mapped to AD environments"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"attack-technique-deep-dives",children:"Attack Technique Deep Dives"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"adsecurity.org"})," - ",(0,r.jsx)(n.a,{href:"https://adsecurity.org/",children:"adsecurity.org"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sean Metcalf's research on AD security and Kerberos"}),"\n",(0,r.jsx)(n.li,{children:"Golden Ticket, Silver Ticket, DCSync attacks"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PayloadsAllTheThings - AD Attack"})," - ",(0,r.jsx)(n.a,{href:"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md",children:"github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cheatsheet with commands and payloads"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pentester Academy - AD Labs"})," - ",(0,r.jsx)(n.a,{href:"https://www.pentesteracademy.com/",children:"pentesteracademy.com"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Hands-on AD pentesting courses"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SpecterOps Blog"})," - ",(0,r.jsx)(n.a,{href:"https://posts.specterops.io/",children:"posts.specterops.io"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Research from BloodHound creators (Will Schroeder, Andy Robbins)"}),"\n",(0,r.jsx)(n.li,{children:"Advanced attack paths and tooling"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"defense--hardening",children:"Defense & Hardening"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Microsoft AD Security Best Practices"})," - ",(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices",children:"docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tier Model (Privileged Access)"})," - ",(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/security/compass/privileged-access-access-model",children:"docs.microsoft.com/en-us/security/compass/privileged-access-access-model"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"AD Security by Orange Cyberdefense"})," - ",(0,r.jsx)(n.a,{href:"https://github.com/Orange-Cyberdefense/arsenal",children:"github.com/Orange-Cyberdefense/arsenal"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cheat-sheets--quick-references",children:"Cheat Sheets & Quick References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Wadcoms - AD Commands"})," - ",(0,r.jsx)(n.a,{href:"https://wadcoms.github.io/",children:"wadcoms.github.io"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Interactive WAD (Windows/AD) command reference"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"AD Pentesting Cheatsheet by S1ckB0y1337"})," - ",(0,r.jsx)(n.a,{href:"https://github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet",children:"github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"AD Exploitation Cheatsheet by Integration IT"})," - ",(0,r.jsx)(n.a,{href:"https://github.com/Integration-IT/Active-Directory-Exploitation-Cheat-Sheet",children:"github.com/Integration-IT/Active-Directory-Exploitation-Cheat-Sheet"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"17-common-pitfalls",children:"17. Common Pitfalls"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u274c Running SharpHound with DCOnly in production (generates excessive traffic)"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Not coordinating with SOC before testing (causes alert fatigue)"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Using production admin accounts for testing (contaminates evidence)"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Requesting too many Kerberos tickets at once (triggers detections)"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Not checking scope before enumerating trusts (cross-domain pivots)"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Forgetting to sanitize credentials in reports/screenshots"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Relying only on BloodHound (manual validation is critical)"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Not testing detection coverage (pentest should validate monitoring)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"related-sops",children:"Related SOPs"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Analysis:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Analysis/sop-reverse-engineering",children:"Reverse Engineering"})," - Windows binary analysis and exploit development"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Analysis/sop-cryptography-analysis",children:"Cryptography Analysis"})," - Kerberos ticket analysis and password cracking"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Analysis/sop-malware-analysis",children:"Malware Analysis"})," - Analyzing malicious tools found in AD environment"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pentesting & Security:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Pentesting/sop-linux-pentest",children:"Linux Pentesting"})," - Linux host compromise in AD environments"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Pentesting/sop-web-application-security",children:"Web Application Security"})," - Web apps integrated with AD authentication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Pentesting/sop-vulnerability-research",children:"Vulnerability Research"})," - Finding Windows and AD vulnerabilities"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Pentesting/sop-detection-evasion-testing",children:"Detection Evasion Testing"})," - Bypassing EDR and AD security monitoring"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Analysis/sop-forensics-investigation",children:"Forensics Investigation"})," - Post-breach analysis and incident response"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../Security/Pentesting/sop-bug-bounty",children:"Bug Bounty Hunting"})," - Reporting AD vulnerabilities responsibly"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);