<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-intel-codex docs-version-current docs-doc-page docs-doc-id-Security/Analysis/sop-malware-analysis" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Malware Analysis SOP | gl0bal01 | Notes &amp; Research</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://gl0bal01.com/img/lama.jpg"><meta data-rh="true" name="twitter:image" content="https://gl0bal01.com/img/lama.jpg"><meta data-rh="true" property="og:url" content="https://gl0bal01.com/intel-codex/Security/Analysis/sop-malware-analysis"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="cybersecurity, osint, digital forensics, penetration testing, reverse engineering, malware analysis, AI security, intelligence gathering"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-intel-codex-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-intel-codex-current"><meta data-rh="true" property="og:title" content="Malware Analysis SOP | gl0bal01 | Notes &amp; Research"><meta data-rh="true" name="description" content="Complete malware analysis guide: static/dynamic analysis, sandbox setup, IOC extraction, YARA rules &amp; threat intelligence for malware investigation."><meta data-rh="true" property="og:description" content="Complete malware analysis guide: static/dynamic analysis, sandbox setup, IOC extraction, YARA rules &amp; threat intelligence for malware investigation."><link data-rh="true" rel="icon" href="/icons/favicon.ico"><link data-rh="true" rel="canonical" href="https://gl0bal01.com/intel-codex/Security/Analysis/sop-malware-analysis"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/intel-codex/Security/Analysis/sop-malware-analysis" hreflang="en"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/intel-codex/Security/Analysis/sop-malware-analysis" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Security & Analysis","item":"https://gl0bal01.com/intel-codex/category/security--analysis"},{"@type":"ListItem","position":2,"name":"Analysis","item":"https://gl0bal01.com/intel-codex/category/analysis"},{"@type":"ListItem","position":3,"name":"Malware Analysis SOP","item":"https://gl0bal01.com/intel-codex/Security/Analysis/sop-malware-analysis"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="gl0bal01 Blog - Security Research &amp; Human Psychology RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="gl0bal01 Blog - Security Research &amp; Human Psychology Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NFE7MZ9S3P"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NFE7MZ9S3P",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="gl0bal01 | Notes &amp; Research" href="/opensearch.xml">




<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous">
<link rel="preconnect" href="https://www.googletagmanager.com">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Host+Grotesk:wght@600;800&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.a89a0862.css">
<script src="/assets/js/runtime~main.e5d3dc9b.js" defer="defer"></script>
<script src="/assets/js/main.90a6e438.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/icons/android-icon-48x48.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">gl0bal01</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" aria-label="Intel Codex documentation" href="/intel-codex">Intel Codex</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" aria-label="Practical resources navigation menu">Practical</a><ul class="dropdown__menu"><li><a class="dropdown__link" aria-label="OSINT resources" href="/osint">Osint</a></li><li><a class="dropdown__link" aria-label="Cybersecurity resources" href="/cyber">Cyber</a></li><li><a class="dropdown__link" aria-label="Reverse engineering resources" href="/reverse-engineering">Reverse</a></li><li><a class="dropdown__link" aria-label="AI and machine learning resources" href="/ai">AI</a></li></ul></div><a class="navbar__item navbar__link" aria-label="Security and development cheatsheets" href="/cheatsheets">Cheatsheets</a><a class="navbar__item navbar__link" aria-label="Blog posts and articles" href="/blog">Blog</a><a class="navbar__item navbar__link" aria-label="Latest news and updates" href="/news">News</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/gl0bal01" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intel-codex"><span title="Intel Codex Overview" class="linkLabel_WmDU">Intel Codex Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/intel-codex/category/investigations"><span title="Investigations" class="categoryLinkLabel_W154">Investigations</span></a><button aria-label="Collapse sidebar category &#x27;Investigations&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Investigations-Index"><span title="Investigation Index" class="linkLabel_WmDU">Investigation Index</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/platform-guides"><span title="Platform Guides" class="categoryLinkLabel_W154">Platform Guides</span></a><button aria-label="Collapse sidebar category &#x27;Platform Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/Platforms-Index"><span title="Platform Investigation SOPs" class="linkLabel_WmDU">Platform Investigation SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-bluesky"><span title="Bluesky SOP" class="linkLabel_WmDU">Bluesky SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-instagram"><span title="Instagram SOP" class="linkLabel_WmDU">Instagram SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-linkedin"><span title="LinkedIn SOP" class="linkLabel_WmDU">LinkedIn SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-reddit"><span title="Reddit SOP" class="linkLabel_WmDU">Reddit SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-telegram"><span title="Telegram SOP" class="linkLabel_WmDU">Telegram SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-tiktok"><span title="TikTok SOP" class="linkLabel_WmDU">TikTok SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-twitter-x"><span title="Twitter/X SOP" class="linkLabel_WmDU">Twitter/X SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/investigation-techniques"><span title="Investigation Techniques" class="categoryLinkLabel_W154">Investigation Techniques</span></a><button aria-label="Collapse sidebar category &#x27;Investigation Techniques&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/Techniques-Index"><span title="OSINT Investigation Techniques" class="linkLabel_WmDU">OSINT Investigation Techniques</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-collection-log"><span title="OSINT Collection Log &amp; Chain of Custody" class="linkLabel_WmDU">OSINT Collection Log &amp; Chain of Custody</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-entity-dossier"><span title="Entity Dossier Guide" class="linkLabel_WmDU">Entity Dossier Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-financial-aml-osint"><span title="Financial Crime &amp; AML OSINT" class="linkLabel_WmDU">Financial Crime &amp; AML OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-image-video-osint"><span title="Image &amp; Video OSINT" class="linkLabel_WmDU">Image &amp; Video OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-legal-ethics"><span title="Legal, Ethics &amp; Data Governance for OSINT" class="linkLabel_WmDU">Legal, Ethics &amp; Data Governance for OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-opsec-plan"><span title="OPSEC Planning for OSINT Investigations" class="linkLabel_WmDU">OPSEC Planning for OSINT Investigations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-reporting-packaging-disclosure"><span title="Reporting, Packaging &amp; Disclosure" class="linkLabel_WmDU">Reporting, Packaging &amp; Disclosure</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-sensitive-crime-intake-escalation"><span title="Sensitive Crime Intake &amp; Escalation" class="linkLabel_WmDU">Sensitive Crime Intake &amp; Escalation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-web-dns-whois-osint"><span title="Web, DNS &amp; WHOIS OSINT" class="linkLabel_WmDU">Web, DNS &amp; WHOIS OSINT</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/intel-codex/category/security--analysis"><span title="Security &amp; Analysis" class="categoryLinkLabel_W154">Security &amp; Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Security &amp; Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/intel-codex/category/analysis"><span title="Analysis" class="categoryLinkLabel_W154">Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/Analysis-Index"><span title="Security Analysis SOPs" class="linkLabel_WmDU">Security Analysis SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-ai-vulnerability-evasion"><span title="AI/ML Vulnerability &amp; Evasion Testing SOP" class="linkLabel_WmDU">AI/ML Vulnerability &amp; Evasion Testing SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-cryptography-analysis"><span title="Cryptography Analysis SOP" class="linkLabel_WmDU">Cryptography Analysis SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-forensics-investigation"><span title="Digital Forensics Investigation SOP" class="linkLabel_WmDU">Digital Forensics Investigation SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-hash-generation-methods"><span title="Hash Generation Methods for Evidence Integrity" class="linkLabel_WmDU">Hash Generation Methods for Evidence Integrity</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/intel-codex/Security/Analysis/sop-malware-analysis"><span title="Malware Analysis SOP" class="linkLabel_WmDU">Malware Analysis SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-reverse-engineering"><span title="Reverse Engineering" class="linkLabel_WmDU">Reverse Engineering</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/penetration-testing"><span title="Penetration Testing" class="categoryLinkLabel_W154">Penetration Testing</span></a><button aria-label="Collapse sidebar category &#x27;Penetration Testing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/Pentesting-Index"><span title="Pentesting SOPs" class="linkLabel_WmDU">Pentesting SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-ad-pentest"><span title="Active Directory Pentesting SOP (Authorized)" class="linkLabel_WmDU">Active Directory Pentesting SOP (Authorized)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-bug-bounty"><span title="Bug Bounty Methodology SOP" class="linkLabel_WmDU">Bug Bounty Methodology SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-detection-evasion-testing"><span title="Detection &amp; Evasion Testing SOP (Purple Team)" class="linkLabel_WmDU">Detection &amp; Evasion Testing SOP (Purple Team)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering"><span title="Firmware Reverse Engineering" class="linkLabel_WmDU">Firmware Reverse Engineering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-linux-pentest"><span title="Linux Pentesting SOP (Authorized)" class="linkLabel_WmDU">Linux Pentesting SOP (Authorized)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-mobile-security"><span title="Mobile Security (iOS &amp; Android)" class="linkLabel_WmDU">Mobile Security (iOS &amp; Android)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-vulnerability-research"><span title="Vulnerability Research SOP" class="linkLabel_WmDU">Vulnerability Research SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-web-application-security"><span title="Web Application Security Testing SOP" class="linkLabel_WmDU">Web Application Security Testing SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Security-Index"><span title="Security Index" class="linkLabel_WmDU">Security Index</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/intel-codex/category/security--analysis"><span>Security &amp; Analysis</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/intel-codex/category/analysis"><span>Analysis</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Malware Analysis SOP</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Synced from an <strong>Obsidian vault</strong></div><div class="admonitionContent_BuS1"><p>For graph and advanced features, download the <strong>full</strong> <strong><a href="https://github.com/gl0bal01/intel-codex" target="_blank" rel="noopener noreferrer" class="">Intel Codex Vault</a></strong> and open it in <strong>Obsidian</strong>.</p></div></div>
<header><h1>Malware Analysis SOP</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents" translate="no">​</a></h2>
<ol start="0">
<li class=""><a href="#0-scope--principles" class="">Scope &amp; Principles</a></li>
<li class=""><a href="#1-safety--opsec--pre-flight-checklist" class="">Safety &amp; OPSEC — 🔒 Pre-Flight Checklist</a></li>
<li class=""><a href="#2-intake--chain-of-custody" class="">Intake &amp; Chain of Custody</a></li>
<li class=""><a href="#3-rapid-triage-static-analysis" class="">Rapid Triage (Static Analysis)</a></li>
<li class=""><a href="#4-behavior-analysis-dynamic-in-lab-only" class="">Behavior Analysis (Dynamic, In-Lab Only)</a></li>
<li class=""><a href="#5-artefact-extraction--normalization" class="">Artefact Extraction &amp; Normalization</a></li>
<li class=""><a href="#6-specialized-file-analysis" class="">Specialized File Analysis</a></li>
<li class=""><a href="#7-classification--ttp-mapping" class="">Classification &amp; TTP Mapping</a></li>
<li class=""><a href="#8-iocs--detection-engineering" class="">IOCs &amp; Detection Engineering</a></li>
<li class=""><a href="#9-reporting--documentation" class="">Reporting &amp; Documentation</a></li>
<li class=""><a href="#10-advanced-techniques" class="">Advanced Techniques</a></li>
<li class=""><a href="#11-qa--peer-review" class="">QA &amp; Peer Review</a></li>
<li class=""><a href="#12-extended-reference-resources" class="">Extended Reference Resources</a></li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="0-scope--principles">0. Scope &amp; Principles<a href="#0-scope--principles" class="hash-link" aria-label="Direct link to 0. Scope &amp; Principles" title="Direct link to 0. Scope &amp; Principles" translate="no">​</a></h2>
<ul>
<li class=""><strong>Objective:</strong> Analyze suspicious binaries/objects to extract IOCs, assess behavior, and assist containment/detection.</li>
<li class=""><strong>Execution Environment:</strong> Use only <strong>isolated, disposable VM snapshots</strong> (no host execution). No clipboard or drag‑and‑drop. Prefer offline analysis or simulated internet (INetSim/DNS sinkhole).</li>
<li class=""><strong>Legal Notice:</strong> If evidence of <strong>child safety concerns or imminent harm</strong> arises, <strong>stop immediately</strong>. Collect metadata and follow <strong>Sensitive Crime Escalation</strong> procedures.</li>
<li class=""><strong>Confidentiality:</strong> Treat all outputs/samples as sensitive. Share <strong>on a need-to-know basis</strong> only. Label clearly (e.g., <code>MALWARE / DO-NOT-TOUCH</code>).</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-safety--opsec---pre-flight-checklist">1. Safety &amp; OPSEC — 🔒 Pre-Flight Checklist<a href="#1-safety--opsec---pre-flight-checklist" class="hash-link" aria-label="Direct link to 1. Safety &amp; OPSEC — 🔒 Pre-Flight Checklist" title="Direct link to 1. Safety &amp; OPSEC — 🔒 Pre-Flight Checklist" translate="no">​</a></h2>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Use <strong>VM snapshot</strong> (clean, no shared folders/network, no host time sync).</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Use <strong>analysis persona</strong> (no personal/org credentials).</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Hostname, username, timezone must be <strong>non-attributable</strong>.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>No real internet</strong>. Simulated network only (e.g., INetSim).</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <strong>Tooling integrity</strong>: Verify hashes before installation; use only approved tools.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Encrypt artefacts and label with warnings when transporting.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Avoid uploading binaries to public services. Prefer <strong>hash-only queries</strong>.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="lab-environment-setup">Lab Environment Setup<a href="#lab-environment-setup" class="hash-link" aria-label="Direct link to Lab Environment Setup" title="Direct link to Lab Environment Setup" translate="no">​</a></h3>
<p><strong>VMware/VirtualBox Configuration:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Recommended VM specifications</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- OS: Windows </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">/11 or REMnux/FlareVM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- RAM: 4GB minimum </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">8GB preferred</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Disk: 60GB thin provisioned</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Network: Host-only or NAT with INetSim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Snapshots: Take </span><span class="token string" style="color:#e3116c">&quot;Clean State&quot;</span><span class="token plain"> before each analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Disable shared features</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Shared folders: OFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Clipboard sharing: OFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Drag and drop: OFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Time synchronization: OFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Guest additions: Minimal/None</span><br></span></code></pre></div></div>
<p><strong>INetSim Setup (Simulated Internet):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install INetSim (Linux-based)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> inetsim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Configure /etc/inetsim/inetsim.conf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service_bind_address    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dns_default_ip          </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.56.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https_bind_port         </span><span class="token number" style="color:#36acaa">443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http_bind_port          </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start INetSim</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> inetsim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Configure VM to use INetSim as DNS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set DNS server to INetSim host IP (e.g., 192.168.56.1)</span><br></span></code></pre></div></div>
<p><strong>FlareVM Installation (Windows Analysis):</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Run as Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Set-ExecutionPolicy Unrestricted -Force</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-WebRequest https://raw.githubusercontent.com/mandiant/flare-vm/main/install.ps1 -OutFile install.ps1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.\install.ps1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Post-install: Disable Windows Defender (analysis VM only)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Set-MpPreference -DisableRealtimeMonitoring $true</span><br></span></code></pre></div></div>
<p><strong>REMnux Installation (Linux Malware Analysis):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Download REMnux OVA or install on existing Ubuntu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://REMnux.org/remnux-cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"> remnux-cli </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Update tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remnux update</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-intake--chain-of-custody">2. Intake &amp; Chain of Custody<a href="#2-intake--chain-of-custody" class="hash-link" aria-label="Direct link to 2. Intake &amp; Chain of Custody" title="Direct link to 2. Intake &amp; Chain of Custody" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="sample-acquisition--metadata-collection">Sample Acquisition &amp; Metadata Collection<a href="#sample-acquisition--metadata-collection" class="hash-link" aria-label="Direct link to Sample Acquisition &amp; Metadata Collection" title="Direct link to Sample Acquisition &amp; Metadata Collection" translate="no">​</a></h3>
<ol>
<li class="">
<p><strong>Assign identifiers:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">case_id: CASE-2025-1005-001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sample_id: SAM-20251005-1430-001</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Log acquisition metadata:</strong></p>
<ul>
<li class="">Source (email attachment, endpoint, URL, upload)</li>
<li class="">Timestamp (UTC)</li>
<li class="">Submitter name and contact</li>
<li class="">Original filename and path</li>
<li class="">Context (incident ticket, alert ID, user report)</li>
</ul>
</li>
<li class="">
<p><strong>Calculate file hashes:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Linux/macOS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha1sum sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">md5sum sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Windows (PowerShell)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-FileHash sample.exe </span><span class="token parameter variable" style="color:#36acaa">-Algorithm</span><span class="token plain"> SHA256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-FileHash sample.exe </span><span class="token parameter variable" style="color:#36acaa">-Algorithm</span><span class="token plain"> SHA1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-FileHash sample.exe </span><span class="token parameter variable" style="color:#36acaa">-Algorithm</span><span class="token plain"> MD5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># All at once (PowerShell)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;SHA256&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;SHA1&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;MD5&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ForEach-Object </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Get-FileHash sample.exe </span><span class="token parameter variable" style="color:#36acaa">-Algorithm</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$_</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Store original in evidence vault:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create case structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> /evidence/CASE-2025-1005-001/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">intake,binaries,static,dynamic,artifacts,iocs,detections,report</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Copy with hash verification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> sample.exe /evidence/CASE-2025-1005-001/intake/SAM-20251005-1430-001.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum /evidence/CASE-2025-1005-001/intake/SAM-20251005-1430-001.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create password-protected archive (password: infected)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7z a </span><span class="token parameter variable" style="color:#36acaa">-pinfected</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-mhe</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">on /evidence/CASE-2025-1005-001/intake/SAM-20251005-1430-001.7z sample.exe</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Extract email headers (if applicable):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Save .eml file and extract headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^(From|To|Subject|Date|Received|Return-Path|X-|Message-ID):&quot;</span><span class="token plain"> sample.eml </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> headers.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract attachments with munpack (mpack package)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">munpack </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> sample.eml</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>VirusTotal hash lookup (no upload):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Using VT CLI (requires API key)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vt </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">SHA256_HASH</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Manual lookup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://www.virustotal.com/gui/file/&amp;lt;SHA256_HASH&amp;gt;</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="chain-of-custody-form">Chain of Custody Form<a href="#chain-of-custody-form" class="hash-link" aria-label="Direct link to Chain of Custody Form" title="Direct link to Chain of Custody Form" translate="no">​</a></h3>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Field              </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Value                              </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-header-row"></span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">--------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">------------------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-line"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Case ID            </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> CASE-2025-1005-001                 </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Sample ID          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> SAM-20251005-1430-001              </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Filename           </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> invoice_2025.exe                   </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> SHA256             </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> a1b2c3d4e5f6...                    </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Acquisition Date   </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> 2025-10-05 14:30:00 UTC            </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Source             </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Email attachment (phishing report) </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Submitter          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> John Doe (john.doe@example.com)    </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Custodian          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Analyst Name                       </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Storage Location   </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> /evidence/CASE-2025-1005-001/      </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Access Log         </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> See access_log.txt                 </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-rapid-triage-static-analysis">3. Rapid Triage (Static Analysis)<a href="#3-rapid-triage-static-analysis" class="hash-link" aria-label="Direct link to 3. Rapid Triage (Static Analysis)" title="Direct link to 3. Rapid Triage (Static Analysis)" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="31-file-identification--packing">3.1 File Identification &amp; Packing<a href="#31-file-identification--packing" class="hash-link" aria-label="Direct link to 3.1 File Identification &amp; Packing" title="Direct link to 3.1 File Identification &amp; Packing" translate="no">​</a></h3>
<p><strong>Identify file type:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Linux</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> sample.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-b</span><span class="token plain"> sample.bin  </span><span class="token comment" style="color:#999988;font-style:italic"># Brief output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check magic bytes manually</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xxd sample.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">head</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hexdump </span><span class="token parameter variable" style="color:#36acaa">-C</span><span class="token plain"> sample.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">head</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Windows (PowerShell with TrID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trid sample.bin</span><br></span></code></pre></div></div>
<p><strong>PE file analysis (Windows executables):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Using pestudio (Windows GUI)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pestudio.exe sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Using pefile (Python)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;import pefile; pe = pefile.PE(&#x27;sample.exe&#x27;); print(pe.dump_info())&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check sections for packing indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># VirtualSize &gt;&gt; RawSize = likely packed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">peframe sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-A</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Sections&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common packer section names</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># UPX0, UPX1, UPX2 → UPX packer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># .aspack → ASPack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># .petite → PETite</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># .ndata → .NET obfuscation</span><br></span></code></pre></div></div>
<p><strong>PE metadata extraction:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Using exiftool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exiftool sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;(FileDescription|CompanyName|OriginalFilename|LegalCopyright|ProductName)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check digital signature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sigcheck </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> sample.exe  </span><span class="token comment" style="color:#999988;font-style:italic"># Sysinternals</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract timestamp (can be forged)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">peframe sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Timestamp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for overlay data (appended after PE sections)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># If file size &gt; sum of section sizes → overlay exists</span><br></span></code></pre></div></div>
<p><strong>Unpacking (if safe):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># UPX unpacking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">upx </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> sample.exe </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> sample_unpacked.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check entropy (high entropy = encrypted/packed)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">peframe sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Entropy&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Manual unpacking requires debugger (x64dbg/IDA Pro)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set breakpoint on: VirtualAlloc, VirtualProtect, CreateProcess</span><br></span></code></pre></div></div>
<p><strong>ELF file analysis (Linux binaries):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># File type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> sample.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ELF header info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"> sample.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Section headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-S</span><span class="token plain"> sample.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Program headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> sample.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for UPX in ELF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-S</span><span class="token plain"> sample.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> UPX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Unpack ELF UPX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">upx </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> sample.bin </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> sample_unpacked.bin</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-strings--imports">3.2 Strings &amp; Imports<a href="#32-strings--imports" class="hash-link" aria-label="Direct link to 3.2 Strings &amp; Imports" title="Direct link to 3.2 Strings &amp; Imports" translate="no">​</a></h3>
<p><strong>String extraction (obfuscated and plaintext):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># FLARE Obfuscated String Solver (FLOSS) - best for malware</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">floss sample.exe </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">floss --no-static-strings sample.exe  </span><span class="token comment" style="color:#999988;font-style:italic"># Only decoded strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">floss </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> sample.exe  </span><span class="token comment" style="color:#999988;font-style:italic"># Minimum string length of 8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Traditional strings (fallback)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> sample.exe </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> strings.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings </span><span class="token parameter variable" style="color:#36acaa">-el</span><span class="token plain"> sample.exe  </span><span class="token comment" style="color:#999988;font-style:italic"># UTF-16LE (Windows Unicode)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Search for specific patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https?://&quot;</span><span class="token plain"> floss_output.txt  </span><span class="token comment" style="color:#999988;font-style:italic"># URLs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string entity" style="color:#36acaa">\b</span><span class="token string" style="color:#e3116c">([0-9]{1,3}\.){3}[0-9]{1,3}</span><span class="token string entity" style="color:#36acaa">\b</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> floss_output.txt  </span><span class="token comment" style="color:#999988;font-style:italic"># IP addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user-agent&quot;</span><span class="token plain"> floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;password\|username\|token&quot;</span><span class="token plain"> floss_output.txt</span><br></span></code></pre></div></div>
<p><strong>Specific indicators to extract:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># URLs and domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-oE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;(http|https)://[a-zA-Z0-9./?=_%:-]*&quot;</span><span class="token plain"> floss_output.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># IP addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-oE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string entity" style="color:#36acaa">\b</span><span class="token string" style="color:#e3116c">([0-9]{1,3}\.){3}[0-9]{1,3}</span><span class="token string entity" style="color:#36acaa">\b</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> floss_output.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Registry keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hkey\|hklm\|hkcu\|software</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">microsoft&quot;</span><span class="token plain"> floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Mutexes (process synchronization objects)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mutex\|global</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># File paths</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">|</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">Windows</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">|</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">AppData</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">|</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">ProgramData</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Base64 encoded data (look for long alphanumeric strings ending in =)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-oE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[A-Za-z0-9+/]{40,}={0,2}&quot;</span><span class="token plain"> floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PDB paths (reveal development environment)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\.pdb&quot;</span><span class="token plain"> floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common crypto libraries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;advapi32\|bcrypt\|crypt32\|wincrypt&quot;</span><span class="token plain"> floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Email addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-oE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}&quot;</span><span class="token plain"> floss_output.txt</span><br></span></code></pre></div></div>
<p><strong>Import/Export analysis (PE files):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Using peframe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">peframe sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-A</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Imported Functions&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">peframe sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-A</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Exported Functions&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Using pefile (Python)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;import pefile; pe = pefile.PE(&#x27;sample.exe&#x27;); print(&#x27;</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">n&#x27;.join([e.dll.decode() + &#x27; -&gt; &#x27; + f.name.decode() for e in pe.DIRECTORY_ENTRY_IMPORT for f in e.imports if f.name]))&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Using objdump (Linux)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objdump </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DLL Name&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Dangerous import functions to flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Network: URLDownloadToFile, InternetOpen, InternetConnect, send, recv, WSAStartup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Process: CreateProcess, ShellExecute, WinExec, CreateRemoteThread</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Injection: VirtualAlloc, VirtualAllocEx, WriteProcessMemory, NtQueueApcThread</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Persistence: RegSetValue, CreateService, SetWindowsHookEx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Crypto: CryptEncrypt, CryptDecrypt, CryptAcquireContext</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Anti-analysis: IsDebuggerPresent, CheckRemoteDebuggerPresent, NtQueryInformationProcess</span><br></span></code></pre></div></div>
<p><strong>ELF imports (Linux binaries):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List imported libraries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldd sample.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># List imported symbols</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nm </span><span class="token parameter variable" style="color:#36acaa">-D</span><span class="token plain"> sample.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for dangerous functions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nm </span><span class="token parameter variable" style="color:#36acaa">-D</span><span class="token plain"> sample.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;(system|exec|fork|ptrace|socket|connect)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Disassemble imports section</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objdump </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> sample.bin</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="33-capability-detection">3.3 Capability Detection<a href="#33-capability-detection" class="hash-link" aria-label="Direct link to 3.3 Capability Detection" title="Direct link to 3.3 Capability Detection" translate="no">​</a></h3>
<p><strong>CAPA (Mandiant Capability Analysis):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Run CAPA with default rules</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capa sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output to file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capa sample.exe </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> capa_report.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verbose output with offsets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capa </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># JSON output for parsing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capa </span><span class="token parameter variable" style="color:#36acaa">-j</span><span class="token plain"> sample.exe </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> capa_report.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Analyze unpacked sample</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capa sample_unpacked.exe</span><br></span></code></pre></div></div>
<p><strong>Key capabilities to flag:</strong></p>
<table><thead><tr><th>Capability</th><th>Indicators</th><th>MITRE ATT&amp;CK</th></tr></thead><tbody><tr><td><strong>Network Communication</strong></td><td>URLDownloadToFile, InternetOpen, send, recv, WSAStartup</td><td>T1071</td></tr><tr><td><strong>Process Injection</strong></td><td>VirtualAllocEx, WriteProcessMemory, CreateRemoteThread</td><td>T1055</td></tr><tr><td><strong>Code Execution</strong></td><td>CreateProcess, ShellExecute, WinExec, system()</td><td>T1059</td></tr><tr><td><strong>Persistence</strong></td><td>RegSetValue, CreateService, SetWindowsHookEx, WMI</td><td>T1547, T1053</td></tr><tr><td><strong>Credential Access</strong></td><td>LsaEnumerateLogonSessions, CredEnumerate, SamIConnect</td><td>T1003</td></tr><tr><td><strong>Defense Evasion</strong></td><td>IsDebuggerPresent, VirtualProtect, SetThreadContext</td><td>T1140, T1622</td></tr><tr><td><strong>Encryption/Encoding</strong></td><td>CryptEncrypt, CryptDecrypt, Base64 decode</td><td>T1027</td></tr><tr><td><strong>Keylogging</strong></td><td>SetWindowsHookEx (WH_KEYBOARD), GetAsyncKeyState</td><td>T1056.001</td></tr><tr><td><strong>Screen Capture</strong></td><td>BitBlt, GetDC, CreateCompatibleBitmap</td><td>T1113</td></tr><tr><td><strong>File Deletion</strong></td><td>DeleteFile, SHFileOperation, MoveFileEx (MOVEFILE_DELAY...)</td><td>T1070.004</td></tr></tbody></table>
<p><strong>Manual capability review (if CAPA unavailable):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Check for specific WinAPI calls in disassembly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objdump </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;urldownloadtofile\|internetopen\|createprocess&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use strings to find API names</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;createremotethread\|virtualalloc\|writeprocessmemory&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="34-multi-engine-scanning">3.4 Multi-Engine Scanning<a href="#34-multi-engine-scanning" class="hash-link" aria-label="Direct link to 3.4 Multi-Engine Scanning" title="Direct link to 3.4 Multi-Engine Scanning" translate="no">​</a></h3>
<p><strong>Hash-only lookups (preferred - no sample upload):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># VirusTotal CLI (requires API key)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vt </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">SHA256_HASH</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Manual lookup URLs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://www.virustotal.com/gui/file/&amp;lt;SHA256_HASH&amp;gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://www.hybrid-analysis.com/search?hash=&amp;lt;SHA256_HASH&amp;gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://tria.ge/&amp;lt;SHA256_HASH&amp;gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check MalwareBazaar database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST https://mb-api.abuse.ch/api/v1/ </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;query=get_info&amp;hash=&amp;lt;SHA256_HASH&amp;gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check ThreatFox IOC database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST https://threatfox-api.abuse.ch/api/v1/ </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{&quot;query&quot;:&quot;search_hash&quot;,&quot;hash&quot;:&quot;&amp;lt;SHA256_HASH&amp;gt;&quot;}&#x27;</span><br></span></code></pre></div></div>
<p><strong>Local/offline AV scanning (if available):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ClamAV (open-source)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clamscan </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--bell</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Update signatures first</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">freshclam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># YARA scanning with community rules</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yara </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> /path/to/yara-rules/ sample.exe</span><br></span></code></pre></div></div>
<p><strong>Detection name analysis:</strong>
If VirusTotal shows detections, analyze vendor names:</p>
<ul>
<li class=""><code>Trojan.Generic</code> → Generic heuristic detection</li>
<li class=""><code>Trojan.Agent</code> → Unknown malware family</li>
<li class=""><code>Win32.Emotet.A</code> → Specific family (Emotet) and variant (A)</li>
<li class=""><code>Ransom.Lockbit</code> → Ransomware family (Lockbit)</li>
<li class=""><code>PUA</code> / <code>PUP</code> → Potentially Unwanted Application/Program</li>
<li class=""><code>Packed.VMProtect</code> → Packer/protector detection</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-behavior-analysis-dynamic-in-lab-only">4. Behavior Analysis (Dynamic, In-Lab Only)<a href="#4-behavior-analysis-dynamic-in-lab-only" class="hash-link" aria-label="Direct link to 4. Behavior Analysis (Dynamic, In-Lab Only)" title="Direct link to 4. Behavior Analysis (Dynamic, In-Lab Only)" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="41-monitoring-setup">4.1 Monitoring Setup<a href="#41-monitoring-setup" class="hash-link" aria-label="Direct link to 4.1 Monitoring Setup" title="Direct link to 4.1 Monitoring Setup" translate="no">​</a></h3>
<p><strong>Pre-execution checklist:</strong></p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Take clean VM snapshot</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Verify network is isolated (INetSim active)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Start monitoring tools</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Set up screen recording (optional but recommended)</li>
</ul>
<p><strong>Process Monitor (Procmon) - Sysinternals:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Launch Procmon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">procmon.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configure filters to reduce noise:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Filter -&gt; Process Name -&gt; is -&gt; sample.exe -&gt; Include</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Filter -&gt; Process Name -&gt; is -&gt; rundll32.exe -&gt; Include (if sample uses it)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Filter -&gt; Operation -&gt; contains -&gt; Reg -&gt; Include (registry operations)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Filter -&gt; Operation -&gt; contains -&gt; File -&gt; Include (file operations)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable: Show File System Activity, Show Registry Activity, Show Network Activity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Disable: Show Process and Thread Activity (too noisy)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Save output after execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># File -&gt; Save -&gt; All Events -&gt; CSV format</span><br></span></code></pre></div></div>
<p><strong>Wireshark (Network Traffic Capture):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Start capture on adapter connected to INetSim</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wireshark </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> eth0 </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Apply display filter for analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># DNS queries: dns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># HTTP traffic: http</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TLS/SSL: tls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Specific IP: ip.addr == 192.168.56.101</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Save PCAP after execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># File -&gt; Save As -&gt; sample_traffic.pcapng</span><br></span></code></pre></div></div>
<p><strong>Process Hacker (Process &amp; Memory Analysis):</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Launch Process Hacker as Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProcessHacker.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Monitor for:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - New process creation (sample.exe and child processes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Memory allocations (Heap, Private memory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Handles (Files, Registry, Mutexes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Network connections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To dump process memory:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Right-click process -&gt; Create dump file</span><br></span></code></pre></div></div>
<p><strong>Sysmon (Advanced Windows Logging):</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Install Sysmon with SwiftOnSecurity config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sysmon64.exe -accepteula -i sysmonconfig-export.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Download config from:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://github.com/SwiftOnSecurity/sysmon-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># View Sysmon logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-WinEvent -LogName &quot;Microsoft-Windows-Sysmon/Operational&quot; | Format-List</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Export Sysmon logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wevtutil epl Microsoft-Windows-Sysmon/Operational C:\evidence\sysmon_logs.evtx</span><br></span></code></pre></div></div>
<p><strong>Regshot (Registry Comparison):</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Take snapshot before execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Regshot.exe -&gt; 1st shot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Execute malware</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Take snapshot after execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Regshot.exe -&gt; 2nd shot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Compare and save</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compare -&gt; Output to HTML</span><br></span></code></pre></div></div>
<p><strong>Noriben (Automated Procmon Analysis):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Run Noriben with automatic procmon collection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python Noriben.py </span><span class="token parameter variable" style="color:#36acaa">--cmd</span><span class="token plain"> sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generates: Noriben_&amp;lt;timestamp&amp;gt;.txt with parsed behavior</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="42-execution--observation">4.2 Execution &amp; Observation<a href="#42-execution--observation" class="hash-link" aria-label="Direct link to 4.2 Execution &amp; Observation" title="Direct link to 4.2 Execution &amp; Observation" translate="no">​</a></h3>
<p><strong>Execute the sample:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Execute in isolated VM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.\sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Or with arguments if required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.\sample.exe --install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For DLL files, use rundll32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rundll32.exe sample.dll,DllMain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">powershell.exe -ExecutionPolicy Bypass -File sample.ps1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cscript.exe //NoLogo sample.vbs</span><br></span></code></pre></div></div>
<p><strong>Track spawned processes:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># PowerShell - monitor process creation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-WmiObject Win32_Process | Select-Object ProcessId,Name,CommandLine,ParentProcessId | Format-Table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Command line - watch for new processes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wmic process list full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check process tree in Process Hacker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># View -&gt; Tree view -&gt; Expand sample.exe</span><br></span></code></pre></div></div>
<p><strong>Inspect dropped files:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Find recently created files (last 5 minutes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-ChildItem -Path C:\ -Recurse -ErrorAction SilentlyContinue | Where-Object {$_.CreationTime -gt (Get-Date).AddMinutes(-5)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Common drop locations to check manually</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\&amp;lt;user&amp;gt;\AppData\Local\Temp\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\&amp;lt;user&amp;gt;\AppData\Roaming\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\ProgramData\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\Windows\Temp\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Hash all dropped files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-ChildItem -Path C:\Users\&amp;lt;user&amp;gt;\AppData\Local\Temp\ -Recurse | Get-FileHash -Algorithm SHA256</span><br></span></code></pre></div></div>
<p><strong>Common persistence mechanisms to check:</strong></p>
<table><thead><tr><th>Location</th><th>Command</th><th>Technique</th></tr></thead><tbody><tr><td><strong>Registry Run Keys</strong></td><td><code>reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code></td><td>T1547.001</td></tr><tr><td></td><td><code>reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run</code></td><td></td></tr><tr><td><strong>Startup Folder</strong></td><td><code>dir &quot;%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup&quot;</code></td><td>T1547.001</td></tr><tr><td></td><td><code>dir &quot;%PROGRAMDATA%\Microsoft\Windows\Start Menu\Programs\Startup&quot;</code></td><td></td></tr><tr><td><strong>Scheduled Tasks</strong></td><td><code>schtasks /query /fo LIST /v</code></td><td>T1053.005</td></tr><tr><td></td><td><code>Get-ScheduledTask | Where-Object {$_.TaskName -notlike &quot;Microsoft*&quot;}</code></td><td></td></tr><tr><td><strong>Services</strong></td><td><code>sc query</code></td><td>T1543.003</td></tr><tr><td></td><td><code>Get-Service | Where-Object {$_.Status -eq &quot;Running&quot;}</code></td><td></td></tr><tr><td><strong>WMI Event Subscription</strong></td><td><code>Get-WmiObject -Namespace root\Subscription -Class __EventFilter</code></td><td>T1546.003</td></tr><tr><td></td><td><code>Get-WmiObject -Namespace root\Subscription -Class __EventConsumer</code></td><td></td></tr><tr><td><strong>DLL Hijacking</strong></td><td>Check for unexpected DLLs in application directories</td><td>T1574.001</td></tr></tbody></table>
<p><strong>Inspect mutexes and named objects:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Using Process Hacker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Select process -&gt; Handles tab -&gt; Filter: &quot;Mutant&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Using Handle.exe (Sysinternals)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handle.exe -a -p &amp;lt;PID&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Common mutex names to flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Global\&amp;lt;random_string&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Local\&amp;lt;random_string&amp;gt;</span><br></span></code></pre></div></div>
<p><strong>Check for injection into legitimate processes:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Look for unusual memory allocations in explorer.exe, svchost.exe, etc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Process Hacker -&gt; Select process -&gt; Memory tab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Flag RWX (Read-Write-Execute) memory regions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Dump suspicious memory regions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Right-click memory region -&gt; Save -&gt; memory_dump.bin</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="43-network-behavior">4.3 Network Behavior<a href="#43-network-behavior" class="hash-link" aria-label="Direct link to 4.3 Network Behavior" title="Direct link to 4.3 Network Behavior" translate="no">​</a></h3>
<p><strong>DNS traffic analysis:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Wireshark display filter for DNS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract DNS queries from PCAP (tshark)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> dns </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> dns.qry.name </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - DGA (Domain Generation Algorithm) patterns (long random domains)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Known C2 domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Unusual TLDs (.tk, .ml, .ga, .cf)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Fast-flux DNS (multiple A records)</span><br></span></code></pre></div></div>
<p><strong>HTTP/HTTPS traffic analysis:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Wireshark filter for HTTP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract HTTP requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> http.request </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> http.host </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> http.request.uri</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract User-Agent strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> http </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> http.user_agent </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Suspicious User-Agents (PowerShell, python-requests, curl)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - C2 beacon patterns (regular intervals)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - POST requests with encrypted/encoded data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Downloads (exe, dll, ps1, vbs files)</span><br></span></code></pre></div></div>
<p><strong>TLS/SSL analysis:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Extract TLS Server Name Indication (SNI)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> tls.handshake.extensions_server_name </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> tls.handshake.extensions_server_name </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check certificate details</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> ssl.handshake.certificate </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> x509sat.printableString</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Flag:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Self-signed certificates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Unusual certificate issuers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Mismatched SNI and certificate CN</span><br></span></code></pre></div></div>
<p><strong>Identify outbound connections:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Using TCPView (GUI)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcpview.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Using netstat (command line)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netstat -ano | findstr ESTABLISHED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Get full connection details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-NetTCPConnection | Where-Object {$_.State -eq &quot;Established&quot;} | Format-Table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check for common C2 ports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 443, 8443 (HTTPS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 80, 8080 (HTTP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 53 (DNS tunneling)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4444, 5555 (Metasploit default)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1234, 31337 (backdoors)</span><br></span></code></pre></div></div>
<p><strong>Test C2 communication (lab environment only):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Set up ncat listener to catch reverse shell</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ncat </span><span class="token parameter variable" style="color:#36acaa">-lnvp</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4444</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># For HTTPS/TLS callbacks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ncat </span><span class="token parameter variable" style="color:#36acaa">-lnvp</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">443</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--ssl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Monitor all connection attempts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcpdump </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> any </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-vv</span><br></span></code></pre></div></div>
<p><strong>Extract network IOCs:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List all contacted IPs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> ip.dst </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;192.168\|10.0\|127.0.0.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># List all contacted domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> dns </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> dns.qry.name </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract URLs from HTTP traffic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> http.request </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> http.host </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> http.request.uri </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{print &quot;http://&quot;$1$2}&#x27;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-artefact-extraction--normalization">5. Artefact Extraction &amp; Normalization<a href="#5-artefact-extraction--normalization" class="hash-link" aria-label="Direct link to 5. Artefact Extraction &amp; Normalization" title="Direct link to 5. Artefact Extraction &amp; Normalization" translate="no">​</a></h2>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Collect &amp; rehash dropped files</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Export:<!-- -->
<ul>
<li class="">PCAP</li>
<li class=""><code>procmon</code> logs</li>
<li class="">Registry diffs</li>
<li class="">Event logs</li>
<li class="">Screenshots</li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Normalize timestamps to <strong>UTC</strong></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Extract PDB paths &amp; PE metadata</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Store in structured case folder:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/CASE-</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">case_id</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  intake/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  binaries/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dynamic/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  artifacts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  iocs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  detections/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  report/</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-specialized-file-analysis">6. Specialized File Analysis<a href="#6-specialized-file-analysis" class="hash-link" aria-label="Direct link to 6. Specialized File Analysis" title="Direct link to 6. Specialized File Analysis" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="61-netc-analysis">6.1 .NET/C# Analysis<a href="#61-netc-analysis" class="hash-link" aria-label="Direct link to 6.1 .NET/C# Analysis" title="Direct link to 6.1 .NET/C# Analysis" translate="no">​</a></h3>
<p><strong>.NET detection:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Check for .NET assembly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PE32.*Mono/.Net assembly&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mscoree.dll&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check assembly info with ildasm (Microsoft IL Disassembler)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ildasm sample.exe</span><br></span></code></pre></div></div>
<p><strong>Decompilation with dnSpy:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. Open sample.exe in dnSpy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Navigate Assembly Explorer -&gt; sample.exe -&gt; Namespace -&gt; Class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Look for:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Main() function (entry point)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Embedded resources (right-click assembly -&gt; Go to Resources)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Obfuscated strings (base64, XOR, etc.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - System.Net (HTTP, WebClient, DownloadFile)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - System.Security.Cryptography (AES, DES, RSA)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - System.Reflection (dynamic code loading)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - System.Diagnostics.Process (command execution)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Set breakpoints and debug dynamically (Start button)</span><br></span></code></pre></div></div>
<p><strong>Decompilation with ILSpy:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Command-line decompilation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ilspycmd sample.exe </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> decompiled_output/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># GUI version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ilspy.exe sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Hardcoded IPs/domains in strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Decryption routines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Anti-VM checks</span><br></span></code></pre></div></div>
<p><strong>Extract embedded resources:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Using dnSpy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Right-click Assembly -&gt; Resources -&gt; Save All</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Using ResourceHacker (Windows)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ResourceHacker.exe -open sample.exe -save resources.txt -action extract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Embedded payloads often stored as:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Encrypted byte arrays</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Compressed streams (GZip, Deflate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Base64-encoded strings</span><br></span></code></pre></div></div>
<p><strong>.NET deobfuscation:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># de4dot - .NET deobfuscator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">de4dot sample.exe </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> sample_deobfuscated.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Handles common obfuscators:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - ConfuserEx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - .NET Reactor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Eazfuscator</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="62-officemacro-analysis">6.2 Office/Macro Analysis<a href="#62-officemacro-analysis" class="hash-link" aria-label="Direct link to 6.2 Office/Macro Analysis" title="Direct link to 6.2 Office/Macro Analysis" translate="no">​</a></h3>
<p><strong>Identify macro-enabled documents:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># File extensions with macros</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># .docm, .xlsm, .pptm, .doc (legacy), .xls (legacy)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Detect OLE files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> document.docm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: &quot;Composite Document File V2 Document&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Quick check for VBA macros</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings document.docm </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;vba\|macro\|autoopen\|document_open&quot;</span><br></span></code></pre></div></div>
<p><strong>Extract macros with oledump.py (Didier Stevens):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List all streams in OLE file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oledump.py document.docm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for &quot;M&quot; indicator (macros present)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  1:       114 &#x27;\x01CompObj&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  2:      4096 &#x27;\x05DocumentSummaryInformation&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  3: M    8192 &#x27;Macros/VBA/ThisDocument&#x27;  &lt;- Macro present</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract macro from stream 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oledump.py </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> document.docm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Decompress corrupt VBA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oledump.py </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--vbadecompresscorrupt</span><span class="token plain"> document.docm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Dump all macros to file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oledump.py </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> document.docm </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> macros.vba</span><br></span></code></pre></div></div>
<p><strong>Extract macros with olevba (oletools):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Analyze and extract VBA macros</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olevba document.docm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Summary mode (flags suspicious keywords)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olevba </span><span class="token parameter variable" style="color:#36acaa">--decode</span><span class="token plain"> document.docm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># JSON output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olevba </span><span class="token parameter variable" style="color:#36acaa">-j</span><span class="token plain"> document.docm </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> macros.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for IOCs (URLs, IPs, file paths)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olevba </span><span class="token parameter variable" style="color:#36acaa">--decode</span><span class="token plain"> document.docm </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http|https|ftp|powershell|cmd|wscript&quot;</span><br></span></code></pre></div></div>
<p><strong>Suspicious VBA keywords to flag:</strong></p>
<ul>
<li class=""><code>AutoOpen</code>, <code>Document_Open</code>, <code>Workbook_Open</code> (Auto-execution)</li>
<li class=""><code>Shell</code>, <code>CreateObject(&quot;WScript.Shell&quot;)</code> (Command execution)</li>
<li class=""><code>URLDownloadToFile</code>, <code>MSXML2.XMLHTTP</code> (File download)</li>
<li class=""><code>CreateObject(&quot;Scripting.FileSystemObject&quot;)</code> (File operations)</li>
<li class=""><code>ExecuteStatement</code>, <code>Eval</code> (Dynamic code execution)</li>
<li class=""><code>CallByName</code> (Obfuscation technique)</li>
</ul>
<p><strong>Inspect .docx/.xlsx structure (ZIP format):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Extract Office Open XML document</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">unzip</span><span class="token plain"> document.docx </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> document_extracted/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for template injection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> document_extracted/word/_rels/document.xml.rels </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Target.*http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for external relationships (template injection)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &lt;Relationship Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#              Target=&quot;http://malicious.com/template.dotm&quot; TargetMode=&quot;External&quot;/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for embedded objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> document_extracted/word/embeddings/</span><br></span></code></pre></div></div>
<p><strong>Analyze Excel 4.0 macros (XLM macros):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># XLM macros in .xls files (legacy format)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oledump.py document.xls </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> XL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract XLM formulas with XLMMacroDeobfuscator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python XLMMacroDeobfuscator.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> document.xls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use olevba</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olevba document.xls </span><span class="token parameter variable" style="color:#36acaa">--deobf</span><br></span></code></pre></div></div>
<p><strong>Dynamic analysis (sandbox execution):</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. Use Office in isolated VM (FlareVM)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Enable Content when prompted (activates macro)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Monitor with Procmon for:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - PowerShell execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - WScript/CScript execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - File writes to temp directories</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Network connections</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="63-pdf-analysis">6.3 PDF Analysis<a href="#63-pdf-analysis" class="hash-link" aria-label="Direct link to 6.3 PDF Analysis" title="Direct link to 6.3 PDF Analysis" translate="no">​</a></h3>
<p><strong>Analyze PDF structure:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Scan for malicious content with pdfid.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pdfid.py document.pdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Flags to watch for:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># /OpenAction, /AA (Auto-execute on open)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># /JavaScript, /JS (Embedded JavaScript)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># /Launch (Execute external program)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># /EmbeddedFile (Embedded files)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># /RichMedia (Flash, multimedia)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Analyze PDF streams</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pdf-parser.py document.pdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract JavaScript</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pdf-parser.py </span><span class="token parameter variable" style="color:#36acaa">--search</span><span class="token plain"> javascript document.pdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Dump specific object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pdf-parser.py </span><span class="token parameter variable" style="color:#36acaa">--object</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> document.pdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract all streams</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pdf-parser.py </span><span class="token parameter variable" style="color:#36acaa">--raw</span><span class="token plain"> document.pdf </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pdf_streams.txt</span><br></span></code></pre></div></div>
<p><strong>Extract embedded files from PDF:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Using peepdf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">peepdf </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> document.pdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Commands in interactive mode:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &gt; tree  (show object structure)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &gt; object 15  (inspect object)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &gt; stream 15  (extract stream)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &gt; extract stream 15 &gt; extracted_payload.bin</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="64-script-analysis-powershellvbsjs">6.4 Script Analysis (PowerShell/VBS/JS)<a href="#64-script-analysis-powershellvbsjs" class="hash-link" aria-label="Direct link to 6.4 Script Analysis (PowerShell/VBS/JS)" title="Direct link to 6.4 Script Analysis (PowerShell/VBS/JS)" translate="no">​</a></h3>
<p><strong>PowerShell deobfuscation:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Common obfuscation patterns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Base64 encoded commands</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$encoded = &quot;Base64StringHere&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($encoded))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Examine script without executing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-Content malicious.ps1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Look for:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Invoke-Expression (IEX) - executes string as code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - DownloadString, DownloadFile - downloads payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - FromBase64String - decodes embedded payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Compression (IO.Compression.GzipStream)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - WMI queries (Get-WmiObject)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Invoke-WebRequest, Invoke-RestMethod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Static deobfuscation with PSDecode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Import-Module PSDecode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PSDecode -InputFile malicious.ps1 -OutputFile decoded.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Or use online tools (in isolated environment)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://github.com/R3MRUM/PSDecode</span><br></span></code></pre></div></div>
<p><strong>VBScript/JScript analysis:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Analyze without execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> malicious.vbs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common patterns:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - CreateObject(&quot;WScript.Shell&quot;).Run - command execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - CreateObject(&quot;MSXML2.XMLHTTP&quot;) - HTTP requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - CreateObject(&quot;Scripting.FileSystemObject&quot;) - file operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Eval(), Execute() - dynamic code execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Deobfuscate with decoder (manual)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Replace Eval() with WScript.Echo() to print instead of execute</span><br></span></code></pre></div></div>
<p><strong>JavaScript (JS) analysis:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Beautify obfuscated JS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> malicious.js </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> js-beautify </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> beautified.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use online tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://beautifier.io/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - eval() - executes string as code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - unescape(), decodeURIComponent() - decode strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - ActiveXObject - COM object creation (Windows only)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - WScript.Shell, WScript.CreateObject</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="65-archive-analysis">6.5 Archive Analysis<a href="#65-archive-analysis" class="hash-link" aria-label="Direct link to 6.5 Archive Analysis" title="Direct link to 6.5 Archive Analysis" translate="no">​</a></h3>
<p><strong>Inspect archives safely:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List contents without extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7z l archive.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">unzip</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> archive.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-tzf</span><span class="token plain"> archive.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Double extensions (invoice.pdf.exe)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - LNK files (Windows shortcuts)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Executable files masquerading as documents</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Nested archives (archive.zip -&gt; archive2.zip -&gt; payload.exe)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract to isolated directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7z x archive.zip -o/tmp/extracted/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check extracted file types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /tmp/extracted/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> *</span><br></span></code></pre></div></div>
<p><strong>Analyze LNK (shortcut) files:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Parse LNK file with LECmd (Windows)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LECmd.exe </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> malicious.lnk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use lnk-parser (Linux)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lnkinfo malicious.lnk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Target path (what it executes)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Command line arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Working directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Icon location (may reveal payload location)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="66-linuxelf-analysis">6.6 Linux/ELF Analysis<a href="#66-linuxelf-analysis" class="hash-link" aria-label="Direct link to 6.6 Linux/ELF Analysis" title="Direct link to 6.6 Linux/ELF Analysis" translate="no">​</a></h3>
<p><strong>Basic ELF analysis:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># File type and architecture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: ELF 64-bit LSB executable, x86-64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ELF header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"> suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Section headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-S</span><span class="token plain"> suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Program headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Symbol table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for suspicious libraries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldd suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - libc.so (standard)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - libssl.so (network encryption)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - libcrypto.so (cryptography)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Unusual paths (/tmp/lib.so)</span><br></span></code></pre></div></div>
<p><strong>Dynamic analysis (Linux malware):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Use strace to monitor system calls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">strace</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">trace</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">network,file,process ./suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Monitor file operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">strace</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">trace</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">open,read,write,close ./suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Monitor network operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">strace</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">trace</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">socket,connect,send,recv ./suspicious.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ltrace to monitor library calls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ltrace </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ./suspicious.bin</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-classification--ttp-mapping">7. Classification &amp; TTP Mapping<a href="#7-classification--ttp-mapping" class="hash-link" aria-label="Direct link to 7. Classification &amp; TTP Mapping" title="Direct link to 7. Classification &amp; TTP Mapping" translate="no">​</a></h2>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Propose <strong>malware family</strong> or threat cluster (if possible)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Map behaviors to <strong>MITRE ATT&amp;CK</strong>:<!-- -->
<ul>
<li class="">T1055 – Process Injection</li>
<li class="">T1083 – File Discovery</li>
<li class="">T1105 – Remote File Copy</li>
<li class="">T1140 – Deobfuscation</li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-iocs--detection-engineering">8. IOCs &amp; Detection Engineering<a href="#8-iocs--detection-engineering" class="hash-link" aria-label="Direct link to 8. IOCs &amp; Detection Engineering" title="Direct link to 8. IOCs &amp; Detection Engineering" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="81-ioc-extraction--defanging">8.1 IOC Extraction &amp; Defanging<a href="#81-ioc-extraction--defanging" class="hash-link" aria-label="Direct link to 8.1 IOC Extraction &amp; Defanging" title="Direct link to 8.1 IOC Extraction &amp; Defanging" translate="no">​</a></h3>
<p><strong>Extract all IOC types:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># File hashes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum sample.exe dropped_file1.dll dropped_file2.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">md5sum sample.exe dropped_file1.dll dropped_file2.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Network indicators from strings/PCAP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-oE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string entity" style="color:#36acaa">\b</span><span class="token string" style="color:#e3116c">([0-9]{1,3}\.){3}[0-9]{1,3}</span><span class="token string entity" style="color:#36acaa">\b</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> floss_output.txt  </span><span class="token comment" style="color:#999988;font-style:italic"># IPs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-oE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[a-zA-Z0-9.-]+\.(com|net|org|ru|cn)&quot;</span><span class="token plain"> floss_output.txt  </span><span class="token comment" style="color:#999988;font-style:italic"># Domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> ip.dst </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Contacted IPs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> dns </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> dns.qry.name </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># DNS queries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Registry keys from Procmon/Regshot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;RegSetValue&quot;</span><span class="token plain"> procmon.csv </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> -F</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{print $5}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Mutexes from Process Hacker or strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings sample.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mutex\|global</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string entity" style="color:#36acaa">\\</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># User-Agents from PCAP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> http </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> fields </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> http.user_agent </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><br></span></code></pre></div></div>
<p><strong>Defang IOCs for safe sharing:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Defanging patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># http:// → hxxp://</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https:// → hxxps://</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># . → [.]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># @ → [@]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Examples:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># malicious.com → malicious[.]com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># http://evil.com/payload.exe → hxxp://evil[.]com/payload[.]exe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># attacker@evil.com → attacker[@]evil[.]com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 192.168.1.100 → 192[.]168[.]1[.]100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Automated defanging with ioc-fanger (Python)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> ioc-fanger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://malicious.com&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> fanger </span><span class="token parameter variable" style="color:#36acaa">--defang</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or manual sed replacement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://malicious.com/payload.exe&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sed</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;s/http:/hxxp:/g; s/\./[.]/g&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="82-ioc-confidence--volatility-rating">8.2 IOC Confidence &amp; Volatility Rating<a href="#82-ioc-confidence--volatility-rating" class="hash-link" aria-label="Direct link to 8.2 IOC Confidence &amp; Volatility Rating" title="Direct link to 8.2 IOC Confidence &amp; Volatility Rating" translate="no">​</a></h3>
<table><thead><tr><th>IOC Type</th><th>Confidence</th><th>Volatility</th><th>Notes</th></tr></thead><tbody><tr><td>File hash</td><td>High</td><td>Static</td><td>Unique to specific sample</td></tr><tr><td>Mutex name</td><td>High</td><td>Static</td><td>Hardcoded in malware</td></tr><tr><td>Registry key</td><td>High</td><td>Static</td><td>Persistence mechanism</td></tr><tr><td>IP address</td><td>Medium</td><td>Dynamic</td><td>May change (DGA, fast-flux)</td></tr><tr><td>Domain (C2)</td><td>Medium</td><td>Dynamic</td><td>May change frequently</td></tr><tr><td>User-Agent</td><td>Low</td><td>Dynamic</td><td>Common strings, high false positive</td></tr><tr><td>File path</td><td>Medium</td><td>Static</td><td>May vary by environment</td></tr><tr><td>PDB path</td><td>High</td><td>Static</td><td>Reveals dev environment</td></tr><tr><td>Certificate hash</td><td>High</td><td>Static</td><td>Used for code signing</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="83-yara-rule-creation">8.3 YARA Rule Creation<a href="#83-yara-rule-creation" class="hash-link" aria-label="Direct link to 8.3 YARA Rule Creation" title="Direct link to 8.3 YARA Rule Creation" translate="no">​</a></h3>
<p><strong>Basic YARA rule template:</strong></p>
<div class="language-yara codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yara codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rule Malware_Family_Emotet_Variant_A {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        description = &quot;Detects Emotet variant A based on strings and imports&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        author = &quot;Analyst Name&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        date = &quot;2025-10-05&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        reference = &quot;CASE-2025-1005-001&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hash = &quot;a1b2c3d4e5f6...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    strings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $s1 = &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64)&quot; ascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $s2 = &quot;C:\\Windows\\SysWOW64\\rundll32.exe&quot; wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $s3 = { 4D 5A 90 00 03 00 00 00 }  // MZ header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $mutex = &quot;Global\\M12345&quot; wide nocase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $api1 = &quot;VirtualAlloc&quot; ascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $api2 = &quot;CreateRemoteThread&quot; ascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $api3 = &quot;WriteProcessMemory&quot; ascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    condition:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint16(0) == 0x5A4D and  // PE file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        filesize &lt; 500KB and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        2 of ($s*) and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        all of ($api*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Test YARA rule:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Test against sample</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yara malware_rule.yar sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Scan directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yara </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> malware_rule.yar /path/to/samples/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Save matches to file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yara </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> malware_rule.yar /path/to/samples/ </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> matches.txt</span><br></span></code></pre></div></div>
<p><strong>YARA rule repositories:</strong></p>
<ul>
<li class=""><a href="https://github.com/Yara-Rules/rules" target="_blank" rel="noopener noreferrer" class="">https://github.com/Yara-Rules/rules</a></li>
<li class=""><a href="https://github.com/Neo23x0/signature-base" target="_blank" rel="noopener noreferrer" class="">https://github.com/Neo23x0/signature-base</a></li>
<li class=""><a href="https://github.com/reversinglabs/reversinglabs-yara-rules" target="_blank" rel="noopener noreferrer" class="">https://github.com/reversinglabs/reversinglabs-yara-rules</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="84-sigma-rule-creation">8.4 Sigma Rule Creation<a href="#84-sigma-rule-creation" class="hash-link" aria-label="Direct link to 8.4 Sigma Rule Creation" title="Direct link to 8.4 Sigma Rule Creation" translate="no">​</a></h3>
<p><strong>Sigma rule for malicious behavior (Sysmon Event ID 1 - Process Creation):</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Suspicious PowerShell Download Cradle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 12345678</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1234</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1234</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1234</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">123456789abc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">status</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> experimental</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Detects PowerShell download cradle execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">references</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//attack.mitre.org/techniques/T1059/001/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">author</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Analyst Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">date</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token datetime number" style="color:#36acaa">2025-10-05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> attack.execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> attack.t1059.001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">logsource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">category</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> process_creation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">product</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> windows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">detection</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">selection</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Image|endswith</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\powershell.exe&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">CommandLine|contains|all</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DownloadString&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Invoke-Expression&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">condition</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> selection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">falsepositives</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> Legitimate administrative scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> high</span><br></span></code></pre></div></div>
<p><strong>Convert Sigma to SIEM queries:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install sigmac</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> sigma-cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Convert to Splunk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sigma convert </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> splunk rule.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Convert to Elastic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sigma convert </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> elasticsearch rule.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Convert to QRadar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sigma convert </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> qradar rule.yml</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="85-suricata-rule-creation">8.5 Suricata Rule Creation<a href="#85-suricata-rule-creation" class="hash-link" aria-label="Direct link to 8.5 Suricata Rule Creation" title="Direct link to 8.5 Suricata Rule Creation" translate="no">​</a></h3>
<p><strong>Network IDS rule for C2 traffic:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">alert http $HOME_NET any -&gt; $EXTERNAL_NET any (msg:&quot;ET MALWARE Emotet C2 Checkin&quot;; flow:established,to_server; content:&quot;POST&quot;; http_method; content:&quot;/&quot;; http_uri; depth:1; http.user_agent; content:&quot;Mozilla/5.0 (Windows NT 10.0|3b| Win64|3b| x64)&quot;; sid:1234567; rev:1; metadata:created_at 2025_10_05;)</span><br></span></code></pre></div></div>
<p><strong>DNS-based detection:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">alert dns $HOME_NET any -&gt; any 53 (msg:&quot;ET MALWARE Suspicious DGA Domain Query&quot;; dns.query; content:&quot;.tk&quot;; nocase; sid:1234568; rev:1;)</span><br></span></code></pre></div></div>
<p><strong>Test Suricata rules:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Test rule syntax</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">suricata </span><span class="token parameter variable" style="color:#36acaa">-T</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> /etc/suricata/suricata.yaml </span><span class="token parameter variable" style="color:#36acaa">-S</span><span class="token plain"> custom.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run Suricata on PCAP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">suricata </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> sample_traffic.pcapng </span><span class="token parameter variable" style="color:#36acaa">-S</span><span class="token plain"> custom.rules </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> /var/log/suricata/</span><br></span></code></pre></div></div>
<hr>
<h2></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="91-malware-analysis-report-template">9.1 Malware Analysis Report Template<a href="#91-malware-analysis-report-template" class="hash-link" aria-label="Direct link to 9.1 Malware Analysis Report Template" title="Direct link to 9.1 Malware Analysis Report Template" translate="no">​</a></h3>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">#</span><span class="token title important"> Malware Analysis Report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Executive Summary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Malware Family:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> Emotet (Variant A)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Threat Level:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> High</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Initial Vector:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> Phishing email with malicious attachment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Primary Capability:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> Banking trojan, credential theft, lateral movement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Recommended Action:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> Block all network IOCs, hunt for persistence mechanisms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token hr punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Case Metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Field              </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Value                                    </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-header-row"></span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">--------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">------------------------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-line"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Case ID            </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> CASE-2025-1005-001                       </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Sample ID          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> SAM-20251005-1430-001                    </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Analyst            </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Analyst Name                             </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Analysis Date      </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> 2025-10-05                               </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Filename (original)</span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> invoice_2025.exe                         </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> SHA256             </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> a1b2c3d4e5f6...                          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> File Size          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> 245 KB                                   </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> File Type          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> PE32 executable (GUI) x86, for MS Windows</span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token hr punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Technical Analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Static Analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">File Properties:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Compiler: Microsoft Visual C++ 8.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Timestamp: 2025-09-28 14:23:11 UTC (possibly forged)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Digital Signature: None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Packer: UPX (detected and unpacked)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Entropy: 7.2 (high - indicates encryption/packing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Capabilities (CAPA):</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Network communication (URLDownloadToFile, InternetOpen)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Process injection (VirtualAllocEx, WriteProcessMemory, CreateRemoteThread)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Persistence via registry (RegSetValue)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Credential theft (CredEnumerate, LsaEnumerateLogonSessions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Suspicious Strings:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> hxxp://malicious[.]com/payload[.]exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 192[.]168[.]56[.]101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> HKCU\Software\Microsoft\Windows\CurrentVersion\Run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Global\M12345 (mutex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> C:\Users\Public\svchost.exe (dropped file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Dynamic Analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Execution Flow:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">1.</span><span class="token plain"> Creates mutex &quot;Global\M12345&quot; to prevent multiple infections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">2.</span><span class="token plain"> Drops secondary payload to C:\Users\Public\svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">3.</span><span class="token plain"> Establishes persistence via registry Run key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">4.</span><span class="token plain"> Injects code into explorer.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">5.</span><span class="token plain"> Connects to C2 server at 192[.]168[.]56[.]101:443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">6.</span><span class="token plain"> Exfiltrates credentials via HTTP POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Persistence Mechanisms:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Registry: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows Defender</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Scheduled Task: N/A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Service: N/A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Network Behavior:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> DNS queries: malicious[.]com, c2-server[.]tk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> C2 communication: HTTPS POST to 192[.]168[.]56[.]101:443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> User-Agent: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Beacon interval: 60 seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token hr punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Indicators of Compromise (IOCs)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> File Hashes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Hash Type </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Value                                                              </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-header-row"></span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">-----------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">--------------------------------------------------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-line"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> SHA256    </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890 </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> SHA1      </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> 1234567890abcdef1234567890abcdef12345678                           </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> MD5       </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> 12345678901234567890123456789012                                   </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Dropped Files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Filename                     </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> SHA256            </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Path                        </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-header-row"></span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">------------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">-------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">-----------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-line"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> svchost.exe                  </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> b2c3d4e5f6...     </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> C:\Users\Public\svchost.exe </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Network Indicators (Medium Confidence - Dynamic)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Type   </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Value (Defanged)          </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Context            </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-header-row"></span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">--------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">---------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">--------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-line"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Domain </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> malicious[.]com           </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> C2 server          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Domain </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> c2-server[.]tk            </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Backup C2          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> IP     </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> 192[.]168[.]56[.]101      </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> C2 IP address      </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> URL    </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> hxxps://malicious[.]com/api </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> C2 callback URL  </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Host Indicators (High Confidence - Static)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Type         </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Value                                                   </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-header-row"></span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">--------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">---------------------------------------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-line"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Mutex        </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Global\M12345                                           </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Registry Key </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows Defender </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> File Path    </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> C:\Users\Public\svchost.exe                             </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token hr punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> MITRE ATT&amp;CK Mapping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Tactic           </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Technique ID  </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Technique Name                  </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row table-header important"> Evidence                          </span><span class="token table table-header-row punctuation" style="color:#393A34">|</span><span class="token table table-header-row"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-header-row"></span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">---------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">---------------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line punctuation" style="color:#393A34">-----------------------------------</span><span class="token table table-line punctuation" style="color:#393A34">|</span><span class="token table table-line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-line"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Execution        </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> T1059.003     </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Windows Command Shell           </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> cmd.exe spawned by sample         </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Persistence      </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> T1547.001     </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Registry Run Keys               </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> HKCU\...\Run key created          </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Defense Evasion  </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> T1055.001     </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Process Injection               </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Code injected into explorer.exe   </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Credential Access</span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> T1003.001     </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> LSASS Memory Dump               </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> LsaEnumerateLogonSessions called  </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Command &amp; Control</span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> T1071.001     </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Web Protocols (HTTP/HTTPS)      </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> HTTPS POST to C2                  </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Exfiltration     </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> T1041         </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Exfiltration Over C2 Channel    </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows table-data"> Credentials sent via HTTP POST    </span><span class="token table table-data-rows punctuation" style="color:#393A34">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#393A34"><span class="token table table-data-rows"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token hr punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Detection &amp; Hunting Guidance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> YARA Rule</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```yara</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule Malware_Emotet_VariantA {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    meta:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        description = &quot;Detects Emotet variant A&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        author = &quot;Analyst Name&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        date = &quot;2025-10-05&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hash = &quot;a1b2c3d4e5f6...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    strings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $mutex = &quot;Global\\M12345&quot; wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $c2 = &quot;malicious.com&quot; ascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $ua = &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64)&quot; ascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    condition:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint16(0) == 0x5A4D and 2 of them</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Sigma Rule (Process Creation)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">title: Emotet Registry Persistence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">detection:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    selection:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CommandLine|contains: &#x27;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    condition: selection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Hunting Queries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Splunk:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">index=windows EventCode=1 (CommandLine=&quot;</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain">&quot; OR Image=&quot;*\\svchost.exe&quot; AND Image!=&quot;C:\\Windows\\System32\\svchost.exe&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Elastic:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">event.code:1 AND (process.command_line:</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain"> OR (process.executable:*svchost.exe AND NOT process.executable:C\:\\Windows\\System32\\svchost.exe))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token hr punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Recommendations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Immediate Actions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">1.</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Block network IOCs</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> at firewall/proxy (malicious[.]com, c2-server[.]tk, 192.168.56.101)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">2.</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Hunt for mutex</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> &quot;Global\M12345&quot; on endpoints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">3.</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Check registry Run keys</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> for &quot;Windows Defender&quot; entry pointing to non-standard path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">4.</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Search for file</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> C:\Users\Public\svchost.exe across environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Remediation Steps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">1.</span><span class="token plain"> Isolate infected hosts from network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">2.</span><span class="token plain"> Kill malicious processes (svchost.exe in C:\Users\Public\)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">3.</span><span class="token plain"> Delete dropped files and registry persistence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">4.</span><span class="token plain"> Reset credentials for affected users</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">5.</span><span class="token plain"> Re-image compromised systems</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Long-term Mitigations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Enable PowerShell logging (ScriptBlock, Module, Transcription)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Deploy endpoint detection and response (EDR) solution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Implement application whitelisting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> User security awareness training on phishing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token hr punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Appendix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Evidence Files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:#00009f">`sample.exe`</span><span class="token plain"> (original) - SHA256: a1b2c3d4e5f6...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:#00009f">`sample_unpacked.exe`</span><span class="token plain"> - SHA256: b2c3d4e5f6...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:#00009f">`svchost.exe`</span><span class="token plain"> (dropped) - SHA256: c3d4e5f6...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:#00009f">`procmon_output.csv`</span><span class="token plain"> - Process Monitor logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:#00009f">`traffic_capture.pcapng`</span><span class="token plain"> - Network traffic capture</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token code-snippet code keyword" style="color:#00009f">`regshot_comparison.html`</span><span class="token plain"> - Registry changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> Analysis Tools Used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> FLOSS 2.3 (string extraction)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> CAPA 7.0 (capability detection)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> PE-bear 0.6 (PE analysis)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Procmon 3.95 (behavioral analysis)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Wireshark 4.0 (network analysis)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> References</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> MITRE ATT&amp;CK: https://attack.mitre.org/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> VirusTotal: https://www.virustotal.com/gui/file/</span><span class="token entity named-entity" style="color:#36acaa">&amp;lt;</span><span class="token plain">SHA256</span><span class="token entity named-entity" style="color:#36acaa">&amp;gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> MalwareBazaar: https://bazaar.abuse.ch/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token hr punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Report Date:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> 2025-10-05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Last Updated:</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> 2025-10-05</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="92-evidence-package-structure">9.2 Evidence Package Structure<a href="#92-evidence-package-structure" class="hash-link" aria-label="Direct link to 9.2 Evidence Package Structure" title="Direct link to 9.2 Evidence Package Structure" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/CASE-2025-1005-001/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── report/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── malware_analysis_report.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   └── malware_analysis_report.pdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── intake/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── SAM-20251005-1430-001.7z (password: infected)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   └── chain_of_custody.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── binaries/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── sample.exe (original)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── sample_unpacked.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   └── svchost.exe (dropped)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── static/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── floss_output.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── capa_report.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── peframe_analysis.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   └── strings.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── dynamic/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── procmon_output.csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── regshot_comparison.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── sysmon_logs.evtx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   └── traffic_capture.pcapng</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── iocs/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── iocs.txt (defanged)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── iocs.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   └── iocs.csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── detections/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── emotet_variantA.yar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── emotet_sigma.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   └── emotet_suricata.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └── hashes.txt (SHA256 of all files)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="93-handoff-checklist">9.3 Handoff Checklist<a href="#93-handoff-checklist" class="hash-link" aria-label="Direct link to 9.3 Handoff Checklist" title="Direct link to 9.3 Handoff Checklist" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->All file hashes verified in evidence package</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->IOCs defanged in report</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Sensitive data (credentials, PII) sanitized</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Detection rules tested against sample</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->MITRE ATT&amp;CK mapping complete</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Recommendations reviewed with stakeholders</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Evidence package encrypted (password: infected)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Report approved by peer reviewer</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Findings briefed to incident response team</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Threat intelligence shared (if authorized)</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="10-advanced-techniques">10. Advanced Techniques<a href="#10-advanced-techniques" class="hash-link" aria-label="Direct link to 10. Advanced Techniques" title="Direct link to 10. Advanced Techniques" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="101-memory-forensics-integration">10.1 Memory Forensics Integration<a href="#101-memory-forensics-integration" class="hash-link" aria-label="Direct link to 10.1 Memory Forensics Integration" title="Direct link to 10.1 Memory Forensics Integration" translate="no">​</a></h3>
<p><strong>Acquire memory dump during dynamic analysis:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Using FTK Imager (GUI)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># File -&gt; Capture Memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Using DumpIt (command line)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DumpIt.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Using WinPMEM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">winpmem_mini_x64.exe -o memory.dmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Verify memory dump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-FileHash memory.dmp -Algorithm SHA256</span><br></span></code></pre></div></div>
<p><strong>Analyze with Volatility 3:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Easy way for Windows memory analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -&gt; https://github.com/gl0bal01/volatility-windows-analysis </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># List available plugins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Identify OS profile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># List running processes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.pslist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.pstree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Find hidden/injected processes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.pscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Network connections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.netscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Scan for malware signatures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.malfind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Dump suspicious process memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> dump_dir windows.memmap </span><span class="token parameter variable" style="color:#36acaa">--pid</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--dump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract command lines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.cmdline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Registry hives</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.registry.hivelist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.registry.printkey </span><span class="token parameter variable" style="color:#36acaa">--key</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Software\Microsoft\Windows\CurrentVersion\Run&quot;</span><br></span></code></pre></div></div>
<p><strong>YARA scan in memory:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Scan memory dump with YARA rules</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> memory.dmp windows.yarascan --yara-file malware.yar</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="102-automated-sandbox-analysis">10.2 Automated Sandbox Analysis<a href="#102-automated-sandbox-analysis" class="hash-link" aria-label="Direct link to 10.2 Automated Sandbox Analysis" title="Direct link to 10.2 Automated Sandbox Analysis" translate="no">​</a></h3>
<p><strong>ANY.RUN (cloud-based):</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. Upload sample to https://app.any.run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Select Windows version and network simulation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Interact with sample (click buttons, wait for execution)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Review process tree, network traffic, file operations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. Download PCAP and artifacts</span><br></span></code></pre></div></div>
<p><strong>Joe Sandbox (cloud/on-prem):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Submit via jbxapi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jbxapi submit sample.exe </span><span class="token parameter variable" style="color:#36acaa">--systems</span><span class="token plain"> win10x64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Wait for analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jbxapi status </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">submission_id</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Download report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jbxapi download </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">submission_id</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--type</span><span class="token plain"> html </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> joe_report.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jbxapi download </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">submission_id</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--type</span><span class="token plain"> json </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> joe_report.json</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="103-reverse-engineering-workflow">10.3 Reverse Engineering Workflow<a href="#103-reverse-engineering-workflow" class="hash-link" aria-label="Direct link to 10.3 Reverse Engineering Workflow" title="Direct link to 10.3 Reverse Engineering Workflow" translate="no">​</a></h3>
<p><strong>Disassembly with IDA Pro/Ghidra:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># IDA Pro workflow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Open sample.exe in IDA Pro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Auto-analysis completes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Navigate to Functions window</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Find entry point (start/main function)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. Identify interesting functions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Network functions (send, recv, InternetOpen)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Crypto functions (CryptEncrypt, AES_encrypt)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - String decryption routines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6. Set breakpoints for dynamic analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7. Use F5 (Hex-Rays) to decompile to pseudocode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Ghidra workflow (free alternative)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Create new project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Import sample.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Analyze with default options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Use Symbol Tree to find functions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. Decompiler window shows pseudocode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6. Look for XREFs to suspicious functions</span><br></span></code></pre></div></div>
<p><strong>Dynamic debugging with x64dbg:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. Open sample.exe in x64dbg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Set breakpoints on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - VirtualAlloc (memory allocation)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - CreateRemoteThread (process injection)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - InternetConnect (network connection)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - RegSetValue (persistence)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Run until breakpoint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Step through code (F7 - step into, F8 - step over)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. Dump decrypted strings or payloads from memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6. Follow execution flow to understand behavior</span><br></span></code></pre></div></div>
<p><strong>Anti-analysis bypass:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Common anti-analysis techniques and bypasses:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Technique              | Detection Method                     | Bypass                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|------------------------|--------------------------------------|----------------------------------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| IsDebuggerPresent      | Check PEB.BeingDebugged flag         | Patch return value to 0          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| CheckRemoteDebugger    | NtQueryInformationProcess            | Patch return value               |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| RDTSC timing check     | Measure execution time               | Hardware breakpoints instead     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| VM detection (CPUID)   | Check hypervisor bit                 | Modify CPUID response            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Sandbox sleep evasion  | Sleep(300000) before execution       | Patch sleep call or hook API     |</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="104-common-pitfalls--best-practices">10.4 Common Pitfalls &amp; Best Practices<a href="#104-common-pitfalls--best-practices" class="hash-link" aria-label="Direct link to 10.4 Common Pitfalls &amp; Best Practices" title="Direct link to 10.4 Common Pitfalls &amp; Best Practices" translate="no">​</a></h3>
<p><strong>❌ Common Mistakes:</strong></p>
<ul>
<li class="">Running malware on host system (always use isolated VM)</li>
<li class="">Uploading samples to public sandboxes (may alert adversary)</li>
<li class="">Not taking VM snapshots before execution (cannot reproduce)</li>
<li class="">Analyzing packed samples without unpacking (miss true behavior)</li>
<li class="">Ignoring string encoding (miss Unicode/base64 IOCs)</li>
<li class="">Assuming timestamps are accurate (often forged)</li>
<li class="">Forgetting to defang IOCs in reports (accidental clicks)</li>
</ul>
<p><strong>✅ Best Practices:</strong></p>
<ul>
<li class="">Always analyze in snapshottable isolated VM</li>
<li class="">Use hash-only lookups for intelligence gathering</li>
<li class="">Document every command and observation</li>
<li class="">Verify all hashes before and after transfer</li>
<li class="">Store samples in password-protected archives (password: infected)</li>
<li class="">Use defanged IOCs in all communications</li>
<li class="">Maintain chain of custody documentation</li>
<li class="">Peer review findings before publishing</li>
<li class="">Test detection rules before deployment</li>
<li class="">Keep analysis tools updated</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="11-qa--peer-review">11. QA &amp; Peer Review<a href="#11-qa--peer-review" class="hash-link" aria-label="Direct link to 11. QA &amp; Peer Review" title="Direct link to 11. QA &amp; Peer Review" translate="no">​</a></h2>
<p><strong>Review checklist:</strong></p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Second analyst reproduces key behaviors in clean VM</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Validate all file hashes (SHA256, SHA1, MD5)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Verify MITRE ATT&amp;CK technique mappings</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Confirm IOC confidence ratings (High/Medium/Low)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Test YARA/Sigma/Suricata rules against sample</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Check for false positive indicators</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Remove private/organizational data from report</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Sanitize screenshots (no usernames, hostnames, IPs)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Verify all URLs and domains are defanged</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Spell-check and grammar review</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Final sign-off in case notebook</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Archive evidence with verified hashes</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-appendix--tooling-reference">🔧 Appendix — Tooling Reference<a href="#-appendix--tooling-reference" class="hash-link" aria-label="Direct link to 🔧 Appendix — Tooling Reference" title="Direct link to 🔧 Appendix — Tooling Reference" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="static-analysis">Static Analysis<a href="#static-analysis" class="hash-link" aria-label="Direct link to Static Analysis" title="Direct link to Static Analysis" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Use</th><th>Platform</th><th>Link</th></tr></thead><tbody><tr><td>FLOSS</td><td>Obfuscated string extraction</td><td>Win/Linux/Mac</td><td><a href="https://github.com/mandiant/flare-floss" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>CAPA</td><td>Capability detection</td><td>Win/Linux/Mac</td><td><a href="https://github.com/mandiant/capa" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>peframe</td><td>PE file inspection</td><td>Linux</td><td><a href="https://github.com/guelfoweb/peframe" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>PE-bear</td><td>PE file GUI analysis</td><td>Windows</td><td><a href="https://hshrzd.wordpress.com/pe-bear/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>pestudio</td><td>PE analysis GUI</td><td>Windows</td><td><a href="https://www.winitor.com/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>pefile</td><td>PE parsing library (Python)</td><td>Win/Linux/Mac</td><td><a href="https://pypi.org/project/pefile/" target="_blank" rel="noopener noreferrer" class="">PyPI</a></td></tr><tr><td>TrID</td><td>File type identification</td><td>Win/Linux</td><td><a href="https://mark0.net/soft-trid-e.html" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>Detect It Easy</td><td>Packer/compiler detection</td><td>Win/Linux/Mac</td><td><a href="https://github.com/horsicq/Detect-It-Easy" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>strings</td><td>Extract strings (built-in)</td><td>Linux/Mac</td><td>Built-in</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="dynamic-analysis">Dynamic Analysis<a href="#dynamic-analysis" class="hash-link" aria-label="Direct link to Dynamic Analysis" title="Direct link to Dynamic Analysis" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Use</th><th>Platform</th><th>Link</th></tr></thead><tbody><tr><td>Process Monitor</td><td>File/registry/network tracking</td><td>Windows</td><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon" target="_blank" rel="noopener noreferrer" class="">Sysinternals</a></td></tr><tr><td>Process Hacker</td><td>Process/memory analysis</td><td>Windows</td><td><a href="https://processhacker.sourceforge.io/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>Wireshark</td><td>Network traffic capture/analysis</td><td>Win/Linux/Mac</td><td><a href="https://www.wireshark.org/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>TCPView</td><td>Live network connections</td><td>Windows</td><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/tcpview" target="_blank" rel="noopener noreferrer" class="">Sysinternals</a></td></tr><tr><td>Regshot</td><td>Registry comparison</td><td>Windows</td><td><a href="https://sourceforge.net/projects/regshot/" target="_blank" rel="noopener noreferrer" class="">SourceForge</a></td></tr><tr><td>Sysmon</td><td>Advanced Windows event logging</td><td>Windows</td><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon" target="_blank" rel="noopener noreferrer" class="">Sysinternals</a></td></tr><tr><td>Noriben</td><td>Automated Procmon analysis</td><td>Windows</td><td><a href="https://github.com/Rurik/Noriben" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="reverse-engineering">Reverse Engineering<a href="#reverse-engineering" class="hash-link" aria-label="Direct link to Reverse Engineering" title="Direct link to Reverse Engineering" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Use</th><th>Platform</th><th>Link</th></tr></thead><tbody><tr><td>IDA Pro</td><td>Disassembler/debugger (commercial)</td><td>Win/Linux/Mac</td><td><a href="https://hex-rays.com/ida-pro/" target="_blank" rel="noopener noreferrer" class="">Hex-Rays</a></td></tr><tr><td>Ghidra</td><td>Disassembler/decompiler (free)</td><td>Win/Linux/Mac</td><td><a href="https://ghidra-sre.org/" target="_blank" rel="noopener noreferrer" class="">NSA</a></td></tr><tr><td>x64dbg</td><td>Windows debugger</td><td>Windows</td><td><a href="https://x64dbg.com/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>OllyDbg</td><td>32-bit debugger</td><td>Windows</td><td><a href="http://www.ollydbg.de/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>Radare2</td><td>Reverse engineering framework</td><td>Win/Linux/Mac</td><td><a href="https://rada.re/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>Binary Ninja</td><td>Disassembler/decompiler</td><td>Win/Linux/Mac</td><td><a href="https://binary.ninja/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="specialized-tools">Specialized Tools<a href="#specialized-tools" class="hash-link" aria-label="Direct link to Specialized Tools" title="Direct link to Specialized Tools" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Use</th><th>Platform</th><th>Link</th></tr></thead><tbody><tr><td>oledump.py</td><td>Office macro extraction</td><td>Win/Linux/Mac</td><td><a href="https://blog.didierstevens.com/programs/oledump-py/" target="_blank" rel="noopener noreferrer" class="">Didier Stevens</a></td></tr><tr><td>olevba</td><td>VBA macro analysis</td><td>Win/Linux/Mac</td><td><a href="https://github.com/decalage2/oletools" target="_blank" rel="noopener noreferrer" class="">oletools</a></td></tr><tr><td>dnSpy</td><td>.NET decompiler/debugger</td><td>Windows</td><td><a href="https://github.com/dnSpy/dnSpy" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>ILSpy</td><td>.NET assembly browser</td><td>Win/Linux/Mac</td><td><a href="https://github.com/icsharpcode/ILSpy" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>de4dot</td><td>.NET deobfuscator</td><td>Windows</td><td><a href="https://github.com/de4dot/de4dot" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>pdfid.py</td><td>PDF structure analysis</td><td>Win/Linux/Mac</td><td><a href="https://blog.didierstevens.com/programs/pdf-tools/" target="_blank" rel="noopener noreferrer" class="">Didier Stevens</a></td></tr><tr><td>pdf-parser.py</td><td>PDF object extraction</td><td>Win/Linux/Mac</td><td><a href="https://blog.didierstevens.com/programs/pdf-tools/" target="_blank" rel="noopener noreferrer" class="">Didier Stevens</a></td></tr><tr><td>PSDecode</td><td>PowerShell deobfuscator</td><td>Win/Linux/Mac</td><td><a href="https://github.com/R3MRUM/PSDecode" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>js-beautify</td><td>JavaScript beautifier</td><td>Win/Linux/Mac</td><td><a href="https://www.npmjs.com/package/js-beautify" target="_blank" rel="noopener noreferrer" class="">NPM</a></td></tr><tr><td>LECmd</td><td>LNK file parser</td><td>Windows</td><td><a href="https://ericzimmerman.github.io/" target="_blank" rel="noopener noreferrer" class="">EricZimmerman</a></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="memory-forensics">Memory Forensics<a href="#memory-forensics" class="hash-link" aria-label="Direct link to Memory Forensics" title="Direct link to Memory Forensics" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Use</th><th>Platform</th><th>Link</th></tr></thead><tbody><tr><td>Volatility 3</td><td>Memory forensics framework</td><td>Win/Linux/Mac</td><td><a href="https://github.com/volatilityfoundation/volatility3" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>FTK Imager</td><td>Memory/disk acquisition</td><td>Windows</td><td><a href="https://www.exterro.com/ftk-imager" target="_blank" rel="noopener noreferrer" class="">AccessData</a></td></tr><tr><td>DumpIt</td><td>Memory acquisition</td><td>Windows</td><td><a href="https://www.magnetforensics.com/" target="_blank" rel="noopener noreferrer" class="">Magnet Forensics</a></td></tr><tr><td>WinPMEM</td><td>Memory acquisition</td><td>Windows</td><td><a href="https://github.com/Velocidex/WinPmem" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="sandboxes-cloud">Sandboxes (Cloud)<a href="#sandboxes-cloud" class="hash-link" aria-label="Direct link to Sandboxes (Cloud)" title="Direct link to Sandboxes (Cloud)" translate="no">​</a></h3>
<table><thead><tr><th>Service</th><th>Use</th><th>Type</th><th>Link</th></tr></thead><tbody><tr><td>VirusTotal</td><td>Multi-engine AV + intelligence</td><td>Free/Paid</td><td><a href="https://www.virustotal.com" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>ANY.RUN</td><td>Interactive sandbox</td><td>Free/Paid</td><td><a href="https://app.any.run" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>Hybrid Analysis</td><td>Cloud sandbox</td><td>Free/Paid</td><td><a href="https://www.hybrid-analysis.com" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>Tria.ge</td><td>Automated triage sandbox</td><td>Free/Paid</td><td><a href="https://tria.ge" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>Joe Sandbox</td><td>Advanced cloud sandbox</td><td>Commercial</td><td><a href="https://www.joesandbox.com/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="threat-intelligence">Threat Intelligence<a href="#threat-intelligence" class="hash-link" aria-label="Direct link to Threat Intelligence" title="Direct link to Threat Intelligence" translate="no">​</a></h3>
<table><thead><tr><th>Service</th><th>Use</th><th>Link</th></tr></thead><tbody><tr><td>MalwareBazaar</td><td>Malware sample repository</td><td><a href="https://bazaar.abuse.ch/" target="_blank" rel="noopener noreferrer" class="">abuse.ch</a></td></tr><tr><td>ThreatFox</td><td>IOC database</td><td><a href="https://threatfox.abuse.ch/" target="_blank" rel="noopener noreferrer" class="">abuse.ch</a></td></tr><tr><td>URLhaus</td><td>Malicious URL database</td><td><a href="https://urlhaus.abuse.ch/" target="_blank" rel="noopener noreferrer" class="">abuse.ch</a></td></tr><tr><td>MalAPI.io</td><td>Windows API behavior lookup</td><td><a href="https://malapi.io" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>GTFOBins</td><td>Unix binaries exploit database</td><td><a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="detection-engineering">Detection Engineering<a href="#detection-engineering" class="hash-link" aria-label="Direct link to Detection Engineering" title="Direct link to Detection Engineering" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Use</th><th>Link</th></tr></thead><tbody><tr><td>YARA</td><td>Pattern matching engine</td><td><a href="https://github.com/VirusTotal/yara" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>Sigma</td><td>Generic SIEM rule format</td><td><a href="https://github.com/SigmaHQ/sigma" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>Suricata</td><td>Network IDS/IPS</td><td><a href="https://suricata.io/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>ioc-fanger</td><td>IOC defanging/fanging tool</td><td><a href="https://github.com/ioc-fang/ioc-fanger" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="analysis-distributions">Analysis Distributions<a href="#analysis-distributions" class="hash-link" aria-label="Direct link to Analysis Distributions" title="Direct link to Analysis Distributions" translate="no">​</a></h3>
<table><thead><tr><th>Distribution</th><th>Description</th><th>Link</th></tr></thead><tbody><tr><td>FlareVM</td><td>Windows malware analysis VM</td><td><a href="https://github.com/mandiant/flare-vm" target="_blank" rel="noopener noreferrer" class="">GitHub</a></td></tr><tr><td>REMnux</td><td>Linux malware analysis distro</td><td><a href="https://remnux.org/" target="_blank" rel="noopener noreferrer" class="">Website</a></td></tr><tr><td>SIFT Workstation</td><td>Digital forensics distro</td><td><a href="https://www.sans.org/tools/sift-workstation/" target="_blank" rel="noopener noreferrer" class="">SANS</a></td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-additional-resources">📚 Additional Resources<a href="#-additional-resources" class="hash-link" aria-label="Direct link to 📚 Additional Resources" title="Direct link to 📚 Additional Resources" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="reference-materials">Reference Materials<a href="#reference-materials" class="hash-link" aria-label="Direct link to Reference Materials" title="Direct link to Reference Materials" translate="no">​</a></h3>
<ul>
<li class="">SANS Malware Analysis Cheat Sheet: <a href="https://www.sans.org/posters/" target="_blank" rel="noopener noreferrer" class="">https://www.sans.org/posters/</a></li>
<li class="">Practical Malware Analysis Book: <a href="https://practicalmalwareanalysis.com/" target="_blank" rel="noopener noreferrer" class="">https://practicalmalwareanalysis.com/</a></li>
<li class="">FLARE VM Setup Guide: <a href="https://github.com/mandiant/flare-vm" target="_blank" rel="noopener noreferrer" class="">https://github.com/mandiant/flare-vm</a></li>
<li class="">Volatility 3 Documentation: <a href="https://volatility3.readthedocs.io/" target="_blank" rel="noopener noreferrer" class="">https://volatility3.readthedocs.io/</a></li>
<li class="">Volatility Reference Guide:  <a href="https://github.com/gl0bal01/volatility" target="_blank" rel="noopener noreferrer" class="">https://github.com/gl0bal01/volatility</a></li>
<li class="">Volatility Windows Analysis Script: <a href="https://github.com/gl0bal01/volatility-windows-analysis" target="_blank" rel="noopener noreferrer" class="">https://github.com/gl0bal01/volatility-windows-analysis</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="communities--forums">Communities &amp; Forums<a href="#communities--forums" class="hash-link" aria-label="Direct link to Communities &amp; Forums" title="Direct link to Communities &amp; Forums" translate="no">​</a></h3>
<ul>
<li class="">r/Malware (Reddit): <a href="https://www.reddit.com/r/Malware/" target="_blank" rel="noopener noreferrer" class="">https://www.reddit.com/r/Malware/</a></li>
<li class="">MalwareTech Blog: <a href="https://www.malwaretech.com/" target="_blank" rel="noopener noreferrer" class="">https://www.malwaretech.com/</a></li>
<li class="">Malpedia (Malware Encyclopedia): <a href="https://malpedia.caad.fkie.fraunhofer.de/" target="_blank" rel="noopener noreferrer" class="">https://malpedia.caad.fkie.fraunhofer.de/</a></li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="12-extended-reference-resources">12. Extended Reference Resources<a href="#12-extended-reference-resources" class="hash-link" aria-label="Direct link to 12. Extended Reference Resources" title="Direct link to 12. Extended Reference Resources" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="comprehensive-malware-analysis-guides">Comprehensive Malware Analysis Guides<a href="#comprehensive-malware-analysis-guides" class="hash-link" aria-label="Direct link to Comprehensive Malware Analysis Guides" title="Direct link to Comprehensive Malware Analysis Guides" translate="no">​</a></h3>
<ul>
<li class=""><strong>Malware Unicorn&#x27;s Workshop</strong> - <a href="https://malwareunicorn.org/" target="_blank" rel="noopener noreferrer" class="">malwareunicorn.org</a>
<ul>
<li class="">Reverse engineering workshops and training materials</li>
<li class="">x86 assembly crash course</li>
</ul>
</li>
<li class=""><strong>HackTricks - Malware Analysis</strong> - <a href="https://book.hacktricks.xyz/forensics/malware-analysis" target="_blank" rel="noopener noreferrer" class="">book.hacktricks.xyz/forensics/malware-analysis</a>
<ul>
<li class="">Comprehensive malware analysis techniques</li>
<li class="">Static and dynamic analysis methodologies</li>
</ul>
</li>
<li class=""><strong>SANS Malware Analysis Toolkit</strong> - <a href="https://www.sans.org/tools/" target="_blank" rel="noopener noreferrer" class="">sans.org/tools</a>
<ul>
<li class="">Curated malware analysis tools and techniques</li>
</ul>
</li>
<li class=""><strong>OALabs Research</strong> - <a href="https://openanalysis.net/" target="_blank" rel="noopener noreferrer" class="">penanalysis.net</a> and their Discord<!-- -->
<ul>
<li class="">Malware unpacking and analysis tutorials</li>
<li class="">YouTube channel with detailed walkthroughs</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="malware-repositories--threat-intelligence">Malware Repositories &amp; Threat Intelligence<a href="#malware-repositories--threat-intelligence" class="hash-link" aria-label="Direct link to Malware Repositories &amp; Threat Intelligence" title="Direct link to Malware Repositories &amp; Threat Intelligence" translate="no">​</a></h3>
<ul>
<li class=""><strong>MalwareBazaar</strong> - <a href="https://bazaar.abuse.ch/" target="_blank" rel="noopener noreferrer" class="">bazaar.abuse.ch</a>
<ul>
<li class="">Malware sample sharing platform</li>
<li class="">API for automated lookups</li>
</ul>
</li>
<li class=""><strong>Malpedia</strong> - <a href="https://malpedia.caad.fkie.fraunhofer.de/" target="_blank" rel="noopener noreferrer" class="">malpedia.caad.fkie.fraunhofer.de</a>
<ul>
<li class="">Malware family encyclopedia</li>
<li class="">Detailed family profiles and IOCs</li>
</ul>
</li>
<li class=""><strong>ThreatFox</strong> - <a href="https://threatfox.abuse.ch/" target="_blank" rel="noopener noreferrer" class="">threatfox.abuse.ch</a>
<ul>
<li class="">IOC database for malware</li>
<li class="">Real-time threat intelligence</li>
</ul>
</li>
<li class=""><strong>URLhaus</strong> - <a href="https://urlhaus.abuse.ch/" target="_blank" rel="noopener noreferrer" class="">urlhaus.abuse.ch</a>
<ul>
<li class="">Malicious URL tracking</li>
</ul>
</li>
<li class=""><strong>Hybrid Analysis</strong> - <a href="https://www.hybrid-analysis.com/" target="_blank" rel="noopener noreferrer" class="">hybrid-analysis.com</a>
<ul>
<li class="">Free malware analysis sandbox</li>
</ul>
</li>
<li class=""><strong>VirusTotal Graph</strong> - <a href="https://www.virustotal.com/graph/" target="_blank" rel="noopener noreferrer" class="">virustotal.com/graph</a>
<ul>
<li class="">Visualize malware relationships</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="yara-rules--signatures">YARA Rules &amp; Signatures<a href="#yara-rules--signatures" class="hash-link" aria-label="Direct link to YARA Rules &amp; Signatures" title="Direct link to YARA Rules &amp; Signatures" translate="no">​</a></h3>
<ul>
<li class=""><strong>Awesome YARA</strong> - <a href="https://github.com/InQuest/awesome-yara" target="_blank" rel="noopener noreferrer" class="">github.com/InQuest/awesome-yara</a>
<ul>
<li class="">Curated list of YARA resources</li>
</ul>
</li>
<li class=""><strong>YARA-Rules Repository</strong> - <a href="https://github.com/Yara-Rules/rules" target="_blank" rel="noopener noreferrer" class="">github.com/Yara-Rules/rules</a>
<ul>
<li class="">Community YARA rules collection</li>
</ul>
</li>
<li class=""><strong>Neo23x0 Signature Base</strong> - <a href="https://github.com/Neo23x0/signature-base" target="_blank" rel="noopener noreferrer" class="">github.com/Neo23x0/signature-base</a>
<ul>
<li class="">Florian Roth&#x27;s YARA and Sigma rules</li>
</ul>
</li>
<li class=""><strong>ReversingLabs YARA Rules</strong> - <a href="https://github.com/reversinglabs/reversinglabs-yara-rules" target="_blank" rel="noopener noreferrer" class="">github.com/reversinglabs/reversinglabs-yara-rules</a>
<ul>
<li class="">Commercial-grade YARA rules</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="sandbox--dynamic-analysis">Sandbox &amp; Dynamic Analysis<a href="#sandbox--dynamic-analysis" class="hash-link" aria-label="Direct link to Sandbox &amp; Dynamic Analysis" title="Direct link to Sandbox &amp; Dynamic Analysis" translate="no">​</a></h3>
<ul>
<li class=""><strong>ANY.RUN</strong> - <a href="https://app.any.run/" target="_blank" rel="noopener noreferrer" class="">app.any.run</a>
<ul>
<li class="">Interactive malware sandbox</li>
<li class="">Real-time analysis observation</li>
</ul>
</li>
<li class=""><strong>Tria.ge</strong> - <a href="https://tria.ge/" target="_blank" rel="noopener noreferrer" class="">tria.ge</a>
<ul>
<li class="">Automated malware analysis</li>
<li class="">Free tier available</li>
</ul>
</li>
<li class=""><strong>Joe Sandbox</strong> - <a href="https://www.joesandbox.com/" target="_blank" rel="noopener noreferrer" class="">joesandbox.com</a>
<ul>
<li class="">Advanced malware analysis sandbox</li>
</ul>
</li>
<li class=""><strong>CAPE Sandbox</strong> - <a href="https://github.com/kevoreilly/CAPEv2" target="_blank" rel="noopener noreferrer" class="">github.com/kevoreilly/CAPEv2</a>
<ul>
<li class="">Open-source malware sandbox</li>
<li class="">Config extractor for malware families</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="reverse-engineering-resources">Reverse Engineering Resources<a href="#reverse-engineering-resources" class="hash-link" aria-label="Direct link to Reverse Engineering Resources" title="Direct link to Reverse Engineering Resources" translate="no">​</a></h3>
<ul>
<li class=""><strong>Practical Malware Analysis</strong> - <a href="https://practicalmalwareanalysis.com/" target="_blank" rel="noopener noreferrer" class="">practicalmalwareanalysis.com</a>
<ul>
<li class="">Classic malware analysis textbook</li>
</ul>
</li>
<li class=""><strong>Reverse Engineering for Beginners</strong> - <a href="https://beginners.re/" target="_blank" rel="noopener noreferrer" class="">beginners.re</a>
<ul>
<li class="">Free book by Dennis Yurichev</li>
</ul>
</li>
<li class=""><strong>Malware Analysis for Hedgehogs (YouTube)</strong> - <a href="https://www.youtube.com/@MalwareAnalysisForHedgehogs" target="_blank" rel="noopener noreferrer" class="">Colin Hardy&#x27;s channel</a>
<ul>
<li class="">Detailed malware analysis walkthroughs</li>
</ul>
</li>
<li class=""><strong>LiveOverflow Malware Series</strong> - <a href="https://www.youtube.com/c/LiveOverflow" target="_blank" rel="noopener noreferrer" class="">youtube.com/LiveOverflow</a>
<ul>
<li class="">Binary exploitation and malware analysis</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="specialized-analysis-techniques">Specialized Analysis Techniques<a href="#specialized-analysis-techniques" class="hash-link" aria-label="Direct link to Specialized Analysis Techniques" title="Direct link to Specialized Analysis Techniques" translate="no">​</a></h3>
<ul>
<li class=""><strong>Unpacking Malware</strong> - <a href="https://unprotect.it/" target="_blank" rel="noopener noreferrer" class="">unprotect.it</a>
<ul>
<li class="">Malware evasion techniques database</li>
<li class="">Unpacking methods and anti-analysis</li>
</ul>
</li>
<li class=""><strong>Didier Stevens Tools</strong> - <a href="https://blog.didierstevens.com/programs/" target="_blank" rel="noopener noreferrer" class="">blog.didierstevens.com/programs</a>
<ul>
<li class="">PDF analysis, Office macro tools</li>
<li class="">oledump.py, pdfid.py, pdf-parser.py</li>
</ul>
</li>
<li class=""><strong>FLOSS Documentation</strong> - <a href="https://github.com/mandiant/flare-floss" target="_blank" rel="noopener noreferrer" class="">github.com/mandiant/flare-floss</a>
<ul>
<li class="">Mandiant&#x27;s obfuscated string solver</li>
</ul>
</li>
<li class=""><strong>CAPA Rules</strong> - <a href="https://github.com/mandiant/capa-rules" target="_blank" rel="noopener noreferrer" class="">github.com/mandiant/capa-rules</a>
<ul>
<li class="">Capability detection rules</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="memory-forensics-1">Memory Forensics<a href="#memory-forensics-1" class="hash-link" aria-label="Direct link to Memory Forensics" title="Direct link to Memory Forensics" translate="no">​</a></h3>
<ul>
<li class=""><strong>Volatility Cheat Sheet</strong> - <a href="https://github.com/gl0bal01/volatility" target="_blank" rel="noopener noreferrer" class="">github.com/gl0bal01/volatility</a>
<ul>
<li class="">Quick reference for Volatility commands</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="api--behavior-references">API &amp; Behavior References<a href="#api--behavior-references" class="hash-link" aria-label="Direct link to API &amp; Behavior References" title="Direct link to API &amp; Behavior References" translate="no">​</a></h3>
<ul>
<li class=""><strong>MalAPI.io</strong> - <a href="https://malapi.io/" target="_blank" rel="noopener noreferrer" class="">malapi.io</a>
<ul>
<li class="">Windows API calls used by malware</li>
<li class="">Categorized by function (persistence, evasion, etc.)</li>
</ul>
</li>
<li class=""><strong>MITRE ATT&amp;CK</strong> - <a href="https://attack.mitre.org/" target="_blank" rel="noopener noreferrer" class="">attack.mitre.org</a>
<ul>
<li class="">Adversary tactics and techniques</li>
</ul>
</li>
<li class=""><strong>ATT&amp;CK Navigator</strong> - <a href="https://mitre-attack.github.io/attack-navigator/" target="_blank" rel="noopener noreferrer" class="">mitre-attack.github.io/attack-navigator</a>
<ul>
<li class="">Visualize ATT&amp;CK techniques</li>
</ul>
</li>
<li class=""><strong>LOLBins</strong> - <a href="https://lolbas-project.github.io/" target="_blank" rel="noopener noreferrer" class="">lolbas-project.github.io</a>
<ul>
<li class="">Living Off the Land binaries (Windows)</li>
</ul>
</li>
<li class=""><strong>GTFOBins</strong> - <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer" class="">gtfobins.github.io</a>
<ul>
<li class="">Unix binaries for exploitation</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="net--powershell-analysis">.NET &amp; PowerShell Analysis<a href="#net--powershell-analysis" class="hash-link" aria-label="Direct link to .NET &amp; PowerShell Analysis" title="Direct link to .NET &amp; PowerShell Analysis" translate="no">​</a></h3>
<ul>
<li class=""><strong>dnSpyEx</strong> - <a href="https://github.com/dnSpyEx/dnSpy" target="_blank" rel="noopener noreferrer" class="">github.com/dnSpyEx/dnSpy</a>
<ul>
<li class="">.NET debugger and decompiler (maintained fork)</li>
</ul>
</li>
<li class=""><strong>de4dot</strong> - <a href="https://github.com/de4dot/de4dot" target="_blank" rel="noopener noreferrer" class="">github.com/de4dot/de4dot</a>
<ul>
<li class="">.NET deobfuscator</li>
</ul>
</li>
<li class=""><strong>PSDecode</strong> - <a href="https://github.com/R3MRUM/PSDecode" target="_blank" rel="noopener noreferrer" class="">github.com/R3MRUM/PSDecode</a>
<ul>
<li class="">PowerShell deobfuscation tool</li>
</ul>
</li>
<li class=""><strong>PowerShell Empire Detection</strong> - <a href="https://github.com/EmpireProject/Empire" target="_blank" rel="noopener noreferrer" class="">github.com/EmpireProject/Empire</a>
<ul>
<li class="">Understanding PowerShell malware</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="office--document-malware">Office &amp; Document Malware<a href="#office--document-malware" class="hash-link" aria-label="Direct link to Office &amp; Document Malware" title="Direct link to Office &amp; Document Malware" translate="no">​</a></h3>
<ul>
<li class=""><strong>oletools</strong> - <a href="https://github.com/decalage2/oletools" target="_blank" rel="noopener noreferrer" class="">github.com/decalage2/oletools</a>
<ul>
<li class="">Python tools for malicious Office files</li>
<li class="">olevba, rtfobj, msodde</li>
</ul>
</li>
<li class=""><strong>XLMMacroDeobfuscator</strong> - <a href="https://github.com/DissectMalware/XLMMacroDeobfuscator" target="_blank" rel="noopener noreferrer" class="">github.com/DissectMalware/XLMMacroDeobfuscator</a>
<ul>
<li class="">Excel 4.0 macro analysis</li>
</ul>
</li>
<li class=""><strong>VBA Stomping Detection</strong> - <a href="https://outflank.nl/blog/" target="_blank" rel="noopener noreferrer" class="">outflank.nl/blog</a>
<ul>
<li class="">Understanding VBA stomping techniques</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="courses--training">Courses &amp; Training<a href="#courses--training" class="hash-link" aria-label="Direct link to Courses &amp; Training" title="Direct link to Courses &amp; Training" translate="no">​</a></h3>
<ul>
<li class=""><strong>SANS FOR610</strong> - Reverse Engineering Malware: Malware Analysis Tools and Techniques</li>
<li class=""><strong>SANS FOR710</strong> - Reverse Engineering Malware: Advanced Code Analysis</li>
<li class=""><strong>TCM Security - Practical Malware Analysis &amp; Triage</strong> - <a href="https://tcm-sec.com/" target="_blank" rel="noopener noreferrer" class="">tcm-sec.com/pmat</a></li>
<li class=""><strong>Malware Analysis Boot Camp (Cybrary)</strong> - <a href="https://www.cybrary.it/" target="_blank" rel="noopener noreferrer" class="">cybrary.it</a></li>
<li class=""><strong>eLearnSecurity Malware Analysis Professional (eCMAP)</strong></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="blogs--research">Blogs &amp; Research<a href="#blogs--research" class="hash-link" aria-label="Direct link to Blogs &amp; Research" title="Direct link to Blogs &amp; Research" translate="no">​</a></h3>
<ul>
<li class=""><strong>MalwareTech</strong> - <a href="https://www.malwaretech.com/" target="_blank" rel="noopener noreferrer" class="">malwaretech.com</a>
<ul>
<li class="">Marcus Hutchins&#x27; malware research blog</li>
</ul>
</li>
<li class=""><strong>Kryptos Logic</strong> - <a href="https://www.kryptoslogic.com/blog/" target="_blank" rel="noopener noreferrer" class="">kryptoslogic.com/blog</a>
<ul>
<li class="">Advanced malware analysis</li>
</ul>
</li>
<li class=""><strong>Mandiant Blog</strong> - <a href="https://www.mandiant.com/resources/blog/" target="_blank" rel="noopener noreferrer" class="">mandiant.com/resources/blog</a>
<ul>
<li class="">APT and malware research</li>
</ul>
</li>
<li class=""><strong>Malwarebytes Labs</strong> - <a href="https://blog.malwarebytes.com/" target="_blank" rel="noopener noreferrer" class="">blog.malwarebytes.com</a>
<ul>
<li class="">Consumer malware trends</li>
</ul>
</li>
<li class=""><strong>CERT-EU Security Advisories</strong> - <a href="https://cert.europa.eu/" target="_blank" rel="noopener noreferrer" class="">cert.europa.eu</a>
<ul>
<li class="">European CERT malware alerts</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="forensics-integration">Forensics Integration<a href="#forensics-integration" class="hash-link" aria-label="Direct link to Forensics Integration" title="Direct link to Forensics Integration" translate="no">​</a></h3>
<ul>
<li class=""><strong>SANS Digital Forensics Blog</strong> - <a href="https://www.sans.org/blog/" target="_blank" rel="noopener noreferrer" class="">sans.org/blog</a></li>
<li class=""><strong>13Cubed (YouTube)</strong> - <a href="https://www.youtube.com/c/13Cubed" target="_blank" rel="noopener noreferrer" class="">youtube.com/c/13Cubed</a>
<ul>
<li class="">Digital forensics and incident response</li>
</ul>
</li>
<li class=""><strong>DFIR.it</strong> - <a href="https://dfir.it/" target="_blank" rel="noopener noreferrer" class="">dfir.it</a>
<ul>
<li class="">Digital forensics resources</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="communities--forums-1">Communities &amp; Forums<a href="#communities--forums-1" class="hash-link" aria-label="Direct link to Communities &amp; Forums" title="Direct link to Communities &amp; Forums" translate="no">​</a></h3>
<ul>
<li class=""><strong>r/Malware</strong> - <a href="https://www.reddit.com/r/Malware/" target="_blank" rel="noopener noreferrer" class="">reddit.com/r/Malware</a>
<ul>
<li class="">Malware analysis community</li>
</ul>
</li>
<li class=""><strong>r/ReverseEngineering</strong> - <a href="https://www.reddit.com/r/ReverseEngineering/" target="_blank" rel="noopener noreferrer" class="">reddit.com/r/ReverseEngineering</a>
<ul>
<li class="">Reverse engineering discussions</li>
</ul>
</li>
<li class=""><strong>Malware Analysis Discord</strong> - Various community servers</li>
<li class=""><strong>Stack Overflow - Reverse Engineering</strong> - <a href="https://reverseengineering.stackexchange.com/" target="_blank" rel="noopener noreferrer" class="">reverseengineering.stackexchange.com</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="automated-analysis-platforms">Automated Analysis Platforms<a href="#automated-analysis-platforms" class="hash-link" aria-label="Direct link to Automated Analysis Platforms" title="Direct link to Automated Analysis Platforms" translate="no">​</a></h3>
<ul>
<li class=""><strong>DRAKVUF Sandbox</strong> - <a href="https://github.com/CERT-Polska/drakvuf-sandbox" target="_blank" rel="noopener noreferrer" class="">github.com/CERT-Polska/drakvuf-sandbox</a>
<ul>
<li class="">Agentless malware sandbox</li>
</ul>
</li>
<li class=""><strong>Noriben</strong> - <a href="https://github.com/Rurik/Noriben" target="_blank" rel="noopener noreferrer" class="">github.com/Rurik/Noriben</a>
<ul>
<li class="">Automated Procmon analysis script</li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="related-sops">Related SOPs<a href="#related-sops" class="hash-link" aria-label="Direct link to Related SOPs" title="Direct link to Related SOPs" translate="no">​</a></h2>
<p><strong>Analysis:</strong></p>
<ul>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-reverse-engineering">Reverse Engineering</a> - Disassembly, decompilation, and binary analysis</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-cryptography-analysis">Cryptography Analysis</a> - Analyzing encryption in malware</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-hash-generation-methods">Hash Generation Methods</a> - File hashing and integrity</li>
</ul>
<p><strong>Pentesting &amp; Security:</strong></p>
<ul>
<li class=""><a class="" href="/intel-codex/Pentesting/sop-forensics-investigation">Forensics Investigation</a> - Post-incident analysis and evidence collection</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-detection-evasion-testing">Detection Evasion Testing</a> - Understanding malware evasion techniques</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-vulnerability-research">Vulnerability Research</a> - Finding vulnerabilities exploited by malware</li>
</ul>
<hr>
<blockquote>
<p>📦 This SOP is designed for Obsidian vault integration. Link from incident case folders or use as standalone reference for malware analysis workflows.</p>
</blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/gl0bal01/intel-codex/tree/main/intel-codex/Security/Analysis/sop-malware-analysis.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/intel-codex/Security/Analysis/sop-hash-generation-methods"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Hash Generation Methods for Evidence Integrity</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/intel-codex/Security/Analysis/sop-reverse-engineering"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Reverse Engineering</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#0-scope--principles" class="table-of-contents__link toc-highlight">0. Scope &amp; Principles</a></li><li><a href="#1-safety--opsec---pre-flight-checklist" class="table-of-contents__link toc-highlight">1. Safety &amp; OPSEC — 🔒 Pre-Flight Checklist</a><ul><li><a href="#lab-environment-setup" class="table-of-contents__link toc-highlight">Lab Environment Setup</a></li></ul></li><li><a href="#2-intake--chain-of-custody" class="table-of-contents__link toc-highlight">2. Intake &amp; Chain of Custody</a><ul><li><a href="#sample-acquisition--metadata-collection" class="table-of-contents__link toc-highlight">Sample Acquisition &amp; Metadata Collection</a></li><li><a href="#chain-of-custody-form" class="table-of-contents__link toc-highlight">Chain of Custody Form</a></li></ul></li><li><a href="#3-rapid-triage-static-analysis" class="table-of-contents__link toc-highlight">3. Rapid Triage (Static Analysis)</a><ul><li><a href="#31-file-identification--packing" class="table-of-contents__link toc-highlight">3.1 File Identification &amp; Packing</a></li><li><a href="#32-strings--imports" class="table-of-contents__link toc-highlight">3.2 Strings &amp; Imports</a></li><li><a href="#33-capability-detection" class="table-of-contents__link toc-highlight">3.3 Capability Detection</a></li><li><a href="#34-multi-engine-scanning" class="table-of-contents__link toc-highlight">3.4 Multi-Engine Scanning</a></li></ul></li><li><a href="#4-behavior-analysis-dynamic-in-lab-only" class="table-of-contents__link toc-highlight">4. Behavior Analysis (Dynamic, In-Lab Only)</a><ul><li><a href="#41-monitoring-setup" class="table-of-contents__link toc-highlight">4.1 Monitoring Setup</a></li><li><a href="#42-execution--observation" class="table-of-contents__link toc-highlight">4.2 Execution &amp; Observation</a></li><li><a href="#43-network-behavior" class="table-of-contents__link toc-highlight">4.3 Network Behavior</a></li></ul></li><li><a href="#5-artefact-extraction--normalization" class="table-of-contents__link toc-highlight">5. Artefact Extraction &amp; Normalization</a></li><li><a href="#6-specialized-file-analysis" class="table-of-contents__link toc-highlight">6. Specialized File Analysis</a><ul><li><a href="#61-netc-analysis" class="table-of-contents__link toc-highlight">6.1 .NET/C# Analysis</a></li><li><a href="#62-officemacro-analysis" class="table-of-contents__link toc-highlight">6.2 Office/Macro Analysis</a></li><li><a href="#63-pdf-analysis" class="table-of-contents__link toc-highlight">6.3 PDF Analysis</a></li><li><a href="#64-script-analysis-powershellvbsjs" class="table-of-contents__link toc-highlight">6.4 Script Analysis (PowerShell/VBS/JS)</a></li><li><a href="#65-archive-analysis" class="table-of-contents__link toc-highlight">6.5 Archive Analysis</a></li><li><a href="#66-linuxelf-analysis" class="table-of-contents__link toc-highlight">6.6 Linux/ELF Analysis</a></li></ul></li><li><a href="#7-classification--ttp-mapping" class="table-of-contents__link toc-highlight">7. Classification &amp; TTP Mapping</a></li><li><a href="#8-iocs--detection-engineering" class="table-of-contents__link toc-highlight">8. IOCs &amp; Detection Engineering</a><ul><li><a href="#81-ioc-extraction--defanging" class="table-of-contents__link toc-highlight">8.1 IOC Extraction &amp; Defanging</a></li><li><a href="#82-ioc-confidence--volatility-rating" class="table-of-contents__link toc-highlight">8.2 IOC Confidence &amp; Volatility Rating</a></li><li><a href="#83-yara-rule-creation" class="table-of-contents__link toc-highlight">8.3 YARA Rule Creation</a></li><li><a href="#84-sigma-rule-creation" class="table-of-contents__link toc-highlight">8.4 Sigma Rule Creation</a></li><li><a href="#85-suricata-rule-creation" class="table-of-contents__link toc-highlight">8.5 Suricata Rule Creation</a></li><li><a href="#91-malware-analysis-report-template" class="table-of-contents__link toc-highlight">9.1 Malware Analysis Report Template</a></li><li><a href="#92-evidence-package-structure" class="table-of-contents__link toc-highlight">9.2 Evidence Package Structure</a></li><li><a href="#93-handoff-checklist" class="table-of-contents__link toc-highlight">9.3 Handoff Checklist</a></li></ul></li><li><a href="#10-advanced-techniques" class="table-of-contents__link toc-highlight">10. Advanced Techniques</a><ul><li><a href="#101-memory-forensics-integration" class="table-of-contents__link toc-highlight">10.1 Memory Forensics Integration</a></li><li><a href="#102-automated-sandbox-analysis" class="table-of-contents__link toc-highlight">10.2 Automated Sandbox Analysis</a></li><li><a href="#103-reverse-engineering-workflow" class="table-of-contents__link toc-highlight">10.3 Reverse Engineering Workflow</a></li><li><a href="#104-common-pitfalls--best-practices" class="table-of-contents__link toc-highlight">10.4 Common Pitfalls &amp; Best Practices</a></li></ul></li><li><a href="#11-qa--peer-review" class="table-of-contents__link toc-highlight">11. QA &amp; Peer Review</a></li><li><a href="#-appendix--tooling-reference" class="table-of-contents__link toc-highlight">🔧 Appendix — Tooling Reference</a><ul><li><a href="#static-analysis" class="table-of-contents__link toc-highlight">Static Analysis</a></li><li><a href="#dynamic-analysis" class="table-of-contents__link toc-highlight">Dynamic Analysis</a></li><li><a href="#reverse-engineering" class="table-of-contents__link toc-highlight">Reverse Engineering</a></li><li><a href="#specialized-tools" class="table-of-contents__link toc-highlight">Specialized Tools</a></li><li><a href="#memory-forensics" class="table-of-contents__link toc-highlight">Memory Forensics</a></li><li><a href="#sandboxes-cloud" class="table-of-contents__link toc-highlight">Sandboxes (Cloud)</a></li><li><a href="#threat-intelligence" class="table-of-contents__link toc-highlight">Threat Intelligence</a></li><li><a href="#detection-engineering" class="table-of-contents__link toc-highlight">Detection Engineering</a></li><li><a href="#analysis-distributions" class="table-of-contents__link toc-highlight">Analysis Distributions</a></li></ul></li><li><a href="#-additional-resources" class="table-of-contents__link toc-highlight">📚 Additional Resources</a><ul><li><a href="#reference-materials" class="table-of-contents__link toc-highlight">Reference Materials</a></li><li><a href="#communities--forums" class="table-of-contents__link toc-highlight">Communities &amp; Forums</a></li></ul></li><li><a href="#12-extended-reference-resources" class="table-of-contents__link toc-highlight">12. Extended Reference Resources</a><ul><li><a href="#comprehensive-malware-analysis-guides" class="table-of-contents__link toc-highlight">Comprehensive Malware Analysis Guides</a></li><li><a href="#malware-repositories--threat-intelligence" class="table-of-contents__link toc-highlight">Malware Repositories &amp; Threat Intelligence</a></li><li><a href="#yara-rules--signatures" class="table-of-contents__link toc-highlight">YARA Rules &amp; Signatures</a></li><li><a href="#sandbox--dynamic-analysis" class="table-of-contents__link toc-highlight">Sandbox &amp; Dynamic Analysis</a></li><li><a href="#reverse-engineering-resources" class="table-of-contents__link toc-highlight">Reverse Engineering Resources</a></li><li><a href="#specialized-analysis-techniques" class="table-of-contents__link toc-highlight">Specialized Analysis Techniques</a></li><li><a href="#memory-forensics-1" class="table-of-contents__link toc-highlight">Memory Forensics</a></li><li><a href="#api--behavior-references" class="table-of-contents__link toc-highlight">API &amp; Behavior References</a></li><li><a href="#net--powershell-analysis" class="table-of-contents__link toc-highlight">.NET &amp; PowerShell Analysis</a></li><li><a href="#office--document-malware" class="table-of-contents__link toc-highlight">Office &amp; Document Malware</a></li><li><a href="#courses--training" class="table-of-contents__link toc-highlight">Courses &amp; Training</a></li><li><a href="#blogs--research" class="table-of-contents__link toc-highlight">Blogs &amp; Research</a></li><li><a href="#forensics-integration" class="table-of-contents__link toc-highlight">Forensics Integration</a></li><li><a href="#communities--forums-1" class="table-of-contents__link toc-highlight">Communities &amp; Forums</a></li><li><a href="#automated-analysis-platforms" class="table-of-contents__link toc-highlight">Automated Analysis Platforms</a></li></ul></li><li><a href="#related-sops" class="table-of-contents__link toc-highlight">Related SOPs</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Intel Codex</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="Intel Codex overview page" href="/intel-codex">Overview</a></li><li class="footer__item"><a href="https://github.com/gl0bal01/intel-codex" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Download the Intel Codex Obsidian vault">Download Vault<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">OSINT Investigations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="OSINT investigation index" href="/intel-codex/Investigations/Investigations-Index">Investigation Index</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Investigation techniques and methodologies" href="/intel-codex/Investigations/Techniques/Techniques-Index">Investigation Techniques</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Platform-specific investigation guides" href="/intel-codex/Investigations/Platforms/Platforms-Index">Platform Guides</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Security Operations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="Security analysis resources and guides" href="/intel-codex/Security/Analysis/Analysis-Index">Security Analysis</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Penetration testing methodologies and tools" href="/intel-codex/Security/Pentesting/Pentesting-Index">Penetration Testing</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Malware analysis procedures" href="/intel-codex/Security/Analysis/sop-malware-analysis">Malware Analysis</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Reverse engineering techniques" href="/intel-codex/Security/Analysis/sop-reverse-engineering">Reverse Engineering</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Digital forensics investigation procedures" href="/intel-codex/Security/Analysis/sop-forensics-investigation">Digital Forensics (DFIR)</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="OSINT foundations and resources" href="/osint">OSINT Foundations</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Cybersecurity resources and guides" href="/cyber">Cybersecurity</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Artificial intelligence resources" href="/ai">AI Resources</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Technical cheatsheets and quick references" href="/cheatsheets">Cheatsheets</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Security and technology news feeds" href="/news">News Feeds</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Visit our blog" href="/blog">Blog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="CTF platforms and training resources" href="/blog/ctf-platforms-training">Play &amp; Learn</a></li><li class="footer__item"><a href="https://github.com/gl0bal01/" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Visit gl0bal01 on GitHub">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.gg/T5tc9Rq8DV" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Join gl0bal01 Discord community">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://start.me/u/gl0bal01" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Visit gl0bal01 Start.me page">Start.me<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 gl0bal01. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>