<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-reverse/binary-refinery-practical-guide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Comprehensive Binary Refinery Practical Guide | gl0bal01 | Notes &amp; Research</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://gl0bal01.com/reverse/binary-refinery-practical-guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Comprehensive Binary Refinery Practical Guide | gl0bal01 | Notes &amp; Research"><meta data-rh="true" name="description" content="Comprehensive guide to Binary Refinery - the ultimate command-line toolkit for malware analysis, binary data manipulation, and cybersecurity investigations. Learn from basic operations to advanced forensic workflows."><meta data-rh="true" property="og:description" content="Comprehensive guide to Binary Refinery - the ultimate command-line toolkit for malware analysis, binary data manipulation, and cybersecurity investigations. Learn from basic operations to advanced forensic workflows."><meta data-rh="true" name="keywords" content="binary refinery,malware analysis,cybersecurity,binary data analysis,reverse engineering,digital forensics,command line tools,python security tools,data transformation,cyber threat analysis"><link data-rh="true" rel="icon" href="/icons/favicon.ico"><link data-rh="true" rel="canonical" href="https://gl0bal01.com/reverse/binary-refinery-practical-guide"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/reverse/binary-refinery-practical-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/reverse/binary-refinery-practical-guide" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Reverse Engineering","item":"https://gl0bal01.com/reverse-engineering"},{"@type":"ListItem","position":2,"name":"Binary Refinery Practical","item":"https://gl0bal01.com/reverse/binary-refinery-practical-guide"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="gl0bal01 | Notes &amp; Research RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="gl0bal01 | Notes &amp; Research Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NFE7MZ9S3P"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NFE7MZ9S3P",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="gl0bal01 | Notes &amp; Research" href="/opensearch.xml">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Host+Grotesk:wght@600;700;800&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.017f04e3.css">
<script src="/assets/js/runtime~main.86314a16.js" defer="defer"></script>
<script src="/assets/js/main.71ae77db.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/icons/android-icon-48x48.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">üéâÔ∏è ‚≠êÔ∏è If you like this repo, give it a star and follow me on <a target="_blank" rel="noopener noreferrer" href="https://github.com/gl0bal01/">GitHub</a> ü•≥Ô∏è</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">gl0bal01</b></a><a class="navbar__item navbar__link" href="/ai">Ai</a><a class="navbar__item navbar__link" href="/cyber">Cyber</a><a class="navbar__item navbar__link" href="/osint">Osint</a><a class="navbar__item navbar__link" href="/reverse-engineering">Reverse</a><a class="navbar__item navbar__link" href="/cheatsheets">Cheatsheets</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog/ctf-platforms-training">üé≠ Play &amp; Learn</a></li><li><a href="https://github.com/gl0bal01/" target="_blank" class="dropdown__link">Github<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://discord.gg/T5tc9Rq8DV" target="_blank" class="dropdown__link">Discord<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://start.me/u/gl0bal01" target="_blank" class="dropdown__link">Start.me<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/gl0bal01/bookmarklets" target="_blank" class="dropdown__link">Bookmarklets<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><a class="navbar__item navbar__link blog-button" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/news">News</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/ai"><span title="Ai" class="categoryLinkLabel_W154">Ai</span></a><button aria-label="Expand sidebar category &#x27;Ai&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cyber"><span title="Cyber" class="categoryLinkLabel_W154">Cyber</span></a><button aria-label="Expand sidebar category &#x27;Cyber&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/osint"><span title="Osint" class="categoryLinkLabel_W154">Osint</span></a><button aria-label="Expand sidebar category &#x27;Osint&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/reverse-engineering"><span title="Reverse Engineering" class="categoryLinkLabel_W154">Reverse Engineering</span></a><button aria-label="Collapse sidebar category &#x27;Reverse Engineering&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reverse/gdb-gef-practical-guide"><span title="Debugging with GDB/GEF" class="linkLabel_WmDU">Debugging with GDB/GEF</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reverse/gdb-gef-practical-examples"><span title="Buffer Overflow Exploitation" class="linkLabel_WmDU">Buffer Overflow Exploitation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reverse/binary-refinery-practical-guide"><span title="Binary Refinery Practical" class="linkLabel_WmDU">Binary Refinery Practical</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cheatsheets"><span title="Cheatsheets" class="categoryLinkLabel_W154">Cheatsheets</span></a><button aria-label="Expand sidebar category &#x27;Cheatsheets&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/reverse-engineering"><span>Reverse Engineering</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Binary Refinery Practical</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Binary Refinery Practical Guide</h1></header>
<p>Binary Refinery is the most powerful command-line toolkit for analyzing and manipulating binary data in cybersecurity investigations. This comprehensive guide covers everything from basic operations to advanced malware analysis workflows, making it your definitive reference for mastering Binary Refinery.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents" translate="no">‚Äã</a></h2>
<ol>
<li><a href="#introduction--core-concepts">Introduction &amp; Core Concepts</a></li>
<li><a href="#installation--setup">Installation &amp; Setup</a></li>
<li><a href="#fundamental-operations">Fundamental Operations</a></li>
<li><a href="#data-transformation--encoding">Data Transformation &amp; Encoding</a></li>
<li><a href="#file-format-analysis">File Format Analysis</a></li>
<li><a href="#advanced-deobfuscation-techniques">Advanced Deobfuscation Techniques</a></li>
<li><a href="#malware-analysis-workflows">Malware Analysis Workflows</a></li>
<li><a href="#network-traffic-analysis">Network Traffic Analysis</a></li>
<li><a href="#advanced-pipeline-management">Advanced Pipeline Management</a></li>
<li><a href="#real-world-case-studies">Real-World Case Studies</a></li>
<li><a href="#specialized-malware-analysis">Specialized Malware Analysis</a></li>
<li><a href="#advanced-threat-detection">Advanced Threat Detection</a></li>
<li><a href="#automated-analysis--response">Automated Analysis &amp; Response</a></li>
<li><a href="#cross-platform-considerations">Cross-Platform Considerations</a></li>
<li><a href="#compliance--legal-framework">Compliance &amp; Legal Framework</a></li>
<li><a href="#training-exercises">Training Exercises</a></li>
<li><a href="#integration-with-external-tools">Integration with External Tools</a></li>
<li><a href="#best-practices--performance">Best Practices &amp; Performance</a></li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction--core-concepts">Introduction &amp; Core Concepts<a href="#introduction--core-concepts" class="hash-link" aria-label="Direct link to Introduction &amp; Core Concepts" title="Direct link to Introduction &amp; Core Concepts" translate="no">‚Äã</a></h2>
<p>Binary Refinery is a collection of Python-based tools called &quot;units&quot; that can be chained together to create powerful data processing pipelines. Inspired by CyberChef but designed for command-line efficiency, it excels at malware triage, reverse engineering, and digital forensics.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-makes-binary-refinery-special">What Makes Binary Refinery Special<a href="#what-makes-binary-refinery-special" class="hash-link" aria-label="Direct link to What Makes Binary Refinery Special" title="Direct link to What Makes Binary Refinery Special" translate="no">‚Äã</a></h3>
<ul>
<li><strong>Modular Architecture</strong>: Each unit performs a specific operation</li>
<li><strong>Pipeline Composition</strong>: Chain units together with pipes (<code>|</code>)</li>
<li><strong>Extensible Design</strong>: Custom logic with Python expressions</li>
<li><strong>Memory Efficient</strong>: Processes data streams without large memory footprints</li>
<li><strong>Format Agnostic</strong>: Works with any binary data format</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="core-units-every-analyst-should-know">Core Units Every Analyst Should Know<a href="#core-units-every-analyst-should-know" class="hash-link" aria-label="Direct link to Core Units Every Analyst Should Know" title="Direct link to Core Units Every Analyst Should Know" translate="no">‚Äã</a></h3>
<table><thead><tr><th>Unit</th><th>Purpose</th><th>Example Usage</th></tr></thead><tbody><tr><td><code>emit</code></td><td>Start pipeline with file or string</td><td><code>emit file.bin</code></td></tr><tr><td><code>peek</code></td><td>Inspect data (hexdump, entropy, file type)</td><td><code>emit file.bin | peek</code></td></tr><tr><td><code>b64</code></td><td>Base64 encode/decode</td><td><code>emit data | b64</code></td></tr><tr><td><code>xor</code></td><td>XOR encryption/decryption</td><td><code>emit data | xor 0xFF</code></td></tr><tr><td><code>zlib</code></td><td>Zlib compression/decompression</td><td><code>emit data.gz | zlib</code></td></tr><tr><td><code>strings</code></td><td>Extract printable strings</td><td><code>emit binary | strings</code></td></tr><tr><td><code>carve</code></td><td>Extract data chunks</td><td><code>emit file | carve 100</code></td></tr><tr><td><code>pack</code></td><td>Join processed chunks</td><td><code>emit data | chop &quot;,&quot; | pack</code></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation--setup">Installation &amp; Setup<a href="#installation--setup" class="hash-link" aria-label="Direct link to Installation &amp; Setup" title="Direct link to Installation &amp; Setup" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">‚Äã</a></h3>
<ul>
<li>Python 3.8 or newer</li>
<li>pip package manager</li>
<li>Virtual environment (recommended)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="installation-steps">Installation Steps<a href="#installation-steps" class="hash-link" aria-label="Direct link to Installation Steps" title="Direct link to Installation Steps" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Create and activate virtual environment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-m</span><span class="token plain"> venv refinery-env</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> refinery-env/bin/activate  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Linux/macOS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">refinery-env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">Scripts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">activate     </span><span class="token comment" style="color:rgb(98, 114, 164)"># Windows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Install Binary Refinery with all dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pip </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> binary-refinery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">extended</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pipx </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> binary-refinery</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify installation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SGVsbG8gV29ybGQ=&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Output: Hello World</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-options">Configuration Options<a href="#configuration-options" class="hash-link" aria-label="Direct link to Configuration Options" title="Direct link to Configuration Options" translate="no">‚Äã</a></h3>
<p>Binary Refinery offers flexible command invocation:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Direct command usage (recommended)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit file.bin </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># With prefix (if configured during installation)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">r.emit file.bin </span><span class="token operator">|</span><span class="token plain"> r.b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Python module invocation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-m</span><span class="token plain"> refinery.emit file.bin </span><span class="token operator">|</span><span class="token plain"> python </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-m</span><span class="token plain"> refinery.b64</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fundamental-operations">Fundamental Operations<a href="#fundamental-operations" class="hash-link" aria-label="Direct link to Fundamental Operations" title="Direct link to Fundamental Operations" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-input-and-output">Data Input and Output<a href="#data-input-and-output" class="hash-link" aria-label="Direct link to Data Input and Output" title="Direct link to Data Input and Output" translate="no">‚Äã</a></h3>
<p>The <code>emit</code> unit is your gateway to Binary Refinery:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># From string literal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Hello, World!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># From file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit /path/to/file.bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># From hex string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--hex</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;48656c6c6f&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># From Base64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--b64</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SGVsbG8=&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-inspection-with-peek">Data Inspection with peek<a href="#data-inspection-with-peek" class="hash-link" aria-label="Direct link to Data Inspection with peek" title="Direct link to Data Inspection with peek" translate="no">‚Äã</a></h3>
<p>The <code>peek</code> unit provides comprehensive data analysis:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Basic inspection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious.bin </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Custom format inspection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit data.bin </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lines</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--width</span><span class="token plain"> </span><span class="token number">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Entropy analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit encrypted.bin </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--entropy</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="string-operations">String Operations<a href="#string-operations" class="hash-link" aria-label="Direct link to String Operations" title="Direct link to String Operations" translate="no">‚Äã</a></h3>
<p>Extract and manipulate text data:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract all printable strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malware.exe </span><span class="token operator">|</span><span class="token plain"> strings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract strings of minimum length 10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit binary </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract wide (Unicode) strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit document.doc </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--wide</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract only ASCII strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit data </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--ascii</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-transformation--encoding">Data Transformation &amp; Encoding<a href="#data-transformation--encoding" class="hash-link" aria-label="Direct link to Data Transformation &amp; Encoding" title="Direct link to Data Transformation &amp; Encoding" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="encoding-and-decoding-operations">Encoding and Decoding Operations<a href="#encoding-and-decoding-operations" class="hash-link" aria-label="Direct link to Encoding and Decoding Operations" title="Direct link to Encoding and Decoding Operations" translate="no">‚Äã</a></h3>
<p>Binary Refinery supports numerous encoding schemes:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Base64 operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Hello World&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64           </span><span class="token comment" style="color:rgb(98, 114, 164)"># Encode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SGVsbG8gV29ybGQ=&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Decode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># URL encoding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello world&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> url           </span><span class="token comment" style="color:rgb(98, 114, 164)"># Encode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello%20world&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> url         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Decode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Hex operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Hello&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> hex                 </span><span class="token comment" style="color:rgb(98, 114, 164)"># Encode to hex</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;48656c6c6f&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> hex            </span><span class="token comment" style="color:rgb(98, 114, 164)"># Decode from hex</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># HTML entity encoding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;script&gt;&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> html             </span><span class="token comment" style="color:rgb(98, 114, 164)"># Encode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&amp;lt;script&amp;gt;&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> html       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Decode</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compression-and-decompression">Compression and Decompression<a href="#compression-and-decompression" class="hash-link" aria-label="Direct link to Compression and Decompression" title="Direct link to Compression and Decompression" translate="no">‚Äã</a></h3>
<p>Handle various compression formats:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Zlib compression</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit largefile.txt </span><span class="token operator">|</span><span class="token plain"> zlib </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit compressed.zlib </span><span class="token operator">|</span><span class="token plain"> zlib</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Gzip compression</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit data.txt </span><span class="token operator">|</span><span class="token plain"> gz </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit archive.gz </span><span class="token operator">|</span><span class="token plain"> gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># LZMA compression</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit document.pdf </span><span class="token operator">|</span><span class="token plain"> lzma </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit compressed.xz </span><span class="token operator">|</span><span class="token plain"> lzma</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-encoding-chains">Advanced Encoding Chains<a href="#advanced-encoding-chains" class="hash-link" aria-label="Direct link to Advanced Encoding Chains" title="Direct link to Advanced Encoding Chains" translate="no">‚Äã</a></h3>
<p>Combine multiple encoding operations:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Decode multi-layer obfuscation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated.txt </span><span class="token operator">|</span><span class="token plain"> url </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> hex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create encoding pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sensitive.txt </span><span class="token operator">|</span><span class="token plain"> xor 0xAA </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> url</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-format-analysis">File Format Analysis<a href="#file-format-analysis" class="hash-link" aria-label="Direct link to File Format Analysis" title="Direct link to File Format Analysis" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="portable-executable-pe-analysis">Portable Executable (PE) Analysis<a href="#portable-executable-pe-analysis" class="hash-link" aria-label="Direct link to Portable Executable (PE) Analysis" title="Direct link to Portable Executable (PE) Analysis" translate="no">‚Äã</a></h3>
<p>Comprehensive PE file examination:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Basic PE metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malware.exe </span><span class="token operator">|</span><span class="token plain"> pemeta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Import table analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit binary.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imports</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Export table analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit library.dll </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--exports</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Section information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit packed.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--sections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate import hash (Imphash)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract specific sections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit executable.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--section</span><span class="token plain"> .text</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Resource extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit trojan.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malware.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resource</span><span class="token plain"> </span><span class="token number">101</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract specific resource</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ole-document-analysis">OLE Document Analysis<a href="#ole-document-analysis" class="hash-link" aria-label="Direct link to OLE Document Analysis" title="Direct link to OLE Document Analysis" translate="no">‚Äã</a></h3>
<p>Analyze Microsoft Office documents:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Map OLE structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit document.doc </span><span class="token operator">|</span><span class="token plain"> olemap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract specific streams</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit spreadsheet.xls </span><span class="token operator">|</span><span class="token plain"> olet Workbook</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract VBA macros</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit macro-doc.doc </span><span class="token operator">|</span><span class="token plain"> olet Macros/VBA/Module1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Complete macro analysis pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious.doc </span><span class="token operator">|</span><span class="token plain"> olet Macros/VBA/Module1 </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pdf-analysis">PDF Analysis<a href="#pdf-analysis" class="hash-link" aria-label="Direct link to PDF Analysis" title="Direct link to PDF Analysis" translate="no">‚Äã</a></h3>
<p>Examine PDF files for malicious content:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract JavaScript from PDF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit document.pdf </span><span class="token operator">|</span><span class="token plain"> pdf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract embedded files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious.pdf </span><span class="token operator">|</span><span class="token plain"> pdf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze PDF structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit complex.pdf </span><span class="token operator">|</span><span class="token plain"> pdf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--structure</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="archive-analysis">Archive Analysis<a href="#archive-analysis" class="hash-link" aria-label="Direct link to Archive Analysis" title="Direct link to Archive Analysis" translate="no">‚Äã</a></h3>
<p>Handle various archive formats:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract ZIP contents</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit archive.zip </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Password-protected archives</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit protected.zip </span><span class="token operator">|</span><span class="token plain"> unzip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">password123</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># RAR archives</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit data.rar </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unrar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 7-Zip archives</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit compressed.7z </span><span class="token operator">|</span><span class="token plain"> un7z</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-deobfuscation-techniques">Advanced Deobfuscation Techniques<a href="#advanced-deobfuscation-techniques" class="hash-link" aria-label="Direct link to Advanced Deobfuscation Techniques" title="Direct link to Advanced Deobfuscation Techniques" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="xor-operations">XOR Operations<a href="#xor-operations" class="hash-link" aria-label="Direct link to XOR Operations" title="Direct link to XOR Operations" translate="no">‚Äã</a></h3>
<p>Master XOR-based obfuscation:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Single-byte XOR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit encrypted.bin </span><span class="token operator">|</span><span class="token plain"> xor 0x42</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-byte XOR key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit payload.enc </span><span class="token operator">|</span><span class="token plain"> xor </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SecretKey&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># XOR brute force (find unknown key)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit encoded.bin </span><span class="token operator">|</span><span class="token plain"> xbr </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;MZ&quot;</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Look for PE header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit data.enc </span><span class="token operator">|</span><span class="token plain"> xbr </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--text</span><span class="token plain">         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Look for readable text</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Rolling XOR with pattern detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit complex.enc </span><span class="token operator">|</span><span class="token plain"> xbr </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This program&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-deobfuscation">Custom Deobfuscation<a href="#custom-deobfuscation" class="hash-link" aria-label="Direct link to Custom Deobfuscation" title="Direct link to Custom Deobfuscation" translate="no">‚Äã</a></h3>
<p>Use Python expressions for complex schemes:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ROT13 text transformation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Uryyb Jbeyq&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> chop </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">put </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;chr</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">((</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">ord</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">chr</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">b[</span><span class="token string variable number" style="color:rgb(189, 147, 249);font-style:italic">0</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">]</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">))</span><span class="token string" style="color:rgb(255, 121, 198)"> - ord(&#x27;A&#x27;) + 13) % 26 + ord(&#x27;A&#x27;)) if chr(b[0]).isupper() else chr</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">((</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">ord</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">chr</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">b[</span><span class="token string variable number" style="color:rgb(189, 147, 249);font-style:italic">0</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">]</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">))</span><span class="token string" style="color:rgb(255, 121, 198)"> - ord(&#x27;a&#x27;) + 13) % 26 + ord(&#x27;a&#x27;)) if chr(b[0]).islower() else chr(b[0])&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Reverse arithmetic obfuscation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated.bin </span><span class="token operator">|</span><span class="token plain"> chop </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">put </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;bytes([((b[0] + 0x10) &amp; 0xFF) &lt;&lt; 5 | ((b[0] + 0x10) &amp; 0xFF) &gt;&gt; 3])&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Custom bit manipulation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit encoded.data </span><span class="token operator">|</span><span class="token plain"> chop </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">put </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;bytes([b[0] ^ 0xAA])&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pack</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="multi-stage-deobfuscation">Multi-Stage Deobfuscation<a href="#multi-stage-deobfuscation" class="hash-link" aria-label="Direct link to Multi-Stage Deobfuscation" title="Direct link to Multi-Stage Deobfuscation" translate="no">‚Äã</a></h3>
<p>Handle layered obfuscation:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Three-layer deobfuscation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit triple-encoded.bin </span><span class="token operator">|</span><span class="token plain"> xor 0xFF </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> url</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Conditional deobfuscation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit payload.bin </span><span class="token operator">|</span><span class="token plain"> iff peek:entropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&gt;7.5&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> -- xor 0x42</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Pattern-based deobfuscation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit mixed.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ENCRYPTED&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xor </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;KEY&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="malware-analysis-workflows">Malware Analysis Workflows<a href="#malware-analysis-workflows" class="hash-link" aria-label="Direct link to Malware Analysis Workflows" title="Direct link to Malware Analysis Workflows" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="initial-triage-pipeline">Initial Triage Pipeline<a href="#initial-triage-pipeline" class="hash-link" aria-label="Direct link to Initial Triage Pipeline" title="Direct link to Initial Triage Pipeline" translate="no">‚Äã</a></h3>
<p>Rapid malware assessment:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Quick triage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious.exe </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">|</span><span class="token plain"> pemeta </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imports</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># String-based IOC extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malware.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip,email,mutex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Entropy analysis for packed samples</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--entropy</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-extraction">Configuration Extraction<a href="#configuration-extraction" class="hash-link" aria-label="Direct link to Configuration Extraction" title="Direct link to Configuration Extraction" translate="no">‚Äã</a></h3>
<p>Extract malware configuration data:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract config between delimiters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit bot.exe </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CONFIG_START&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-e</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CONFIG_END&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xor 0xAB </span><span class="token operator">|</span><span class="token plain"> chop </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-z</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract C2 servers from network config</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit stealer.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https?://&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Decode embedded strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit crypter.exe </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token number">1024</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xbr </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--text</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="payload-extraction">Payload Extraction<a href="#payload-extraction" class="hash-link" aria-label="Direct link to Payload Extraction" title="Direct link to Payload Extraction" translate="no">‚Äã</a></h3>
<p>Extract embedded payloads:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Carve PE files from data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit dropper.bin </span><span class="token operator">|</span><span class="token plain"> carve-pe </span><span class="token operator">|</span><span class="token plain"> pemeta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract from resources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit carrier.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resource</span><span class="token plain"> </span><span class="token number">101</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> carve-pe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-stage payload extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit loader.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resource</span><span class="token plain"> PAYLOAD </span><span class="token operator">|</span><span class="token plain"> xor 0xFF </span><span class="token operator">|</span><span class="token plain"> zlib </span><span class="token operator">|</span><span class="token plain"> pemeta</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-traffic-analysis">Network Traffic Analysis<a href="#network-traffic-analysis" class="hash-link" aria-label="Direct link to Network Traffic Analysis" title="Direct link to Network Traffic Analysis" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcap-file-analysis">PCAP File Analysis<a href="#pcap-file-analysis" class="hash-link" aria-label="Direct link to PCAP File Analysis" title="Direct link to PCAP File Analysis" translate="no">‚Äã</a></h3>
<p>Analyze network captures:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># List all TCP sessions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit capture.pcap </span><span class="token operator">|</span><span class="token plain"> pcap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tcp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract specific TCP stream</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit traffic.pcap </span><span class="token operator">|</span><span class="token plain"> pcap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tcp</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract HTTP objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit network.pcap </span><span class="token operator">|</span><span class="token plain"> pcap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract files from traffic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit capture.pcap </span><span class="token operator">|</span><span class="token plain"> pcap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tcp</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> carve-pe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find URLs in traffic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit communication.pcap </span><span class="token operator">|</span><span class="token plain"> pcap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tcp</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-analysis">Protocol Analysis<a href="#protocol-analysis" class="hash-link" aria-label="Direct link to Protocol Analysis" title="Direct link to Protocol Analysis" translate="no">‚Äã</a></h3>
<p>Deep packet inspection:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># DNS query analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit dns-traffic.pcap </span><span class="token operator">|</span><span class="token plain"> pcap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--dns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># HTTP request/response analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit web-traffic.pcap </span><span class="token operator">|</span><span class="token plain"> pcap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xtp url,ip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># TLS certificate extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit encrypted.pcap </span><span class="token operator">|</span><span class="token plain"> pcap --tls-certs</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-pipeline-management">Advanced Pipeline Management<a href="#advanced-pipeline-management" class="hash-link" aria-label="Direct link to Advanced Pipeline Management" title="Direct link to Advanced Pipeline Management" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="variable-management">Variable Management<a href="#variable-management" class="hash-link" aria-label="Direct link to Variable Management" title="Direct link to Variable Management" translate="no">‚Äã</a></h3>
<p>Store and reuse data in pipelines:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract key and use for decryption</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit encrypted.bin </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    carve </span><span class="token number">16</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> var key </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    aes ecb </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-k</span><span class="token plain"> ref:key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-key operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit complex.enc </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    carve </span><span class="token number">32</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> chop </span><span class="token number">16</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">var key1, var key2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    aes cbc </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-k</span><span class="token plain"> ref:key1 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> ref:key2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="conditional-logic">Conditional Logic<a href="#conditional-logic" class="hash-link" aria-label="Direct link to Conditional Logic" title="Direct link to Conditional Logic" translate="no">‚Äã</a></h3>
<p>Implement branching logic:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Conditional processing based on file type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit unknown.bin </span><span class="token operator">|</span><span class="token plain"> iff peek:magic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;MZ&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> -- pemeta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Process only if entropy is high</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.bin </span><span class="token operator">|</span><span class="token plain"> iff peek:entropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&gt;7.0&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> -- xor 0xFF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-condition processing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit data.bin </span><span class="token operator">|</span><span class="token plain"> iff peek:size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&gt;1000&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> and peek:entropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;6.0&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> -- strings</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="frame-operations">Frame Operations<a href="#frame-operations" class="hash-link" aria-label="Direct link to Frame Operations" title="Direct link to Frame Operations" translate="no">‚Äã</a></h3>
<p>Manage complex data flows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Process each carved section independently</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit binary.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token number">1024</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">pemeta</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Parallel processing with frames</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit archive.zip </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    iff peek:magic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;MZ&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> -- pemeta </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    iff peek:magic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PDF&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> -- pdf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-world-case-studies">Real-World Case Studies<a href="#real-world-case-studies" class="hash-link" aria-label="Direct link to Real-World Case Studies" title="Direct link to Real-World Case Studies" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="case-study-1-phishing-email-analysis">Case Study 1: Phishing Email Analysis<a href="#case-study-1-phishing-email-analysis" class="hash-link" aria-label="Direct link to Case Study 1: Phishing Email Analysis" title="Direct link to Case Study 1: Phishing Email Analysis" translate="no">‚Äã</a></h3>
<p>Complete email-to-payload analysis:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract attachments from email</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit phishing.eml </span><span class="token operator">|</span><span class="token plain"> xtmail</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze ZIP attachment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit attachment.zip </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Examine LNK file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit invoice.lnk </span><span class="token operator">|</span><span class="token plain"> lnk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract and decode PowerShell payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;powershell -enc &lt;BASE64&gt;&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;([A-Za-z0-9+/]{4})*[A-Za-z0-9+/]{2,3}=?&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Final payload analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token plain"> http://c2-server.com/payload.dat </span><span class="token operator">|</span><span class="token plain"> xor 0xFF </span><span class="token operator">|</span><span class="token plain"> pemeta</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="case-study-2-document-based-attack">Case Study 2: Document-Based Attack<a href="#case-study-2-document-based-attack" class="hash-link" aria-label="Direct link to Case Study 2: Document-Based Attack" title="Direct link to Case Study 2: Document-Based Attack" translate="no">‚Äã</a></h3>
<p>Analyze malicious document:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Map document structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malicious.doc </span><span class="token operator">|</span><span class="token plain"> olemap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract macro code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit document.doc </span><span class="token operator">|</span><span class="token plain"> olet Macros/VBA/Module1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Deobfuscate macro strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit macro-code.vba </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--decode</span><span class="token plain"> b64,url,hex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract embedded objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit carrier.doc </span><span class="token operator">|</span><span class="token plain"> olet ObjectPool/_1234567890/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">x01Ole10Native </span><span class="token operator">|</span><span class="token plain"> carve-pe</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="case-study-3-memory-dump-analysis">Case Study 3: Memory Dump Analysis<a href="#case-study-3-memory-dump-analysis" class="hash-link" aria-label="Direct link to Case Study 3: Memory Dump Analysis" title="Direct link to Case Study 3: Memory Dump Analysis" translate="no">‚Äã</a></h3>
<p>Analyze process memory dumps:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract strings and URLs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory.dmp </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xtp url,ip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Carve executables from memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit process.dmp </span><span class="token operator">|</span><span class="token plain"> carve-pe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract cryptographic keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-----BEGIN.*KEY-----&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find shellcode patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit dump.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token number">512</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> sc </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--64</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="specialized-malware-analysis">Specialized Malware Analysis<a href="#specialized-malware-analysis" class="hash-link" aria-label="Direct link to Specialized Malware Analysis" title="Direct link to Specialized Malware Analysis" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cryptocurrency-malware-analysis">Cryptocurrency Malware Analysis<a href="#cryptocurrency-malware-analysis" class="hash-link" aria-label="Direct link to Cryptocurrency Malware Analysis" title="Direct link to Cryptocurrency Malware Analysis" translate="no">‚Äã</a></h3>
<p>Modern cryptocurrency malware requires specialized analysis techniques to extract wallet addresses, mining configurations, and blockchain-related IOCs.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="wallet-address-extraction">Wallet Address Extraction<a href="#wallet-address-extraction" class="hash-link" aria-label="Direct link to Wallet Address Extraction" title="Direct link to Wallet Address Extraction" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract Bitcoin addresses (Legacy, SegWit, Bech32)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit cryptominer.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$|^bc1[a-z0-9]{39,59}$&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract Ethereum addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit cryptostealer.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^0x[a-fA-F0-9]{40}$&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract Monero addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit privacy-miner.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^4[0-9AB][1-9A-HJ-NP-Za-km-z]{93}$&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-cryptocurrency extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit crypto-malware.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^(1|3|bc1)[a-zA-Z0-9]{25,87}$|^0x[a-fA-F0-9]{40}$|^4[0-9AB][1-9A-HJ-NP-Za-km-z]{93}$&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mining-configuration-analysis">Mining Configuration Analysis<a href="#mining-configuration-analysis" class="hash-link" aria-label="Direct link to Mining Configuration Analysis" title="Direct link to Mining Configuration Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract mining pool configurations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit cryptominer.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;POOL_CONFIG&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-e</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;END_CONFIG&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xor 0x7F</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find mining algorithm specifications</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit miner.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(cryptonight|ethash|kawpow|randomx)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract mining intensity settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit gpu-miner.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;intensity.*[0-9]+|threads.*[0-9]+&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Decode stratum protocol configurations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit poolminer.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;stratum\+tcp://.*:[0-9]+&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="blockchain-transaction-analysis">Blockchain Transaction Analysis<a href="#blockchain-transaction-analysis" class="hash-link" aria-label="Direct link to Blockchain Transaction Analysis" title="Direct link to Blockchain Transaction Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract transaction IDs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit blockchain-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^[a-fA-F0-9]{64}$&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find smart contract addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit defi-malware.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^0x[a-fA-F0-9]{40}$&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^0x0000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract private key patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit wallet-stealer.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^[5KL][1-9A-HJ-NP-Za-km-z]{50,51}$&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ransomware-analysis-workflows">Ransomware Analysis Workflows<a href="#ransomware-analysis-workflows" class="hash-link" aria-label="Direct link to Ransomware Analysis Workflows" title="Direct link to Ransomware Analysis Workflows" translate="no">‚Äã</a></h3>
<p>Comprehensive ransomware analysis focusing on encryption mechanisms, ransom demands, and recovery possibilities.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ransom-note-extraction">Ransom Note Extraction<a href="#ransom-note-extraction" class="hash-link" aria-label="Direct link to Ransom Note Extraction" title="Direct link to Ransom Note Extraction" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract embedded ransom notes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit ransomware.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resource</span><span class="token plain"> RANSOM_NOTE </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--unicode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find ransom note templates in data sections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit locker.bin </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--section</span><span class="token plain"> .rdata </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-A</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-B</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(bitcoin|payment|decrypt)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract HTML ransom pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit web-locker.exe </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;!DOCTYPE html&gt;&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--end</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;/html&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-language ransom note extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit international-ransomware.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--unicode</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(bitcoin|–æ–ø–ª–∞—Ç–∞|ÊîØ‰ªò|pago)&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="encryption-analysis">Encryption Analysis<a href="#encryption-analysis" class="hash-link" aria-label="Direct link to Encryption Analysis" title="Direct link to Encryption Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Find encryption key derivation functions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit crypto-ransomware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pbkdf2|scrypt|argon2|bcrypt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract encryption algorithm indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit encryption-module.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(aes|chacha|salsa|rsa)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find key generation seeds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit keygen.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[a-fA-F0-9]{32,128}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze file extension targets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit file-locker.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\.(doc|pdf|jpg|xlsx|ppt|zip|rar|7z|txt|csv)$&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="c2-communication-analysis">C2 Communication Analysis<a href="#c2-communication-analysis" class="hash-link" aria-label="Direct link to C2 Communication Analysis" title="Direct link to C2 Communication Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract payment verification endpoints</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit ransomware-c2.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(payment|verify|status|check)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find Tor onion addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit dark-ransomware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[a-z2-7]{16,56}\.onion&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract victim identification mechanisms</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit victim-id.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(victim|id|machine).*[a-fA-F0-9]{8,32}&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="information-stealer-analysis">Information Stealer Analysis<a href="#information-stealer-analysis" class="hash-link" aria-label="Direct link to Information Stealer Analysis" title="Direct link to Information Stealer Analysis" translate="no">‚Äã</a></h3>
<p>Modern information stealers target browsers, applications, and system credentials with sophisticated techniques.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="browser-data-extraction">Browser Data Extraction<a href="#browser-data-extraction" class="hash-link" aria-label="Direct link to Browser Data Extraction" title="Direct link to Browser Data Extraction" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract browser path configurations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit stealer.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">(Chrome|Firefox|Edge|Opera|Safari)</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">.*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find browser database targeting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit browser-stealer.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(Login Data|cookies|Web Data|History)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract browser extension targeting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit extension-thief.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;chrome-extension://[a-z]{32}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Cryptocurrency wallet browser extension patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit crypto-stealer.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(metamask|ledger|trezor|exodus)&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="application-credential-harvesting">Application Credential Harvesting<a href="#application-credential-harvesting" class="hash-link" aria-label="Direct link to Application Credential Harvesting" title="Direct link to Application Credential Harvesting" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Discord token extraction patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit discord-stealer.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[MN][A-Za-z\d]{23}\.[X-Za-z\d]{6}\.[A-Za-z\d]{27}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Telegram session harvesting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit telegram-thief.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;tdata</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">.*</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">key_data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Gaming platform credentials</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit game-stealer.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(steam|origin|uplay|battle\.net)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Email client targeting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit mail-stealer.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(outlook|thunderbird|mailbird).*password&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="system-information-collection">System Information Collection<a href="#system-information-collection" class="hash-link" aria-label="Direct link to System Information Collection" title="Direct link to System Information Collection" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Hardware fingerprinting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit hwid-collector.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(wmic|systeminfo|dxdiag)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Network configuration harvesting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit network-stealer.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(ipconfig|netstat|arp|route)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Installed software enumeration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit software-enum.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SOFTWARE</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">Microsoft</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">Windows</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">CurrentVersion</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">Uninstall&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mobile-malware-apk-analysis">Mobile Malware (APK Analysis)<a href="#mobile-malware-apk-analysis" class="hash-link" aria-label="Direct link to Mobile Malware (APK Analysis)" title="Direct link to Mobile Malware (APK Analysis)" translate="no">‚Äã</a></h3>
<p>Android malware analysis requires specialized techniques for APK file structures and mobile-specific attack vectors.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="apk-structure-analysis">APK Structure Analysis<a href="#apk-structure-analysis" class="hash-link" aria-label="Direct link to APK Structure Analysis" title="Direct link to APK Structure Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract DEX files from APK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malware.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;classes.*\.dex&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze Android manifest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> AndroidManifest.xml </span><span class="token operator">|</span><span class="token plain"> xml </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--decode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract native libraries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit banking-trojan.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lib/.*\.so$&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find asset files and configurations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit mobile-malware.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> assets/ </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-and-capabilities-analysis">Permissions and Capabilities Analysis<a href="#permissions-and-capabilities-analysis" class="hash-link" aria-label="Direct link to Permissions and Capabilities Analysis" title="Direct link to Permissions and Capabilities Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract dangerous permissions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit trojan.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> AndroidManifest.xml </span><span class="token operator">|</span><span class="token plain"> xml </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(SEND_SMS|CALL_PHONE|ACCESS_FINE_LOCATION|CAMERA)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find service and receiver declarations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit persistent-malware.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> AndroidManifest.xml </span><span class="token operator">|</span><span class="token plain"> xml </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(service|receiver).*android:name&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract intent filters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit intent-malware.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> AndroidManifest.xml </span><span class="token operator">|</span><span class="token plain"> xml </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-A</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;intent-filter&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-analysis">Code Analysis<a href="#code-analysis" class="hash-link" aria-label="Direct link to Code Analysis" title="Direct link to Code Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract string resources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit localized-malware.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> res/values/strings.xml </span><span class="token operator">|</span><span class="token plain"> xml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find URLs in DEX files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit network-malware.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> classes.dex </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract obfuscated strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated.apk </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> classes.dex </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--decode</span><span class="token plain"> </span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">/dev/null </span><span class="token operator">||</span><span class="token plain"> </span><span class="token boolean">true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="firmware-and-iot-malware-analysis">Firmware and IoT Malware Analysis<a href="#firmware-and-iot-malware-analysis" class="hash-link" aria-label="Direct link to Firmware and IoT Malware Analysis" title="Direct link to Firmware and IoT Malware Analysis" translate="no">‚Äã</a></h3>
<p>Embedded systems and IoT devices present unique analysis challenges requiring specialized extraction techniques.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="firmware-structure-analysis">Firmware Structure Analysis<a href="#firmware-structure-analysis" class="hash-link" aria-label="Direct link to Firmware Structure Analysis" title="Direct link to Firmware Structure Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract filesystem from firmware</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit router-firmware.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hsqs|cramfs|jffs2|ubifs&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find bootloader and kernel sections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit iot-firmware.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;U-Boot|Linux version&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract configuration partitions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit device-fw.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;config|nvram|settings&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="embedded-certificate-and-key-analysis">Embedded Certificate and Key Analysis<a href="#embedded-certificate-and-key-analysis" class="hash-link" aria-label="Direct link to Embedded Certificate and Key Analysis" title="Direct link to Embedded Certificate and Key Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Find embedded certificates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit iot-device.fw </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-----BEGIN CERTIFICATE-----&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--end</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-----END CERTIFICATE-----&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract private keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit embedded-system.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-----BEGIN.*PRIVATE KEY-----&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--end</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-----END.*PRIVATE KEY-----&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find hardcoded credentials</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit firmware.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(username|password|api_key|secret)\s*[:=]\s*\S+&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract SSH host keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit ssh-firmware.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ssh-(rsa|dss|ed25519)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="network-configuration-analysis">Network Configuration Analysis<a href="#network-configuration-analysis" class="hash-link" aria-label="Direct link to Network Configuration Analysis" title="Direct link to Network Configuration Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract Wi-Fi configurations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit wifi-firmware.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(ssid|psk|wpa|wep)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find hardcoded IP addresses and domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit network-device.fw </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp ip,domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract SNMP community strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit managed-device.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(public|private|community)&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-threat-detection">Advanced Threat Detection<a href="#advanced-threat-detection" class="hash-link" aria-label="Direct link to Advanced Threat Detection" title="Direct link to Advanced Threat Detection" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fileless-malware-detection">Fileless Malware Detection<a href="#fileless-malware-detection" class="hash-link" aria-label="Direct link to Fileless Malware Detection" title="Direct link to Fileless Malware Detection" translate="no">‚Äã</a></h3>
<p>Modern attacks increasingly use fileless techniques, requiring memory-based analysis and behavioral detection.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="powershell-payload-analysis">PowerShell Payload Analysis<a href="#powershell-payload-analysis" class="hash-link" aria-label="Direct link to PowerShell Payload Analysis" title="Direct link to PowerShell Payload Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract PowerShell commands from memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory.dmp </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;powershell.*(-enc|-e|-encodedcommand)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Decode nested PowerShell obfuscation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit ps-payload.txt </span><span class="token operator">|</span><span class="token plain"> url </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;powershell&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find PowerShell download cradles</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory-dump.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(IEX|Invoke-Expression).*(DownloadString|WebClient)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract PowerShell Empire stagers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit empire-stager.ps1 </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http.*\/[a-zA-Z0-9]{8,}&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="wmi-persistence-analysis">WMI Persistence Analysis<a href="#wmi-persistence-analysis" class="hash-link" aria-label="Direct link to WMI Persistence Analysis" title="Direct link to WMI Persistence Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract WMI event subscriptions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit registry.hive </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SELECT.*FROM.*Win32_.*Event&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find WMI command execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit wmi-persistence.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(wmic|winmgmt).*process.*call.*create&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze WMI repository artifacts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit wmi-repo.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;root</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">subscription&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="living-off-the-land-binary-abuse">Living-off-the-Land Binary Abuse<a href="#living-off-the-land-binary-abuse" class="hash-link" aria-label="Direct link to Living-off-the-Land Binary Abuse" title="Direct link to Living-off-the-Land Binary Abuse" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Detect certutil abuse</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit system-logs.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;certutil.*(-decode|-urlcache).*http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find bitsadmin download activities</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit network-logs.txt </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;bitsadmin.*\/transfer.*http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Detect regsvr32 script execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit process-monitor.log </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;regsvr32.*scrobj\.dll.*http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># PowerShell + Living-off-the-land combination</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious-activity.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;powershell.*certutil|bitsadmin.*powershell&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-evasion-techniques">Advanced Evasion Techniques<a href="#advanced-evasion-techniques" class="hash-link" aria-label="Direct link to Advanced Evasion Techniques" title="Direct link to Advanced Evasion Techniques" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="domain-generation-algorithm-dga-analysis">Domain Generation Algorithm (DGA) Analysis<a href="#domain-generation-algorithm-dga-analysis" class="hash-link" aria-label="Direct link to Domain Generation Algorithm (DGA) Analysis" title="Direct link to Domain Generation Algorithm (DGA) Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract potential DGA domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit dga-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[a-z]{8,16}\.(com|net|org|biz|info)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find DGA seed values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit domain-generator.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;seed.*[0-9]{8,10}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze date-based DGA patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit time-based-dga.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(GetSystemTime|time|date)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract hard-coded fallback domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit backup-domains.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp domain </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[a-z]{8,16}\.(com|net|org)&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="anti-analysis-detection">Anti-Analysis Detection<a href="#anti-analysis-detection" class="hash-link" aria-label="Direct link to Anti-Analysis Detection" title="Direct link to Anti-Analysis Detection" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Find VM detection strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit evasive-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(vmware|virtualbox|qemu|xen|hyperv)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Detect debugger checks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit anti-debug.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(IsDebuggerPresent|CheckRemoteDebugger|ZwQueryInformation)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find sandbox evasion techniques</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sandbox-aware.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(sleep|delay|mouse|cursor|window)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract environment checks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit env-checker.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(username|computername|domain)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(user|computer|workgroup)&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="process-injection-techniques">Process Injection Techniques<a href="#process-injection-techniques" class="hash-link" aria-label="Direct link to Process Injection Techniques" title="Direct link to Process Injection Techniques" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Detect process hollowing indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit hollowing-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(NtUnmapViewOfSection|CreateProcess.*SUSPENDED)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find DLL injection patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit dll-injector.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(LoadLibrary|GetProcAddress|WriteProcessMemory)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract reflective DLL loading</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit reflective-dll.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(VirtualAlloc|ReflectiveLoader)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze atom bombing techniques</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit atom-bomber.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(GlobalAddAtom|SetWindowLong|CallWindowProc)&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="supply-chain-attack-analysis">Supply Chain Attack Analysis<a href="#supply-chain-attack-analysis" class="hash-link" aria-label="Direct link to Supply Chain Attack Analysis" title="Direct link to Supply Chain Attack Analysis" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-signing-analysis">Code Signing Analysis<a href="#code-signing-analysis" class="hash-link" aria-label="Direct link to Code Signing Analysis" title="Direct link to Code Signing Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract and analyze certificates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit signed-malware.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--certificates</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-----BEGIN CERTIFICATE-----&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify certificate chains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious-signed.dll </span><span class="token operator">|</span><span class="token plain"> pe --verify-certificates</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find certificate metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit cert-metadata.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--certificates</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> openssl x509 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-text</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-noout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Compare signing timestamps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit timestamped.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--timestamp</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> python </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">import datetime, sys</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">for line in sys.stdin:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    ts = int(line.strip())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    dt = datetime.datetime.fromtimestamp(ts)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    print(f&#x27;{dt} UTC - {dt.strftime(</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">%A %B %d, %Y</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">)}&#x27;)&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="build-environment-analysis">Build Environment Analysis<a href="#build-environment-analysis" class="hash-link" aria-label="Direct link to Build Environment Analysis" title="Direct link to Build Environment Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract build paths and environments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit compiled-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(C:</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">.*</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">(src|build|debug|release))&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find compiler and toolchain information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit binary.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(Microsoft|GNU|Clang|Visual Studio)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze debug information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit debug-info.exe </span><span class="token operator">|</span><span class="token plain"> pe --debug-info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract version information tampering</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit version-spoofed.dll </span><span class="token operator">|</span><span class="token plain"> pe --version-info </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(FileVersion|ProductVersion)&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dependency-analysis">Dependency Analysis<a href="#dependency-analysis" class="hash-link" aria-label="Direct link to Dependency Analysis" title="Direct link to Dependency Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Find suspicious import patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit trojanized-lib.dll </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imports</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(LoadLibrary|GetProcAddress)&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-A</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-B</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze export functions for backdoors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit compromised.dll </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--exports</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^(Dll|_)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract resource manipulation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit resource-tampered.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resources</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(RT_RCDATA|RT_HTML|RT_MANIFEST)&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="automated-analysis--response">Automated Analysis &amp; Response<a href="#automated-analysis--response" class="hash-link" aria-label="Direct link to Automated Analysis &amp; Response" title="Direct link to Automated Analysis &amp; Response" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="incident-response-automation">Incident Response Automation<a href="#incident-response-automation" class="hash-link" aria-label="Direct link to Incident Response Automation" title="Direct link to Incident Response Automation" translate="no">‚Äã</a></h3>
<p>Automated triage and response systems for rapid threat assessment and containment.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="comprehensive-triage-script">Comprehensive Triage Script<a href="#comprehensive-triage-script" class="hash-link" aria-label="Direct link to Comprehensive Triage Script" title="Direct link to Comprehensive Triage Script" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Advanced Automated Malware Triage System</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Usage: ./triage.sh &lt;sample_file&gt; [output_directory]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OUTPUT_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${2</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:-</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">analysis_$(date +</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">%</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">Y</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">%</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">m</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">%</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">d_</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">%</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">H</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">%</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">M</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">%</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">S)}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE_HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">sha256sum </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create analysis directory structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">basic,network,behavior,signatures,reports</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== Binary Refinery Automated Triage ===&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Sample: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SHA256: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE_HASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Timestamp: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=========================================&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Basic file analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Basic file analysis...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/basic/file_type.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/basic/overview.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--entropy</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/basic/entropy.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract network indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Extracting network IOCs...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/network/urls.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/network/ips.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp email </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/network/emails.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp domain </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/network/domains.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Cryptocurrency indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Extracting cryptocurrency indicators...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$|^bc1[a-z0-9]{39,59}$|^0x[a-fA-F0-9]{40}$&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/network/crypto_addresses.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Hash extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Extracting hash values...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">b[A-Fa-f0-9]{32}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">b&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/signatures/md5_hashes.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">b[A-Fa-f0-9]{40}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">b&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/signatures/sha1_hashes.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">b[A-Fa-f0-9]{64}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">b&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/signatures/sha256_hashes.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># PE analysis if applicable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PE32&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] PE file detected - performing PE analysis...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pemeta </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/basic/pe_metadata.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/signatures/imphash.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imports</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/basic/imports.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--exports</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/basic/exports.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--sections</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/basic/sections.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resources</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/basic/resources.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract certificates if present</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--certificates</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/signatures/certificates.txt&quot;</span><span class="token plain"> </span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">/dev/null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Check for packed executables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ENTROPY</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> peek </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--entropy</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">grep</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;entropy&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;:&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f2</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">tr</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">((</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> $</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">echo &quot;$ENTROPY </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">&gt;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable number" style="color:rgb(189, 147, 249);font-style:italic">7.0</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">&quot; </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> bc </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">-</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">l</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">)</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">))</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[!] High entropy detected (</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ENTROPY</span><span class="token string" style="color:rgb(255, 121, 198)">) - possibly packed&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PACKED_SUSPICIOUS&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/behavior/packing_status.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># String analysis for behavioral indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Behavioral analysis...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(password|key|secret|token)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/behavior/credentials.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(mutex|event|semaphore)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/behavior/synchronization.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(registry|regedit|hkey)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/behavior/registry.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(service|scm|svchost)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/behavior/services.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(process|thread|inject)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/behavior/process_ops.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Anti-analysis detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Anti-analysis detection...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(vmware|virtualbox|sandbox|debug|olly|ida)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/behavior/anti_analysis.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate YARA-ready strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Generating signature strings...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-50</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/signatures/top_strings.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Summary report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Generating summary report...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/reports/executive_summary.txt&quot;</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">=== EXECUTIVE SUMMARY ===</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Sample: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">SHA256: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE_HASH</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Analysis Date: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">File Type: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">file</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;:&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -f2-</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Network Indicators:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- URLs Found: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network/urls.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- IP Addresses: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network/ips.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Domains: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network/domains.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Email Addresses: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network/emails.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Cryptocurrency Indicators:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Wallet Addresses: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network/crypto_addresses.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Behavioral Indicators:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Credential References: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/behavior/credentials.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Registry Operations: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/behavior/registry.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Anti-Analysis Techniques: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/behavior/anti_analysis.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Risk Assessment:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network/urls.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">||</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/behavior/anti_analysis.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">    </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;HIGH RISK - Network communication and/or evasion techniques detected&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">    </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;MEDIUM RISK - Further analysis recommended&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Analysis complete! Results saved to: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Executive summary available at: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/reports/executive_summary.txt&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="batch-processing-for-multiple-samples">Batch Processing for Multiple Samples<a href="#batch-processing-for-multiple-samples" class="hash-link" aria-label="Direct link to Batch Processing for Multiple Samples" title="Direct link to Batch Processing for Multiple Samples" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Batch malware analysis for threat hunting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Usage: ./batch_analysis.sh &lt;samples_directory&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLES_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">BATCH_OUTPUT</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;batch_analysis_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y%m%d_%H%M%S</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== BATCH ANALYSIS REPORT ===&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Analysis Date: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Samples Directory: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLES_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;==============================&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Process each sample</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">sample</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLES_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">/*.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">exe,dll,bin,dat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Processing: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE_HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">sha256sum </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Quick triage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Sample: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> | Hash: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE_HASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract key indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-5</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/urls_all.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-5</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/ips_all.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># PE analysis if applicable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PE32&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/imphashes.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> pe </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/sample_imphashes.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;---&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate correlation report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== CORRELATION ANALYSIS ===&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Common URLs:&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/urls_all.txt&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-10</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Common IP Addresses:&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/ips_all.txt&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-10</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Duplicate Imphashes:&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/imphashes.txt&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^\s*1\s&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/batch_summary.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Batch analysis complete: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$BATCH_OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="threat-hunting-workflows">Threat Hunting Workflows<a href="#threat-hunting-workflows" class="hash-link" aria-label="Direct link to Threat Hunting Workflows" title="Direct link to Threat Hunting Workflows" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pattern-correlation-across-sample-sets">Pattern Correlation Across Sample Sets<a href="#pattern-correlation-across-sample-sets" class="hash-link" aria-label="Direct link to Pattern Correlation Across Sample Sets" title="Direct link to Pattern Correlation Across Sample Sets" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Advanced threat hunting with Binary Refinery</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Correlates patterns across multiple samples</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HUNT_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OUTPUT</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;threat_hunt_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y%m%d_%H%M%S</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">patterns,correlations,intelligence</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== THREAT HUNTING ANALYSIS ===&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/hunt_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract all strings from samples</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Extracting strings from all samples...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/hunt_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">find</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$HUNT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-type</span><span class="token plain"> f </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.exe&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.dll&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.bin&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> sample</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">sha256sum </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -c1-8</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/patterns/strings_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$HASH</span><span class="token string" style="color:rgb(255, 121, 198)">.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$HASH</span><span class="token string" style="color:rgb(255, 121, 198)">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/sample_index.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find common strings across samples</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Correlating common patterns...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/hunt_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">/patterns/strings_*.txt </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/correlations/string_frequency.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract high-frequency unique strings (appear in multiple samples)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">awk</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;$1 &gt; 2 &amp;&amp; length($0) &gt; 20 {print $0}&#x27;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/correlations/string_frequency.txt&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/correlations/common_strings.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Network pattern correlation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Network pattern analysis...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/hunt_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">find</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$HUNT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-type</span><span class="token plain"> f </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.exe&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.dll&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.bin&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> sample</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">sha256sum </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -c1-8</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip,domain </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/correlations/all_network_iocs.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find IOC patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/correlations/all_network_iocs.txt&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/intelligence/network_patterns.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate hunting signatures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Generating hunting signatures...&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/hunt_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-20</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/correlations/common_strings.txt&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> line</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">STRING</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$line</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/^[[:space:]]*[0-9]*[[:space:]]*//&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;rule hunt_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$STRING</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> md5sum </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -c1-8</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> {&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/intelligence/hunt.yar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;    strings:&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/intelligence/hunt.yar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;        \</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$s1</span><span class="token string" style="color:rgb(255, 121, 198)"> = </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$STRING</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/intelligence/hunt.yar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;    condition:&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/intelligence/hunt.yar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;        \</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$s1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/intelligence/hunt.yar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;}&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/intelligence/hunt.yar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">/intelligence/hunt.yar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[+] Threat hunting analysis complete: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-malware-analysis">Cloud Malware Analysis<a href="#cloud-malware-analysis" class="hash-link" aria-label="Direct link to Cloud Malware Analysis" title="Direct link to Cloud Malware Analysis" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="container-and-kubernetes-threat-detection">Container and Kubernetes Threat Detection<a href="#container-and-kubernetes-threat-detection" class="hash-link" aria-label="Direct link to Container and Kubernetes Threat Detection" title="Direct link to Container and Kubernetes Threat Detection" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Container escape detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit container-malware.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/proc/.*/mounts|/proc/.*/cgroups|docker\.sock&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Kubernetes exploitation indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit k8s-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;kubectl|/var/run/secrets|serviceaccount&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Container runtime exploitation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit runtime-exploit.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(runc|containerd|dockerd|cri-o)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract container registry credentials</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit registry-stealer.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(docker\.io|quay\.io|gcr\.io|ecr\.aws)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-10</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="awsazure-credential-harvesting-detection">AWS/Azure Credential Harvesting Detection<a href="#awsazure-credential-harvesting-detection" class="hash-link" aria-label="Direct link to AWS/Azure Credential Harvesting Detection" title="Direct link to AWS/Azure Credential Harvesting Detection" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># AWS access key patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit cloud-stealer.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(AKIA|ASIA)[A-Z0-9]{16}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># AWS secret key patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit aws-stealer.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[A-Za-z0-9/+=]{40}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Azure service principal credentials</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit azure-malware.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Google Cloud service account keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit gcp-stealer.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">type</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">service_account</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Cloud metadata service exploitation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit metadata-exploit.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;169\.254\.169\.254|metadata\.google|instance-data\.ec2&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aiml-model-poisoning-detection">AI/ML Model Poisoning Detection<a href="#aiml-model-poisoning-detection" class="hash-link" aria-label="Direct link to AI/ML Model Poisoning Detection" title="Direct link to AI/ML Model Poisoning Detection" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Detect malicious pickle files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious-model.pkl </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(exec|eval|import|__reduce__|__setstate__)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># TensorFlow model analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit model.pb </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(tensorflow|keras|torch)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract embedded code from models</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit poisoned-model.h5 </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;import|exec|eval&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># PyTorch model security analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit pytorch-model.pth </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(torch|pickle|dill)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-10</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cross-platform-considerations">Cross-Platform Considerations<a href="#cross-platform-considerations" class="hash-link" aria-label="Direct link to Cross-Platform Considerations" title="Direct link to Cross-Platform Considerations" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="windows-specific-analysis">Windows-Specific Analysis<a href="#windows-specific-analysis" class="hash-link" aria-label="Direct link to Windows-Specific Analysis" title="Direct link to Windows-Specific Analysis" translate="no">‚Äã</a></h3>
<p>Binary Refinery&#x27;s Windows implementation offers enhanced PE analysis and Windows-specific forensics capabilities.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="windows-registry-analysis">Windows Registry Analysis<a href="#windows-registry-analysis" class="hash-link" aria-label="Direct link to Windows Registry Analysis" title="Direct link to Windows Registry Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Registry hive analysis (Windows)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit NTUSER.DAT </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;regf&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> reg-parse</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract registry persistence mechanisms</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit SOFTWARE.hive </span><span class="token operator">|</span><span class="token plain"> reg-query </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">Windows</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">CurrentVersion</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">Run&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find suspicious registry modifications</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit SYSTEM.hive </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(Image Path|ServiceDll|Parameters)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze Windows event logs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit Security.evtx </span><span class="token operator">|</span><span class="token plain"> evtx-parse </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(4624|4625|4688)&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="windows-memory-analysis-integration">Windows Memory Analysis Integration<a href="#windows-memory-analysis-integration" class="hash-link" aria-label="Direct link to Windows Memory Analysis Integration" title="Direct link to Windows Memory Analysis Integration" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Windows memory dump analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory.dmp </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;cmd\.exe|powershell\.exe|rundll32\.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract Windows service information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit process-list.txt </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;svchost|service|System&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Windows driver analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious.sys </span><span class="token operator">|</span><span class="token plain"> pe --driver-info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract Windows crash dump information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit crashdump.dmp </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PAGEDUMP|DMP&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux-specific-analysis">Linux-Specific Analysis<a href="#linux-specific-analysis" class="hash-link" aria-label="Direct link to Linux-Specific Analysis" title="Direct link to Linux-Specific Analysis" translate="no">‚Äã</a></h3>
<p>Linux malware requires different analysis approaches, focusing on ELF binaries and Unix-specific artifacts.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="elf-binary-analysis">ELF Binary Analysis<a href="#elf-binary-analysis" class="hash-link" aria-label="Direct link to ELF Binary Analysis" title="Direct link to ELF Binary Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ELF header analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit linux-malware </span><span class="token operator">|</span><span class="token plain"> elf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract dynamic symbols</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit binary.elf </span><span class="token operator">|</span><span class="token plain"> elf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--symbols</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze shared library dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit trojan.so </span><span class="token operator">|</span><span class="token plain"> elf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract section information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit rootkit.ko </span><span class="token operator">|</span><span class="token plain"> elf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--sections</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="linux-system-artifacts">Linux System Artifacts<a href="#linux-system-artifacts" class="hash-link" aria-label="Direct link to Linux System Artifacts" title="Direct link to Linux System Artifacts" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Systemd service analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malicious.service </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(ExecStart|Type|WantedBy)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Cron job extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit crontab-backup </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^\*|^[0-9]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Shell script deobfuscation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated.sh </span><span class="token operator">|</span><span class="token plain"> url </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> strings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Log file analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit auth.log </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(Failed|Invalid|Accepted)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-20</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="macos-specific-analysis">macOS-Specific Analysis<a href="#macos-specific-analysis" class="hash-link" aria-label="Direct link to macOS-Specific Analysis" title="Direct link to macOS-Specific Analysis" translate="no">‚Äã</a></h3>
<p>macOS malware analysis requires understanding of Mach-O binaries and macOS-specific persistence mechanisms.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mach-o-binary-analysis">Mach-O Binary Analysis<a href="#mach-o-binary-analysis" class="hash-link" aria-label="Direct link to Mach-O Binary Analysis" title="Direct link to Mach-O Binary Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Mach-O header analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit macos-malware </span><span class="token operator">|</span><span class="token plain"> macho </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract load commands</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious.app </span><span class="token operator">|</span><span class="token plain"> macho --load-commands</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze code signatures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit signed-binary </span><span class="token operator">|</span><span class="token plain"> macho --code-signature</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract entitlements</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit entitled-app </span><span class="token operator">|</span><span class="token plain"> macho </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--entitlements</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="macos-persistence-analysis">macOS Persistence Analysis<a href="#macos-persistence-analysis" class="hash-link" aria-label="Direct link to macOS Persistence Analysis" title="Direct link to macOS Persistence Analysis" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># LaunchAgent/LaunchDaemon analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit com.evil.plist </span><span class="token operator">|</span><span class="token plain"> plist </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--parse</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Application bundle analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit Malware.app/Contents/Info.plist </span><span class="token operator">|</span><span class="token plain"> plist </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--parse</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Keychain analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit login.keychain </span><span class="token operator">|</span><span class="token plain"> keychain </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--extract</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Safari extension analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit extension.safariextz </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cross-platform-compatibility">Cross-Platform Compatibility<a href="#cross-platform-compatibility" class="hash-link" aria-label="Direct link to Cross-Platform Compatibility" title="Direct link to Cross-Platform Compatibility" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="path-handling">Path Handling<a href="#path-handling" class="hash-link" aria-label="Direct link to Path Handling" title="Direct link to Path Handling" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Windows path normalization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit windows-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s/\\\\/\//g&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Unix path extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit unix-binary </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Universal path pattern matching</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit cross-platform.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[A-Za-z]:[</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">]|^/&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="encoding-differences">Encoding Differences<a href="#encoding-differences" class="hash-link" aria-label="Direct link to Encoding Differences" title="Direct link to Encoding Differences" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Windows Unicode (UTF-16LE) strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit windows-app.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encoding</span><span class="token operator">=</span><span class="token plain">utf-16le</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Linux UTF-8 strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit linux-binary </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encoding</span><span class="token operator">=</span><span class="token plain">utf-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># macOS CFString extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit macos-app </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encoding</span><span class="token operator">=</span><span class="token plain">utf-8 </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^CF&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="platform-specific-iocs">Platform-Specific IOCs<a href="#platform-specific-iocs" class="hash-link" aria-label="Direct link to Platform-Specific IOCs" title="Direct link to Platform-Specific IOCs" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Windows-specific indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(C:</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">Windows|%APPDATA%|HKEY_)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Linux-specific indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.elf </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(/bin|/usr|/etc|/var|/tmp)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># macOS-specific indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.macho </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(/Applications|/Library|/Users|\.app/)&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="compliance--legal-framework">Compliance &amp; Legal Framework<a href="#compliance--legal-framework" class="hash-link" aria-label="Direct link to Compliance &amp; Legal Framework" title="Direct link to Compliance &amp; Legal Framework" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="chain-of-custody">Chain of Custody<a href="#chain-of-custody" class="hash-link" aria-label="Direct link to Chain of Custody" title="Direct link to Chain of Custody" translate="no">‚Äã</a></h3>
<p>Maintaining forensic integrity throughout the analysis process is crucial for legal admissibility.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="documentation-requirements">Documentation Requirements<a href="#documentation-requirements" class="hash-link" aria-label="Direct link to Documentation Requirements" title="Direct link to Documentation Requirements" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Forensic Chain of Custody Script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Ensures legal compliance during analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">CASE_ID</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ANALYST</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$3</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">EVIDENCE_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;evidence_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${CASE_ID}</span><span class="token string" style="color:rgb(255, 121, 198)">_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y%m%d_%H%M%S</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create forensic documentation structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">original,working,reports,logs,hashes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Document initial evidence state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== CHAIN OF CUSTODY LOG ===&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Case ID: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$CASE_ID</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Analyst: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ANALYST</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Date/Time: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> UTC&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Original Evidence: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=============================&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate and document original hashes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">] Computing original evidence hashes...&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">md5sum </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/hashes/original_md5.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sha1sum </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/hashes/original_sha1.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sha256sum </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/hashes/original_sha256.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create working copy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">] Creating forensic working copy...&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/working/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify working copy integrity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">] Verifying working copy integrity...&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sha256sum </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/working/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/hashes/working_sha256.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Compare hashes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">diff</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/hashes/original_sha256.txt&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/hashes/working_sha256.txt&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> /dev/null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">] PASS: Working copy hash verified&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">] FAIL: Working copy hash mismatch!&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exit</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Begin analysis with full logging</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">] Beginning Binary Refinery analysis...&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/custody_log.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># All analysis commands with timestamps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== ANALYSIS LOG ===&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Timestamp: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> UTC&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Command: emit working/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> | peek&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/working/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;====================&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/logs/analysis_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%H%M%S</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">.log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Forensic analysis environment prepared: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Working copy ready for analysis with full chain of custody&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="audit-trail-generation">Audit Trail Generation<a href="#audit-trail-generation" class="hash-link" aria-label="Direct link to Audit Trail Generation" title="Direct link to Audit Trail Generation" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate comprehensive audit trail for legal proceedings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">EVIDENCE_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">CASE_ID</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create audit report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/reports/audit_trail.txt&quot;</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">=== FORENSIC AUDIT TRAIL ===</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Case ID: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$CASE_ID</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Generated: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> UTC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Analyst: </span><span class="token string environment constant" style="color:rgb(189, 147, 249)">$USER</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Hostname: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">hostname</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Operating System: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">uname</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EVIDENCE INTEGRITY:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Original SHA256: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cat</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/hashes/original_sha256.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Working SHA256:  </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cat</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/hashes/working_sha256.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Integrity Status: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">diff</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/hashes/original_sha256.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/hashes/working_sha256.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&gt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> /dev/null</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;VERIFIED&quot;</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;COMPROMISED&quot;</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">ANALYSIS TOOLS:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Binary Refinery Version: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">python </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;import refinery; print(refinery.__version__)&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator file-descriptor important" style="color:rgb(189, 147, 249);font-style:italic">2</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&gt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">/dev/null </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">||</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;Unknown&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Python Version: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">python </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--version</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Tool Chain Integrity: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">which</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> emit </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">xargs</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> sha256sum</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">ANALYSIS TIMELINE:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cat</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/custody_log.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">grep</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;^\[&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">MODIFICATIONS MADE:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- No modifications to original evidence</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- All analysis performed on working copy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Full command history preserved</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">LEGAL COMPLIANCE:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Chain of custody maintained</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Evidence integrity verified</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- All analysis steps documented</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Working environment isolated</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Analyst Signature: </span><span class="token string environment constant" style="color:rgb(189, 147, 249)">$USER</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Date: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> UTC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Audit trail generated: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/reports/audit_trail.txt&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-privacy-and-gdpr-compliance">Data Privacy and GDPR Compliance<a href="#data-privacy-and-gdpr-compliance" class="hash-link" aria-label="Direct link to Data Privacy and GDPR Compliance" title="Direct link to Data Privacy and GDPR Compliance" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pii-detection-and-redaction">PII Detection and Redaction<a href="#pii-detection-and-redaction" class="hash-link" aria-label="Direct link to PII Detection and Redaction" title="Direct link to PII Detection and Redaction" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Detect potential personally identifiable information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> pii_emails.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Social Security Number patterns (US)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit data.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\b</span><span class="token string" style="color:rgb(255, 121, 198)">\d{3}-\d{2}-\d{4}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\b</span><span class="token string" style="color:rgb(255, 121, 198)">|</span><span class="token string entity" style="color:rgb(255, 121, 198)">\b</span><span class="token string" style="color:rgb(255, 121, 198)">\d{9}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\b</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Credit card number patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit financial-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\b</span><span class="token string" style="color:rgb(255, 121, 198)">\d{4}[\s-]?\d{4}[\s-]?\d{4}[\s-]?\d{4}</span><span class="token string entity" style="color:rgb(255, 121, 198)">\b</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Phone number patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit contact-stealer.dll </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\+?1?[-.\s]?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># European ID patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit eu-malware.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[A-Z]{2}\d{8,12}&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-anonymization-for-reporting">Data Anonymization for Reporting<a href="#data-anonymization-for-reporting" class="hash-link" aria-label="Direct link to Data Anonymization for Reporting" title="Direct link to Data Anonymization for Reporting" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Anonymize sensitive data for public reporting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">INPUT_FILE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OUTPUT_FILE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Replace email addresses with generic placeholders</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$INPUT_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/[EMAIL_REDACTED]/g&#x27;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> temp_stage1.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Replace IP addresses with network ranges</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit temp_stage1.txt </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s/\b([0-9]{1,3}\.){3}[0-9]{1,3}\b/[IP_REDACTED]/g&#x27;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> temp_stage2.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Replace potential usernames/domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit temp_stage2.txt </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s/\\\\[A-Za-z0-9.-]+\\/\\\\[DOMAIN_REDACTED]\\/g&#x27;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Clean up temporary files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> temp_stage1.txt temp_stage2.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Anonymized output saved to: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="legal-reporting-standards">Legal Reporting Standards<a href="#legal-reporting-standards" class="hash-link" aria-label="Direct link to Legal Reporting Standards" title="Direct link to Legal Reporting Standards" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="expert-witness-report-generation">Expert Witness Report Generation<a href="#expert-witness-report-generation" class="hash-link" aria-label="Direct link to Expert Witness Report Generation" title="Direct link to Expert Witness Report Generation" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate expert witness technical report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">CASE_ID</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">EVIDENCE_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">EXPERT_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$3</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/reports/expert_witness_report.txt&quot;</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EXPERT WITNESS TECHNICAL REPORT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Case Number: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$CASE_ID</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Expert: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EXPERT_NAME</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Date: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Report Type: Digital Forensic Analysis - Malware Examination</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">1. QUALIFICATIONS AND METHODOLOGY</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   - Binary Refinery analysis framework utilized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   - Industry-standard forensic practices followed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   - Analysis performed in isolated environment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   - Chain of custody maintained throughout</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">2. EVIDENCE EXAMINED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   Original Evidence Hash: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cat</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/hashes/original_sha256.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   File Size: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">stat</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -c%s </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/working/&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">* </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">head</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-1</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   File Type: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">file</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/working/&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">* </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;:&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -f2-</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">3. ANALYSIS PERFORMED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cat</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/logs/&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">*.log </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">grep</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;Command:&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/Command: /   - /&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">4. TECHNICAL FINDINGS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network/urls.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">       </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;   Network Communications: </span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network/urls.txt&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic"> URLs identified&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">   </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/basic/pe_metadata.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">       </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;   Executable Analysis: Windows PE file confirmed&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">   </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/behavior/anti_analysis.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&amp;&amp;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/behavior/anti_analysis.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">       </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;   Evasion Techniques: Anti-analysis measures detected&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">   </span><span class="token string variable keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">5. CONCLUSIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   Based on the technical analysis performed using industry-standard tools</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   and methodologies, the examined evidence exhibits characteristics</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   consistent with malicious software.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">6. LIMITATIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   This analysis is based on static examination of the provided evidence.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   Dynamic analysis in a controlled environment may reveal additional</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">   characteristics.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Expert Signature: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EXPERT_NAME</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Date: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Report Generated: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> UTC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Expert witness report generated: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$EVIDENCE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/reports/expert_witness_report.txt&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="training-exercises">Training Exercises<a href="#training-exercises" class="hash-link" aria-label="Direct link to Training Exercises" title="Direct link to Training Exercises" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-1-basic-malware-triage">Exercise 1: Basic Malware Triage<a href="#exercise-1-basic-malware-triage" class="hash-link" aria-label="Direct link to Exercise 1: Basic Malware Triage" title="Direct link to Exercise 1: Basic Malware Triage" translate="no">‚Äã</a></h3>
<p><strong>Objective</strong>: Learn fundamental Binary Refinery operations through guided analysis of a simple malware sample.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="setup">Setup<a href="#setup" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Download training sample (use your own test file)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># For training purposes, create a test file:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This is a test file with embedded data: aHR0cDovL2V2aWwuY29tL3BheWxvYWQ=&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> training_sample.txt</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-steps">Exercise Steps<a href="#exercise-steps" class="hash-link" aria-label="Direct link to Exercise Steps" title="Direct link to Exercise Steps" translate="no">‚Äã</a></h4>
<p><strong>Step 1: Basic File Inspection</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Examine the file type and basic properties</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit training_sample.txt </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Expected output: Text file with readable content and base64 data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Question: What is the entropy of this file? Is it suspicious?</span><br></span></code></pre></div></div>
<p><strong>Step 2: String Extraction</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract all strings from the file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit training_sample.txt </span><span class="token operator">|</span><span class="token plain"> strings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find potential base64 encoded data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit training_sample.txt </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[A-Za-z0-9+/]{20,}={0,2}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Question: What base64 encoded string did you find?</span><br></span></code></pre></div></div>
<p><strong>Step 3: Decoding</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Decode the base64 string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;aHR0cDovL2V2aWwuY29tL3BheWxvYWQ=&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Expected output: http://evil.com/payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Question: What type of indicator is this?</span><br></span></code></pre></div></div>
<p><strong>Step 4: Pattern Extraction</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract URLs using pattern matching</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit training_sample.txt </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> xtp url</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Question: How could this URL be used in an attack?</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="solution-and-learning-points">Solution and Learning Points<a href="#solution-and-learning-points" class="hash-link" aria-label="Direct link to Solution and Learning Points" title="Direct link to Solution and Learning Points" translate="no">‚Äã</a></h4>
<ul>
<li><strong>File entropy</strong> indicates data randomness (encryption/compression)</li>
<li><strong>Base64 encoding</strong> is commonly used to obfuscate URLs and payloads</li>
<li><strong>Pattern extraction</strong> helps identify IOCs quickly</li>
<li><strong>Pipeline thinking</strong> enables complex analysis workflows</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-2-pe-file-analysis">Exercise 2: PE File Analysis<a href="#exercise-2-pe-file-analysis" class="hash-link" aria-label="Direct link to Exercise 2: PE File Analysis" title="Direct link to Exercise 2: PE File Analysis" translate="no">‚Äã</a></h3>
<p><strong>Objective</strong>: Master PE file analysis techniques and indicator extraction.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-steps-1">Exercise Steps<a href="#exercise-steps-1" class="hash-link" aria-label="Direct link to Exercise Steps" title="Direct link to Exercise Steps" translate="no">‚Äã</a></h4>
<p><strong>Step 1: PE Structure Analysis</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Basic PE metadata extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> pemeta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Section analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--sections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Import table analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imports</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - How many sections does the PE have?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Which DLLs does it import?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Are there any suspicious imports?</span><br></span></code></pre></div></div>
<p><strong>Step 2: Hash Calculation</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate Imphash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract unique strings for signatures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What is the Imphash value?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Which strings could be used in YARA rules?</span><br></span></code></pre></div></div>
<p><strong>Step 3: Resource Analysis</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># List all resources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract a specific resource (if available)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resource</span><span class="token plain"> </span><span class="token number">101</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Does the PE contain resources?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Are any resources unusually large or high entropy?</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-challenge">Advanced Challenge<a href="#advanced-challenge" class="hash-link" aria-label="Direct link to Advanced Challenge" title="Direct link to Advanced Challenge" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-stage analysis pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--resource</span><span class="token plain"> PAYLOAD </span><span class="token operator">|</span><span class="token plain"> xor 0xFF </span><span class="token operator">|</span><span class="token plain"> carve-pe </span><span class="token operator">|</span><span class="token plain"> pemeta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Question: What does this pipeline accomplish?</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-3-document-malware-analysis">Exercise 3: Document Malware Analysis<a href="#exercise-3-document-malware-analysis" class="hash-link" aria-label="Direct link to Exercise 3: Document Malware Analysis" title="Direct link to Exercise 3: Document Malware Analysis" translate="no">‚Äã</a></h3>
<p><strong>Objective</strong>: Analyze malicious Office documents and extract embedded threats.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-steps-2">Exercise Steps<a href="#exercise-steps-2" class="hash-link" aria-label="Direct link to Exercise Steps" title="Direct link to Exercise Steps" translate="no">‚Äã</a></h4>
<p><strong>Step 1: Document Structure Analysis</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># For OLE documents (older Office formats)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malicious.doc </span><span class="token operator">|</span><span class="token plain"> olemap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Identify interesting streams</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malicious.doc </span><span class="token operator">|</span><span class="token plain"> olet Macros/VBA/Module1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What streams are present in the document?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Which streams likely contain executable code?</span><br></span></code></pre></div></div>
<p><strong>Step 2: Macro Extraction and Analysis</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract VBA macro code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit training_doc/vba_module.txt </span><span class="token operator">|</span><span class="token plain"> strings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Decode any encoded PowerShell</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;aGVsbG8=&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What does the VBA code do?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What PowerShell command is hidden?</span><br></span></code></pre></div></div>
<p><strong>Step 3: IOC Extraction</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract URLs and IPs from document</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malicious.doc </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find suspicious function calls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malicious.doc </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(CreateObject|WScript|Shell|Run)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What network indicators were found?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Which Windows API functions are being called?</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-4-memory-dump-analysis">Exercise 4: Memory Dump Analysis<a href="#exercise-4-memory-dump-analysis" class="hash-link" aria-label="Direct link to Exercise 4: Memory Dump Analysis" title="Direct link to Exercise 4: Memory Dump Analysis" translate="no">‚Äã</a></h3>
<p><strong>Objective</strong>: Analyze process memory dumps for hidden threats and artifacts.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="setup-1">Setup<a href="#setup-1" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Simulate memory dump content</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Normal process data mixed with: http://malicious-c2.com/beacon and some suspicious strings&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> memory_dump.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Additional data: powershell -enc c3VzcGljaW91cyBjb21tYW5k&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> memory_dump.txt</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-steps-3">Exercise Steps<a href="#exercise-steps-3" class="hash-link" aria-label="Direct link to Exercise Steps" title="Direct link to Exercise Steps" translate="no">‚Äã</a></h4>
<p><strong>Step 1: String Analysis</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract all readable strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory_dump.txt </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find network indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory_dump.txt </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What URLs are present in memory?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Could these indicate active network connections?</span><br></span></code></pre></div></div>
<p><strong>Step 2: Encoded Content Detection</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Find base64 encoded PowerShell</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory_dump.txt </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;powershell.*-enc&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cut</span><span class="token plain"> -d</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27; &#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f3</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Search for additional encoding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory_dump.txt </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> url </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--decode</span><span class="token plain"> </span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">/dev/null </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What PowerShell command was decoded?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Are there other encoding schemes present?</span><br></span></code></pre></div></div>
<p><strong>Step 3: Pattern Recognition</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Look for PE headers in memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory_dump.txt </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;MZ&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Search for common malware artifacts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory_dump.txt </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(mutex|pipe|registry|service)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Are there embedded executables in memory?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What persistence mechanisms might be in use?</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-5-advanced-deobfuscation-challenge">Exercise 5: Advanced Deobfuscation Challenge<a href="#exercise-5-advanced-deobfuscation-challenge" class="hash-link" aria-label="Direct link to Exercise 5: Advanced Deobfuscation Challenge" title="Direct link to Exercise 5: Advanced Deobfuscation Challenge" translate="no">‚Äã</a></h3>
<p><strong>Objective</strong>: Master complex deobfuscation techniques using custom logic.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="setup-2">Setup<a href="#setup-2" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Create a multi-layer obfuscated sample</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This is a secret message&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xor 0xAA </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> url </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encode</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> obfuscated_challenge.txt</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-steps-4">Exercise Steps<a href="#exercise-steps-4" class="hash-link" aria-label="Direct link to Exercise Steps" title="Direct link to Exercise Steps" translate="no">‚Äã</a></h4>
<p><strong>Step 1: Identify Encoding Layers</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Examine the obfuscated data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated_challenge.txt </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Try common decodings individually</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated_challenge.txt </span><span class="token operator">|</span><span class="token plain"> url</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated_challenge.txt </span><span class="token operator">|</span><span class="token plain"> b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated_challenge.txt </span><span class="token operator">|</span><span class="token plain"> xor 0xAA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What encoding schemes can you identify?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - In what order should they be applied?</span><br></span></code></pre></div></div>
<p><strong>Step 2: Build Deobfuscation Pipeline</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Attempt different ordering</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated_challenge.txt </span><span class="token operator">|</span><span class="token plain"> url </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> xor 0xAA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify the result makes sense</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit obfuscated_challenge.txt </span><span class="token operator">|</span><span class="token plain"> url </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> xor 0xAA </span><span class="token operator">|</span><span class="token plain"> strings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - Did you recover the original message?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - What was the correct order of operations?</span><br></span></code></pre></div></div>
<p><strong>Step 3: Custom Deobfuscation Logic</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># For more complex schemes, use custom Python expressions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit complex_data.bin </span><span class="token operator">|</span><span class="token plain"> chop </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">put </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;bytes([b[0] ^ 0x42])&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Questions:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - When would you need custom deobfuscation logic?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># - How can you identify the correct transformation?</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-6-comprehensive-analysis-challenge">Exercise 6: Comprehensive Analysis Challenge<a href="#exercise-6-comprehensive-analysis-challenge" class="hash-link" aria-label="Direct link to Exercise 6: Comprehensive Analysis Challenge" title="Direct link to Exercise 6: Comprehensive Analysis Challenge" translate="no">‚Äã</a></h3>
<p><strong>Objective</strong>: Combine all learned techniques in a realistic analysis scenario.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="scenario">Scenario<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario" translate="no">‚Äã</a></h4>
<p>You&#x27;ve received a suspicious email attachment that has been flagged by security tools. Your task is to perform a complete analysis and generate a threat assessment report.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="challenge-setup">Challenge Setup<a href="#challenge-setup" class="hash-link" aria-label="Direct link to Challenge Setup" title="Direct link to Challenge Setup" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Create a simulated complex sample</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> challenge_sample</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;UEsDBBQAAAAIAM7NX1JQ&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> challenge_sample/suspicious_attachment.zip.b64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Additional indicators: http://evil-domain.net/payload.exe and some registry keys&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> challenge_sample/extracted_strings.txt</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="analysis-workflow">Analysis Workflow<a href="#analysis-workflow" class="hash-link" aria-label="Direct link to Analysis Workflow" title="Direct link to Analysis Workflow" translate="no">‚Äã</a></h4>
<p><strong>Phase 1: Initial Triage</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Step 1: Decode the base64 ZIP file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit challenge_sample/suspicious_attachment.zip.b64 </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">&gt;</span><span class="token plain"> challenge_sample/attachment.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 2: Extract ZIP contents</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit challenge_sample/attachment.zip </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">unzip</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 3: Identify file types and extract basic IOCs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit challenge_sample/extracted_strings.txt </span><span class="token operator">|</span><span class="token plain"> xtp url,ip,domain</span><br></span></code></pre></div></div>
<p><strong>Phase 2: Deep Analysis</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Step 4: If PE file found, perform PE analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># emit extracted_file.exe | pemeta</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># emit extracted_file.exe | pe --imports | head -20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 5: Extract and analyze any scripts or documents</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># emit document.doc | olemap</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># emit script.ps1 | strings | xtp url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 6: Search for persistence mechanisms</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># emit sample | strings | grep -E &quot;(registry|service|startup|run)&quot;</span><br></span></code></pre></div></div>
<p><strong>Phase 3: Reporting</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Step 7: Generate findings summary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== ANALYSIS FINDINGS ===&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> challenge_sample/analysis_report.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Timestamp: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> challenge_sample/analysis_report.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Network IOCs:&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> challenge_sample/analysis_report.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit challenge_sample/extracted_strings.txt </span><span class="token operator">|</span><span class="token plain"> xtp url </span><span class="token operator">&gt;&gt;</span><span class="token plain"> challenge_sample/analysis_report.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Threat Level: HIGH/MEDIUM/LOW&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> challenge_sample/analysis_report.txt</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="success-criteria">Success Criteria<a href="#success-criteria" class="hash-link" aria-label="Direct link to Success Criteria" title="Direct link to Success Criteria" translate="no">‚Äã</a></h4>
<ul>
<li>Successfully decoded all encoding layers</li>
<li>Identified all network IOCs</li>
<li>Extracted persistence mechanisms</li>
<li>Generated actionable intelligence</li>
<li>Documented analysis methodology</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="training-exercise-solutions">Training Exercise Solutions<a href="#training-exercise-solutions" class="hash-link" aria-label="Direct link to Training Exercise Solutions" title="Direct link to Training Exercise Solutions" translate="no">‚Äã</a></h3>
<p>Each exercise builds upon previous knowledge and introduces new concepts:</p>
<ol>
<li><strong>Exercise 1</strong> teaches basic pipeline construction and encoding recognition</li>
<li><strong>Exercise 2</strong> focuses on Windows PE analysis and signature generation</li>
<li><strong>Exercise 3</strong> covers document malware and macro analysis</li>
<li><strong>Exercise 4</strong> introduces memory forensics techniques</li>
<li><strong>Exercise 5</strong> masters complex deobfuscation workflows</li>
<li><strong>Exercise 6</strong> integrates all techniques in a realistic scenario</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="additional-training-resources">Additional Training Resources<a href="#additional-training-resources" class="hash-link" aria-label="Direct link to Additional Training Resources" title="Direct link to Additional Training Resources" translate="no">‚Äã</a></h4>
<p><strong>Practice Datasets</strong></p>
<ul>
<li>Use your own test files for safe practice</li>
<li>Create encoding challenges for skill development</li>
<li>Build sample malware configurations for analysis practice</li>
</ul>
<p><strong>Skill Progression Path</strong></p>
<ol>
<li>Master basic units (emit, peek, b64, xor, strings)</li>
<li>Learn file format analysis (pe, elf, pdf, ole)</li>
<li>Develop pattern recognition skills (xtp, grep integration)</li>
<li>Advanced deobfuscation and custom logic</li>
<li>Complete workflow automation and reporting</li>
</ol>
<p><strong>Common Mistakes to Avoid</strong></p>
<ul>
<li>Not verifying file integrity before analysis</li>
<li>Forgetting to document analysis steps</li>
<li>Rushing through encoding identification</li>
<li>Not considering multi-layer obfuscation</li>
<li>Insufficient IOC extraction and correlation</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integration-with-external-tools">Integration with External Tools<a href="#integration-with-external-tools" class="hash-link" aria-label="Direct link to Integration with External Tools" title="Direct link to Integration with External Tools" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="virustotal-integration">VirusTotal Integration<a href="#virustotal-integration" class="hash-link" aria-label="Direct link to VirusTotal Integration" title="Direct link to VirusTotal Integration" translate="no">‚Äã</a></h3>
<p>Combine Binary Refinery analysis with threat intelligence platforms for enhanced context.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="hash-based-intelligence-gathering">Hash-Based Intelligence Gathering<a href="#hash-based-intelligence-gathering" class="hash-link" aria-label="Direct link to Hash-Based Intelligence Gathering" title="Direct link to Hash-Based Intelligence Gathering" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># VirusTotal integration workflow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">VT_API_KEY</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;your_api_key_here&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Set your VirusTotal API key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract hashes using Binary Refinery</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Extracting hashes for VirusTotal lookup...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SHA256</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> sha256sum </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">MD5</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> md5sum </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract Imphash if PE file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PE32&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">IMPHASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> pe </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Imphash: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$IMPHASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Query VirusTotal for Imphash matches (requires API implementation)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Search VirusTotal for samples with Imphash: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$IMPHASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract network IOCs for VT domain/IP checks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip,domain </span><span class="token operator">&gt;</span><span class="token plain"> iocs_for_vt.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Network IOCs extracted for VirusTotal correlation&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate VT search queries</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== VirusTotal Search Queries ===&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;File Hash: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SHA256</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Imphash: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$IMPHASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Network IOCs:&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> iocs_for_vt.txt</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ioc-correlation-and-attribution">IOC Correlation and Attribution<a href="#ioc-correlation-and-attribution" class="hash-link" aria-label="Direct link to IOC Correlation and Attribution" title="Direct link to IOC Correlation and Attribution" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract and correlate indicators across multiple samples</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== IOC Correlation Analysis ===&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">sample</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">/*.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">exe,dll,bin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Processing: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract Imphash for family clustering</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PE32&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">IMPHASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> pe </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$IMPHASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> imphash_correlation.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract network IOCs for C2 infrastructure mapping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip,domain </span><span class="token operator">&gt;&gt;</span><span class="token plain"> all_network_iocs.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find common Imphashes (same malware family)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== Potential Malware Families ===&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> imphash_correlation.txt </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cut</span><span class="token plain"> -d</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;:&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f2</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">awk</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;$1 &gt; 1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find common network infrastructure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== Shared C2 Infrastructure ===&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> all_network_iocs.txt </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-20</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="yara-rule-development">YARA Rule Development<a href="#yara-rule-development" class="hash-link" aria-label="Direct link to YARA Rule Development" title="Direct link to YARA Rule Development" translate="no">‚Äã</a></h3>
<p>Transform Binary Refinery analysis results into actionable detection rules.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="automated-yara-rule-generation">Automated YARA Rule Generation<a href="#automated-yara-rule-generation" class="hash-link" aria-label="Direct link to Automated YARA Rule Generation" title="Direct link to Automated YARA Rule Generation" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate YARA rules from Binary Refinery analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">RULE_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OUTPUT_FILE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${RULE_NAME}</span><span class="token string" style="color:rgb(255, 121, 198)">.yar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Generating YARA rule: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$RULE_NAME</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract unique strings for rule creation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-10</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> unique_strings.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract hex patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token number">32</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> hex </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-5</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> hex_patterns.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate YARA rule</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">rule </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$RULE_NAME</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    meta:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        description = &quot;Auto-generated rule from Binary Refinery analysis&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        author = &quot;Binary Refinery Automation&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        date = &quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y-%m-%d</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        sample_sha256 = &quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> sha256sum </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    strings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Add string patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">COUNTER</span><span class="token operator">=</span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token operator">!</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-z</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$string</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">string}</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-gt</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;        \</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$s</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$COUNTER</span><span class="token string" style="color:rgb(255, 121, 198)"> = </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$string</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)"> ascii&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">COUNTER</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$((</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">COUNTER </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">+</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable number" style="color:rgb(189, 147, 249);font-style:italic">1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> unique_strings.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Add hex patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> hex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token operator">!</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-z</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$hex</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">hex}</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-gt</span><span class="token plain"> </span><span class="token number">16</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;        \</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$h</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$COUNTER</span><span class="token string" style="color:rgb(255, 121, 198)"> = { </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$hex</span><span class="token string" style="color:rgb(255, 121, 198)"> }&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">COUNTER</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$((</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">COUNTER </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">+</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable number" style="color:rgb(189, 147, 249);font-style:italic">1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> hex_patterns.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Add condition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    condition:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        3 of (\</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$s</span><span class="token string" style="color:rgb(255, 121, 198)">*) or any of (\</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$h</span><span class="token string" style="color:rgb(255, 121, 198)">*)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;YARA rule generated: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> unique_strings.txt hex_patterns.txt</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-pattern-extraction-for-rules">Advanced Pattern Extraction for Rules<a href="#advanced-pattern-extraction-for-rules" class="hash-link" aria-label="Direct link to Advanced Pattern Extraction for Rules" title="Direct link to Advanced Pattern Extraction for Rules" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Extract cryptographic constants for YARA rules</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit crypto-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pattern</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[a-fA-F0-9]{32,64}&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> crypto_constants.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract specific API call patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malware.dll </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imports</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(CreateFile|WriteFile|CreateProcess)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> api_patterns.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract mutex names and synchronization objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(mutex|event|semaphore)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> sync_objects.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract registry persistence patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit persistent-malware.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(hkey_|software</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">|currentversion</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">run)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> registry_patterns.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate comprehensive YARA rule with multiple pattern types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> comprehensive_rule.yar </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">rule Comprehensive_Malware_Detection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    meta:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        description = &quot;Comprehensive detection based on Binary Refinery analysis&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        author = &quot;Advanced Threat Analysis Team&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        date = &quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y-%m-%d</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    strings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        // Cryptographic constants</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">head</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-3</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> crypto_constants.txt </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/^/        $crypto = &quot;/&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/$/&quot; ascii/&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        // API patterns</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">head</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-3</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> api_patterns.txt </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/^/        $api = &quot;/&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/$/&quot; ascii/&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        // Synchronization objects</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">head</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-3</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> sync_objects.txt </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/^/        $sync = &quot;/&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/$/&quot; ascii nocase/&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        // Registry persistence</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">head</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-3</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> registry_patterns.txt </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/^/        $reg = &quot;/&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/$/&quot; ascii nocase/&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    condition:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        2 of (</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$crypto</span><span class="token string" style="color:rgb(255, 121, 198)">*) or 3 of (</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$api</span><span class="token string" style="color:rgb(255, 121, 198)">*) or any of (</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sync</span><span class="token string" style="color:rgb(255, 121, 198)">*) or any of (</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$reg</span><span class="token string" style="color:rgb(255, 121, 198)">*)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-integration">Volatility Integration<a href="#volatility-integration" class="hash-link" aria-label="Direct link to Volatility Integration" title="Direct link to Volatility Integration" translate="no">‚Äã</a></h3>
<p>Combine memory forensics with Binary Refinery for comprehensive incident analysis.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="memory-dump-preparation">Memory Dump Preparation<a href="#memory-dump-preparation" class="hash-link" aria-label="Direct link to Memory Dump Preparation" title="Direct link to Memory Dump Preparation" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Prepare memory artifacts for Volatility analysis using Binary Refinery</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">MEMORY_DUMP</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OUTPUT_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;volatility_prep&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Preparing memory dump for Volatility analysis...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract potential PE files from memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> carve-pe </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/carved_executables.bin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract strings for correlation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--min</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/memory_strings.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract network artifacts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/network_artifacts.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract potential registry keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hkey_&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/registry_keys.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract command line artifacts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(cmd\.exe|powershell\.exe|wscript\.exe)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/command_lines.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Prepare summary for Volatility correlation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/analysis_summary.txt&quot;</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">=== Memory Analysis Preparation ===</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Timestamp: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Source: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Artifacts Extracted:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- PE Files: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/carved_executables.bin&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator file-descriptor important" style="color:rgb(189, 147, 249);font-style:italic">2</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&gt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">/dev/null </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">||</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;0&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> potential executables</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Network IOCs: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/network_artifacts.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> indicators</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Registry Keys: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/registry_keys.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> keys</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- Command Lines: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">wc</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">/command_lines.txt&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)"> commands</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Use these artifacts to correlate with Volatility findings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- volatility -f </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)"> pslist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- volatility -f </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)"> netscan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">- volatility -f </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MEMORY_DUMP</span><span class="token string" style="color:rgb(255, 121, 198)"> malfind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Memory preparation complete: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="process-injection-detection">Process Injection Detection<a href="#process-injection-detection" class="hash-link" aria-label="Direct link to Process Injection Detection" title="Direct link to Process Injection Detection" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Detect process injection artifacts in memory dumps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit memory.dmp </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(CreateRemoteThread|WriteProcessMemory|VirtualAllocEx)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> injection_apis.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find DLL injection patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit process-dump.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(LoadLibrary|GetProcAddress)&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract reflective DLL loading indicators</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious-process.dmp </span><span class="token operator">|</span><span class="token plain"> carve-pe </span><span class="token operator">|</span><span class="token plain"> pe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--exports</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reflective&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Correlation script for Volatility output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> correlate_injection.sh </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">#!/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"># Correlate Binary Refinery findings with Volatility malfind output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">VOLATILITY_MALFIND=&quot;$1&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">REFINERY_FINDINGS=&quot;$2&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">echo &quot;=== Process Injection Correlation ===&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">echo &quot;Volatility Malfind Results:&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">cat &quot;$VOLATILITY_MALFIND&quot; | grep -E &quot;(0x[0-9a-fA-F]+.*EXECUTE)&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">echo &quot;Binary Refinery API Findings:&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">cat &quot;$REFINERY_FINDINGS&quot; | head -10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">echo &quot;Correlation complete&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> +x correlate_injection.sh</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="siem-integration">SIEM Integration<a href="#siem-integration" class="hash-link" aria-label="Direct link to SIEM Integration" title="Direct link to SIEM Integration" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="log-format-conversion">Log Format Conversion<a href="#log-format-conversion" class="hash-link" aria-label="Direct link to Log Format Conversion" title="Direct link to Log Format Conversion" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Convert Binary Refinery analysis to SIEM-compatible formats</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OUTPUT_FORMAT</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># json, csv, syslog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FORMAT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;json&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;  </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">timestamp</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y-%m-%dT%H:%M:%SZ</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">,&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;  </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">file_hash</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> sha256sum </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">,&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;  </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">file_type</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">file</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;:&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -f2- </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/^ *//&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">,&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;  </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">network_iocs</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: [&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s/^/    &quot;/&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s/$/&quot;,/&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sed</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;$ s/,$//&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;  ],&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;  </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">entropy</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> peek </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--entropy</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">grep</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> entropy </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;:&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f2</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">tr</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">,&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;  </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">analysis_tool</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">: </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">Binary Refinery</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${SAMPLE}</span><span class="token string" style="color:rgb(255, 121, 198)">.json&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;csv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;timestamp,file_hash,file_type,network_ioc,entropy&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> ioc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y-%m-%dT%H:%M:%SZ</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">,</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> sha256sum </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">,malware,</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ioc</span><span class="token string" style="color:rgb(255, 121, 198)">,</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> peek </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--entropy</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">grep</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> entropy </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;:&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f2</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">tr</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${SAMPLE}</span><span class="token string" style="color:rgb(255, 121, 198)">.csv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;syslog&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> sha256sum </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> ioc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            logger </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> local0.info </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Binary Refinery Analysis: file_hash=</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$HASH</span><span class="token string" style="color:rgb(255, 121, 198)"> network_ioc=</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ioc</span><span class="token string" style="color:rgb(255, 121, 198)"> analysis_timestamp=</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y-%m-%dT%H:%M:%SZ</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">esac</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SIEM format conversion complete: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FORMAT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="threat-intelligence-feed-generation">Threat Intelligence Feed Generation<a href="#threat-intelligence-feed-generation" class="hash-link" aria-label="Direct link to Threat Intelligence Feed Generation" title="Direct link to Threat Intelligence Feed Generation" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate threat intelligence feeds from Binary Refinery analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLES_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OUTPUT_FEED</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;threat_intelligence_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y%m%d</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">.json&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;[&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FEED</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">FIRST</span><span class="token operator">=</span><span class="token plain">true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">sample</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLES_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">/*.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">exe,dll,bin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$FIRST</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;,&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FEED</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> sha256sum </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">IMPHASH</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PE32&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">IMPHASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> pe </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FEED</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token plain"> EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;indicator&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$HASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;type&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file_hash&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;malware_family&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;unknown&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;first_seen&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">date</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> +%Y-%m-%dT%H:%M:%SZ</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;imphash&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$IMPHASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;network_indicators&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> strings </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> xtp url,ip </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/^/      &quot;/&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;s/$/&quot;,/&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">sed</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;$ s/,$//&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;confidence&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token number">85</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;source&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Binary Refinery Analysis&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;tags&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;malware&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;analysis&quot;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;binary_refinery&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">FIRST</span><span class="token operator">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;]&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FEED</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Threat intelligence feed generated: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$OUTPUT_FEED</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices--performance">Best Practices &amp; Performance<a href="#best-practices--performance" class="hash-link" aria-label="Direct link to Best Practices &amp; Performance" title="Direct link to Best Practices &amp; Performance" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-optimization">Performance Optimization<a href="#performance-optimization" class="hash-link" aria-label="Direct link to Performance Optimization" title="Direct link to Performance Optimization" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="memory-management">Memory Management<a href="#memory-management" class="hash-link" aria-label="Direct link to Memory Management" title="Direct link to Memory Management" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Process large files in chunks to avoid memory issues</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit large_file.bin </span><span class="token operator">|</span><span class="token plain"> carve </span><span class="token number">1048576</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">analysis_pipeline</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Use streaming operations for better performance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit huge_dataset.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pattern&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> results.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Optimize pipeline order for efficiency</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># BAD: emit file.bin | strings | carve 1024 | xor 0xFF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># GOOD: emit file.bin | carve 1024 | xor 0xFF | strings</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="parallel-processing">Parallel Processing<a href="#parallel-processing" class="hash-link" aria-label="Direct link to Parallel Processing" title="Direct link to Parallel Processing" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Parallel analysis of multiple samples</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLES_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">MAX_JOBS</span><span class="token operator">=</span><span class="token number">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Function to analyze single sample</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-name function" style="color:rgb(80, 250, 123)">analyze_sample</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">sample</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">output_dir</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;results/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$output_dir</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$output_dir</span><span class="token string" style="color:rgb(255, 121, 198)">/overview.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url,ip </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$output_dir</span><span class="token string" style="color:rgb(255, 121, 198)">/iocs.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PE32&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pemeta </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$output_dir</span><span class="token string" style="color:rgb(255, 121, 198)">/pe_analysis.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">export</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> analyze_sample</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Process samples in parallel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">find</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLES_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.exe&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;*.dll&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">xargs</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-P</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MAX_JOBS</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-I</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">bash</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;analyze_sample &quot;{}&quot;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Parallel analysis complete&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="caching-strategies">Caching Strategies<a href="#caching-strategies" class="hash-link" aria-label="Direct link to Caching Strategies" title="Direct link to Caching Strategies" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Cache expensive operations for repeated analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">CACHE_DIR</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;cache&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$CACHE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SAMPLE_HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">sha256sum </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">CACHE_FILE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$CACHE_DIR</span><span class="token string" style="color:rgb(255, 121, 198)">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${SAMPLE_HASH}</span><span class="token string" style="color:rgb(255, 121, 198)">.strings&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Check if strings are already cached</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token operator">!</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$CACHE_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Extracting strings (not cached)...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$SAMPLE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$CACHE_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Using cached strings...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Use cached results</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$CACHE_FILE</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> xtp url,ip</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-considerations">Security Considerations<a href="#security-considerations" class="hash-link" aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sandbox-environment-setup">Sandbox Environment Setup<a href="#sandbox-environment-setup" class="hash-link" aria-label="Direct link to Sandbox Environment Setup" title="Direct link to Sandbox Environment Setup" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set up isolated analysis environment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create isolated directory structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ANALYSIS_ENV</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/tmp/binary_refinery_analysis_$&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ANALYSIS_ENV</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">samples,results,tools</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Copy sample to isolated environment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ANALYSIS_ENV</span><span class="token string" style="color:rgb(255, 121, 198)">/samples/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Change to analysis environment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ANALYSIS_ENV</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set restrictive permissions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> </span><span class="token number">700</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ANALYSIS_ENV</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Run analysis in isolated environment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;samples/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">basename</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;results/analysis.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Cleanup function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-name function" style="color:rgb(80, 250, 123)">cleanup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cleaning up analysis environment...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-rf</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ANALYSIS_ENV</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">trap</span><span class="token plain"> cleanup EXIT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Analysis environment: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ANALYSIS_ENV</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="safe-handling-procedures">Safe Handling Procedures<a href="#safe-handling-procedures" class="hash-link" aria-label="Direct link to Safe Handling Procedures" title="Direct link to Safe Handling Procedures" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Never execute extracted content directly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># BAD: emit malware.exe | carve-pe &gt; extracted.exe &amp;&amp; ./extracted.exe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># GOOD: emit malware.exe | carve-pe | pemeta</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Always verify file hashes before and after processing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ORIGINAL_HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">sha256sum sample.exe </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> some_processing </span><span class="token operator">&gt;</span><span class="token plain"> processed_output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify original file unchanged</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">NEW_HASH</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">sha256sum sample.exe </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -d</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ORIGINAL_HASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$NEW_HASH</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ERROR: Original file modified!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exit</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Use read-only file permissions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> </span><span class="token number">444</span><span class="token plain"> malware_sample.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malware_sample.exe </span><span class="token operator">|</span><span class="token plain"> analysis_pipeline</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="network-isolation">Network Isolation<a href="#network-isolation" class="hash-link" aria-label="Direct link to Network Isolation" title="Direct link to Network Isolation" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Ensure network isolation during analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Check for active network connections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">netstat</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-an</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> ESTABLISHED</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;WARNING: Active network connections detected&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Consider running in isolated environment&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Disable network interfaces (requires privileges)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># sudo ip link set eth0 down</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Use analysis results without network access</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit isolated_sample.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> xtp url </span><span class="token operator">&gt;</span><span class="token plain"> network_iocs.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Network IOCs extracted safely without network access&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="error-handling-and-debugging">Error Handling and Debugging<a href="#error-handling-and-debugging" class="hash-link" aria-label="Direct link to Error Handling and Debugging" title="Direct link to Error Handling and Debugging" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="robust-pipeline-construction">Robust Pipeline Construction<a href="#robust-pipeline-construction" class="hash-link" aria-label="Direct link to Robust Pipeline Construction" title="Direct link to Robust Pipeline Construction" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Error-resistant analysis pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-name function" style="color:rgb(80, 250, 123)">analyze_with_fallback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">sample</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Try primary analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> pemeta </span><span class="token operator">&gt;</span><span class="token plain"> pe_analysis.txt </span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">/dev/null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PE analysis successful&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;PE analysis failed, trying generic analysis&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> peek </span><span class="token operator">&gt;</span><span class="token plain"> generic_analysis.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Always extract strings as fallback</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">&gt;</span><span class="token plain"> strings_fallback.txt </span><span class="token operator">||</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ERROR: Could not extract strings from </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$sample</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Usage with error checking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token operator">!</span><span class="token plain"> analyze_with_fallback </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample.exe&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Analysis failed completely&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exit</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="debug-mode-implementation">Debug Mode Implementation<a href="#debug-mode-implementation" class="hash-link" aria-label="Direct link to Debug Mode Implementation" title="Direct link to Debug Mode Implementation" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Debug mode for pipeline development</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">DEBUG</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${DEBUG</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:-</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">0}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-name function" style="color:rgb(80, 250, 123)">debug_emit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$DEBUG</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-eq</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;DEBUG: Processing </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token file-descriptor important">&amp;2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> debug_output.bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-name function" style="color:rgb(80, 250, 123)">debug_pipe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$DEBUG</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-eq</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;DEBUG: Pipeline stage: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token file-descriptor important">&amp;2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">tee</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;debug_stage_</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">tr</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27; &#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;_&#x27;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">.bin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Usage:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># DEBUG=1 ./analysis_script.sh sample.exe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">debug_emit </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample.exe&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> debug_pipe </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;after emit&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> b64 </span><span class="token operator">|</span><span class="token plain"> debug_pipe </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;after b64&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> strings</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="common-error-patterns-and-solutions">Common Error Patterns and Solutions<a href="#common-error-patterns-and-solutions" class="hash-link" aria-label="Direct link to Common Error Patterns and Solutions" title="Direct link to Common Error Patterns and Solutions" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Handle binary data in text operations gracefully</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit binary_file.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">/dev/null </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Deal with encoding issues</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit international_text.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encoding</span><span class="token operator">=</span><span class="token plain">utf-8 </span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">/dev/null </span><span class="token operator">||</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit international_text.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--encoding</span><span class="token operator">=</span><span class="token plain">utf-16le </span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">/dev/null </span><span class="token operator">||</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit international_text.bin </span><span class="token operator">|</span><span class="token plain"> strings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Handle empty results</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">RESULT</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">emit sample.exe </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> pe </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--imphash</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator file-descriptor important" style="color:rgb(189, 147, 249);font-style:italic">2</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">&gt;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">/dev/null</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-z</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$RESULT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;No Imphash available (not a PE file or corrupted)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Imphash: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$RESULT</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Timeout protection for long-running operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">timeout</span><span class="token plain"> </span><span class="token number">300</span><span class="token plain"> emit large_file.bin </span><span class="token operator">|</span><span class="token plain"> complex_analysis </span><span class="token operator">||</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Analysis timed out&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-tips-and-tricks">Advanced Tips and Tricks<a href="#advanced-tips-and-tricks" class="hash-link" aria-label="Direct link to Advanced Tips and Tricks" title="Direct link to Advanced Tips and Tricks" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-unit-development">Custom Unit Development<a href="#custom-unit-development" class="hash-link" aria-label="Direct link to Custom Unit Development" title="Direct link to Custom Unit Development" translate="no">‚Äã</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">#!/usr/bin/env python3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># custom_analysis.py - Custom Binary Refinery unit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> refinery </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Unit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> hashlib</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">threat_score</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Unit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;Calculate threat score based on multiple indicators&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        score </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Check entropy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">0.8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            score </span><span class="token operator">+=</span><span class="token plain"> </span><span class="token number">25</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Check for suspicious strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        suspicious_strings </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">b&#x27;cmd.exe&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">b&#x27;powershell&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">b&#x27;http://&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">b&#x27;bitcoin&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> s </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> suspicious_strings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> s </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                score </span><span class="token operator">+=</span><span class="token plain"> </span><span class="token number">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Check file size (very small or very large files)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">1024</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">or</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">10485760</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            score </span><span class="token operator">+=</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        result </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;Threat Score: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">score</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">/100\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> score </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">70</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            result </span><span class="token operator">+=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Risk Level: HIGH\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">elif</span><span class="token plain"> score </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            result </span><span class="token operator">+=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Risk Level: MEDIUM\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            result </span><span class="token operator">+=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Risk Level: LOW\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> __name__ </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    threat_score</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Use custom unit in pipeline</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit suspicious_file.exe </span><span class="token operator">|</span><span class="token plain"> python3 custom_analysis.py</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-pattern-matching">Advanced Pattern Matching<a href="#advanced-pattern-matching" class="hash-link" aria-label="Direct link to Advanced Pattern Matching" title="Direct link to Advanced Pattern Matching" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Complex regex for advanced IOC extraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit malware.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-P</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;(?=.*[A-Z])(?=.*[a-z])(?=.*\d)[A-Za-z\d]{32,}&#x27;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> potential_keys.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-pattern extraction with context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit sample.exe </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-B</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-A</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;(password|secret|token|key)&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> credential_context.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract structured data patterns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">emit config.bin </span><span class="token operator">|</span><span class="token plain"> strings </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-E</span><span class="token plain"> &#x27;^</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">A-Za-z_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">s*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">:</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">s*.+</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">‚Äã</a></h2>
<p>Binary Refinery represents the pinnacle of command-line binary analysis tools, offering unparalleled flexibility and power for malware analysts, reverse engineers, and digital forensics investigators. This comprehensive guide has covered the complete spectrum of Binary Refinery capabilities, from fundamental operations to advanced automation workflows.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-takeaways">Key Takeaways<a href="#key-takeaways" class="hash-link" aria-label="Direct link to Key Takeaways" title="Direct link to Key Takeaways" translate="no">‚Äã</a></h3>
<p><strong>Technical Mastery</strong></p>
<ul>
<li>Binary Refinery&#x27;s modular architecture enables infinite analysis possibilities through unit composition</li>
<li>Pipeline thinking transforms complex analysis tasks into manageable, repeatable workflows</li>
<li>Custom logic capabilities allow adaptation to any analysis challenge</li>
</ul>
<p><strong>Practical Applications</strong></p>
<ul>
<li>Cryptocurrency malware analysis requires specialized IOC extraction techniques</li>
<li>Ransomware analysis benefits from multi-layer configuration extraction</li>
<li>Supply chain attacks demand comprehensive certificate and build environment analysis</li>
<li>Cloud and container threats require modern detection approaches</li>
</ul>
<p><strong>Professional Excellence</strong></p>
<ul>
<li>Legal compliance and chain of custody are essential for forensic validity</li>
<li>Cross-platform considerations ensure analysis accuracy across different environments</li>
<li>Integration with external tools multiplies analysis effectiveness</li>
<li>Automated workflows enable rapid response to emerging threats</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-capabilities-unlocked">Advanced Capabilities Unlocked<a href="#advanced-capabilities-unlocked" class="hash-link" aria-label="Direct link to Advanced Capabilities Unlocked" title="Direct link to Advanced Capabilities Unlocked" translate="no">‚Äã</a></h3>
<ins>Through this guide, you&#x27;ve mastered:</ins>
<ol>
<li><strong>Specialized Threat Analysis</strong>: Cryptocurrency malware, ransomware, information stealers, mobile threats, and firmware analysis</li>
<li><strong>Advanced Detection</strong>: Fileless malware, evasion techniques, supply chain attacks, and attribution analysis</li>
<li><strong>Automation Excellence</strong>: Incident response automation, threat hunting workflows, and batch processing</li>
<li><strong>Legal Framework</strong>: Compliance requirements, chain of custody, and expert witness reporting</li>
<li><strong>Hands-On Skills</strong>: Progressive training exercises building from basic to expert level</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-path-forward">The Path Forward<a href="#the-path-forward" class="hash-link" aria-label="Direct link to The Path Forward" title="Direct link to The Path Forward" translate="no">‚Äã</a></h3>
<ins>Binary Refinery&#x27;s true power lies not in memorizing every unit, but in developing the analytical mindset to:</ins>
<ul>
<li><strong>Decompose complex problems</strong> into simple, chainable operations</li>
<li><strong>Recognize patterns</strong> across different malware families and attack techniques</li>
<li><strong>Adapt quickly</strong> to new threats and analysis challenges</li>
<li><strong>Automate repetitive tasks</strong> while maintaining analysis quality</li>
<li><strong>Integrate seamlessly</strong> with existing security workflows and tools</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="future-proofing-your-skills">Future-Proofing Your Skills<a href="#future-proofing-your-skills" class="hash-link" aria-label="Direct link to Future-Proofing Your Skills" title="Direct link to Future-Proofing Your Skills" translate="no">‚Äã</a></h3>
<p>As the threat landscape evolves, Binary Refinery&#x27;s extensible architecture ensures your analysis capabilities can grow. New units can be developed for emerging threats, existing workflows can be adapted for novel attack vectors, and the fundamental pipeline approach remains applicable regardless of technological changes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="real-world-impact">Real-World Impact<a href="#real-world-impact" class="hash-link" aria-label="Direct link to Real-World Impact" title="Direct link to Real-World Impact" translate="no">‚Äã</a></h3>
<ins>The techniques covered in this guide have direct applications across the cybersecurity industry:</ins>
<p><strong>Incident Response Teams</strong> can use automated triage scripts to rapidly assess threats and prioritize response efforts.</p>
<p><strong>Threat Intelligence Analysts</strong> can leverage pattern correlation workflows to identify campaign attribution and infrastructure relationships.</p>
<p><strong>Digital Forensics Investigators</strong> can maintain legal compliance while extracting maximum intelligence from evidence.</p>
<p><strong>Malware Researchers</strong> can scale their analysis capabilities through batch processing and custom automation.</p>
<p><strong>Security Operations Centers</strong> can integrate Binary Refinery with SIEM platforms for enhanced threat detection and response.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="community-and-collaboration">Community and Collaboration<a href="#community-and-collaboration" class="hash-link" aria-label="Direct link to Community and Collaboration" title="Direct link to Community and Collaboration" translate="no">‚Äã</a></h3>
<ins>Binary Refinery thrives on community contributions and shared knowledge. Consider:</ins>
<ul>
<li><strong>Contributing custom units</strong> for specialized analysis tasks</li>
<li><strong>Sharing analysis workflows</strong> that solve common challenges</li>
<li><strong>Documenting novel techniques</strong> for complex malware families</li>
<li><strong>Teaching others</strong> through workshops and training materials</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="continuous-learning">Continuous Learning<a href="#continuous-learning" class="hash-link" aria-label="Direct link to Continuous Learning" title="Direct link to Continuous Learning" translate="no">‚Äã</a></h3>
<ins>The cybersecurity field evolves rapidly, and Binary Refinery analysts must stay current:</ins>
<ul>
<li>Monitor new malware families and attack techniques</li>
<li>Practice with diverse sample sets and real-world scenarios</li>
<li>Experiment with new unit combinations and workflow designs</li>
<li>Participate in community discussions and knowledge sharing</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="quality-assurance">Quality Assurance<a href="#quality-assurance" class="hash-link" aria-label="Direct link to Quality Assurance" title="Direct link to Quality Assurance" translate="no">‚Äã</a></h3>
<ins>Professional analysis requires consistent quality standards:</ins>
<ul>
<li><strong>Document all analysis steps</strong> for reproducibility and peer review</li>
<li><strong>Validate findings</strong> through multiple analytical approaches</li>
<li><strong>Maintain tool integrity</strong> through regular updates and verification</li>
<li><strong>Follow ethical guidelines</strong> for responsible disclosure and research</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="final-recommendations">Final Recommendations<a href="#final-recommendations" class="hash-link" aria-label="Direct link to Final Recommendations" title="Direct link to Final Recommendations" translate="no">‚Äã</a></h3>
<ol>
<li><strong>Practice Regularly</strong>: Use the training exercises to maintain and improve your skills</li>
<li><strong>Stay Updated</strong>: Monitor Binary Refinery releases for new capabilities</li>
<li><strong>Share Knowledge</strong>: Contribute to the community with custom units and workflows</li>
<li><strong>Integrate Wisely</strong>: Combine Binary Refinery with other tools for maximum effectiveness</li>
<li><strong>Document Everything</strong>: Maintain detailed analysis logs for learning and legal purposes</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-metrics">Performance Metrics<a href="#performance-metrics" class="hash-link" aria-label="Direct link to Performance Metrics" title="Direct link to Performance Metrics" translate="no">‚Äã</a></h3>
<ins>Track your analysis effectiveness through measurable outcomes:</ins>
<ul>
<li><strong>Time to IOC extraction</strong> from initial sample receipt</li>
<li><strong>Accuracy of threat classification</strong> compared to ground truth</li>
<li><strong>Coverage of analysis scope</strong> across different malware families</li>
<li><strong>Automation ratio</strong> between manual and automated analysis steps</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-research-applications">Advanced Research Applications<a href="#advanced-research-applications" class="hash-link" aria-label="Direct link to Advanced Research Applications" title="Direct link to Advanced Research Applications" translate="no">‚Äã</a></h3>
<ins>Binary Refinery supports cutting-edge cybersecurity research:</ins>
<ul>
<li><strong>Malware evolution tracking</strong> through longitudinal analysis</li>
<li><strong>Campaign attribution</strong> using infrastructure and code similarities</li>
<li><strong>Zero-day discovery</strong> through anomaly detection in sample sets</li>
<li><strong>AI/ML model development</strong> using extracted features and patterns</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="industry-recognition">Industry Recognition<a href="#industry-recognition" class="hash-link" aria-label="Direct link to Industry Recognition" title="Direct link to Industry Recognition" translate="no">‚Äã</a></h3>
<ins>Mastery of Binary Refinery positions analysts for career advancement:</ins>
<ul>
<li><strong>Enhanced job prospects</strong> in threat intelligence and incident response roles</li>
<li><strong>Research publication opportunities</strong> in academic and industry venues</li>
<li><strong>Speaking engagements</strong> at security conferences and workshops</li>
<li><strong>Consulting opportunities</strong> for specialized analysis projects</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ethical-considerations">Ethical Considerations<a href="#ethical-considerations" class="hash-link" aria-label="Direct link to Ethical Considerations" title="Direct link to Ethical Considerations" translate="no">‚Äã</a></h3>
<ins>Responsible use of Binary Refinery requires ethical awareness:</ins>
<ul>
<li><strong>Respect for intellectual property</strong> when analyzing commercial software</li>
<li><strong>Privacy protection</strong> when handling samples containing personal data</li>
<li><strong>Responsible disclosure</strong> of vulnerabilities discovered during analysis</li>
<li><strong>Legal compliance</strong> with jurisdiction-specific regulations</li>
</ul>
<p>The cybersecurity community benefits when analysts share knowledge and techniques while maintaining ethical standards. Your mastery of Binary Refinery contributes to the collective defense against evolving threats.</p>
<p>Binary Refinery is more than a tool‚Äîit&#x27;s a methodology for approaching binary analysis with precision, creativity, and effectiveness. Armed with the knowledge from this comprehensive guide, you&#x27;re prepared to tackle any binary analysis challenge with confidence and expertise.</p>
<p>Whether you&#x27;re investigating the latest ransomware campaign, hunting for advanced persistent threats, or conducting digital forensics examinations, Binary Refinery provides the flexibility and power to extract maximum intelligence from binary data.</p>
<p>The techniques you&#x27;ve learned will serve as a foundation for continued growth and specialization in the dynamic field of cybersecurity. As new threats emerge and analysis challenges evolve, the principles and practices outlined in this guide will remain relevant and valuable.</p>
<p><strong>Happy Refining!</strong></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-this-guide">About This Guide<a href="#about-this-guide" class="hash-link" aria-label="Direct link to About This Guide" title="Direct link to About This Guide" translate="no">‚Äã</a></h2>
<p>This comprehensive Binary Refinery guide represents the collective knowledge and experience of cybersecurity professionals worldwide. It serves as both a learning resource for newcomers and a practical reference for experienced analysts.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="acknowledgments">Acknowledgments<a href="#acknowledgments" class="hash-link" aria-label="Direct link to Acknowledgments" title="Direct link to Acknowledgments" translate="no">‚Äã</a></h3>
<p>Special thanks to the Binary Refinery development team and the broader cybersecurity community for their contributions to this field. The techniques and workflows documented here build upon years of research, practice, and knowledge sharing.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contributing-to-this-guide">Contributing to This Guide<a href="#contributing-to-this-guide" class="hash-link" aria-label="Direct link to Contributing to This Guide" title="Direct link to Contributing to This Guide" translate="no">‚Äã</a></h3>
<ins>This guide benefits from community input and real-world experience. Contributors are encouraged to:</ins>
<ul>
<li>Submit corrections and improvements</li>
<li>Share additional use cases and workflows</li>
<li>Provide feedback on training exercises</li>
<li>Suggest new topics and techniques</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="feedback-and-support">Feedback and Support<a href="#feedback-and-support" class="hash-link" aria-label="Direct link to Feedback and Support" title="Direct link to Feedback and Support" translate="no">‚Äã</a></h3>
<ins>For questions, suggestions, or technical support related to this guide:</ins>
<ul>
<li>Visit the Binary Refinery GitHub repository for the latest updates</li>
<li>Participate in community forums and discussions</li>
<li>Contact the authors through appropriate channels</li>
<li>Share your success stories and use cases</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="version-history">Version History<a href="#version-history" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History" translate="no">‚Äã</a></h3>
<ul>
<li><strong>v1.0</strong>: Initial comprehensive guide release</li>
<li><strong>v2.0</strong>: Added specialized malware analysis sections</li>
<li><strong>v3.0</strong>: Complete rewrite with advanced automation, legal compliance, and training exercises</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="legal-notice">Legal Notice<a href="#legal-notice" class="hash-link" aria-label="Direct link to Legal Notice" title="Direct link to Legal Notice" translate="no">‚Äã</a></h3>
<p>This guide is intended for legitimate cybersecurity research, education, and defense purposes. Users are responsible for ensuring compliance with applicable laws and regulations in their jurisdiction. The techniques described should only be used on authorized systems and with appropriate legal permissions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="copyright-and-license">Copyright and License<a href="#copyright-and-license" class="hash-link" aria-label="Direct link to Copyright and License" title="Direct link to Copyright and License" translate="no">‚Äã</a></h3>
<p>This guide is provided for educational and professional use. Proper attribution is requested when referencing or building upon this work. The goal is to advance cybersecurity knowledge and capabilities while maintaining ethical standards.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references-and-further-reading">References and Further Reading<a href="#references-and-further-reading" class="hash-link" aria-label="Direct link to References and Further Reading" title="Direct link to References and Further Reading" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="official-documentation-and-resources">Official Documentation and Resources<a href="#official-documentation-and-resources" class="hash-link" aria-label="Direct link to Official Documentation and Resources" title="Direct link to Official Documentation and Resources" translate="no">‚Äã</a></h3>
<ul>
<li><a href="https://github.com/binref/refinery" target="_blank" rel="noopener noreferrer">Binary Refinery GitHub Repository</a> - Official source code, documentation, and issue tracking</li>
<li><a href="https://binref.github.io/" target="_blank" rel="noopener noreferrer">Binary Refinery Documentation</a> - Comprehensive API reference and unit documentation</li>
<li><a href="https://pypi.org/project/binary-refinery/" target="_blank" rel="noopener noreferrer">Binary Refinery PyPI Package</a> - Official Python package distribution</li>
</ul>
<p><strong>Last Updated</strong>: June 22, 2025<br>
<strong>Version</strong>: Comprehensive Binary Refinery Practical Guide v3.0<br>
<strong>Total Length</strong>: 50,000+ words of comprehensive Binary Refinery expertise<br>
<strong>Exercises Included</strong>: 6 progressive hands-on training labs<br>
<strong>Workflows Documented</strong>: 25+ real-world analysis scenarios<br>
<strong>Integration Examples</strong>: 15+ external tool integrations</p>
<p><em>Your definitive reference for mastering binary analysis in cybersecurity investigations.</em></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/malware-analysis">malware-analysis</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/security-tools">security-tools</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/binary-analysis">binary-analysis</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/forensics">forensics</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/reverse-engineering">reverse-engineering</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/gl0bal01/gl0bal01.github.io/tree/main/docs/reverse/binary_refinery.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-07-01T00:00:00.000Z" itemprop="dateModified">Jul 1, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/reverse/gdb-gef-practical-examples"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Buffer Overflow Exploitation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cheatsheets"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cheatsheets</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#introduction--core-concepts" class="table-of-contents__link toc-highlight">Introduction &amp; Core Concepts</a><ul><li><a href="#what-makes-binary-refinery-special" class="table-of-contents__link toc-highlight">What Makes Binary Refinery Special</a></li><li><a href="#core-units-every-analyst-should-know" class="table-of-contents__link toc-highlight">Core Units Every Analyst Should Know</a></li></ul></li><li><a href="#installation--setup" class="table-of-contents__link toc-highlight">Installation &amp; Setup</a><ul><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#installation-steps" class="table-of-contents__link toc-highlight">Installation Steps</a></li><li><a href="#configuration-options" class="table-of-contents__link toc-highlight">Configuration Options</a></li></ul></li><li><a href="#fundamental-operations" class="table-of-contents__link toc-highlight">Fundamental Operations</a><ul><li><a href="#data-input-and-output" class="table-of-contents__link toc-highlight">Data Input and Output</a></li><li><a href="#data-inspection-with-peek" class="table-of-contents__link toc-highlight">Data Inspection with peek</a></li><li><a href="#string-operations" class="table-of-contents__link toc-highlight">String Operations</a></li></ul></li><li><a href="#data-transformation--encoding" class="table-of-contents__link toc-highlight">Data Transformation &amp; Encoding</a><ul><li><a href="#encoding-and-decoding-operations" class="table-of-contents__link toc-highlight">Encoding and Decoding Operations</a></li><li><a href="#compression-and-decompression" class="table-of-contents__link toc-highlight">Compression and Decompression</a></li><li><a href="#advanced-encoding-chains" class="table-of-contents__link toc-highlight">Advanced Encoding Chains</a></li></ul></li><li><a href="#file-format-analysis" class="table-of-contents__link toc-highlight">File Format Analysis</a><ul><li><a href="#portable-executable-pe-analysis" class="table-of-contents__link toc-highlight">Portable Executable (PE) Analysis</a></li><li><a href="#ole-document-analysis" class="table-of-contents__link toc-highlight">OLE Document Analysis</a></li><li><a href="#pdf-analysis" class="table-of-contents__link toc-highlight">PDF Analysis</a></li><li><a href="#archive-analysis" class="table-of-contents__link toc-highlight">Archive Analysis</a></li></ul></li><li><a href="#advanced-deobfuscation-techniques" class="table-of-contents__link toc-highlight">Advanced Deobfuscation Techniques</a><ul><li><a href="#xor-operations" class="table-of-contents__link toc-highlight">XOR Operations</a></li><li><a href="#custom-deobfuscation" class="table-of-contents__link toc-highlight">Custom Deobfuscation</a></li><li><a href="#multi-stage-deobfuscation" class="table-of-contents__link toc-highlight">Multi-Stage Deobfuscation</a></li></ul></li><li><a href="#malware-analysis-workflows" class="table-of-contents__link toc-highlight">Malware Analysis Workflows</a><ul><li><a href="#initial-triage-pipeline" class="table-of-contents__link toc-highlight">Initial Triage Pipeline</a></li><li><a href="#configuration-extraction" class="table-of-contents__link toc-highlight">Configuration Extraction</a></li><li><a href="#payload-extraction" class="table-of-contents__link toc-highlight">Payload Extraction</a></li></ul></li><li><a href="#network-traffic-analysis" class="table-of-contents__link toc-highlight">Network Traffic Analysis</a><ul><li><a href="#pcap-file-analysis" class="table-of-contents__link toc-highlight">PCAP File Analysis</a></li><li><a href="#protocol-analysis" class="table-of-contents__link toc-highlight">Protocol Analysis</a></li></ul></li><li><a href="#advanced-pipeline-management" class="table-of-contents__link toc-highlight">Advanced Pipeline Management</a><ul><li><a href="#variable-management" class="table-of-contents__link toc-highlight">Variable Management</a></li><li><a href="#conditional-logic" class="table-of-contents__link toc-highlight">Conditional Logic</a></li><li><a href="#frame-operations" class="table-of-contents__link toc-highlight">Frame Operations</a></li></ul></li><li><a href="#real-world-case-studies" class="table-of-contents__link toc-highlight">Real-World Case Studies</a><ul><li><a href="#case-study-1-phishing-email-analysis" class="table-of-contents__link toc-highlight">Case Study 1: Phishing Email Analysis</a></li><li><a href="#case-study-2-document-based-attack" class="table-of-contents__link toc-highlight">Case Study 2: Document-Based Attack</a></li><li><a href="#case-study-3-memory-dump-analysis" class="table-of-contents__link toc-highlight">Case Study 3: Memory Dump Analysis</a></li></ul></li><li><a href="#specialized-malware-analysis" class="table-of-contents__link toc-highlight">Specialized Malware Analysis</a><ul><li><a href="#cryptocurrency-malware-analysis" class="table-of-contents__link toc-highlight">Cryptocurrency Malware Analysis</a></li><li><a href="#ransomware-analysis-workflows" class="table-of-contents__link toc-highlight">Ransomware Analysis Workflows</a></li><li><a href="#information-stealer-analysis" class="table-of-contents__link toc-highlight">Information Stealer Analysis</a></li><li><a href="#mobile-malware-apk-analysis" class="table-of-contents__link toc-highlight">Mobile Malware (APK Analysis)</a></li><li><a href="#firmware-and-iot-malware-analysis" class="table-of-contents__link toc-highlight">Firmware and IoT Malware Analysis</a></li></ul></li><li><a href="#advanced-threat-detection" class="table-of-contents__link toc-highlight">Advanced Threat Detection</a><ul><li><a href="#fileless-malware-detection" class="table-of-contents__link toc-highlight">Fileless Malware Detection</a></li><li><a href="#advanced-evasion-techniques" class="table-of-contents__link toc-highlight">Advanced Evasion Techniques</a></li><li><a href="#supply-chain-attack-analysis" class="table-of-contents__link toc-highlight">Supply Chain Attack Analysis</a></li></ul></li><li><a href="#automated-analysis--response" class="table-of-contents__link toc-highlight">Automated Analysis &amp; Response</a><ul><li><a href="#incident-response-automation" class="table-of-contents__link toc-highlight">Incident Response Automation</a></li><li><a href="#threat-hunting-workflows" class="table-of-contents__link toc-highlight">Threat Hunting Workflows</a></li><li><a href="#cloud-malware-analysis" class="table-of-contents__link toc-highlight">Cloud Malware Analysis</a></li></ul></li><li><a href="#cross-platform-considerations" class="table-of-contents__link toc-highlight">Cross-Platform Considerations</a><ul><li><a href="#windows-specific-analysis" class="table-of-contents__link toc-highlight">Windows-Specific Analysis</a></li><li><a href="#linux-specific-analysis" class="table-of-contents__link toc-highlight">Linux-Specific Analysis</a></li><li><a href="#macos-specific-analysis" class="table-of-contents__link toc-highlight">macOS-Specific Analysis</a></li><li><a href="#cross-platform-compatibility" class="table-of-contents__link toc-highlight">Cross-Platform Compatibility</a></li></ul></li><li><a href="#compliance--legal-framework" class="table-of-contents__link toc-highlight">Compliance &amp; Legal Framework</a><ul><li><a href="#chain-of-custody" class="table-of-contents__link toc-highlight">Chain of Custody</a></li><li><a href="#data-privacy-and-gdpr-compliance" class="table-of-contents__link toc-highlight">Data Privacy and GDPR Compliance</a></li><li><a href="#legal-reporting-standards" class="table-of-contents__link toc-highlight">Legal Reporting Standards</a></li></ul></li><li><a href="#training-exercises" class="table-of-contents__link toc-highlight">Training Exercises</a><ul><li><a href="#exercise-1-basic-malware-triage" class="table-of-contents__link toc-highlight">Exercise 1: Basic Malware Triage</a></li><li><a href="#exercise-2-pe-file-analysis" class="table-of-contents__link toc-highlight">Exercise 2: PE File Analysis</a></li><li><a href="#exercise-3-document-malware-analysis" class="table-of-contents__link toc-highlight">Exercise 3: Document Malware Analysis</a></li><li><a href="#exercise-4-memory-dump-analysis" class="table-of-contents__link toc-highlight">Exercise 4: Memory Dump Analysis</a></li><li><a href="#exercise-5-advanced-deobfuscation-challenge" class="table-of-contents__link toc-highlight">Exercise 5: Advanced Deobfuscation Challenge</a></li><li><a href="#exercise-6-comprehensive-analysis-challenge" class="table-of-contents__link toc-highlight">Exercise 6: Comprehensive Analysis Challenge</a></li><li><a href="#training-exercise-solutions" class="table-of-contents__link toc-highlight">Training Exercise Solutions</a></li></ul></li><li><a href="#integration-with-external-tools" class="table-of-contents__link toc-highlight">Integration with External Tools</a><ul><li><a href="#virustotal-integration" class="table-of-contents__link toc-highlight">VirusTotal Integration</a></li><li><a href="#yara-rule-development" class="table-of-contents__link toc-highlight">YARA Rule Development</a></li><li><a href="#volatility-integration" class="table-of-contents__link toc-highlight">Volatility Integration</a></li><li><a href="#siem-integration" class="table-of-contents__link toc-highlight">SIEM Integration</a></li></ul></li><li><a href="#best-practices--performance" class="table-of-contents__link toc-highlight">Best Practices &amp; Performance</a><ul><li><a href="#performance-optimization" class="table-of-contents__link toc-highlight">Performance Optimization</a></li><li><a href="#security-considerations" class="table-of-contents__link toc-highlight">Security Considerations</a></li><li><a href="#error-handling-and-debugging" class="table-of-contents__link toc-highlight">Error Handling and Debugging</a></li><li><a href="#advanced-tips-and-tricks" class="table-of-contents__link toc-highlight">Advanced Tips and Tricks</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a><ul><li><a href="#key-takeaways" class="table-of-contents__link toc-highlight">Key Takeaways</a></li><li><a href="#advanced-capabilities-unlocked" class="table-of-contents__link toc-highlight">Advanced Capabilities Unlocked</a></li><li><a href="#the-path-forward" class="table-of-contents__link toc-highlight">The Path Forward</a></li><li><a href="#future-proofing-your-skills" class="table-of-contents__link toc-highlight">Future-Proofing Your Skills</a></li><li><a href="#real-world-impact" class="table-of-contents__link toc-highlight">Real-World Impact</a></li><li><a href="#community-and-collaboration" class="table-of-contents__link toc-highlight">Community and Collaboration</a></li><li><a href="#continuous-learning" class="table-of-contents__link toc-highlight">Continuous Learning</a></li><li><a href="#quality-assurance" class="table-of-contents__link toc-highlight">Quality Assurance</a></li><li><a href="#final-recommendations" class="table-of-contents__link toc-highlight">Final Recommendations</a></li><li><a href="#performance-metrics" class="table-of-contents__link toc-highlight">Performance Metrics</a></li><li><a href="#advanced-research-applications" class="table-of-contents__link toc-highlight">Advanced Research Applications</a></li><li><a href="#industry-recognition" class="table-of-contents__link toc-highlight">Industry Recognition</a></li><li><a href="#ethical-considerations" class="table-of-contents__link toc-highlight">Ethical Considerations</a></li></ul></li><li><a href="#about-this-guide" class="table-of-contents__link toc-highlight">About This Guide</a><ul><li><a href="#acknowledgments" class="table-of-contents__link toc-highlight">Acknowledgments</a></li><li><a href="#contributing-to-this-guide" class="table-of-contents__link toc-highlight">Contributing to This Guide</a></li><li><a href="#feedback-and-support" class="table-of-contents__link toc-highlight">Feedback and Support</a></li><li><a href="#version-history" class="table-of-contents__link toc-highlight">Version History</a></li><li><a href="#legal-notice" class="table-of-contents__link toc-highlight">Legal Notice</a></li><li><a href="#copyright-and-license" class="table-of-contents__link toc-highlight">Copyright and License</a></li></ul></li><li><a href="#references-and-further-reading" class="table-of-contents__link toc-highlight">References and Further Reading</a><ul><li><a href="#official-documentation-and-resources" class="table-of-contents__link toc-highlight">Official Documentation and Resources</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">¬© 2025 gl0bal01. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>